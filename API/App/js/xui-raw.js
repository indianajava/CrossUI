var root,factory;root="undefined"!=typeof window?window:this,factory=function(){
/*!
* CrossUI(xui) JavaScript Library v3.0
* https://crossui.com
*
* Copyright ( 2004 ~ present) CrossUI.com
* Released under the MIT license
*
*/
var undefined,window=this,document=window.document,xui=window.xui=function(nodes,flag){return xui.Dom.pack(nodes,flag)},root,factory;return xui.window=window,xui.Class=function(key,pkey,obj){var _Static,parent0,_this,i,t,_t,_parent=[],self=xui.Class,w=xui.window,env=self._fun,reg=self._reg,_c=self._all,_funadj=function(str){return(str+"").replace(/(\s*\/\*[^*]*\*+([^\/][^*]*\*+)*\/)|(\s*\/\/[^\n]*)|(\)[\s\S]*)/g,(function(a){return")"!=a.charAt(0)?"":a}))};if(obj=obj||{},!self._ignoreNSCache&&(t=xui.get(w,key.split(".")))&&"function"==typeof t&&t.$xuiclass$)return self._last=t;for((t=xui.get(w,["xui","$cache","SC"]))&&delete t[key],pkey=pkey?"string"==typeof pkey?[pkey]:pkey:[],i=0;t=pkey[i];i++)if(!(_parent[i]=xui.get(w,t.split("."))||xui.get(window,t.split("."))||xui&&xui.SC&&xui.SC(t)))throw new Error("errNoParent--"+t);if(obj.Required)for("string"==typeof obj.Required&&(obj.Required=[obj.Required]),i=0;t=obj.Required[i];i++)if(!(xui.get(w,t.split("."))||xui&&xui.SC&&xui.SC(t)))throw new Error("errNoRequiredClass--"+t);parent0=_parent[0];var $Start=obj.$Start||parent0&&parent0.$Start;for(i in xui.tryF($Start,[],obj),t={},_Static=obj.Static||{})reg[i]&&(t[i]=1);for(i in t)delete _Static[i];_Static.Before=obj.Before||parent0&&parent0.Before,_Static.After=obj.After||parent0&&parent0.After,_Static.$Start=$Start,_Static.$End=obj.$End||parent0&&parent0.$End,_Static.__gc=obj.__gc||_Static.__gc||parent0&&parent0.__gc||function(){xui.Class.__gc(this.$key)};var cf=function(){xui.Class.$instanceCreated&&xui.Class.$instanceCreated(this),"function"==typeof this.initialize&&this.initialize()};if("function"==typeof obj.Constructor)(_this=env(obj.Constructor,"Constructor",key,parent0||cf,"constructor")).Constructor=_funadj(obj.Constructor);else if(parent0){var f=cf,str=parent0.Constructor;str&&(f=new Function(str.slice(str.indexOf("(")+1,str.indexOf(")")).split(","),str.slice(str.indexOf("{")+1,str.lastIndexOf("}")))),(_this=env(f,"Constructor",key,parent0.upper,"constructor")).Constructor=_funadj(str)}else _this=cf;for(_t=xui.fun(),i=_parent.length-1;t=_parent[i--];)xui.merge(_t,t),xui.merge(_t.prototype,t.prototype);if(_this.KEY=_this.$key=_this.prototype.KEY=_this.prototype.$key=key,self._wrap(_this,_Static,0,_t,"static"),(t=obj.Instance)&&self._wrap(_this.prototype,t,1,_t.prototype,"instance"),self._inherit(_this,_t),self._inherit(_this.prototype,_t.prototype),_t=null,!1===xui.tryF(_this.Before,arguments,_this))return!1;for(i=0;t=_parent[i];i++){for(var b,j=0,k=(t=t.$children||(t.$children=[])).length;j<k;j++)if(t[k]==key){b=!0;break}b||(t[t.length]=key)}if(_this.$xui$=_this.$xuiclass$=1,_this.$children=[],_this.$parent=_parent,_this.prototype.constructor=_this,_this.prototype.$xui$=1,_this[key]=_this.prototype[key]=!0,_t=t=xui.get(w,key.split(".")),xui.set(w,key.split("."),_this),"[object Object]"==Object.prototype.toString.call(_t))for(i in _t)_this[i]=_t[i];return xui.tryF(_this.After,[],_this),xui.tryF(obj.Initialize,[],_this),xui.tryF(_this.$End,[],_this),xui.breakO([obj.Static,obj.Instance,obj],2),key in _c||(_c[key]=_c.length,_c.push(key)),self._last=_this},xui.Namespace=function(key){var a=key.split("."),w=xui.window;return xui.get(w,a)||(xui.Namespace._all[a[0]]=1)&&xui.set(w,a,{})},xui.Namespace._all={},xui.merge=function(target,source,type,force){var i,f;switch("function"==typeof type&&(f=type,type="fun"),type){case"fun":for(i in source)(force||source.hasOwnProperty(i))&&!0===f(source[i],i)&&(target[i]=source[i]);break;case"all":for(i in source)(force||source.hasOwnProperty(i))&&(target[i]=source[i]);break;case"with":for(i in source)(force||source.hasOwnProperty(i))&&target.hasOwnProperty(i)&&(target[i]=source[i]);break;default:for(i in source)!force&&!source.hasOwnProperty(i)||target.hasOwnProperty(i)||(target[i]=source[i])}return target},new function(){for(var tag,lastTime=0,vendors=["ms","moz","webkit","o"],w=window,i=0,l=vendors.length;i<l&&!w.requestAnimationFrame&&(tag=vendors[i++]);)w.requestAnimationFrame=w[tag+"RequestAnimationFrame"],w.cancelAnimationFrame=w[tag+"CancelAnimationFrame"]||w[tag+"CancelRequestAnimationFrame"];w.requestAnimationFrame=w.requestAnimationFrame||function(callback,element){var currTime=(new Date).getTime(),timeToCall=Math.max(0,1e3/60-(currTime-lastTime)),id=setTimeout((function(){callback(currTime+timeToCall)}),timeToCall);return lastTime=currTime+timeToCall,id},w.cancelAnimationFrame=w.cancelAnimationFrame||function(id){clearTimeout(id)},w.requestIdleCallback=w.requestIdleCallback||function(cb){return setTimeout((function(){var start=Date.now();cb({didTimeout:!1,timeRemaining:function(){return Math.max(0,50-(Date.now()-start))}})}),1)},w.cancelIdleCallback=w.cancelIdleCallback||function(id){clearTimeout(id)}},new function(){var _to=Object.prototype.toString;xui.merge(xui,{stamp:function(){return+new Date},rand:function(head,tail){return(head||"")+parseInt(xui.stamp()*Math.random(),10).toString(36)+(tail||"")},setTimeout:function(callback,delay){return!1===delay||(delay||0)>1e3/60?-1*setTimeout(callback,delay||0):requestAnimationFrame(callback)},clearTimeout:function(id){id>=0?cancelAnimationFrame(id):clearTimeout(Math.abs(id))},fun:function(){return function(){}},exec:function(script,id,closure){var n,d=document,h=d.getElementsByTagName("head")[0]||d.documentElement,s=d.createElement("script");return closure&&(script="!function(){"+script+"}(xui.window)"),s.type="text/javascript",id&&((n=d.getElementById(id))&&n.parentNode==h&&h.removeChild(n),s.id=id),xui.browser.ie?s.text=script:s.appendChild(d.createTextNode(script)),h.appendChild(s),s.disalbed=!0,s.disabled=!1,id||h.removeChild(s),s},_s2a:function(s){return(s+"").replace(/^\[/,"").replace(/\]$/,"").split(/\s*[\[\]\.]\s*[\[\]\.]?\s*/)},get:function(hash,path,deep){if(!path)return hash;if(!xui.isSet(hash))return undefined;if(deep&&(path=xui._s2a(path)),"string"==typeof path)return hash[path];for(var t,i=0,l=path.length;i<l;)if((t=path[i++]+"")&&(!hash||(hash=t!=(t=t.replace("()",""))?"function"==typeof hash[t]&&0!==t.indexOf("set")?hash[t]():undefined:hash[t])===undefined))return;return hash},set:function(hash,path,value,deep){if(hash){if(deep&&(path=xui._s2a(path)),"string"!=typeof path){for(var v,m,i=0,last=path.length-1;i<last;)hash=!hash[v=path[i++]]||"object"!=(m=typeof hash[v])&&"function"!=m?hash[v]={}:hash[v];path=path[last]}if(path!=(path=(path+"").replace("()",""))){if("function"==typeof hash[path])return hash[path](value),value}else{if(value!==undefined)return hash[path]=value;hash.hasOwnProperty&&hash.hasOwnProperty(path)?delete hash[path]:hash[path]=undefined}}},clonePath:function(obj,path){var i,l1,p2=[],l2=path.length;return xui.clone(obj,(function(v,k,deep,h){if(i=0,p2[deep-1]=k,p2.splice(deep),(l1=p2.length)>l2)return h[k]=v,!1;for(;i<=l1-1;){if(path[i]!==p2[i])return h[k]=v,!1;i++}}))},tryF:function(fun,args,scope,df){return fun&&"function"==typeof fun?fun.apply(scope||{},args||[]):df},asyRun:function(fun,defer,args,scope){return xui.setTimeout("string"==typeof fun?function(){xui.exec(fun)}:function(){fun.apply(scope,args||[]),fun=args=null},defer)},idleRun:function(fun,args,scope){return window.requestIdleCallback("string"==typeof fun?function(){xui.exec(fun)}:function(){fun.apply(scope,args||[]),fun=args=null})},asyHTML:function(content,callback,defer,size){var div=document.createElement("div"),fragment=document.createDocumentFragment(),f=function(){for(var i=size||10;--i&&div.firstChild;)fragment.appendChild(div.firstChild);div.firstChild?xui.setTimeout(f,defer):callback(fragment)};div.innerHTML=content,f()},isEmpty:function(hash){if(xui.isSet(hash)){if(!0===hash)return!1;if(xui.isNumb(hash))return!1;if(xui.isHash(hash)){for(var i in hash)if(Object.prototype.hasOwnProperty.call(hash,i))return!1;return!0}return!!(xui.isArr(hash)||xui.isStr(hash)||xui.isArguments(hash))&&0===hash.length}return!0},resetRun:function(key,fun,defer,args,scope){var task,me=xui.resetRun,cache=me.$cache||(me.get=me.exists=function(k){return this.$cache[k]})&&(me.run=function(k,c){(c=this.$cache[k])&&(xui.clearTimeout(c.id),c.task(),delete this.$cache[k])})&&(me.cancel=function(k){xui.resetRun(k)})&&(me.$cache={});cache[key]&&xui.clearTimeout(cache[key].id),"function"==typeof fun?(task=function(){delete cache[key],fun.apply(scope||null,args||[])},cache[key]={id:xui.setTimeout(task,defer),task:task}):delete cache[key]},observableRun:function(tasks,onEnd,threadid,busyMsg){xui.Thread.observableRun(tasks,onEnd,threadid,busyMsg)},breakO:function(target,depth,_layer){var i,n=depth||1,l=1+(_layer||0),self=xui.breakO,_t="___gc_";if(target&&("object"==typeof target||"function"==typeof target)&&target!==window&&target!==document&&1!==target.nodeType){try{if(target.hasOwnProperty(_t))return;target[_t]=null}catch(e){return}try{for(i in target)if(target.hasOwnProperty(i)&&target[i]){"object"!=typeof target[i]&&"function"!=typeof target[i]||l<n&&self(target[i],n,l);try{target[i]=null}catch(e){}}}catch(e){return}target.length&&(target.length=0),delete target[_t]}},each:function(hash,fun,scope){for(var i in scope=scope||hash,hash)if(!1===fun.call(scope,hash[i],i,hash))break;return hash},compareVar:function(x,y,MAXL,MAXS){return x===y||(xui.isObj(x)||xui.isObj(y)?xui.isDate(x)&&xui.isDate(y)||xui.isReg(x)&&xui.isReg(y)?x+""==y+"":!!(xui.isHash(x)&&xui.isHash(y)||xui.isArr(x)&&xui.isArr(y)||xui.isArguments(x)&&xui.isArguments(y))&&(x=xui.serialize(x,0,0,MAXL||5,MAXS||300),y=xui.serialize(y,0,0,MAXL||5,MAXS||300),-1==x.indexOf(xui.$_outofmilimted)&&-1==y.indexOf(xui.$_outofmilimted)&&x===y):void 0)},compareNumber:function(a,b,digits){return xui.toFixedNumber(a,digits)===xui.toFixedNumber(b,digits)},toFixedNumber:function(number,digits){xui.isSet(digits)||(digits=2);var v,t,start,end,m=Math.abs(number),s=""+Math.round(m*Math.pow(10,digits));if(/\D/.test(s))v=""+m;else{for(;s.length<1+digits;)s="0"+s;start=s.substring(0,t=s.length-digits),(end=s.substring(t))&&(end="."+end),v=start+end}return parseFloat((number<0?"-":"")+v)},toNumeric:function(value,precision,groupingSeparator,decimalSeparator){return xui.isNumb(value)||(value=parseFloat((value+"").replace(/\s*(e\+|[^0-9])/g,(function(a,b,c){return"e+"==b||"E+"==b||0==c&&"-"==b?b:b==decimalSeparator?".":""})))||0),xui.isSet(precision)&&precision>=0&&(value=xui.toFixedNumber(value,precision)),value},formatNumeric:function(value,precision,groupingSeparator,decimalSeparator,forceFillZero,trimTailZero){return xui.isSet(precision)&&(precision=parseInt(precision,10)),precision=precision||0===precision?precision:0,groupingSeparator=xui.isSet(groupingSeparator)?groupingSeparator:",",decimalSeparator=decimalSeparator||".",-1==(value=""+parseFloat(value)).indexOf("e")&&(value=(value=xui.toFixedNumber(value,precision)+"").split("."),!1!==forceFillZero&&(value[1]?value[1].length:0)<precision&&(value[1]=(value[1]||"")+xui.str.repeat("0",precision-(value[1]?value[1].length:0))),value[0]=value[0].split("").reverse().join("").replace(/(\d{3})(?=\d)/g,"$1"+groupingSeparator).split("").reverse().join(""),value=value.join(decimalSeparator)),trimTailZero&&-1!=value.indexOf(decimalSeparator)?value.replace(new RegExp("["+decimalSeparator+"]?0+$"),""):value},replace:function(str,reg,replace,ignore_case){if(!str)return"";var i,len,_t,m,n,flag,a1=[],a2=[],me=arguments.callee,reg3=me.reg3||(me.reg3=/\$\d/),reg4=me.reg4||(me.reg4=/^\$\d+$/),reg5=me.reg5||(me.reg5=/'/),reg6=me.reg6||(me.reg6=/\\./g),reg11=me.reg11||(me.reg11=/(['"])\1\+(.*)\+\1\1$/);return xui.isArr(reg)?ignore_case=replace:reg=[reg,replace],xui.isArr(reg[0])||(reg=[reg]),xui.arr.each(reg,(function(o){if(m="string"==typeof o[0]?o[0]:o[0].source,n=o[1]||"",len=new RegExp("("+m+")|[\\s\\S]").exec(" ").length-2,"function"!=typeof n&&reg3.test(n))if(reg4.test(n))(_t=parseInt(n.slice(1),10))<=len&&(n=_t);else{for(flag=reg5.test(n.replace(reg6,""))?'"':"'",i=len;i+1;)n=n.split("$"+i).join(flag+"+a[o+"+i--+"]+"+flag);n=new Function("a,o","return"+flag+n.replace(reg11,"$1")+flag)}a1.push(m||"^$"),a2.push([n,len,typeof n])})),str.replace(new RegExp("("+a1.join(")|(")+")",ignore_case?"gim":"gm"),(function(){var p,i=1,j=0,args=arguments;if(!args[0])return"";for(;p=a2[j++];)if(args[i])switch(p[2]){case"function":return p[0](args,i,j-1);case"number":return args[p[0]+i];default:return p[0]}else i+=p[1]+1}))},copy:function(hash,filter){return xui.clone(hash,filter,1)},clone:function(hash,filter,deep,_layer){if(_layer=_layer||0,hash&&(xui.isHash(hash)||xui.isArr(hash))){if(xui.isObj(hash)){var v,l,me=xui.clone,isArr=xui.isArr(hash),h=isArr?[]:{},i=0;if(xui.isSet(deep)){if(deep<=0)return hash}else deep=100;if(isArr)for(l=hash.length;i<l;i++)"function"==typeof filter&&!1===filter.call(hash,hash[i],i,_layer+1,h)||(h[h.length]=(v=hash[i])&&deep&&(xui.isHash(v)||xui.isArr(v))?me(v,filter,deep-1,_layer+1):v);else for(i in hash)(!0===filter?"_"!=i.charAt(0):!1===filter?"_"!=i.charAt(0)&&"$"!=i.charAt(0):"function"!=typeof filter||!1!==filter.call(hash,hash[i],i,_layer+1,h))&&(h[i]=(v=hash[i])&&deep&&(xui.isHash(v)||xui.isArr(v))?me(v,filter,deep-1,_layer+1):v);return h}return hash}return hash},deepEquals:function(x,y,deep,ignore,_curLayer){if(xui.isSet(deep)||(deep=100),xui.isSet(_curLayer)||(_curLayer=1),x===y)return!0;if(!(x instanceof Object&&y instanceof Object))return!1;if(x.constructor!==y.constructor)return!1;for(let p in x)if((!ignore||!ignore(p))&&x.hasOwnProperty(p)){if(!y.hasOwnProperty(p))return!1;if(x[p]!==y[p]){if("object"!=typeof x[p])return!1;if(!(xui.isHash(x[p])&&xui.isHash(y[p])&&xui.isEmpty(x[p])&&xui.isEmpty(y[p])||xui.isArr(x[p])&&xui.isArr(y[p])&&0===x[p].length&&0===y[p].length))if(_curLayer>=deep){if(x[p]!==y[p])return!1}else if(!xui.deepEquals(x[p],y[p],deep,ignore,_curLayer+1))return!1}}for(let p in y)if(y.hasOwnProperty(p)&&!x.hasOwnProperty(p))return!1;return!0},filter:function(obj,filter,force){if(!force&&obj&&xui.isArr(obj)){var l,a=[];for(i=0,l=obj.length;i<l;i++)a[a.length]=obj[i];for(obj.length=0,i=0,l=a.length;i<l;i++)"function"==typeof filter&&!1===filter.call(a,a[i],i)||(obj[obj.length]=a[i])}else{var i,bak={};for(i in obj)(!0===filter?"_"==i.charAt(0):!1===filter?"_"==i.charAt(0)||"$"==i.charAt(0):"function"==typeof filter&&!1===filter.call(obj,obj[i],i))&&(bak[i]=1);for(i in bak)delete obj[i]}return obj},toArr:function(value,flag){if(!value)return[];var arr=[];if("boolean"==typeof flag)for(var i in value)arr[arr.length]=flag?i:value[i];else if(xui.isHash(value))for(var i in value)arr.push({key:i,value:value[i]});else if("string"==typeof value)arr=value.split(flag||",");else{i=0;for(var l=value.length;i<l;++i)arr[i]=value[i]}return arr},toUTF8:function(str){return str.replace(/[^\x00-\xff]/g,(function(a,b){return"\\u"+((b=a.charCodeAt())<16?"000":b<256?"00":b<4096?"0":"")+b.toString(16)}))},fromUTF8:function(str){return str.replace(/\\u([0-9a-f]{3})([0-9a-f])/g,(function(a,b,c){return String.fromCharCode(16*parseInt(b,16)+parseInt(c,16))}))},urlEncode:function(hash){var i,c,o,a=[],b=[];for(i in hash)a[c=a.length]=b[b.length]=encodeURIComponent(i),((o=hash[i])||0===o)&&(a[c]+="="+encodeURIComponent("string"==typeof o?o:xui.serialize(o)));return(a=xui.arr.stableSort(a,(function(x,y,i,j){return b[i]>b[j]?1:b[i]==b[j]?0:-1}))).join("&")},urlDecode:function(str,key){if(!str)return key?"":{};for(var arr,hash={},a=str.split("&"),i=0,l=a.length;i<l;i++){arr=a[i].split("=");try{hash[decodeURIComponent(arr[0])]=decodeURIComponent(arr[1]||"")}catch(e){hash[arr[0]]=arr[1]||""}}return key?hash[key]:hash},getUrlParams:function(url){var hash=(url||location.href).replace(/^[^#]*[#!]+|^[^#]*$/,"");return-1!=hash.indexOf("?")&&(hash=hash.split("?")[1]),-1!=hash.indexOf("=")?xui.urlDecode(hash):{}},getUrlPath:function(url){var hash=(url||location.href).replace(/^[^#]*[#!]+|^[^#]*$/,"");return hash=-1!=hash.indexOf("?")?hash.split("?")[0]:-1==hash.indexOf("=")?hash:"","/"+decodeURIComponent(hash).replace(/^\//,"").replace(/\/$/,"")},preLoadImage:function(src,onSuccess,onFail){if(xui.isArr(src)){for(var i=0,l=src.length;i<l;i++)xui.preLoadImage(src[i],onSuccess,onFail);return l}var img=document.createElement("img");return img.style.cssText="position:absolute;left:-999px;top:-999px",img.width=img.height=2,img.onload=function(){"function"==typeof onSuccess&&onSuccess.call(this),this.onload=this.onerror=null,document.body.removeChild(this)},img.onerror=function(){"function"==typeof onFail&&onFail.call(this),this.onload=this.onerror=null,document.body.removeChild(this)},document.body.appendChild(img),img.src=src,1},isDefined:function(target){return target!==undefined},isNull:function(target){return null===target},isSet:function(target){return target!==undefined&&null!==target&&NaN!==target},isObj:function(target){return!!target&&("object"==typeof target||"function"==typeof target)},isHash:function(target){return!!target&&"[object Object]"==_to.call(target)&&target.constructor&&/^\s*function\s+Object\(\s*\)/.test(target.constructor.toString())&&!Object.prototype.hasOwnProperty.call(target,"callee")},isBool:function(target){return"boolean"==typeof target},isNumb:function(target){return"number"==typeof target&&isFinite(target)},isFinite:function(target){return(target||0===target)&&isFinite(target)&&!isNaN(parseFloat(target))},isDate:function(target){return"[object Date]"===_to.call(target)&&isFinite(+target)},isFun:function(target){return"[object Function]"===_to.call(target)},isAsyncFun:function(target){return"[object AsyncFunction]"===_to.call(target)},isArr:function(target){return"[object Array]"===_to.call(target)},isReg:function(target){return"[object RegExp]"===_to.call(target)},isStr:function(target){return"[object String]"===_to.call(target)},isFile:function(target){return"[object File]"===_to.call(target)},isArguments:function(target){return target&&("[object Arguments]"===_to.call(target)||Object.prototype.hasOwnProperty.call(target,"callee"))},isEvent:function(target){return target&&(/^(\[object (Keyboard|Mouse|Focus|Wheel|Composition|Storage)Event\])|(\[object Event\])$/.test(_to.call(target))||xui.isHash(target)&&!(!target.$xuievent&&!target.$xuieventpara))},isElem:function(target){return!(!target||1!==target.nodeType)},isNaN:function(target){return"number"==typeof target&&target!=+target},str:{startWith:function(str,sStr){return 0===str.indexOf(sStr)},endWith:function(str,eStr){var l=str.length-eStr.length;return l>=0&&str.lastIndexOf(eStr)===l},repeat:function(str,times){return new Array(times+1).join(str)},initial:function(str){return str.charAt(0).toUpperCase()+str.substring(1)},trim:function(str){return str?str.replace(/^(\s|\uFEFF|\xA0)+|(\s|\uFEFF|\xA0)+$/g,""):str},ltrim:function(str){return str?str.replace(/^(\s|\uFEFF|\xA0)+/,""):str},rtrim:function(str){return str?str.replace(/(\s|\uFEFF|\xA0)+$/,""):str},toDom:function(str){var p=xui.$getGhostDiv(),r=[];p.innerHTML=str;for(var i=0,t=p.childNodes,l=t.length;i<l;i++)r[r.length]=t[i];return p=null,xui(r)}},arr:{fastSortObject:function(arr,getKey){if(!arr||arr.length<2)return arr;for(var o,s,c,t,ll=arr.length,zero=[],len=(ll+"").length,p=Object.prototype,i=0;i<len;i++)zero[i]=new Array(len-i).join("0");for(var j=0;j<ll;j++)s=j+"","object"==typeof(c=arr[j])&&(c._xui_$s$=(xui.isSet(t=getKey.call(c,j))?t:"")+zero[s.length-1]+s);try{o=p.toString,p.toString=function(){return this.hasOwnProperty("_xui_$s$")?this._xui_$s$:o.call(this)},arr.sort()}finally{for(p.toString=o,j=0;j<ll;j++)"object"==typeof arr[j]&&delete arr[j]._xui_$s$}return arr},stableSort:function(arr,sortby){if(arr&&arr.length>1){for(var i=0,l=arr.length,a=[],b=[];i<l;i++)b[i]=arr[a[i]=i];for(xui.isFun(sortby)?a.sort((function(x,y){return sortby.call(arr,arr[x],arr[y],x,y)||(x>y?1:-1)})):a.sort((function(x,y){return arr[x]>arr[y]?1:arr[x]<arr[y]?-1:x>y?1:-1})),i=0;i<l;i++)arr[i]=b[a[i]];a.length=b.length=0}return arr},subIndexOf:function(arr,key,value){if(value===undefined)return-1;for(var i=0,l=arr.length;i<l;i++)if(arr[i]&&arr[i][key]===value)return i;return-1},removeFrom:function(arr,index,length){return arr.splice(index,length||1),arr},removeValue:function(arr,value){for(var i=arr.length-1;i>=0;i--)arr[i]===value&&arr.splice(i,1);return arr},intersection:function(a,b){for(var ai=0,bi=0,result=[];ai<a.length&&bi<b.length;)a[ai]<b[bi]?ai++:(a[ai]>b[bi]||(result.push(a[ai]),ai++),bi++);return result},insertAny:function(arr,target,index,flag){var a,l=arr.length;return flag=!xui.isArr(target)||flag,0===index?flag?arr.unshift(target):arr.unshift.apply(arr,target):((!index||index<0||index>l)&&(index=l),index!=l&&(a=arr.splice(index,l-index)),flag?arr[arr.length]=target:arr.push.apply(arr,target),a&&arr.push.apply(arr,a)),index},indexOf:function(arr,value){for(var i=0,l=arr.length;i<l;i++)if(arr[i]===value)return i;return-1},each:function(arr,fun,scope,desc){var i,l,a=arr;if(!a)return a;if(!xui.isArr(a)){if(!xui.isArr(a._nodes))return a;a=a._nodes,desc===undefined&&(desc=1)}if(l=a.length,scope=scope||arr,desc)for(i=l-1;i>=0&&!1!==fun.call(scope,a[i],i,a);i--);else for(i=0;i<l&&!1!==fun.call(scope,a[i],i,a);i++);return arr},removeDuplicate:function(arr,subKey){var l=arr.length,a=arr.concat();arr.length=0;for(var i=l-1;i>=0;i--)(subKey?this.subIndexOf(a,subKey,a[i][subKey])===i:this.indexOf(a,a[i])===i)&&arr.push(a[i]);return arr.reverse()}},_scope_set:function(dataMap){window.get&&(xui._scope_bak=window.get),xui._scope_datamap=dataMap,window.get=function(key){if(key){var t,i=(key=""+key).indexOf("."),scope=-1==i?key:key.substr(0,i),name=-1==i?null:key.substr(i+1,key.length);return(t=xui._scope_datamap)&&(t=t[scope])&&(name?t[name]:t)}}},_scope_clear:function(bak){(bak=xui._scope_bak)&&(window.get=bak,delete xui._scope_bak,delete xui._scope_datamap)}})},new function(){var AsyncFunction,reg1=/(\s*\/\*[^*]*\*+([^\/][^*]*\*+)*\/)|(\s*\/\/[^\n]*)|(\)[\s\S]*)/g,reg2=/^\s*(\([\w,\s]*\)|\s*[\w]+\s*)\s*=>\s*([\s\S]*)\s*$/;try{AsyncFunction=Object.getPrototypeOf((async function(){})).constructor}catch(e){}xui.merge(xui.fun,{body:function(fun){var s=(""+fun).replace(/^async\s+/,"").replace(reg1,(function(a){return")"!=a.charAt(0)?"":a})),r=reg2.exec(s);return r?"{"==r[2][0]?r[2].slice(1,-1):r[2]:s.slice(s.indexOf("{")+1,s.lastIndexOf("}"))},args:function(fun){var s=(""+fun).replace(/^async\s+/,"").replace(reg1,(function(a){return")"!=a.charAt(0)?"":a})),r=reg2.exec(s);return(s=xui.str.trim(r?"("==r[1][0]?r[1].slice(1,-1):r[1]:s.slice(s.indexOf("(")+1,s.indexOf(")"))).split(/\s*,\s*/))[0]?s:[]},clone:function(fun){return xui.isAsyncFun(fun)&&AsyncFunction?new AsyncFunction(xui.fun.args(fun),xui.fun.body(fun)):new Function(xui.fun.args(fun),xui.fun.body(fun))}})},xui.merge(xui.Class,{_reg:{$key:1,$parent:1,$children:1,KEY:1,Static:1,Instance:1,Constructor:1,Initialize:1},_reg2:{nodeType:1,constructor:1,prototype:1,toString:1,valueOf:1,hasOwnProperty:1,isPrototypeOf:1,propertyIsEnumerable:1,toLocaleString:1},_all:[],_fun:function(fun,name,original,upper,type){return fun.$name$=name,fun.$original$=original,type&&(fun.$type$=type),upper&&fun!==upper&&(fun.upper=upper),fun},_other:["toString","valueOf"],_o:{},_inherit:function(target,src,instance){var i,o,r=this._reg;for(i in src)i in target||!instance&&r[i]||"$"==i.charAt(0)||(o=src[i])&&o.$xui$||(target[i]=o)},_wrap:function(target,src,instance,parent,prtt){var i,j,o,k=target.KEY,r=this._reg,r2=this._reg2,f=this._fun,oo=this._other;for(i in src)r2[i]||!instance&&r[i]||(o=src[i],target[i]="function"!=typeof o?o:f(o,i,k,"function"==typeof parent[i]&&parent[i],prtt));for(j=0;i=oo[j++];)(o=src[i])&&o==this._o[i]||(target[i]="function"!=typeof o?o:f(o,i,k,"function"==typeof parent[i]&&parent[i],prtt))},__gc:function(key){var _c=xui.Class._all;if(key){"object"==typeof key&&(key=key.KEY||"");var s,j,o,t=xui.get(window,key.split("."));if(t){if((s=xui.get(window,["xui","$cache","SC"]))&&delete s[key],t.$parent&&(t.$parent.length=0),s=t.$children){for(i=0;o=s[i];i++)(o=xui.get(window,o.split(".")))&&o.__gc&&o.__gc();s.length=0}for(i in t)if("upper"!=i&&"function"==typeof t[i])for(j in t[i])t[i].hasOwnProperty(j)&&delete t[i][j];for(i in xui.breakO(t),t=t.prototype)if("upper"!=i&&"function"==typeof t[i])for(j in t[i])t[i].hasOwnProperty(j)&&delete t[i][j];xui.breakO(t),xui.set(window,key.split("."))}_c.splice(_c[key],1),delete _c[key]}else for(var i=_c.length-1;i>0;i--)xui.Class.__gc(_c[i])},destroy:function(key){xui.Class.__gc(key)}}),xui.merge(xui,{version:3,$DEFAULTHREF:"javascript:;",$IEUNSELECTABLE:function(){return xui.browser.ie?' onselectstart="return false;" ':""},SERIALIZEMAXLAYER:99,SERIALIZEMAXSIZE:9999,$localeKey:"en",$localeDomId:"xlid",$dateFormat:"",$rand:"_rnd_",_rnd:function(force){return xui.debugMode||force?xui.$rand+"="+xui.rand():null},_debugPre:function(arr){return(arr=xui.toArr(arr))[0]="%c ["+arr[0]+"@xui]",xui.arr.insertAny(arr,"color:#0000ff; font-style: italic;",1),arr},_debugInfo:function(){xui.debugMode&&xui.isDefined(window.console)&&"function"==typeof console.log&&console.log.apply(console,xui._debugPre(arguments))},_debugGroup:function(){xui.debugMode&&xui.isDefined(window.console)&&"function"==typeof console.group?console.group.apply(console,xui._debugPre(arguments)):xui._debugInfo.apply(xui,arguments)},_debugGroupEnd:function(){xui.debugMode&&xui.isDefined(window.console)&&"function"==typeof console.groupEnd?console.groupEnd():xui._debugInfo.apply(xui,arguments)},SpaceUnit:"em",$us:function(p){return xui.browser.ie6||xui.browser.ie7?p?-2:-1:"px"==(p=p?p._spaceUnit||p.properties&&p.properties.spaceUnit:"")?-2:"em"==p?2:"px"==xui.SpaceUnit?-1:"em"==xui.SpaceUnit?1:0},debugMode:!0,Locale:{},constant:{},$cache:{thread:{},SC:{},clsByURI:{},fetching:{},hookKey:{},hookKeyUp:{},snipScript:{},subscribes:{},ghostDiv:[],data:{},callback:{},functions:{},domPurgeData:{},profileMap:{},reclaimId:{},template:{},UIKeyMapEvents:{},droppable:{},unique:{}},subscribe:function(topic,subscriber,receiver,asy){if(null!==topic&&topic!==undefined&&null!==subscriber&&subscriber!==undefined&&"function"==typeof receiver){var i,c=xui.$cache.subscribes;return c[topic]=c[topic]||[],-1!=(i=xui.arr.subIndexOf(c[topic],"id",subscriber))&&xui.arr.removeFrom(c[topic],i),c[topic].push({id:subscriber,receiver:receiver,asy:!!asy})}},unsubscribe:function(topic,subscriber){var i,c=xui.$cache.subscribes;subscriber?c[topic]&&-1!=(i=xui.arr.subIndexOf(c[topic],"id",subscriber))&&xui.arr.removeFrom(c[topic],i):null===topic||topic===undefined?c={}:delete c[topic]},publish:function(topic,args,subscribers,scope){var c=xui.$cache.subscribes;if(null===topic||topic===undefined)for(var t in c)xui.arr.each(c[t],(function(o){if(!subscribers||subscribers===o.id||xui.isArr(subscribers)&&-1!=xui.arr.indexOf(subscribers,o.id)){if(!o.asy)return xui.tryF(o.receiver,args,scope,!0);xui.asyRun(o.receiver,0,args,scope)}}));else c[topic]&&xui.arr.each(c[topic],(function(o){if(!subscribers||subscribers===o.id||xui.isArr(subscribers)&&-1!=xui.arr.indexOf(subscribers,o.id)){if(!o.asy)return xui.tryF(o.receiver,args,scope,!0);xui.asyRun(o.receiver,0,args,scope)}}))},getSubscribers:function(topic){return null===topic||topic===undefined?xui.$cache.subscribes:xui.$cache.subscribes[topic]},setDateFormat:function(format){xui.$dateFormat=format},getDateFormat:function(format,t){return xui.isStr(t=format&&format.dateFormat)&&t||xui.isStr(t=format)&&t||xui.isStr(t=xui.$dateFormat)&&t||xui.isStr(t=xui.$cache.data.$DATE_FORMAT)&&t?t:"yyyy-mm-dd hh:mm:ss"},setFirstDayOfWeek:function(day){xui.$firstDayOfWeek=day},getFirstDayOfWeek:function(day,t){return xui.isNumb(t=day&&day.firstDayOfWeek)||xui.isNumb(t=day)||xui.isNumb(t=xui.$firstDayOfWeek)||xui.isNumb(t=xui.$cache.data.$DATE_WEEKFROM)?t:0},setAppLangKey:function(key){xui.$appLangKey=key},getAppLangKey:function(key){return xui.$appLangKey},getLang:function(){return xui.$localeKey},setLang:function(key,onOK,callback){var t,v,i,j,f,m,z,l,g=xui.getRes,a=[];if(xui.$localeKey=key,v=document.getElementsByTagName?document.getElementsByTagName("span"):document.all&&document.all.tags?document.all.tags("span"):null){for(i=0;t=v[i];i++)t.id==xui.$localeDomId&&(a[a.length]=t);l=a.length,f=function(){var ff=function(){for(j=a.splice(0,100),i=0;t=j[i];i++)t.className&&"string"==typeof(v=g(t.className))&&(t.innerHTML=v);a.length&&xui.setTimeout(ff,0),xui.tryF(callback,[a.length,l]),a.length||xui.tryF(onOK,[0,l])};ff()},z="xui.Locale."+key,m=function(){var k=xui.$appLangKey;k?xui.include(z+"."+k,xui.getPath("Locale."+key,".js"),f,f):f()},xui.include(z+".inline.$_$",xui.getPath(z,".js"),m,m)}},getTheme:function(a,e){try{(e=document.createElement("xui")).className="setting-uikey",document.body.appendChild(e),a=xui(e).css("font-family"),document.body.removeChild(e)}catch(e){}finally{return a||"default"}},setTheme:function(key,refresh,onSucess,onFail,tag){key=key||"default";var okey=xui.getTheme();if(key!=okey){var onend=function(onSucess){if("default"!=okey){for(var style;style=xui.CSS.$getCSSValue(".setting-uikey","fontFamily",okey);)style.disabled=!0,style.parentNode.removeChild(style),style=null;for(;(style=document.getElementById("theme:"+okey))&&"link"==style.tagName.toLowerCase();)style.parentNode.removeChild(style)}!1!==refresh&&xui.CSS.adjustFont(),xui.tryF(onSucess)};if("default"==key)onend(onSucess);else{var id="theme:"+key,path=xui.getPath("xui.appearance."+key,"");tag?xui.getFileAsync(path+"theme.css",(function(rsp){rsp=(rsp=xui.replace(rsp,[[/(\/\*[^*]*\*+([^\/][^*]*\*+)*\/)/,"$0"],[/\{[^}]*\}/,"$0"],[/([^\/{},]+)/,function(a){return xui.str.endWith(a[0],".setting-uikey")?a[0]:a[0].replace(/([^\s>]+)/,"$1"+tag)}]])).replace(/url\(([^)]+)\)/g,"url("+path+"$1)"),xui.CSS._appendSS(xui("head"),rsp,id,!1)})):xui.CSS.includeLink(path+"theme.css",id);var count=0,fun=function(){if(count++>4){if(fun=count=null,!1!==xui.tryF(onFail))throw new Error("errLoadTheme:"+key)}else xui.getTheme()==key?(onend(onSucess),fun=count=null):xui.asyRun(fun,100*count)};fun()}}else xui.tryF(onSucess)},reLayout:function(){xui.UI&&xui.UI.getAll().reLayout(!0)},_langParamReg:/\x24(\d+)/g,_langscMark:/[$@{][\S]+/,_langReg:/((\$)([^\w\(]))|((\$)([\w][\w\.-]*[\w]+))|((\$)\(([\w][\w\.]*[^)\n\r]+))\)|((\$)([^\s]))|((\@)([\w][\w\.]*[\w]+)(\@?))|((\@)([^\s])(\@?))|((\{)([~!@#$%^&*+-\/?.|:][\w\[\]]*|[\w\[\]]+(\(\))?(\.[\w\[\]]+(\(\))?)*)(\}))/g,_escapeMap:{$:"",".":"","-":"",")":"","@":""},_unescapeMap:{"":"$","":".","":"-","":")","":"@"},getRes:function(path){var arr,conf,tmp,params=arguments;if(xui.isStr(path))"$"==(path=path.replace(/\$([$.-])/g,(function(a,b){return xui._escapeMap[b]||a}))).charAt(0)&&(path=path.slice(1)),-1!=path.indexOf("-")?(tmp=path.split("-"),path=tmp[0],params=tmp):xui.isArr(params[1])&&(params=params[1]).unshift(path),(arr=path.split("."))[arr.length-1]=arr[arr.length-1].replace(/([\x01\x02\x03\x04])/g,(function(a){return xui._unescapeMap[a]}));else{if(!xui.isArr(path))return path;arr=path}return"function"==(tmp=typeof(conf=xui.get(xui.Locale[xui.$localeKey],arr)))?conf.apply(null,params):"object"==tmp?conf:(conf="string"==tmp?conf.replace(/\$([$.-])/g,(function(a,b){return xui._escapeMap[b]||a})):arr[arr.length-1],(params.length>1?conf.replace(xui._langParamReg,(function(z,id,k){return null===(k=params[+id+1])||k===undefined?z:k})):conf).replace(/([\x01\x02\x03])/g,(function(a){return xui._unescapeMap[a]})))},wrapRes:function(id){if(!xui.isStr(id))return id;var s,r,i=id;return"$"==i.charAt(0)&&(arguments[0]=i.substr(1,i.length-1)),(s=id)==(r=xui.getRes.apply(null,arguments))&&(r=i),'<span id="'+xui.$localeDomId+'" class="'+s.replace(/([\x01\x02\x03\x04])/g,(function(a){return"$"+xui._unescapeMap[a]}))+'" '+xui.$IEUNSELECTABLE()+">"+r+"</span>"},adjustRes:function(str,wrap,onlyBraces,onlyVars,params,scope1,scope2){return xui.isStr(str)?(wrap=wrap?xui.wrapRes:xui.getRes,str=str.replace(/\$([\$\.\-\)])/g,(function(a,b){return xui._escapeMap[b]||a})),(str=xui._langscMark.test(str)?str.replace(xui._langReg,(function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z){return"$"==c?onlyVars?a:d:"$"==f?onlyVars?a:wrap(g,params):"$"==i?onlyVars?a:wrap(j,params):"$"==l?onlyVars?a:wrap(m,params):(onlyBraces||"@"!=o&&"@"!=s)&&"{"!=w?a:(z=xui.SC.get("@"==o?p:"@"==s?t:x,scope1,scope2))||(xui.isSet(z)?z:"")})):str).replace(/([\x01\x02\x03\x04])/g,(function(a){return xui._unescapeMap[a]}))):str},_feval:function(body,scope){try{return new Function("","with(this){return "+body+"}").apply(scope||{})}catch(e){return""}},adjustVar:function(obj,scope1,scope2){var t;return"string"==typeof obj?"{[]}"==obj?[]:"{{}}"==obj?{}:"{}"==obj?"":"{true}"==obj||"{false}"!=obj&&("{NaN}"==obj?NaN:"{null}"==obj?null:"{undefined}"==obj?undefined:"{now}"==obj?new Date:(t=/^\s*\{\s*eval\s*\((.*)\)\s*\}\s*$/.exec(obj))?this._feval(t[1],scope1||scope2):(t=/^\s*\{((-?\d\d*\.\d*)|(-?\d\d*)|(-?\.\d\d*))\}\s*$/.exec(obj))?parseFloat(t[1]):(t=/^\s*\{([\w\.]+\([^)]*\))\s*\}\s*$/.exec(obj))&&(scope1||scope2)&&xui.isHash(scope1||scope2)?new Function("try{return this."+t[1]+"}catch(e){}").call(scope1||scope2):(t=/^\s*\{([^}]+)\}\s*$/.exec(obj))?xui.SC.get(t[1],scope1,scope2):xui.adjustRes(obj,!1,!0,!0,null,scope1,scope2)):obj},_getrpc:function(uri,query,options){var t=options&&options.proxyType?options.proxyType.toLowerCase():"";return"sajax"==t||"jsonp"==t?xui.JSONP:"iajax"==t||"xdmi"==t?xui.XDMI:"ajax"==t?xui.Ajax:"fetch"==t?xui.Fetch:options&&"object"==typeof options.data&&function(d){if(!xui.isHash(d))return 0;for(var i in d)if(d[i]&&1==d[i].nodeType&&"INPUT"==d[i].nodeName||d[i]&&d[i].$xuiFileCtrl)return 1}(options.data)?xui.XDMI:options&&options.method&&"post"==options.method.toLowerCase()?xui.absIO.isCrossDomain(uri)?xui.XDMI:xui.Ajax:xui.absIO.isCrossDomain(uri)?xui.JSONP:xui.Ajax},request:function(uri,query,onSuccess,onFail,threadid,options){return xui._getrpc(uri,query,options).apply(null,arguments).start()},ajax:function(uri,query,onSuccess,onFail,threadid,options){return xui.Ajax.apply(null,arguments).start()},jsonp:function(uri,query,onSuccess,onFail,threadid,options){return xui.JSONP.apply(null,arguments).start()},xdmi:function(uri,query,onSuccess,onFail,threadid,options){return xui.XDMI.apply(null,arguments).start()},fetch:function(uri,query,onSuccess,onFail,threadid,options){return xui.Fetch.apply(null,arguments).start()},restGet:function(uri,query,onSuccess,onFail,threadid,options){return options||(options={}),options.method="get",xui.Ajax(uri,query,onSuccess,onFail,threadid,options).start()},restPost:function(uri,query,onSuccess,onFail,threadid,options){return options||(options={}),options.method="post",xui.Ajax(uri,query,onSuccess,onFail,threadid,options).start()},restPut:function(uri,query,onSuccess,onFail,threadid,options){return options||(options={}),options.method="put",xui.Ajax(uri,query,onSuccess,onFail,threadid,options).start()},restDelete:function(uri,query,onSuccess,onFail,threadid,options){return options||(options={}),options.method="delete",xui.Ajax(uri,query,onSuccess,onFail,threadid,options).start()},getFileSync:function(uri,onSuccess,onFail,options){return xui.Ajax(uri,xui._rnd(options&&options.force),onSuccess,onFail,null,xui.merge({asy:!1,rspType:options&&options.rspType||"text"},options,"without")).start()||null},getFileAsync:function(uri,onSuccess,onFail,threadid,options){xui.Ajax(uri,xui._rnd(options&&options.force),onSuccess,onFail,threadid,xui.merge({asy:!0,rspType:options&&options.rspType||"text"},options,"without")).start()},include:function(id,path,onSuccess,onFail,sync,options){if(id&&xui.SC.get(id))xui.tryF(onSuccess);else{options=options||{};var rnd=xui._rnd(options.force);options.rspType="script",options.keepDomNode=1,sync?(options.asy=!sync,xui.Ajax(path,rnd,(function(rsp){try{xui.exec(rsp,id)}catch(e){xui.tryF(onFail,[e])}xui.tryF(onSuccess)}),onFail,0,options).start()):(options.checkKey=id,xui.JSONP(path,rnd,onSuccess,onFail,0,options).start())}},mailTo:function(email,subject,body,cc,bcc){xui.isHash(subject)&&(bcc=subject.bcc||"",cc=subject.cc||"",body=subject.body||"",subject=subject.subject||"");var url="mailto:"+email+"?subject="+encodeURIComponent(xui.adjustRes(subject||""))+"&body= "+encodeURIComponent(xui.adjustRes(body||""))+"&cc= "+(cc||"")+"&bcc= "+(bcc||"");xui.XDMI(url).start()},fetchAlienClass:function(uri,onSuccess,onFail,onAlert,force,threadid,options){return(options=options||{}).alien=!0,this.fetchClass(uri,onSuccess,onFail,onAlert,force,threadid,options)},_getIdUri:function(item,options){var attrs,id,uri,obj;return xui.isHash(item)?(id=item.id,uri=item.uri,delete(attrs=xui.copy(item)).id,delete attrs.uri):(obj=/^\[([\w][\w\.]*[\w])\](.+)/.exec(item))?(id=obj[1],uri=obj[2]):/^[\w][\w\.]*[\w]$/.test(item)?(id=item,uri=xui.getPath(id,".js","js",options)):(uri=item,id=xui.getClassName(uri)),{id:id,uri:uri,attrs:attrs}},fetchClass:function(uri,onSuccess,onFail,onAlert,force,threadid,options){!(options=options||{}).hasOwnProperty("appPath")&&window["/"]&&(options.appPath=window["/"]);var ww,c=xui.$cache.clsByURI,onFetching=xui.$cache.fetching,clearFetching=function(){for(var i in onFetching[uri][3])xui.Thread.abort(onFetching[uri][3][i]);onFetching[uri]&&(onFetching[uri][0].length=0,onFetching[uri][1].length=0,onFetching[uri][2].length=0,onFetching[uri][3].length=0,onFetching[uri].length=0,delete onFetching[uri]),onFetching=null},rnd=xui._rnd(options.force),obj=xui._getIdUri(uri,options),cls=obj.id,attrs=obj.attrs;uri=obj.uri,!force&&xui.isSet(obj=cls&&xui.SC.get(cls)||c[uri])?xui.tryF(onSuccess,[uri,obj&&obj.KEY],obj):onFetching[uri]?(onSuccess&&onFetching[uri][0].push(onSuccess),onFail&&onFetching[uri][1].push(onFail),onAlert&&onFetching[uri][2].push(onAlert),threadid&&(onFetching[uri][3].push(threadid),xui.Thread.suspend(threadid))):(onFetching[uri]=[onSuccess=onSuccess?[onSuccess]:[],onFail=onFail?[onFail]:[],onAlert=onAlert?[onAlert]:[],[]],options.useAjax?xui.Ajax(uri,rnd,(function(rsp){xui.Class._ignoreNSCache=1,xui.Class._last=null;var s=xui.getClassName(uri);options.alien&&(ww=xui.window,xui.window={});try{xui.exec(rsp,s)}catch(e){for(var i=0,l=onFail.length;i<l;i++)xui.tryF(onFail[i],[e]);xui.Class._last=null}if(xui.Class._last&&(obj=c[uri]=xui.Class._last),xui.Class._ignoreNSCache=xui.Class._last=null,cls){if(obj)for(i=0,l=onSuccess.length;i<l;i++)xui.tryF(onSuccess[i],[uri,obj&&obj.KEY],obj);else for(i=0,l=onFail.length;i<l;i++)xui.tryF(onFail[i],['"'+uri+'" is not an xui class!']);var clsName=xui.getClassName(uri);if(obj&&clsName&&obj.KEY!=clsName){var msg="[xui] > The last class name in '"+uri+"' should be '"+clsName+"', but it's '"+obj.KEY+"'!";for(i=0,l=onAlert.length;i<l;i++)xui.tryF(onAlert[i],[msg,uri,clsName,obj.KEY]);xui.log(msg)}}else for(i=0,l=onSuccess.length;i<l;i++)xui.tryF(onSuccess[i],[uri,obj&&obj.KEY],obj);options.alien&&(xui.window=ww),clearFetching()}),(function(){options.alien&&(xui.window=ww),xui.Class._ignoreNSCache=xui.Class._last=null;for(var i=0,l=onFail.length;i<l;i++)xui.tryF(onFail[i],xui.toArr(arguments));clearFetching()}),threadid,{rspType:"text",asy:!options.sync}).start():(xui.Class._ignoreNSCache=1,xui.Class._last=null,options.alien&&(ww=xui.window,xui.window={}),xui.JSONP(uri,rnd,(function(){if(xui.Class._last&&(obj=c[uri]=xui.Class._last),xui.Class._ignoreNSCache=xui.Class._last=null,cls){if(obj)for(var i=0,l=onSuccess.length;i<l;i++)xui.tryF(onSuccess[i],[uri,obj&&obj.KEY],obj);else for(i=0,l=onFail.length;i<l;i++)xui.tryF(onFail[i],['"'+uri+'" is not an xui class!']);var clsName=xui.getClassName(uri);if(obj&&clsName&&obj.KEY!=clsName){var msg="[xui] > The last class name in '"+uri+"' should be '"+clsName+"', but it's '"+obj.KEY+"'!";for(i=0,l=onAlert.length;i<l;i++)xui.tryF(onAlert[i],[msg,uri,clsName,obj.KEY]);xui.log(msg)}}else for(i=0,l=onSuccess.length;i<l;i++)xui.tryF(onSuccess[i],[uri,obj&&obj.KEY],obj);options.alien&&(xui.window=ww),clearFetching()}),(function(){options.alien&&(xui.window=ww),xui.Class._ignoreNSCache=xui.Class._last=null;for(var i=0,l=onFail.length;i<l;i++)xui.tryF(onFail[i],xui.toArr(arguments));clearFetching()}),threadid,{rspType:"script",keepDomNode:!options.noDomNode,attrs:attrs,asy:!options.sync}).start()))},fetchClasses:function(uris,onEnd,onSuccess,onFail,onAlert,force,threadid,options){xui.arr.removeDuplicate(uris);for(var hash={},f=function(uri,i,hash){hash[i]=xui.Thread(null,[function(tid){xui.fetchClass(uri,onSuccess,onFail,onAlert,force,tid,options)}])},i=0,l=uris.length;i<l;i++)f(uris[i],i,hash);return xui.Thread.group(null,hash,null,(function(){xui.Thread.suspend(threadid)}),(function(){!1!==xui.tryF(onEnd,arguments,this)&&xui.Thread.resume(threadid)})).start()},_collectClassRequired:function(cls,required,required2,options){if(cls.$xuiclass$){var t,id,uri,obj;if(xui.isArr(t=cls.prototype.Dependencies))for(var i=0,l=t.length;i<l;i++)id=xui.isHash(t[i])&&t[i].id,uri=xui.isHash(t[i])?t[i].uri:t[i],id&&!xui.Dom.byId(id)?required2.push(t[i]):xui.querySelector('link[href="'+uri+'"]').get(0)||required2.push(t[i]);if(xui.isArr(t=cls.prototype.Required))for(i=0,l=t.length;i<l;i++)xui.isArr(t[i])?required.push(t[i]):(id=(obj=xui._getIdUri(t[i],options)).id,uri=obj.uri,id&&xui.isSet(xui.SC.get(id))||xui.$cache.clsByURI[uri]||xui.$cache.fetching[uri]||required.push(t[i]));if(cls["xui.Module"]&&xui.isFun(t=cls.prototype.iniComponents))try{(t+"").replace(/\bappend\s*\(\s*xui.create\s*\(\s*['"]([\w.]+)['"]\s*[,)]/g,(function(a,b){return xui.SC.get(b)||required.push(b),a})).replace(/\.setRenderer\s*\(\s*['"]([a-zA-Z]+([\w]+\.?)+[\w]+)['"]\s*\)/g,(function(a,b){return xui.SC.get(b)||required.push(b),a})).replace(/['"](renderer|cellRenderer)['"]\s*:\s*['"]([a-zA-Z]+([\w]+\.?)+[\w]+)['"]\s*/g,(function(a,b,c){return xui.SC.get(c)||required.push(c),a})).replace(/['"]newbies['"]\s*:\s*\{([^}]+)\}/g,(function(a,b,c){for(var i=0,l=(b=b.split(/\s*,\s*/)).length;i<l;i++)(c=b[i].split(/\s*:s*/))[1]&&(c=c[1].replace(/['"\s]/g,""),xui.SC.get(c)||required.push(c));return a}))}catch(e){}cls["xui.Module"]&&cls.prototype.functions&&xui.each(cls.prototype.functions,(function(f){xui.isHash(f)&&f.newbies&&xui.isHash(f.newbies)&&xui.each(f.newbies,(function(c){xui.SC.get(c)||required.push(c)}))}))}},require:function(clsArr,onEnd,onSuccess,onFail,onAlert,force,threadid,options){xui.isStr(clsArr)&&(clsArr=[clsArr]);var results={},fun=function(paths,tid){var required=[],required2=[];xui.filter(paths,(function(path){if(xui.isArr(path))return options&&!options.stopRecursive&&Array.prototype.push.apply(required,path),!1})),xui.fetchClasses(paths,(function(){for(var obj,id,uri,attrs,i=0,l=clsArr.length;i<l;i++)id=(obj=xui._getIdUri(clsArr[i],options)).id,uri=obj.uri,results[id||uri]=id?xui.SC.get(id):null;if(options&&!options.stopRecursive){for(i=0,l=paths.length;i<l;i++)(obj=xui.SC.get(paths[i]))&&obj.$xuiclass$&&xui._collectClassRequired(obj,required,required2,options);if(required2.length){for(var j=0,m=required2.length;j<m;j++)id=attrs=null,xui.isHash(required2[j])?(id=required2[j].id||null,uri=required2[j].uri,delete(attrs=xui.copy(required2[j])).id,delete attrs.uri):uri=required2[j],uri&&xui.isStr(uri)&&xui.trim(url).length>0&&(id&&!xui.Dom.byId(id)?xui.CSS.includeLink(uri,id,!1,attrs):xui.querySelector('link[href="'+uri+'"]').get(0)||xui.CSS.includeLink(uri,id,!1,attrs));required2=null}}return required.length?(fun(required,tid),required=null,!1):(fun=null,!onEnd||onEnd.call(null,results))}),onSuccess,onFail,onAlert,force,tid,options)};fun(clsArr,threadid)},_m:[],main:function(fun){-1==xui.arr.indexOf(xui._m,fun)&&xui._m.push(fun),xui.isDomReady&&xui._domReadyFuns()},getPath:function(key,tag,folder,options){if(key=key.split("."),folder){for(var a=[key[0],folder],i=1,l=key.length;i<l;i++)a.push(key[i]);key.length=0,key=a}var pre,t,ini=xui.ini,ensureTag=function(s){return s&&"/"!=s.slice(-1)?s+"/":s};return"xui"==key[0]?(key.shift(),key.length==(folder?1:0)&&key.push("xui"),pre=ensureTag(options&&options.xuiPath||ini.path)):(key.length==1+(folder?1:0)&&".js"==tag&&key.push("index"),(pre=ensureTag(options&&options.appPath))?((t=options&&options.verPath)&&(pre+=ensureTag(t)),(t=options&&options.ver)&&(pre+=ensureTag(t))):(pre=ensureTag(ini.appPath))&&((t=ini.verPath)&&(pre+=ensureTag(t)),(t=ini.ver)&&(pre+=ensureTag(t)))),pre+key.join("/")+(tag||"/")},getClassName:function(uri){if(uri&&xui.isStr(uri)){var b,a=uri.split(/\/js\//g),n=a.length;if(n>=2)return a[n-2]+"/"==xui.ini.path&&(a[n-2]="xui"),((b=(b=a[n-2].split(/\//g))[b.length-1])+((a=a[n-1].replace(/\.js$/i,""))?".":"")+a.replace(/\//g,".")).replace(/^([^.]+)\.index$/,"$1")}},log:xui.fun(),echo:xui.fun(),message:xui.fun(),getErrMsg:function(e,split){return(e&&(e.stack||e.stacktrace||(console&&console.trace?console.trace():null)||e.description||e.message||e.toString())).replace(/\n/g,split||"<br />")},_pool:[],getObject:function(id){return xui._pool["$"+id]},getObjectByAlias:function(alias){var o,a=[],l=0;for(var i in xui._pool)"alias"in(o=xui._pool[i])&&o.alias===alias&&(a.push(o),l++);return 0===l?null:1===l?a[0]:a},_ghostDivId:"xui.ghost::",$getGhostDiv:function(){var p,pool=xui.$cache.ghostDiv,i=0,l=pool.length;do{p=pool[i++]}while(i<l&&p&&p.firstChild);return p&&!p.firstChild||((p=document.createElement("div")).id=xui._ghostDivId,pool.push(p)),p},$xid:0,$registerNode:function(o){var id,v,purge=xui.$cache.domPurgeData;return o.$xid&&(v=purge[o.$xid])&&v.element==o||((v=purge[id="!"+xui.$xid++]||(purge[id]={})).element=o,o.$xid=v.$xid=id),o=null,v},getId:function(node){return"string"==typeof node&&(node=document.getElementById(node)),node?window===node?"!window":document===node?"!document":node.$xid||"":""},getNode:function(xid){return xui.use(xid).get(0)},getNodeData:function(node,path){if(node)return xui.get(xui.$cache.domPurgeData["string"==typeof node?node:xui.getId(node)],path)},setData:function(path,value){return xui.set(xui.$cache.data,path,value)},getData:function(path){return xui.get(xui.$cache.data,path)},setNodeData:function(node,path,value){if(node)return xui.set(xui.$cache.domPurgeData["string"==typeof node?node:xui.getId(node)],path,value)},$purgeChildren:function(node){var i,j,o,t,v,w,id,cache=xui.$cache,proMap=cache.profileMap,pdata=(cache.UIKeyMapEvents,cache.domPurgeData),event=xui.Event,handler=event.$eventhandler,handler3=event.$eventhandler3,children=xui.browser.ie&&node.all?node.all:node.getElementsByTagName("*"),l=children.length,bak=[];for(i=0;i<l;i++)if(v=children[i]){if(t=v.$xid){if(o=pdata[t]){if(w=o.eHandlers)for(j in xui.browser.isTouch&&w.onxuitouchdown&&event._removeEventListener(v,"xuitouchdown",handler),w)event._removeEventListener(v,j,handler),event._removeEventListener(v,j,handler3);for(j in o)o[j]=null;delete pdata[t]}xui.browser.ie?v.removeAttribute("$xid"):delete v.$xid}if((id=v.id)&&id in proMap){if(!(o=proMap[id]))continue;if("!window"===(t=o.renderId)||"!document"===t)continue;o.__gc(!0,!0),bak[bak.length]=id,o.$domId&&o.$domId!=o.domId&&(bak[bak.length]=o.$domId)}}for(i=0;i<bak.length;)delete proMap[bak[i++]];for(i=node.childNodes.length-1;i>=0;i--)node.removeChild(node.childNodes[i])},create:function(tag,bak){var arr,o,t,r1=/</;if(xui.isArr(tag)){arr=[];for(var i=0,l=tag.length;i<l;i++)Array.prototype.push.apply(arr,xui.create(tag[i]).get());return xui(arr)}if("string"==typeof tag)if(t=xui.absBox.$type[tag]){for(arr=[],i=1,l=arguments.length;i<l;i++)arr[i-1]=arguments[i];(o=new(xui.SC(t))(!1))._ini&&o._ini.apply(o,arr)}else(t=xui.SC.get(tag))&&t["xui.Module"]||"xui.Module"==bak?t?o=new t:(o=new xui.UI.MoudluePlaceHolder,xui.require(tag,(function(module){if(module&&module["xui.Module"]){var t=o.get(0);if(t)if(t.renderId){var m=new module;m.create((function(){o.replaceWithModule(m)}))}else t._module=new module}}))):/^[\w-]+$/.test(tag)?((o=document.createElement(tag)).id="string"==typeof id?id:xui.id(),o=xui(o)):(r1.test(tag)&&(o=xui.str.toDom(tag)),o&&o.n0||(o=xui.str.toDom("<xui>"+tag+"</xui>")));else tag["xui.Module"]?(t=xui.SC.get(tag.key))&&t["xui.Module"]?o=new t(tag):(o=new xui.UI.MoudluePlaceHolder,(t=tag.events)&&o.setEvents(t),(t=tag.properties)&&o.setProperties(t),tag.moduleClass&&tag.moduleXid&&(o.get(0).moduleClass=tag.moduleClass,o.get(0).moduleXid=tag.moduleXid),xui.require(tag.key,(function(module){if(module&&module["xui.Module"]){var m=new module(tag);m.create((function(){o.replaceWithModule(m)}))}}))):o=new(xui.SC(tag.key))(tag);return o["xui.absObj"]&&(t=o.n0)&&t.host&&t.host!=t&&t.alias&&o.setHost(t.host,t.alias),o},query:function(){return xui.doc.query.apply(xui.doc,arguments)},querySelector:function(){return xui.doc.querySelector.apply(xui.doc,arguments)},querySelectorAll:function(){return xui.doc.querySelectorAll.apply(xui.doc,arguments)},use:function(xid){var c=xui._tempBox||(xui._tempBox=xui()),n=c._nodes;return n[0]=xid,1!=n.length&&(n.length=1),c}}),new function(){var ini=xui.ini={rootModuleName:"_xui_root"};window.xui_ini&&xui.merge(ini,window.xui_ini,"all");var w=window,u=navigator.userAgent.toLowerCase(),d=document,dm=d.documentMode,b=xui.browser={kde:/webkit/.test(u),applewebkit:/applewebkit/.test(u),opr:/opera/.test(u),ie:/msie/.test(u)&&!/opera/.test(u),newie:/trident\/.* rv:([0-9]{1,}[.0-9]{0,})/.test(u),gek:/mozilla/.test(u)&&!/(compatible|webkit)/.test(u),isStrict:"CSS1Compat"==d.compatMode,isWebKit:/webkit/.test(u),isFF:/firefox/.test(u),isChrome:/chrome/.test(u),isSafari:!/chrome/.test(u)&&/safari/.test(u),isWin:/(windows|win32)/.test(u),isMac:/(macintosh|mac os x)/.test(u),isAir:/adobeair/.test(u),isLinux:/linux/.test(u),isSecure:0==location.href.toLowerCase().indexOf("https"),isTouch:!!(navigator.userAgent.match(/AppleWebkit.*Mobile.*/)||"ontouchend"in d&&!/hp-tablet/.test(u)||w.DocumentTouch&&d instanceof w.DocumentTouch||w.PointerEvent||w.MSPointerEvent),isIOS:/iphone|ipad|ipod/.test(u),isAndroid:/android/.test(u),isBB:/blackberry/.test(u)||/BB[\d]+;.+\sMobile\s/.test(navigator.userAgent)},v=function(k,s){return s=u.split(s)[1].split("."),k+(b.ver=parseFloat(s.length>0&&isFinite(s[1])?s[0]+"."+s[1]:s[0]))};if(w.matchMedia&&"function"==typeof w.matchMedia?(b.isTouch=w.matchMedia("(any-pointer: coarse)").matches,b.deviceType=b.isTouch?w.matchMedia("(any-hover: hover)").matches||w.matchMedia("(any-pointer: fine)").matches?"hybrid":"touchOnly":"mouseOnly"):b.deviceType=b.isTouch?"touchOnly":"mouseOnly",xui.ini.fakeTouch&&"mouseOnly"==b.deviceType&&(b.fakeTouch=!0),xui.$secureUrl=b.isSecure&&b.ie?'javascript:""':"about:blank",xui.filter(b,(function(o){return!!o})),b.newie)b["newie"+(b.ver=dm)]=!0,b.cssTag1="-ms-",b.cssTag2="ms";else if(b.ie){if(xui.isNumb(dm)?b["ie"+(b.ver=dm)]=!0:b[v("ie","msie ")]=!0,b.ie6){try{document.execCommand("BackgroundImageCache",!1,!0)}catch(e){}w.XMLHttpRequest=function(){return new ActiveXObject("Msxml2.XMLHTTP")}}(b.ie6||b.ie7)&&(b.ie67=1),(b.ie6||b.ie7||b.ie8)&&(b.ie678=1),b.cssTag1="-ms-",b.cssTag2="ms"}else b.gek?(b[v("gek",/.+\//)]=!0,b.cssTag1="-moz-",b.cssTag2="Moz"):b.opr?(b[v("opr","opera/")]=!0,b.cssTag1="-o-",b.cssTag2="O"):b.kde&&(b[v("kde","webkit/")]=!0,b.isSafari?/applewebkit\/4/.test(u)?b["safari"+(b.ver=2)]=!0:/version/.test(u)&&(b[v("safari","version/")]=!0):b.isChrome&&(b[v("chrome","chrome/")]=!0),b.isWebKit?(b.cssTag1="-webkit-",b.cssTag2="Webkit"):(b.cssTag1="-khtml-",b.cssTag2="Khtml"));if(b.isBB&&!b.ver&&(b.ver=parseFloat(u.split("/")[1].substring(0,3)),b["bb"+b.ver]=!0),!ini.path)for(var s,arr=document.getElementsByTagName("script"),reg=/js\/xui(-[\w]+)?\.js$/,l=arr.length;--l>=0;)if((s=arr[l].src).match(reg)){ini.path=s.replace(reg,"").replace(/\(/g,"%28").replace(/\)/g,"%29");break}xui.merge(ini,{appPath:location.href.split("#")[0].split("?")[0].replace(/[^\\\/]+$/,""),dummy_tag:"$_dummy_$"},"without"),ini.path||(ini.path=ini.appPath+"/xui/"),ini.basePath||(ini.basePath=ini.path.replace(/xui\/$/,"").replace(/runtime\/$/,"")),ini.releasePath=ini.appPath,ini.verPath&&(ini.releasePath+=(ini.verPath?ini.verPath+"/":"")+(ini.ver?ini.ver+"/":""));var data=new Image;data.onload=data.onerror=function(){var path=xui.ini.path+"appearance/_oldbrowser/";1==this.width&&1==this.height||(document.documentElement.className+=" xui-nodatauri",xui.merge(xui.ini,{img_dd:path+"ondrag.gif",img_busy:path+"busy.gif",img_pic:path+"picture.png",img_handler:path+"handler.gif",img_bg:path+"bg.gif",img_blank:path+"bg.gif",img_touchcur:path+"touchcur.png"},"without")),data.onload=data.onerror=null},data.src="data:image/gif;base64,R0lGODlhAQABAIAAAP///wAAACH5BAEAAAAALAAAAAABAAEAAAICRAEAOw==",xui.merge(xui.ini,{img_dd:"data:image/gif;base64,R0lGODlhEABAAPcAAAAAAAEBAQICAgMDAwUFBAUFBQcHBwgICAkJCQwMDA8PDx4eHiQkJDAwMD8/P0JCQl1dXf///wAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACH5BAEAAP8ALAAAAAAQAEAAAAj/AP8JHPigQQMHAxMOTAAAgIABAgAkUPgPQsMABAoQCNAQAISEFw0cMMCxI4CFAAIY+Eey4b+LCgSmXCnzpECVBf49AEBgJEWVBwg8WCCgQMuEQEkuYDBgo8uBIlsyeCCgJMWWAB68fPpP5cCOAhm6TLpV4teQI0tyrTgzrcmPChNoVIuAYsKCB+3qtQsgQt+/fgPb/Ce4MOCvEfb6HbhYb1/Eigc35ptYZmW7kw1rRgy48+S9oEOLHk26tGnRnlMzTl0Yst7Mgyk+tnzWpO3JfSPo3q274eXcfjv21rxbeHDBwE32VphbeHPmvYEvBzmc9+eXxa3Hxm69OHPbtk2zNO68WvNh2q8lb6fuuix434Ola5/Nvbt53tLhH8/unXpw49vlhx90/E2HmH3XyTcgSO91FBAAOw==",img_busy:"data:image/gif;base64,R0lGODlhEAAQAOMAAAQCBHx+fLy+vOTm5ERCRMTGxISGhAQGBISChMTCxOzq7FRSVMzKzP7+/gAAAAAAACH/C05FVFNDQVBFMi4wAwEAAAAh+QQJCQANACwAAAAAEAAQAAAESrDJSau9OOvNe1VFonCFIBRcIiQJp7BjNySDxRjMNAQBUk+FAwCAaiR6gURhsUgYhgCEZIDgDRYEwqIALTZmNay2UTB4KwKmwBIBACH5BAkJAA8ALAAAAAAQABAAgwQCBHx+fLy+vERCRKSmpOTi5BQWFNTW1KyurIyKjMTCxERGRPTy9BwaHLSytP7+/gRE8MlJq7046827n47RIJwBAEZ5phsikg9TMNZBHBMj7PR0DEDco7ATFA6JhA04IEh0AgUjEQgomcLY7EG1PmzZClJpiQAAIfkECQkADQAsAAAAABAAEAAABEewyUmrtcywWxn4BTcZH4CIUlGGaFMYbOsuSywuBLHIuC4LNEFrkBjIBoEAwmhRFBKKRDKQuBQEgsIAoWRWEoJEleitRKGWCAAh+QQJCQAPACwAAAAAEAAQAIMEAgR8fny8vrxEQkSkpqTk4uQUFhTU1tSsrqyMiozEwsRERkT08vQcGhy0srT+/v4ERfDJ6UxDM2sDgHkHcWgT5x1DOpKIhRDpQJAaqtK1iJNHkqy7RyIQSAQlw+IR5APiGAXGkiGoSoOFqqBwpAoU1yA0vJxEAAAh+QQJCQANACwAAAAAEAAQAAAES7DJWdYqMzdmWFsEsTRDMkwMoFbhMgQBcjaGCiCCJQhwkEgFG2YyQMRmjYJhmCkhNVBFoqCAQgu7nzWTECS0W4k0UQ2bz+i0en2OAAAh+QQJCQAPACwAAAAAEAAQAIMEAgR8fny8vrxEQkSkpqTk4uQUFhTU1tSsrqyMiozEwsRERkT08vQcGhy0srT+/v4ERfDJeVI6M79DcApB8jAFQy3DUIEJI7zmQ6RDZx3FKxTSQWMTl0AR23Q0o5LEYWggkEgDAGCAaqRUawbRfGq/4LB4TC5DIwAh+QQJCQANACwAAAAAEAAQAAAER7DJqUpSM7eRRkuCUGjSgAQIJyQJ+QXwxWLkAKeuxnm5VCyLVk+yIBAWQ6IRmRQABclJwcCIMg4AwGhoyAIQyYJ3O5ySo9EIACH5BAkJAA8ALAAAAAAQABAAgwQCBHx+fLy+vERCRKSmpOTi5BQWFNTW1KyurIyKjMTCxERGRPTy9BwaHLSytP7+/gRG8MlJ62SFWcuE19tUeEIRXp4Cng+2hkeSHKyUBEFSP3e+x7Od5ECg1Q6LwcB4IigHBETD4NgcngcDAGCAFR9a7g5hMCAsEQA7",img_pic:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEAAAABACAYAAACqaXHeAAAABHNCSVQICAgIfAhkiAAAAAlwSFlzAAAJOgAACToB8GSSSgAAABl0RVh0U29mdHdhcmUAd3d3Lmlua3NjYXBlLm9yZ5vuPBoAAA92SURBVHiczZt7fFTlmce/ZzKT66S5cQsChUC4yKVsFaEUYlAWi4ClfqTq6tYVrfVSy1W01roudPWj4H6ga6ygu3SpZdeu0iKIgLFoIZREBAIGSDDhHkLIhMncJzNz3v3jPScZkklyzkzYT5/5vJ9J5pzznvf3O8/7vM/zvM9RhBAkIoqiWAALYNNaMpCkHY4AIaBV+1aFEGpCN+xlURIhQAOfBKQCGUAmkI4kQUEC9wEewAv4gfDfEgnWeC9UFEVBPvk04BtAXyAXSUKqdloQCf4q4ABaAK+iKKG/FRLiJgAJPgUJuL/W+gHpAyBTBdEon74PqR2p2v0UJAmtZkjQCL9GRKLzlzgJiHr6KUAWkJMPgyfB8BkwdDjkW4DTcGU31B6D+jNgsUJSWF6nAJ6eSFAURcFJAWl8Cz9ZOKliPcd5iSAgFEVRkTzETURcNkCb+8lIlc8fDeN/CjO/D7f2gb5WsGoGIOSCli1QthEOfgE1yKlwCWhCTo+Y00HxKzeQyjsofO+aAxHqqWIR32I30rCGgEjcJAghTDek4csAhoyHO7fCe5ehQYCI1a6C869w8LvwPHA3UAwUAnlILbJc07+fIgTNiG4+VfwKyEfaH1vHPow2S1ysSVFSIHk2DJoKk/tJGxBTsiFrLIx6FeYXwY0a8IFIDbIDNk2rUAJKEal8BOR0e/fRrOBFpml9pANJsexET5IIAaIAlHtgUhbc0NPJmWCfCDe+Bt+fBqOJRYJTmaGBtxsYuY0fsRgYgLRDKYDFLAnxrgIqEJ4MDIZh1nbHp1vJgIwbYczLoD4P7IOTbQcrmEo2mzECXpc+FCI1L4D0MVq1sRmWRDQgMhWUTKmqhg1QJmRMhLFr4AdFuia8zmxu4j3MgJed5ZJEDlID0mlfZg1LXARoFlf9IzS0QoUwyXomZIyD0f8Kdw1/jNn8jNewkGZ6IE04iJBKu/dpSBOjJW5HSAihblCUsApVQi5pA8xcnwEZzmLGX1jLzVjj1MRTnEc+xCTa/YvrrwG6PCaEbyNsjMABs9d+VgT3bSctmBbnGAIEeJrdyIArrH2rmJiOkCABABUQcMEqAYeNXrPnVpi7A7wZcd9WsJZtHMaBNH5eZNxhPr4w6Pjorm90U9A8yR2Qch5GhOFAV86Q3v58KyLD062L09NH5U22ASuAx4F5wASgD9IOWLoab0xs3QH3+xkaibAyHOajcJjyQIC3Gxq4H2l0UpA2xAIo68HWBLcI+Or/AfxzwJPAAmAKMBiw4/PdQzi8nnC4nFBoB17vy3z++RhkIKYbScUQAeEwjwqBK9Zht5udK1cyFumGpugdb4P0Bhgfhr2dwBf3Avg3+Aj4OfAUcC8wDRjOW28VEgp9GBNIJOKhpmY50vHKoIPb3BX4BT3NDL+fc88+yzRkHqBtDV4ASZdgrArHosGnexME/zp/BlYCi4D7gOnACDZtGkckUtvjPC4tXappSpY+VWIS4HKRJwSXjcQSXi8XnniCmcigxK6TsB/SHDAlDOW9An4VB4H1wEvAo8BtwCg2bhxvCLwQgkDAye23/z0wlPYASon19P/BTEDl8XDxkUf4HjIeaCNhPdiKt/Ngqp9IvNAVFfHtxTj7wi7gbeBfgPuBSaxZc5Nh8Hr77W//DbhFG2s6YOlk7UMhXjdDgGYT6hcuZPY1JPi5HUHcz15REXOfQPwSgj+Guhvgv4EXgAd46KE5tLaeNjdKIfjss13AbGAM0oW3dvIDhCCl4289id1O/rp1/MfChUwAsjjGHVj5EEG62b4AFAFznoLv/gb6Q/IUyF8KE8dCDsXFfSkp2YDNNjSOrlOR6m9HWxU6usKKz8eRrCzzPesk1Exl3b5s/pkAaaSirQ/G+4kGn4lc3AdCagZ8c1BGxm0PvP/+4HBGRp75EQJHjtQjV60UtNWgkwYcPkypquKJp3+7nfxt97JsSCM+WpBBagTDzmkX4BkADIW0GV7viIfWrPEY7zFKgsEgGzee6vR7RxsApNTVscysHYhuzS6uDDlIMxcQuBGEEKjG5vwrIN4A8T8g/gKiBoQDRABECMQVcP9oxYpzCKGaGtWvf/1HYAnSiN6i8ZoSiwAbkFNfz5ZESHC00DSkAqcREoyAj2gtAKIWPD945pkLhknYt+8Q8CzwE2AuMBZpBG2dzkXO2vTsbL555gzbEyHhylWah5TT0h0JRsGrWguBaAFRCd55y5df6pGEsrJDWK3PA08jvcepSIcoHUiKRYCuBdmZmYyqrWXHdSRBvW0RLiPgda8yAiIIohnEIfDOWb68vksSysoOa+AXAQ/Qno3OpitHSCNB3/ToY7dz49dfs/M6kKAm/Ts7RsO6lVBrBHw0CQHtvEPgmRNLE/bu/Qqr9UVgMfAgcDsyBdeHqFR8l6PWSEgF+trtjO1lElTeYCvwnAWevgWW7oQ6I+CF9ns0CV+Cb240CXv21GC1rkFGjf8EzESm4/tqmNqCoS53hqK2v2xApt1O/8pKXi8oYFb3603X0uTk6k3VJJ3bSynPsB+ZzHDkgWMp5D4MP8+BiTbaA/quRGgthMyGnAHfi8uXt5TOmhUMzp69i0jEC9QDtfIwl5Cbs/o2fdtTjn0DeYKqXeD2eLg8+k/8/vOzVMVLQJ9scg6PJPSdLRxBbos5gAYHnF29cmX1iOZmb/WoUcf0/FZ3LoSe/LMhY9yhkL5qzZqsV2fN8g2JRNKQGaIQ0hvxaf9HosHrQLtt2n2SqGEml/FYqojsqeN4ItPh6lUai4tZBMwCxrJ69TgikWqEECk+X8P+wsJTzSC8mtXvaip0nA7NII6C9zdQWQjrkEmTecB4pPp33oYzMmLc3EoYN34EjQhLFZHSU9QkQkJLCw3z53M/jz46ndbWU9FHrR5P45ZRo47Vg3CDaDVIQhCEC0QdeLbCl38no8cFQBFQgIwDrERlhXoGLzcq3agIwog2Er5C3X2S2kRIONgw6ARe75lYR60uV9N7I0acO6+BMkpCSCPCAe49cGCKdIDmAZOQnnU6PWWE2g6GmK4tXEJLTXQm4QR18YCvduW3pLQ0NnZ3ltXpbN40cmS1URJ0IvTWAq59sL8IltG+DGYDth4J6AS+Iwm++Ek42ZLvSm6+5DBydpLL1fT7wsJaMyRENze4y2DvZHgYmT3ur9kCpUsC8DAAgaPL0CUBEk625LuSHfXNZvTF5nQ2by4sPK2T0JNhjFGfcOV92PRtmUobiKxriu0IAQoqW3rM2cQg4ZMeSIgHfLQmbBo58sR5zTCaJaERau6UgdAgjYDYGoCbvj2C75qESNkRjvU2eL31+fjj0r9C3SUQPs3oGSUgCIG9sGqcDITalsPOjpCNm7r1Zjp6I3q1kB3U3WwtnsTblZVURJ9W7cp3Twh/GW7Nze++6qM7KS+v8N111x9Ww6uX4ZBeCGA0M5IESf0hq0j+23bpNQQoiqKgkm1qYDoJ/8V2lrI/FCI4ZQolx49TBlDjzndNiBwKJQS+rOww06Z94AuF1K1wvgReCMFxM2khBUKZQKHcSA3rv3fWgEYqTQ/wbT7iCcqQvr0zEODS5Mm8uK1q2M4JHA205gzINd2nPvD9ZUcoLv6AcDgI+CLgKYW6Y/AzAUdMdBWKwL4T0CI0gVgEzKSOCLWGu32HHfyEfYCb9hK4i56HnvLfVVA1OpjZp5+JQV4jeeU7zj6/s2jQ4PxwCjKQcQCO0+BYCxUn4F4VvjDQlVBlUHR+vRC+a490XAHAxiFmIwxsaLzDDmTI+VNktqUIGMnq1eMIhWoSMXh55TvO/OplS2TtWsRbb3F54kQeQ26EDkGmtZNeAqsXJgm5IRvqwgCqETjph0diLvkxlsEkIJOj/JIwgZjAAwRYwwdIN/Mp5F5dEVBISckYPbDpDfC/+x2itBRRUUH9vHnMR25tZaFldE5BihOGqfC+KmsVVc0jjKgQUOFkCJa9BNZYt+uUD4iqAs1mCZN5jEX0YwzZ9OUKTZziPMsppZwmZCjuABqABkpKrDz++J+wWEYaU/LOklfx8dkln84dbE9XLXl5kJ8vW9++ANQvXszCzZupApxoiXchhLisKBm5cE8STFJk4OMX8JkKR6xC7O3qfrEIUDQtSEPW8A0A+pNEjlaQlISMq/3aIK4AjZSUJCcM/uDOs0s+mRMTfGYm2Gzg83HhySdZ+O67HIf23QchhEBRrC2QaYPUdAhfhdYcIVq6u2fMjJBGghUZOWXBNaVoOgFebQBOXnnFyooVH19v8BYLKAq43Vz44Q/5x507OYV8CEHirBfuLiWmV1+lILUhTfvbgiRAfxkiQCj0n1itC+IBDpB3cNe5JZ/cOcierlpyc2HgwK7B61JXx1+GD2cRcBn5IIJ0zPYYkO5SYirSYfBrN2hCLnH1yDnfBLjweot7E3z0k7fbY4MHKCigqKSEecgsbwZxFElCD1ViGpt6XlAvR/Vp3wEgRHLyDLM3bZMDByoXbLzTEQ1+4MB28MnJscHrMmEC30Gmutpqhc0OoccLRLuoQohIVJMlaYoy3uxNASgvr2T69P99Z4O62e3mC7PgAQYMYCjSPn0DLd1tdhiJ1gkqqGqz6avKyyuZNu0PhMPecBjHqlWsDoX43Ax4gJYWAkj1z6C9WMuUJFwoSSh0zNT5UeCBZqC+tZVz993Hc01NfGoUPEB1NQ20v65nshJBSuIE7Nu3GVV1Gjq3vPxoR/DAReCiy8WFqVNZdvYsnxoB7/fjf+01vkSGtaZLZHVJnIA77rhEdfULPZ5XXn6UoqJo8PqKcgW5ljudThpuvpklp0/zaU/drVvH9spKmpHGWN8EuT6lsl012jdnctm162n8/s6JzmAwyJtvfojF8hxyi/pB2vfq+iH9C6vW0oB+ycmM3bWLdaEQ/o63dblw/eIXvAs8A/wYmIPc788lKttrtCX05ii0OUypQC7Tp4/i4YdnM2zYOBQlnaNH69m06WsOHtSLmp1AI+1+hJtr3/LQ45BMoM/8+Yy7+25mFBQwyuuFQ4eo37CB6tOncdO+tXYRqUnNQECYfCGzNwjQ3eY05JLUD+mc6GW0oO0vaoNs0r69aOB17y1qQzYZadlztb70N1JtWn9BwKX11Yh8M1V/LdcUoETeHAWkn6Aoih4cgfQePciYPZoAD5IEN9KZCtPBddX6UmnXighyjrdo/UUT4EGS4Nbu3buxgOmO2qPIZK3p1eQKEmyrNvBWtI3frgas9RXdX4r2bUVa+3BUX60k8OJkrxEAnQau1+mDfJptzehgo6ZEdIvur1sijcj/AcgCrHU5y1W7AAAAAElFTkSuQmCC",img_handler:"data:image/gif;base64,R0lGODlhBAAEAPcAAAAAAGSMtP///wAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACH5BAEAAP8ALAAAAAAEAAQAAAgPAP8JFCDwX4B/BAUe/BcQADs=",img_touchcur:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABIAAAATCAMAAACqTK3AAAAAnFBMVEVKS0sAAAD6+vr39/fj4+OsrKxQUVHk5OTY2NjV1dVgYWHm5ube3t7c3NzV1dXT09PPz8/q6ur19fXNzc2/v7/v7+/u7u6QkJB1dnbt7e1SU1Pd3d3b29vW1tbU1NTT09Ps7Ozl5eXe39/e3t709PS7u7u5ublmZ2fp6enn5+fj4+Ph4eHg4ODc3Nzc3NzZ2dnZ2dnW1tbU1NTT09Pxrtv7AAAANHRSTlPmAP78+fHnyPf26NGiizAcBfr49fPu7e3q6Oedh08oDPr5+Pj38vLp3NfBuLGUkXRrSzgYlzzxjwAAAKFJREFUGNNl0NUOwzAMQFE7sDLzSmPm/f+/LY2atVXv45FlyQac1ZPnaCfLdgdqr4TF/KATq+nJS1gOXWZE35L8wlhAHw+bjuxAiCqyOgozGDKJC1hTGKeXgM52QnsN0DYmxM9iik0oFlMuWY6JVYCY8JHk5CvoSc2/LNY3edAlOCox0laSr1Eu92WrwlPPeaWE6Ru6u/soSfapyketXjjrB1sXCDrwyo6RAAAAAElFTkSuQmCC",img_bg:data.src,img_blank:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAQAAAC1HAwCAAAAC0lEQVQYV2NgYAAAAAMAAWgmWQ0AAAAASUVORK5CYII="},"without");var f=xui._domReadyFuns=function(){if(!xui.isDomReady&&(d.addEventListener?(d.removeEventListener("DOMContentLoaded",f,!1),w.removeEventListener("load",f,!1)):d.detachEvent&&(d.detachEvent("onreadystatechange",f),w.detachEvent("onload",f)),"touchOnly"!=xui.browser.deviceType&&!xui.Dom.getScrollBarSize()&&xui.UI)){var f2=function(c){xui.arr.each(c,(function(key){(key=xui.SC.get(key))&&(key.$DataModel.overflow&&(key.$DataModel.overflow.ini="auto",key.$DataStruct.overflow="auto"),key.$children&&key.$children.length&&f2(key.$children))}))};f2(xui.UI.$children)}try{if(xui.ini.customStyle&&!xui.isEmpty(xui.ini.customStyle)){var txt,arr=[],style=xui.ini.customStyle;xui.each(style,(function(v,k){arr.push(k+" : "+v+";")})),txt=".xui-custom{\r\n"+arr.join("\r\n")+"\r\n}",xui.CSS.addStyleSheet(txt,"xui:css:custom",1)}for(var i=0,l=xui._m.length;i<l;i++)xui.tryF(xui._m[i]);xui._m.length=0,xui.History&&xui.History.activate(),xui.isDomReady=!0}catch(e){xui.asyRun((function(){throw e}))}};if(d.addEventListener)d.addEventListener("DOMContentLoaded",f,!1),w.addEventListener("load",f,!1);else{d.attachEvent("onreadystatechange",f),w.attachEvent("onload",f);var ff=function(){if(!xui.isDomReady)try{d.activeElement.id,d.documentElement.doScroll("left"),f()}catch(e){xui.setTimeout(ff,9)}};ff()}var fe=function(){xui.isDomReady||d.readyState&&!/in/.test(d.readyState)?xui.setTimeout(f,9):xui.setTimeout(fe,9)};fe()},new function(){xui._uriReg=/^([\w.+-]+:)(?:\/\/(?:[^\/?#]*@|)([^\/?#:]*)(?::(\d+)|)|)/,xui._localReg=/^(?:about|app|app\-storage|.+\-extension|file|widget):$/,xui._curHref=function(a){try{return location.href}catch(e){return(a=document.createElement("a")).href="",a.href}}(),xui._localParts=xui._uriReg.exec(xui._curHref.toLowerCase())||[]},new function(){xui.pseudocode={getScope:function(eventArgs,module,temp){return{temp:temp,page:module,args:eventArgs,functions:xui.$cache.functions,constant:xui.constant,global:xui.$cache.data,getCookies:xui.Cookies.get,getFI:function(key){var h=xui.getUrlParams();return h&&h[key]}}},exec:function(_ns,conf,resumeFun,level){var t,tt,m,n,arr,t1,t2,_type,_target,_page,con,ns=this,type=conf.type||"other",comparevars=function(x,y,s){switch(xui.str.trim(s)){case"=":case"is":return x===y;case"<>":case"is-not":case"!=":return x!==y;case"exists":case"defined":return xui.isDefined(x);case"not-exists":case"undefined":return!xui.isDefined(x);case"empty":return xui.isEmpty(x);case"non-empty":return!xui.isEmpty(x);case">":return parseFloat(x)>parseFloat(y);case"<":return parseFloat(x)<parseFloat(y);case">=":return parseFloat(x)>=parseFloat(y);case"<=":return parseFloat(x)<=parseFloat(y);case"inlist":return-1!==xui.arr.indexOf(xui.isArr(y)?y:(y+"").split(/[,;\s:|]+/),x);case"exlist":return-1==xui.arr.indexOf(xui.isArr(y)?y:(y+"").split(/[,;\s:|]+/),x);case"include":return-1!=(x+"").indexOf(y+"");case"exclude":return-1==(x+"").indexOf(y+"");case"begin":return 0===(x+"").indexOf(y+"");case"end":return(x+"").indexOf(y+"")===(x+"").length-(y+"").length;case"objhaskey":return"object"==typeof x&&y in x;case"objnokey":return"object"==typeof x&&!(y in x);case"arrhasvalue":return!!xui.isArr(x)&&-1!==xui.arr.indexOf(x,y);case"arrnovalue":return!!xui.isArr(x)&&-1==xui.arr.indexOf(x,y);case"objarrhaskey":return!!xui.isArr(x)&&-1!==xui.arr.subIndexOf(x,"id",y);case"objarrnokey":return!!xui.isArr(x)&&-1==xui.arr.subIndexOf(x,"id",y);default:return!1}},adjustparam=function(o,_ns){if("string"==typeof o){var m,jsondata,oo,t=o;xui.str.startWith(o,"[data]")&&(o=o.replace("[data]",""),jsondata=1),o=xui.adjustVar(oo=o,_ns),xui.isDefined(o)||(o=xui.adjustVar(oo)),jsondata&&"string"==typeof o?o=xui.unserialize(xui.getFileSync(o)):o&&xui.isStr(t)&&xui.isHash(o)&&(o.actions&&xui.isArr(o.actions)&&o.actions.length||o.return)?(t=(""+t).split(".functions"))&&2==t.length&&(t=xui.adjustVar(t[0]+"}",_ns))&&(oo=o,o=function(){return xui.pseudocode._callFunctions(oo,arguments,t,_ns.temp,null,"refer:"+(oo.desc||oo.id||""))}):o&&xui.isStr(t)&&xui.isFun(o)&&(t=t.replace(/\[(\d+)\]/,".$1"),(t=xui._s2a(t)).length>1?m=t.pop().replace(/[()}\s]/g,""):(m=t[0].replace(/[{()}\s]/g,""),t=["{window"]),t=t.join(".")+"}",t=xui.adjustVar(tt=t,_ns),xui.isDefined(t)||(t=xui.adjustVar(tt)),o=function(){return t[m].apply(t,arguments)})}else if(xui.isHash(o))for(var i in o)o[i]=adjustparam(o[i],_ns);else if(xui.isArr(o)){i=0;for(var l=o.length;i<l;i++)o[i]=adjustparam(o[i],_ns)}return o},redirection=conf.redirection,target=conf.target,method=conf.method,iparams=xui.clone(conf.args||conf.params)||[],conditions=conf.conditions||[],adjust=adjustparam(conf.adjust,_ns)||null,timeout=xui.isSet(conf.timeout)?parseInt(conf.timeout,10):null,resetid=conf.resetid||null,_debug='"'+conf.desc+'"',_var={type:type,target:target,method:method,args:iparams,pseudo:conf,scope:_ns};if(-1!=method.indexOf("-")){t=method.split("-"),method=t[0];for(var i=1,l=t.length;i<l;i++)t[i]&&(iparams[i-1]=t[i])}for(i=0,l=conditions.length;i<l;i++)if(con=conditions[i],!comparevars(xui.isDefined(t1=xui.adjustVar(con.left,_ns))?t1:xui.adjustVar(con.left),xui.isDefined(t2=xui.adjustVar(con.right,_ns))?t2:xui.adjustVar(con.right),con.symbol))return"function"==typeof resumeFun?(xui._debugInfo.apply(xui,["pseudo",xui.str.repeat("  ",level||1),"//",_debug,_var]),resumeFun()):void xui._debugInfo.apply(xui,["pseudo",xui.str.repeat("  ",level||1),"//",_debug,_var]);if(redirection&&(arr=redirection.split(":"))&&xui.isArr(arr)&&(_type=type,_target=target,arr[0]&&(type=arr[0]),arr[1]&&(target=arr[1]),arr[2]&&(method=arr[2])),target&&method&&"none"!=target&&"none"!=method){for(i=redirection?3:"other"!=type||"callback"!=target||"call"!=method&&"set"!=method?0:1,l=iparams.length;i<l;i++)iparams[i]=adjustparam(iparams[i],_ns);!redirection||"other"==type&&"callback"==target&&"call"==method||(iparams=iparams.slice(3));var fun=function(){if(xui._debugInfo.apply(xui,["pseudo",xui.str.repeat("  ",level||1),_debug,_var]),!1!==xui.tryF(ns._Handlers,[type,method,iparams,adjust,target,conf]))switch(type){case"page":if("switch"==method){xui.History._callbackTag||(xui.History._callbackTag=function(fi,init){if(!init){var ar=xui.urlDecode(fi||"");return ar.cls||(ar.cls="App",ar.cache=!0),xui("body").children().each((function(xid){var module=xui.Module.getFromDom(xid);module&&module._showed&&(ar.cache?module.hide():module.destroy())})),xui.showModule(ar.cls),!1}});var hash={cls:target,cache:!!iparams[0]};return iparams[1]&&!xui.isEmpty(iparams[1])&&(hash=xui.merge(hash,iparams[1])),void xui.History.setFI(hash,!0)}if("open"==method)return hash={cls:target},iparams[0]&&!xui.isEmpty(iparams[0])&&(hash=xui.merge(hash,iparams[0])),void window.open("#!"+xui.urlEncode(hash));var ins;if(target&&"*"!=target){if(cls=xui.get(window,target.split(".")))for(var i in cls._cache){ins=cls._cache[i];break}}else ins=_ns.page;if("destroy"==method)return void(ins&&xui.isFun(t=xui.get(ins,[method]))&&t.apply(ins,iparams));if("show"==method&&iparams.unshift((function(err,module){err&&xui.message(err)})),ins)xui.isFun(t=xui.get(ins,[method]))&&t.apply(ins,iparams);else{var t1=_ns.temp._module_funs_=_ns.temp._module_funs_||{},t2=t1[target]=t1[target]||[];t2.push((function(ins,t){xui.isFun(t=xui.get(ins,[method]))&&t.apply(ins,iparams)})),1===t2.length&&xui.getModule(target,(function(err,ins){if(!err){if(ins)for(var i=0,l=t2.length;i<l;i++)t2[i].call(null,ins);t2.length=0,t1=t2=null,delete _ns.temp._module_funs_[target]}}))}break;case"control":case"module":if("{"==target.charAt(0)&&(t=xui.adjustVar(target,_ns))&&xui.isFun(t.getAlias)&&(target=t.getAlias()),"disable"==method||"enable"==method)xui.isFun(t=xui.get(_ns.page,[target,"setDisabled"]))&&t.apply(_ns.page[target],["disable"==method,!0]);else{if("setProperties"==method){var params=xui.merge(iparams[0],iparams[1],"all");iparams[1]=null,(m=params)&&(m.CA&&(xui.isFun(t=xui.get(_ns.page,[target,"setCustomAttr"]))&&t.apply(_ns.page[target],[m.CA]),delete m.CA),m.CC&&(xui.isFun(t=xui.get(_ns.page,[target,"setCustomClass"]))&&t.apply(_ns.page[target],[m.CC]),delete m.CC),m.CS&&(xui.isFun(t=xui.get(_ns.page,[target,"setCustomStyle"]))&&t.apply(_ns.page[target],[m.CS]),delete m.CS))}else"show"==method&&iparams.unshift((function(err,module){err&&xui.message(err)}));xui.isFun(t=xui.get(_ns.page,[target,method]))&&t.apply(_ns.page[target],iparams)}break;case"other":switch(target){case"url":switch(method){case"close":window.close();break;case"open":xui.Dom.submit(iparams[0],iparams[1],iparams[2],iparams[3]);break;case"mailTo":xui.mailTo.apply(xui,iparams);break;case"selectFile":xui.Dom.selectFile.apply(xui.Dom,iparams);break;case"readText":xui.getFileAsync.apply(xui,iparams);break;case"readJSON":iparams[4]={rspType:"json"},xui.getFileAsync.apply(xui,iparams)}break;case"msg":"busy"==method||"free"==method?xui.isFun(t=xui.get(xui.Dom,[method]))&&t.apply(xui.Dom,iparams):"console"==method&&xui.isDefined(window.console)&&"function"==typeof console.log?console.log.apply(console,iparams):xui.isFun(t=xui.get(xui,[method]))&&t.apply(xui,iparams);break;case"var":if(iparams[0].length){var v=iparams[1];if(iparams[2]&&(v=xui.get(v,xui._s2a(iparams[2]))),adjust)switch(adjust){case"serialize":v=xui.serialize(v);break;case"unserialize":v=xui.unserialize(v);break;case"stringify":v=xui.stringify(v);break;default:"function"==typeof adjust&&(v=adjust(v))}xui.set(_ns,xui._s2a(method+"."+xui.str.trim(iparams[0])),v)}break;case"callback":switch(method){case"setCookies":iparams[0]&&!xui.isEmpty(iparams[0])&&xui.Cookies.set(iparams[0]);break;case"setFI":iparams[0]&&!xui.isEmpty(iparams[0])&&xui.History.setFI(iparams[0],!0,!0);break;case"set":xui.set(_ns,xui._s2a("temp."+xui.str.trim(iparams[0])),iparams[1]);break;case"call":var cls;if("page"==_type&&(_page=_ns.page,cls=xui.get(window,_target.split("."))))for(var i in cls._cache){_ns.page=cls._cache[i];break}var doit,doit2,y,args=iparams.slice(3);if(t=iparams[0],xui.isStr(t)&&/^\{[\w][\w.]*[\w](\([^)]*\))?\}$/.test(t.replace(/\s/g,"").replace(/\[(\d+)\]/,".$1"))&&(t=t.replace(/\[(\d+)\]/,".$1"),(t=xui._s2a(t)).length>1?m=t.pop().replace(/[()}\s]/g,""):(m=t[0].replace(/[{()}\s]/g,""),t=["{window"]),t=t.join(".")+"}",t=xui.adjustVar(tt=t,_ns),xui.isDefined(t)||(t=xui.adjustVar(tt)),t&&t[m]))if(xui.isFun(t[m]))doit=1;else if((t[m].actions&&xui.isArr(t[m].actions)&&t[m].actions.length||t[m].return)&&(t=t[m],doit2=1,args&&args.length&&t.params&&t.params.length)){i=0;for(var l=args.length;i<l;i++)(y=t.params[i]&&t.params[i].type)&&(args[i]="String"==y?xui.isSet(args[i])?args[i]+"":args[i]:"Number"==y?parseFloat(args[i])||0:"Boolean"==y?!!args[i]:args[i])}doit?t=t[m].apply(t,args):doit2&&((n=(""+conf.args[0]).split(".functions"))&&2==n.length&&(n=xui.adjustVar(n[0]+"}",_ns)),t=ns._callFunctions(t,args,n||_ns.page,_ns.temp,null,"nested:"+(t.desc||t.id||""),(level||1)+1)),(doit||doit2)&&iparams[1]&&iparams[2]&&xui.get(_ns,xui._s2a(iparams[1]))&&xui.set(_ns,xui._s2a(iparams[1]+"."+iparams[2]),t),_page&&(_ns.page=_page,_page=null)}}}};null!==timeout?resetid?xui.resetRun(resetid,fun,timeout):xui.asyRun(fun,timeout):fun()}return conf.return},apply:function(funConf,args,scope){var fs=xui.$cache.functions;return xui.isStr(funConf)&&(funConf=fs&&fs[funConf]),xui.isObj(funConf)?xui.pseudocode._callFunctions(funConf,args||[],scope||this):null},_callFunctions:function(pseudo,args,module,temp,holder,fromtag,level){temp=temp||{};var fun,t,newbie,funsrtn,ns=this,resume=0,funs=pseudo.actions||pseudo||[],rtn=pseudo.return,newbies=pseudo.newbies,innerE=1==funs.length&&("function"==typeof funs[0]||"string"==typeof funs[0]),_ns=ns.getScope(args,module,temp),recursive=function(data){var irtn;xui.isStr(this)&&(_ns.temp[this+""]=data||"");for(var j=resume,l=funs.length;j<l;j++)if(resume=j+1,fun=funs[j],module&&"string"==typeof fun&&(fun=module[fun]),holder&&"string"==typeof fun&&(fun=holder[fun]),"function"==typeof fun){if(!1===(irtn=xui.tryF(fun,_ns.args,_ns.page))){resume=j;break}}else if(xui.isHash(fun)){if(fun.disabled)continue;if("onOK"in fun||"onKO"in fun){var resumeRtn,resumeFun=function(key,args,flag){if(recursive)return xui.isStr(flag)&&(_ns.temp[flag]=!0),!1!==resumeRtn&&recursive.apply(key,args||[])};"onOK"in fun&&((fun.args||fun.params||(fun.args=[]))[parseInt(fun.onOK,10)||0]=function(){resumeFun&&resumeFun("okData",arguments,fun.okFlag)}),"onKO"in fun&&((fun.args||fun.params||(fun.args=[]))[parseInt(fun.onKO,10)||0]=function(){resumeFun&&resumeFun("koData",arguments,fun.koFlag)}),resumeRtn=ns.exec(_ns,fun,resumeFun,level);break}if(!1===ns.exec(_ns,fun,null,level)){xui._debugInfo("pseudo",xui.str.repeat("  ",level||1),"The action returns false to stop the follow-up actions!"),resume=j;break}}return resume==j&&(resume=recursive=null),irtn};if(!innerE&&(xui._debugGroup("pseudo",xui.str.repeat("  ",(level||1)-1),'"'+fromtag+'"',{pseudo:pseudo},{scope:_ns}),xui._debugInfo("pseudo",xui.str.repeat("  ",(level||1)-1),"{"),newbies))for(var k in temp.newbies={},newbies)(newbie=xui.create(newbies[k])).setHost&&_ns.page&&newbie.setHost(_ns.page,newbie.getAlias()+"-"+xui.rand()),temp.newbies[k]=newbie;return funsrtn=recursive(),rtn?(rtn=xui.adjustVar(t=rtn,_ns),xui.isDefined(rtn)||(rtn=xui.adjustVar(t))):rtn=funsrtn,innerE||(xui._debugInfo("pseudo",xui.str.repeat("  ",level||1),"return",rtn),xui._debugInfo("pseudo",xui.str.repeat("  ",(level||1)-1),"}"),xui._debugGroupEnd("pseudo",xui.str.repeat("  ",(level||1)-1))),rtn}}},new function(){var M={"\b":"\\b","\t":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\","/":"\\/","\v":"\\u000b"},H={"@window":"window","@this":"this"},A1=/\uffff/.test("￿")?/[\\\"\x00-\x1f\x7f-\uffff]/:/[\\\"\x00-\x1f\x7f-\xff]/,A2=/\uffff/.test("￿")?/[\\\"\x00-\x1f\x7f-\uffff]/g:/[\\\"\x00-\x1f\x7f-\xff]/g,D=/^(-\d+|\d{4})-(\d{2})-(\d{2})T(\d{2}):(\d{2}):(\d{2})(?:\.(\d{1,3}))?((?:[+-](\d{2})(\d{2}))|Z)?$/,E=function(t,i,a,v,m,n,p){for(i in p||(p=[t]),t)"string"==(a=typeof(v=t[i]))&&(v=D.exec(v))?(n="Z"!=(m=v[8]&&v[8].charAt(0))?("-"==m?-1:1)*(60*(+v[9]||0))+(+v[10]||0):0,(n+=(m=new Date(+v[1],+v[2]-1,+v[3],+v[4],+v[5],+v[6],+v[7]||0)).getTimezoneOffset())&&m.setTime(m.getTime()+6e4*n),t[i]=m):"object"==a&&t[i]&&(xui.isHash(t[i])||xui.isArr(t[i]))&&-1==xui.arr.indexOf(p,t[i])&&(E(t[i],0,0,0,0,0,p),p.push(t[i]));return t},F="function",N="number",L="boolean",S="string",O="object",T={},PS=function(v,n){return("000"+(v||0)).slice(-n)},Z=((a=-(new Date).getTimezoneOffset()/60)>0?"+":"-")+(1==(a=""+Math.abs(a)).length?"0":"")+a+"00",a,safeW;T[void 0]=function(){return"null"},T[L]=function(x){return String(x)},T[N]=function(x){return(x||0===x)&&isFinite(x)?String(x):"null"},T[S]=function(x){return H[x]||'"'+(A1.test(x)?x.replace(A2,(function(a,b){return(b=M[a])?b:"\\u"+((b=a.charCodeAt())<16?"000":b<256?"00":b<4096?"0":"")+b.toString(16)})):x)+'"'},T[O]=function(x,filter,dateformat,deep,max,MAXL,MAXS){var map={prototype:1,constructor:1,toString:1,valueOf:1,toLocaleString:1,propertyIsEnumerable:1,isPrototypeOf:1,hasOwnProperty:1};if(deep=deep||1,max=max||0,MAXL=MAXL||xui.SERIALIZEMAXLAYER,MAXS=MAXS||xui.SERIALIZEMAXSIZE,deep>MAXL||max>MAXS)return xui.$_outofmilimted;if(max++,x){var f,i,l,v,a=[],b=[];if(x===window)return"window";if(x===document)return"document";if(!(typeof x!=O&&typeof x!=F||xui.isFun(x.constructor)))return x.nodeType?"document.getElementById('"+x.id+"')":"$alien";if(xui.isArr(x)){for(a[0]="[",l=x.length,i=0;i<l;++i)"function"==typeof filter&&0==filter.call(x,x[i],i,b)||(xui.isNaN(v=x[i])?b[b.length]="NaN":xui.isNull(v)?b[b.length]="null":xui.isDefined(v)?(f=T[typeof v])&&typeof(v=f(v,filter,dateformat,deep+1,max,MAXL,MAXS))==S&&(b[b.length]=v):b[b.length]="undefined");a[2]="]"}else if(xui.isDate(x))switch(dateformat){case"utc":return'"'+PS(x.getUTCFullYear(),4)+"-"+PS(x.getUTCMonth()+1,2)+"-"+PS(x.getUTCDate(),2)+"T"+PS(x.getUTCHours(),2)+":"+PS(x.getUTCMinutes(),2)+":"+PS(x.getUTCSeconds(),2)+"."+PS(x.getUTCMilliseconds(),3)+'Z"';case"gmt":return'"'+PS(x.getFullYear(),4)+"-"+PS(x.getMonth()+1,2)+"-"+PS(x.getDate(),2)+"T"+PS(x.getHours(),2)+":"+PS(x.getMinutes(),2)+":"+PS(x.getSeconds(),2)+"."+PS(x.getMilliseconds(),3)+Z+'"';case"date":return"new Date("+[x.getFullYear(),x.getMonth(),x.getDate(),x.getHours(),x.getMinutes(),x.getSeconds(),x.getMilliseconds()].join(",")+")";default:return'"'+xui.Date.format(x,dateformat||"yyyy-mm-dd hh:mm:ss")+'"'}else{if(xui.isReg(x))return String(x);if(typeof x.serialize==F&&(x=x.serialize()),typeof x!=O)return String(x);if(x.nodeType)return"document.getElementById('"+x.id+"')";for(i in a[0]="{",x)map[i]||(!0===filter?"_"==i.charAt(0):"function"==typeof filter&&!1===filter.call(x,x[i],i,b))||(xui.isNaN(v=x[i])?b[b.length]=T.string(i)+":NaN":xui.isNull(v)?b[b.length]=T.string(i)+":null":xui.isDefined(v)?(f=T[typeof v])&&typeof(v=f(v,filter,dateformat,deep+1,max,MAXL,MAXS))==S&&(b[b.length]=T.string(i)+":"+v):b[b.length]=T.string(i)+":undefined");a[2]="}"}return a[1]=b.join(", "),a[0]+a[1]+a[2]}return"null"},T[F]=function(x){return x.$path?x.$path:String(x)},xui.$_outofmilimted='"..."',xui.serialize=function(obj,filter,dateformat,MAXL,MAXS){return xui.isNaN(obj)?"NaN":xui.isNull(obj)?"null":xui.isDefined(obj)?T[typeof obj](obj,filter,xui.getDateFormat(dateformat),0,0,MAXL,MAXS)||"":"undefined"},xui.stringify=function(obj,filter,dateformat,MAXL,MAXS){return xui.fromUTF8(xui.serialize(obj,filter,xui.getDateFormat(dateformat),0,0,MAXL,MAXS))},xui.unserialize=function(str,dateformat){if("string"!=typeof str)return str;if(!str)return!1;if(!safeW){var ifr=document.createElement(xui.browser.ie&&xui.browser.ver<9?"<iframe>":"iframe"),w,d;for(var i in document.body.appendChild(ifr),w="contentWindow"in ifr?ifr.contentWindow:"window"in ifr?ifr.window:(d=ifr.contentDocument||ifr.document).defaultView||d.parentWindow,safeW={},w)safeW[i]=null;document.body.removeChild(ifr)}str="({ _ : (function(){ with(this){ return ("+str+"); } }).call(safeW) })";try{str=eval(str)}catch(e){return!1}return xui.getDateFormat(dateformat)&&E(str),str=str._,str}},new function(){xui.id=function(){if(this.constructor!==xui.id||this.a)return(xui.id._||(xui.id._=new xui.id)).next();this.a=[-1],this.b=[""],this.value=""},xui.id.prototype={constructor:xui.id,_chars:"abcdefghijklmnopqrstuvwxyz".split(""),next:function(i){var m,k,l;if(i=i||0===i?i:this.b.length-1,(m=this.a[i])>=25)if(m=0,0===i){for(this.a.splice(0,0,1),this.b.splice(0,0,"a"),l=this.a.length,k=1;k<l;++k)this.a[k]=0,this.b[k]="0";++i}else this.next(i-1);else++m;return this.a[i]=m,this.b[i]=this._chars[m],this.value=this.b.join("")}}},xui.Class("xui.Thread",null,{Constructor:function(id,tasks,delay,callback,onStart,onEnd,cycle){var upper=arguments.callee.upper;upper&&upper.call(this),upper=null;var self=this,me=arguments.callee,t=xui.$cache.thread;if(self.constructor!==me||self.id)return new me(id,tasks,delay,callback,onStart,onEnd,cycle);"string"!=typeof id&&(id="$"+self.constructor.$xid++),self.id=id,self.profile=t[id]||(t[id]={id:id,_start:!1,time:0,_left:0,_asy:.1,index:0,tasks:tasks||[],delay:delay||0,callback:callback,onStart:onStart,onEnd:onEnd,cache:{},status:"ini",cycle:!!cycle,instance:self})},Instance:{_fun:xui.fun(),__gc:function(){var m=xui.$cache.thread,t=m[this.id];if(t)for(var i in delete m[this.id],t.tasks.length=0,t)t[i]=null},_task:function(){var p=this.profile;if(p&&p.status&&p.tasks){p._asy=.1;var r,i,t={},value=p.tasks[p.index],type=typeof value;if("function"==type)t.task=value;else if("object"==type)for(i in value)t[i]=value[i];if("function"!=typeof t.callback&&(t.callback=p.callback),"function"==typeof t.task&&(t.args=t.args||[],t.args=t.args.concat([p.id,p.tasks,p.index])),p.index++,p.time=xui.stamp(),"function"==typeof t.task&&(r=xui.tryF(t.task,t.args||[p.id,p.tasks,p.index],t.scope||this,null)),p.status){if(t.id&&(p.cache[t.id]=r),t.callback&&!1===xui.tryF(t.callback,[p.id,p.tasks,p.index],this,!0))return this.abort("callback");"run"===p.status&&this.start()}}},start:function(time,delaycb){var p=this.profile;if(p.__delaycb&&(xui.tryF(p.__delaycb,[p.id],this),delete p.__delaycb),delaycb&&(p.__delaycb=delaycb),!1===p._start&&(p._start=!0,p.onStart)){var r=xui.tryF(p.onStart,[p.id],this);if(!1===r)return this.abort("start");if(!0===r)return;if(xui.isNumb(r))return void this.suspend(r)}if(p.status="run",!p.tasks.length)return this.abort("empty");if(p.index>=p.tasks.length){if(!0!==p.cycle)return this.abort("normal");this.profile.index=0}var task=p.tasks[p.index],delay="number"==typeof task?task:task&&"number"==typeof task.delay?task.delay:p.delay;return p._left=time||0===time?time:delay,.1!=p._asy&&xui.clearTimeout(p._asy),p._asy=xui.asyRun(this._task,p._left,[],this),p.time=xui.stamp(),this},suspend:function(time,delaycb){var n,p=this.profile;if("pause"!=p.status)return p.status="pause",.1!==p._asy&&(xui.clearTimeout(p._asy),p.index>0&&p.index--),n=p._left-(xui.stamp()-p.time),p._left=n>=0?n:0,Number(time)&&this.resume(time,delaycb),this},resume:function(time,delaycb){var p=this.profile;return"run"==p.status||(time=time===undefined?p._left:!0===time?p.delay:!1===time?0:Number(time)||0,p.status="run",this.start(time,delaycb)),this},abort:function(flag){var p=this.profile;if("stop"!=p.status){p.status="stop";var onEnd=p.onEnd,id=p.id;xui.clearTimeout(p._asy),this.__gc(),xui.tryF(onEnd,[id,flag])}},links:function(thread){var p=this.profile,onEnd=p.onEnd;return p.id,p.onEnd=function(tid,flag){xui.tryF(onEnd,[tid,flag]),thread.start()},this},insert:function(arr,index){var a,o=this.profile.tasks,l=o.length;return xui.isArr(arr)||(arr=[arr]),(index=index||this.profile.index)<0&&(index=-1),-1==index?Array.prototype.push.apply(o,arr):(index>l&&(index=l),a=o.splice(index,l-index),o.push.apply(o,arr),o.push.apply(o,a)),this},getCache:function(key){return this.profile.cache[key]},setCache:function(key,value){return this.profile.cache[key]=value,this},isAlive:function(){return!!xui.$cache.thread[this.id]},getStatus:function(){return this.profile.status}},After:function(){for(var self=this,f=function(i){self[i]=function(id){var t;if(xui.$cache.thread[id])return(t=xui.Thread(id))[i].apply(t,Array.prototype.slice.call(arguments,1))}},a="start,suspend,resume,abort,links,insert,isAlive,getStatus".split(","),i=0,l=a.length;i<l;i++)f(a[i])},Static:{$asFunction:1,$xid:1,__gc:function(){xui.$cache.thread={}},get:function(id){return(id=xui.$cache.thread[id])&&id.instance},isAlive:function(id){return!!xui.$cache.thread[id]},observableRun:function(tasks,onEnd,threadid,busyMsg){var thread=xui.Thread,dom=xui.Dom;xui.isArr(tasks)||(tasks=[tasks]),xui.$cache.thread[threadid]?("function"==typeof onEnd&&tasks.push(onEnd),thread.insert(threadid,tasks)):thread(threadid,tasks,0,null,(function(threadid){dom&&dom.busy(threadid,busyMsg)}),(function(threadid){xui.tryF(onEnd,arguments,this),dom&&dom.free(threadid)})).start()},group:function(id,group,callback,onStart,onEnd){var bak={},thread=xui.Thread,f=function(o,i,threadid){if("string"==typeof o&&(o=thread(o)),o){var f=function(){var me=arguments.callee;xui.tryF(me.onEnd,arguments,this),me.onEnd=null,delete bak[i],xui.tryF(callback,[i,threadid],this),xui.isEmpty(bak)&&thread.resume(threadid)};f.onEnd=o.profile.onEnd,o.profile.onEnd=f,o.start()}};for(var i in group)bak[i]=1;return thread(id,[function(threadid){if(!xui.isEmpty(group))for(var i in thread.suspend(threadid),group)f(group[i],i,threadid)}],0,null,onStart,onEnd)},repeat:function(task,interval,onStart,onEnd){return xui.Thread(null,[null],interval||0,task,onStart,onEnd,!0).start()}}}),xui.Class("xui.absIO",null,{Constructor:function(uri,query,onSuccess,onFail,threadid,options){var upper=arguments.callee.upper;upper&&upper.call(this),upper=null,"object"==typeof uri?options=uri:(options=options||{},xui.merge(options,{uri:uri,query:query,onSuccess:onSuccess,onFail:onFail,threadid:threadid}));var self=this,me=arguments.callee,con=self.constructor;if(con!==me||self.id)return new me(options);xui.merge(options,{id:options.id||""+con._id++,uid:""+con.uid++,uri:options.uri?xui.adjustRes(options.uri,0,1,1):"",username:options.username||undefined,password:options.password||undefined,query:options.query||options.params||"",data:options.data||options.body||"",contentType:options.contentType||"",Accept:options.Accept||"",headers:options.headers||options.header||null,asy:!1!==options.asy,scriptType:options.scriptType},"all"),options.method=(options.method||con.method).toUpperCase();for(var a="retry,timeout,reqType,rspType,optimized,customQS".split(","),i=0,l=a.length;i<l;i++)options[a[i]]=a[i]in options?options[a[i]]:con[a[i]],"string"==typeof options[a[i]]&&(options[a[i]]=options[a[i]].toLowerCase());return xui.merge(self,options,"all"),"xml"==self.reqType&&(self.method="POST"),con.events&&xui.merge(self,con.events),self.query=self.customQS(self.query,options&&options.exData),"object"==typeof self.query&&"xml"!=self.reqType&&(self.query=xui.copy(self.query,(function(o){return o!==undefined}))),!self._useForm&&xui.isHash(self.query)&&"xml"!=self.reqType&&(self.query=con._buildQS(self.query,"json"==self.reqType)),self},Instance:{_fun:xui.fun(),_flag:0,_response:!1,_txtresponse:"",_retryNo:0,_time:function(){this.constructor,this._clear(),this._retryNo<this.retry?(this._retryNo++,xui.tryF(this.onRetry,[this._retryNo],this),this.start()):!1!==xui.tryF(this.onTimeout,[],this)&&this._onError(new Error("Request timeout"))},_onEnd:function(){this._end||(this._end=!0,this._flag>0&&(xui.clearTimeout(this._flag),this._flag=0),xui.Thread.resume(this.threadid),xui.tryF(this.$onEnd,[],this),xui.tryF(this.onEnd,[],this),this._clear())},_onStart:function(){xui.Thread.suspend(this.threadid),xui.tryF(this.$onStart,[],this),xui.tryF(this.onStart,[],this)},_onResponse:function(){!1!==xui.tryF(this.beforeSuccess,[this._response,this.rspType,this.threadid],this)&&xui.tryF(this.onSuccess,[this._response,this.rspType,this.threadid],this),this._onEnd()},_onError:function(e,status,statusText,response){!1!==xui.tryF(this.beforeFail,[e,this.threadid,status,statusText,response],this)&&xui.tryF(this.onFail,[e,this.rspType,this.threadid,status,statusText,response],this),this._onEnd()},isAlive:function(){return!this._end},abort:function(){this._onEnd()}},Static:{$abstract:!0,get:function(uri,query,onSuccess,onFail,threadid,options){return(options=options||{}).method="GET",this.apply(this,arguments).start()},post:function(uri,query,onSuccess,onFail,threadid,options){return(options=options||{}).method="POST",this.apply(this,arguments).start()},_id:1,uid:1,method:"GET",retry:0,timeout:6e4,reqType:"form",rspType:"json",optimized:!1,callback:"callback",_buildQS:function(hash,flag){return hash=xui.clone(hash,(function(o,i){return!(xui.isNaN(o)||!xui.isDefined(o)||xui.isFile(o))})),flag?(flag=xui.serialize(hash))&&encodeURIComponent(flag):xui.urlEncode(hash)},customQS:function(obj,ex){return ex&&("string"==typeof obj?obj=(obj||"")+"&"+xui.urlEncode(ex):xui.merge(obj,ex,"all")),obj},_if:function(doc,id,onLoad){var w,d,ie8=xui.browser.ie&&xui.browser.ver<9,scr=ie8?"<iframe "+(id?"name='xui_xdmi:"+id+"'":"")+(onLoad?" onload='xui.XDMI._o(\""+id+"\")'":"")+">":"iframe",ifr=doc.createElement(scr);return id&&(ifr.id=ifr.name="xui_xdmi:"+id),!ie8&&onLoad&&(ifr.onload=onLoad),ifr.style.display="none",doc.body.appendChild(ifr),[ifr,w="contentWindow"in ifr?ifr.contentWindow:"window"in ifr?ifr.window:(d=ifr.contentDocument||ifr.document).defaultView||d.parentWindow,w.document]},isCrossDomain:function(uri){var b=xui._localParts;uri=uri.replace(/#.*$/,"").replace(/^\/\//,b[1]+"//");var a=xui._uriReg.exec((uri||"").toLowerCase());return!(!a||a[1]===b[1]&&a[2]===b[2]&&(a[3]||("http:"===a[1]?80:443))===(b[3]||("http:"===b[1]?80:443)))},groupCall:function(hash,callback,onStart,onEnd,threadid){var i,f=function(o,i,hash){hash[i]=xui.Thread(null,[function(threadid){o.threadid=threadid,o.start()}])};for(i in hash)f(hash[i],i,hash);return xui.Thread.group(null,hash,callback,(function(){xui.Thread.suspend(threadid),xui.tryF(onStart,arguments,this)}),(function(){xui.tryF(onEnd,arguments,this),xui.Thread.resume(threadid)})).start()}}}),xui.Class("xui.Fetch","xui.absIO",{Instance:{withCredentials:!0,credentials:"include",_init:"method,headers,body,referrer,referrerPolicy,mode,credentials,cache,redirect,integrity,keepalive,signal".split(","),start:function(){var self=this;if(!1!==xui.tryF(self.beforeStart,[],self)){if(!self._retryNo&&self.query&&(self.uri=self.uri.split("#")[0].split("?")[0]+"?"+self.query,self.query=null),self._retryNo||self._onStart(),self.data)if(xui.isHash(self.data))if(xui.isEmpty(self.data))self.body=null;else if("json"==self.reqType)self.body=JSON.stringify(self.data);else{var formData=new FormData;xui.each(self.data,(function(o,i){xui.isFile(o)?formData.append(i,o,o.name):formData.append(i,o)})),self.body=formData}else self.body=self.data;self.controller||(self.controller=new AbortController,self.signal=self.controller.signal),xui.get(self,["headers","Authorization"])&&!self.credentials&&(self.credentials="include");var ok,e1,status,statusText,init={};if(xui.arr.each(self._init,(function(k){self.hasOwnProperty(k)&&self[k]&&(init[k]=self[k])})),!1!==xui.tryF(self.beforeSend,[self.uri,init],self))return fetch(self.uri,init).then((function(response){var rst;status=response.status,statusText=response.statusText;try{switch(self.rspType.toLowerCase()){case"arraybuffer":rst=response.arrayBuffer();break;case"formData":rst=response.formData();break;case"json":rst=response.json();break;case"text":rst=response.text();break;case"blob":rst=response.blob();break;default:throw new Error("Unsupported rspType -- "+rspType)}}catch(e){return void(e1=e)}return response.ok?ok=!0:e1=new Error("State error -- "+status+" "+statusText),rst})).then((function(response){ok?(self._response=response,self._onResponse()):self._onError(e1,status,statusText,response)})).catch((function(e){"AbortError"===e.name||self._onError(e)})),self.timeout>0&&(self._flag=xui.asyRun((function(){self&&!self._end&&(self.controller&&self.controller.abort(),self._time())}),self.timeout)),self;self._onEnd()}else self._onEnd()},abort:function(){var self=this;self.controller&&self.controller.abort(),arguments.callee.upper.call(self)},_clear:function(){}}}),xui.Class("xui.Ajax","xui.absIO",{Instance:{_XML:null,_unsafeHeader:"Accept-Charset,Accept-Encoding,Access-Control-Request-Headers,Access-Control-Request-Method,Connection,Content-Length,Cookie,Cookie2,Date,DNT,Expect,Host,Keep-Alive,Origin,Referer,TE,Trailer,Transfer-Encoding,Upgrade,User-Agent,Via".toLowerCase().split(","),_isunsafe:function(k){return xui.browser.isWebKit&&(xui.str.startWith("Proxy-",k)||xui.str.startWith("Sec-",k)||-1!==xui.arr.indexOf(this._unsafeHeader,k.toLowerCase()))},_header:function(n,v){this._isunsafe(n)||this._XML&&this._XML.setRequestHeader(n,v)},start:function(){var self=this;if(!1!==xui.tryF(self.beforeStart,[],self)){self._retryNo||self._onStart();try{if(self._XML=new window.XMLHttpRequest,self.asy&&(self._XML.onreadystatechange=function(){self&&self._XML&&4==self._XML.readyState&&(self._complete.apply(self),self._clear())}),!self._retryNo&&self.query&&(self.uri=self.uri.split("#")[0].split("?")[0]+"?"+self.query,self.query=null),self.data)if(xui.isHash(self.data))if(xui.isEmpty(self.data))self.body=null;else{var formData=new FormData;xui.each(self.data,(function(o,i){xui.isFile(o)?formData.append(i,o,o.name):formData.append(i,o)})),self.body=formData}else self.body=self.data;if(self.username&&self.password?self._XML.open(self.method,self.uri,self.asy,self.username,self.password):self._XML.open(self.method,self.uri,self.asy),self.onUploadProgress&&request.upload&&self._XML.upload.addEventListener("progress",self._uploadProgress=function(e){xui.tryF(self.onUploadProgress,[e.loaded/e.total*100,e.loaded,e.total,e],self)}),self.onDownloadProgress&&(self._XML.onprogress=function(e){xui.tryF(self.onDownloadProgress,[e.loaded/e.total*100,e.loaded,e.total,e],self)}),self._header("Accept",self.Accept?self.Accept:"json"==self.rspType?"application/json,text/javascript,*/*;q=0.01":"xml"==self.rspType?"text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8":"*/*"),!xui.absIO.isCrossDomain(self.uri)&&(self._header("Content-type",self.contentType?self.contentType:("xml"==self.reqType?"text/xml; ":"json"==self.reqType?"application/json; ":"POST"==self.method?"application/x-www-form-urlencoded; ":"")+"charset="+(self.charset||"UTF-8")),self._header("X-Requested-With","XMLHttpRequest"),self.optimized))try{self._header("User-Agent",null),self._header("Accept-Language",null),self._header("Connection","keep-alive"),self._header("Keep-Alive",null),self._header("Cookie",null),self._header("Cookie","")}catch(e){}try{xui.isHash(self.headers)&&xui.each(self.headers,(function(o,i){self._header(i,o)}))}catch(e){}if(!1===xui.tryF(self.beforeSend,[self._XML],self))return void self._onEnd();try{self._XML.send(self.body||null)}catch(e){}if(!self.asy)return self._complete();self._XML&&self.timeout>0&&(self._flag=xui.asyRun((function(){self&&!self._end&&self._time()}),self.timeout))}catch(e){self._onError(e)}return self}self._onEnd()},abort:function(){var self=this;self._XML&&(self._XML.abort(),self._clear()),arguments.callee.upper.call(self)},_clear:function(){this._XML&&(this._XML.onreadystatechange=this._XML.onprogress=this._fun,this._uploadProgress&&this._XML.upload.removeEventListener("progress",this._uploadProgress),this._uploadProgress=this._XML=null)},_complete:function(){var obj,ns=this,status=ns._XML.status,statusText=ns._XML.statusText;return ns._txtresponse="xml"==ns.rspType?ns._XML.responseXML:ns._XML.responseText,ns._response="blob"==ns.rspType||"document"==ns.rspType||"arraybuffer"==ns.rspType?ns._XML.response:"json"==ns.rspType?/^\s*\</.test(ns._txtresponse)&&(obj=xui.XML.xml2json(xui.XML.parseXML(ns._txtresponse)))&&obj.data?obj.data:!1===(obj=xui.unserialize(ns._txtresponse))?ns._txtresponse:obj:ns._txtresponse,!status&&xui._localReg.test(xui._localParts[1])&&(status=ns._XML.responseText?200:404),1223==status&&(status=204),status>=200&&status<300||304==status?ns._onResponse():status===undefined||status<10?ns._onError(new Error("Network problems--"+status),status,statusText,ns._response):ns._onError(new Error("XMLHTTP returns--"+status),status,statusText,ns._response),ns._response}},Static:{$asFunction:1}}),xui.Class("xui.JSONP","xui.absIO",{Instance:{start:function(){var id,n,self=this,c=self.constructor,ok=!1;if(!1!==xui.tryF(self.beforeStart,[],self)){self._retryNo||self._onStart(),"script"==self.rspType&&(self.retry=0),id=self.id,c._pool[id]?c._pool[id].push(self):c._pool[id]=[self],c.No["_"+id]=function(rsp){c.$response(rsp,id)};var w=document,_cb=function(){ok||(ok=!0,"script"==self.rspType?"string"==typeof self.checkKey?xui.setTimeout((function(){xui.exec("!function(t){if(t=xui.get(xui.JSONP,['_pool','"+id+"',0])) {if(xui.SC.get('"+self.checkKey+"'))t._onResponse();else t._loaded();}}()")}),!1):self._onResponse():self._loaded())};n=self.node=w.createElement("script");var uri=self.uri;self.query&&(uri=uri.split("#")[0].split("?")[0]+"?"+self.query),n.src=uri,n.type=self.scriptType||"text/javascript",n.charset=self.charset||"UTF-8",n.async=!!self.asy,self.attrs&&xui.each(self.attrs,(function(o,i){n.setAttribute(i,o)})),n.onload=n.onreadystatechange=function(){if(!ok){var t=this.readyState;t&&"loaded"!=t&&"complete"!=t||_cb(),"interactive"==t&&xui.browser.opr&&xui.Thread.repeat((function(){return!ok&&(/loaded|complete/.test(document.readyState)?(_cb(),!1):void 0)}),50)}},"onerror"in n&&(n.onerror=function(e){self._clear(),self._onError(new Error("Not Found - "+uri)),self=null}),(self.keepDomNode?w.getElementsByTagName("head")[0]:w.body).appendChild(n),n=null,self.timeout>0&&(self._flag=xui.asyRun((function(){self&&!self._end&&self._time()}),self.timeout))}else self._onEnd()},_clear:function(){var n=this.node,c=this.constructor,id=this.id,_pool=c._pool;if(_pool[id]&&(_pool[id].length=0,delete _pool[id]),delete c.No["_"+id],n){if(this.node=n.onload=n.onreadystatechange=n.onerror=null,!this.keepDomNode){var div=document.createElement("div");div.appendChild(n.parentNode&&n.parentNode.removeChild(n)||n),xui.browser.ie?xui.asyRun((function(){div.innerHTML=n.outerHTML="",xui.isEmpty(_pool)&&(c._id=1),_pool=c=n=div=null})):xui.asyRun((function(){div.innerHTML="",n=div=null,xui.isEmpty(_pool)&&(c._id=1)}))}}else xui.isEmpty(_pool)&&(c._id=1)},_loaded:function(){var self=this;xui.asyRun((function(){self.id&&self.constructor._pool[self.id]&&self._onError(new Error("JSONP return script doesn't match"))}),500)}},Static:{$asFunction:1,_pool:{},No:{},$response:function(obj,id){var o;if(obj&&(o=this._pool[id]))for(var i=0,l=o.length;i<l;i++)o[i]._response=obj,o[i]._onResponse();else this._onError(new Error("JSONP return value formatting error--"+obj))},customQS:function(obj,ex){var b=this.constructor.callback,nr="script"!=this.rspType;return"string"==typeof obj?(obj=(obj||"")+(nr?"&"+b+"=xui.JSONP.No._"+this.id:""),ex&&(obj=(obj||"")+(nr?"&"+xui.urlEncode(ex):""))):nr&&(obj[b]="xui.JSONP.No._"+this.id,ex&&xui.merge(obj,ex,"all")),obj}}}),xui.Class("xui.XDMI","xui.absIO",{Instance:{_useForm:!0,start:function(){var i,id,t,k,b,form,onload,self=this,w=window,c=self.constructor;if(!1!==xui.tryF(self.beforeStart,[],self)){self._retryNo||self._onStart(),id=self.id,c._pool[id]?c._pool[id].push(self):c._pool[id]=[self];var a=c._if(document,id,onload);self.node=a[0],self.frm=a[1],(form=self.form=document.createElement("form")).style.display="none",w.postMessage?(self._msgcb=function(e){if(self.node&&e.source===self.frm)if(e=e.data,"json"==self.rspType&&(e=xui.unserialize(e)||e),e&&(t=c._pool[self.id]))for(var i=0,l=t.length;i<l;i++)t[i]._response=e,t[i]._onResponse();else self._clear(),self._onError(new Error("XDMI return value formatting error"))},w.addEventListener?w.addEventListener("message",self._msgcb,!1):w.attachEvent("onmessage",self._msgcb)):self._onload=onload=function(id){if(!self.OK&&self.node){var o,t,w=self.node.contentWindow,c=xui.XDMI;if(xui.browser.opr)try{if("about:blank"==w.location)return}catch(e){}self.OK=1;var flag=0;try{w.name===undefined&&(flag=1)}catch(e){flag=1}flag&&w.location.replace(c._getDummy()+"#"+xui.ini.dummy_tag);var getData=function(){var data,flag=0;try{w.name===undefined&&(flag=1)}catch(e){flag=1}if(flag)return xui.asyRun(getData);if("xui_xdmi:"+self.id==w.name)return self._clear(),void self._onError(new Error("XDMI no return value"));if((data=w.name)&&(o=xui.unserialize(data))&&(t=c._pool[self.id]))for(var i=0,l=t.length;i<l;i++)t[i]._response=o,t[i]._onResponse();else self._clear(),self._onError(new Error("XDMI return value formatting error, or no matched 'id'-- "+data))};getData()}},self.query&&("GET"==self.method?xui.isHash(self.data)&&!xui.isEmpty(self.data)&&(xui.merge(self.query,self.data,"without"),self.data=self.query):xui.isHash(self.query)&&!xui.isEmpty(self.query)&&(self.data=self.data||{},xui.merge(self.data,self.query,"without")),self.query=null),form.action=self.uri,form.method=self.method,form.target="xui_xdmi:"+id,k=self.data||{};var file,files=[];for(i in k)k[i]&&k[i]["xui.UIProfile"]&&k[i].$xuiFileCtrl?(file=k[i].boxing().getUploadObj())&&(files.push({id:k[i].$xid,file:file}),file.id=file.name=i,form.appendChild(file),b=!0):k[i]&&1==k[i].nodeType?(k[i].id=k[i].name=i,form.appendChild(k[i]),b=!0):xui.isDefined(k[i])&&((t=document.createElement("textarea")).id=t.name=i,t.value="string"==typeof k[i]?k[i]:xui.serialize(k[i],(function(o){return o!==undefined})),form.appendChild(t));b&&(self.method="POST",form.enctype="multipart/form-data",form.encoding&&(form.encoding=form.enctype)),document.body.appendChild(form),form.submit(),files.length&&xui.arr.each(files,(function(o,i){(i=xui.getObject(o.id))&&i["xui.UIProfile"]&&i.boxing()&&i.boxing().setUploadObj&&i.boxing().setUploadObj(o.file)})),t=form=null,self.timeout>0&&(self._flag=xui.asyRun((function(){self&&!self._end&&self._time()}),self.timeout))}else self._onEnd()},_clear:function(){var n=this.node,f=this.form,c=this.constructor,w=window,div=document.createElement("div"),id=this.id,_pool=c._pool;if(_pool[id]&&(_pool[id].length=0,delete _pool[id]),n&&w.postMessage)w.removeEventListener?w.removeEventListener("message",this._msgcb,!1):w.detachEvent("onmessage",this._msgcb),this._msgcb=null;else if(xui.browser.gek&&n)try{n.onload=null;var d=n.contentWindow.document;d.write(" "),d.close()}catch(e){}this.form=this.node=this.frm=null,n&&div.appendChild(n.parentNode.removeChild(n)),f&&div.appendChild(f.parentNode.removeChild(f)),div.innerHTML="",xui.isEmpty(_pool)&&(c._id=1),f=div=null}},Static:{$asFunction:1,method:"POST",_pool:{},_o:function(id){var p=this._pool[id],o=p[p.length-1];xui.tryF(o._onload)},_getDummy:function(win){var arr,o,ns=this,d=(win=win||window).document,ini=xui.ini,b=xui.browser,f=ns.isCrossDomain;if(ns.dummy)return ns.dummy;if(ini.dummy)return ns.dummy=ini.dummy;if(f(ini.path)||d.getElementById("xui:img:bg")||((o=d.createElement("img")).id="xui:img:bg",o.src=ini.img_bg,o.style.display="none",d.body.appendChild(o),o=null),o=d.getElementById("xui:img:bg"))return ns.dummy=o.src.split("#")[0];for(var i=0,j=(arr=d.getElementsByTagName("img")).length;i<j;i++)if((o=arr[i]).src&&!f(o.src))return ns.dummy=o.src.split("#")[0];if(b.gek)for(i=0,j=(arr=d.getElementsByTagName("link")).length;i<j;i++)if("stylesheet"==(o=arr[i]).rel&&!f(o.href))return ns.dummy=o.href.split("#")[0];try{if(win!=win.parent&&(win=win.parent)&&!f(""+win.document.location.href))return ns._getDummy(win)}catch(e){}return"/favicon.ico"},customQS:function(obj,ex){var t=this.constructor.callback,w=window;return"string"==typeof obj&&(obj=xui.urlDecode(obj)),w.postMessage?obj[t]=obj.parentDomain=w.location.origin||w.location.protocol+"//"+w.location.hostname+(w.location.port?":"+w.location.port:""):obj[t]="window.name",ex&&xui.merge(obj,ex,"all"),obj}}}),new function(){xui.SAjax=xui.JSONP,xui.IAjax=xui.XDMI,"fetch"in window||(xui.Fetch=xui.Ajax)},xui.Class("xui.SC",null,{Constructor:function(path,callback,isAsy,threadid,options,force){var upper=arguments.callee.upper;upper&&upper.call(this),upper=null;var r,p=xui.$cache.SC;return(r=p[path]||(p[path]=xui.get(xui.window,path.split("."))))?xui.tryF(callback,[path,null,threadid],r):((options=options||{}).$cb=callback,isAsy&&(options.threadid=threadid),r=p[path]=xui.SC._call(path||"",options,isAsy,force)),r},Static:{$asFunction:1,__gc:function(k){xui.$cache.SC={}},beforeGetScript:function(path,onSucess,onFail){},get:function(path,obj1,obj2,v){if("string"==typeof path)return path=xui._s2a(path),obj1&&(v=xui.get(obj1,path)),obj2&&v===undefined&&(v=xui.get(obj2,path)),v===undefined&&(v=xui.get(xui.window,path)),v},_call:function(s,options,isAsy,force){isAsy=!!isAsy;var t,r,o,ajax,ep=xui.SC.get,ct=xui.$cache.snipScript,f=function(text,rspType,threadid){var t,uri=this.uri;if(text&&!ep(s))if(this.$p)(this.$cache||ct)[this.$tag]=text;else try{xui.exec(text,s)}catch(e){xui.asyRun((function(){throw e}))}t=xui.Class._last,xui.Class._ignoreNSCache=xui.Class._last=null,xui.tryF(this.$cb,[this.$tag,text,threadid],ep(s)||t||{}),!ep(s)&&t&&t.KEY!=s&&xui.log("[xui] > '"+s+"' doesn't in '"+uri+"'. The last class '"+t.KEY+"' was triggered.")},fe=function(text,rspType,threadid){xui.tryF(this.$cb,[null,null,this.threadid],this)};return force||!(r=ep(s))?(!force&&(t=ct[s])&&(isAsy=!1,f.call({$cb:options.$cb},t),delete ct[s]),(force||!(r=ep(s)))&&(options=options||{},o=xui.getPath(s,".js","js",options),options.$tag=s,xui.Class._ignoreNSCache=1,xui.Class._last=null,isAsy&&!options.$p?(options.rspType="script",ajax=xui.JSONP):(options.asy=isAsy,ajax=xui.Ajax),!1!==xui.SC.beforeGetScript(o,f,fe)&&ajax(o,xui._rnd(options.force),f,fe,null,options).start(),isAsy||(r=ep(s)))):options.$cb&&f.call(options),r},loadSnips:function(pathArr,cache,callback,onEnd,threadid,options,isAsy){if(pathArr&&pathArr.length){var s,bak={};options=xui.merge(options||{},{$p:1,$cache:cache||xui.$cache.snipScript});for(var i=0,l=pathArr.length;i<l;i++)bak[pathArr[i]]=1;for((callback||onEnd)&&(options.$cb=function(path){callback&&xui.tryF(callback,arguments,this),delete bak[path||this.$tag],xui.isEmpty(bak)&&(xui.tryF(onEnd,[threadid]),onEnd=null,xui.Thread.resume(threadid))}),xui.Thread.suspend(threadid),i=0;s=pathArr[i++];)this._call(s,xui.merge({$tag:s},options,isAsy),!0)}else xui.tryF(onEnd,[threadid])},runInBG:function(pathArr,callback,onStart,onEnd){var j,t,i=0,self=this;xui.Thread(null,[function(threadid){for(;pathArr.length>i&&(t=self.get(j=pathArr[i++])););t||self._call(j,{threadid:threadid},!0),pathArr.length<i&&xui.Thread.abort(threadid),pathArr.length==i&&i++}],1e3,callback,onStart,onEnd,!0).start()},execSnips:function(cache){var i,h=cache||xui.$cache.snipScript;for(i in h)try{xui.exec(h[i],i)}catch(e){xui.asyRun((function(){throw e}))}h={}},groupCall:function(pathArr,onEnd,callback,threadid,options,isAsy){if(pathArr){var self=this;self.execSnips(),xui.Thread.suspend(threadid),self.loadSnips(pathArr,0,callback,(function(){self.execSnips(),xui.tryF(onEnd,[threadid]),onEnd=null,xui.Thread.resume(threadid)}),null,options,isAsy)}else xui.tryF(onEnd,[threadid])}}}),xui.Class("xui.absBox",null,{Constructor:function(){var upper=arguments.callee.upper;upper&&upper.call(this),upper=null,this._nodes=[],this.Class=this.constructor},Before:function(key){var t=xui.absBox;t&&((t=t.$type)[key.replace("xui.","")]=t[key]=key)},Instance:{__gc:function(){this.each((function(profile){xui.tryF(profile.__gc)})),this._nodes=0},_get:function(index){var t=this._nodes;return xui.isNumb(index)?t[index]:t},_empty:function(){return this._nodes.length=0,this},getProfile:function(all){return all?this._nodes:this._nodes[0]},get:function(index){return this._get(index)},size:function(){return this._nodes.length},_each:function(fun,scope,desc){var i,n,j=this._nodes,l=j.length;if(desc)for(i=l;i>=0&&(!(n=j[i])||!1!==fun.call(scope||this,n,i));i--);else for(i=0;i<l&&(!(n=j[i])||!1!==fun.call(scope||this,n,i));i++);return n=null,this},each:function(fun,scope,desc){return this._each(fun,scope,desc)},isEmpty:function(){return!this._nodes.length},merge:function(obj){if(this==xui.win||this==xui.doc||this==xui("body")||this==xui("html"))return this;var t,c=this.constructor,i=0,n=this._nodes;if((obj=obj._nodes).length){for(;t=obj[i++];)n[n.length]=t;this._nodes=c._unique(n)}return this},reBoxing:function(key,ensureValue){var t=xui.absBox.$type[key||"Dom"];return t?t==this.KEY?this:(t=xui.SC(t))?t.pack(this._nodes,ensureValue):void 0:xui.UI.pack([])}},Static:{$abstract:!0,$type:{},pack:function(arr,ensureValue){var o=new this(!1);return o._nodes=arr?!1===ensureValue?xui.isArr(arr)?arr:[arr]:"function"==typeof this._ensureValues?this._ensureValues(arr):xui.isArr(arr)?arr:[arr]:[],o.n0=o._nodes[0],o},_unique:function(arr){for(var t,k,h={},a=[],i=0,l=arr.length;i<l;i++)a[i]=arr[i];for(arr.length=0,i=0;t=a[i++];)h[k="string"==typeof t?t:t.$xid]||(h[k]=1,arr.push(t));return arr},plugIn:function(name,fun){return this.prototype[name]=fun,this}}}),xui.Class("xui.absProfile",null,{Constructor:function(){var upper=arguments.callee.upper;upper&&upper.call(this),upper=null,this.$xid||(this.$xid=xui.absProfile.$xid.next())},Instance:{getId:function(){return this.$xid},getUid:function(ext){return this.key+":"+this.$xid+(ext?":"+ext:"")},link:function(obj,id,target,index){return xui.absProfile.prototype.$link(this,obj,id,target,index)},$link:function(self,obj,id,target,index){var uid="$"+self.$xid;return target=target||self,obj[uid]&&self.unLink(id),obj[uid]=target,xui.isArr(obj)&&xui.arr.insertAny(obj,target,index,!0),self._links[id]=obj,self},unLink:function(id){return xui.absProfile.prototype.$unLink(this,id)},$unLink:function(self,id){var o,index,uid="$"+self.$xid;if(self._links&&(o=self._links[id]))return xui.isArr(o)&&-1!=(index=xui.arr.indexOf(o,o[uid]))&&xui.arr.removeFrom(o,index),delete o[uid],delete self._links[id],index},unLinkAll:function(){return xui.absProfile.prototype.$unLinkAll(this)},$unLinkAll:function(self){var o,i,id="$"+self.$xid,l=self._links;for(i in l)o=l[i],xui.isArr(o)&&xui.arr.removeValue(o,o[id]),delete o[id];return self._links={},self},getModule:function(top){var t,getUpperModule=function(module){if(module.moduleClass&&module.moduleXid){var pm=xui.SC.get(module.moduleClass);if(pm&&(pm=pm.getInstance(module.moduleXid)))return getUpperModule(pm)}return module};if(this.moduleClass&&this.moduleXid&&(t=xui.SC.get(this.moduleClass))&&(t=t.getInstance(this.moduleXid)))return top?getUpperModule(t):t},getParent:function(){return this.parent&&this.parent.boxing()},getChildrenId:function(){return this.childrenId}},Static:{$xid:new xui.id,$abstract:!0}}),xui.Class("xui.Profile","xui.absProfile",{Constructor:function(host,key,alias,box,properties,events,options){var upper=arguments.callee.upper,args=xui.toArr(arguments);upper.apply(this,args),upper=null;var self=this;xui.merge(self,options),self.key=key||self.key||"",self.alias=alias||self.alias||"",self.properties=properties?xui.copy(properties):self.properties||{},self.events=events?xui.copy(events):self.events||{},self.host=host||self.host||self,self.Class=self.constructor,self.box=box||self.box,self._dftProps={},self.events&&(self.setEvents(self.events),delete self.events),self._links={}},Instance:{setEvents:function(key,value){var evs=this.box.$EventHandlers;if(xui.isHash(key))return xui.merge(this,key,"all",(function(o,i){return evs[i]}));evs[key]&&(this[key]=value)},getEvents:function(key){if(key)return this[key];var self=this,hash={};return xui.each(self.box.$EventHandlers,(function(o,i){self[i]&&(hash[i]=self[i])})),hash},getProperties:function(key){var prop=this.properties;return xui.isFun(this._propGetter)&&(prop=this._propGetter(prop)),xui.isFun(this.propGetter)&&(prop=this.propGetter(prop)),key?prop[key]:xui.copy(prop)},setProperties:function(key,value){xui.isHash(key)?(xui.merge(key,this.box.$DataStruct,(function(o,i){i in key||(key[i]=xui.isObj(o)?xui.clone(o):o)})),this.properties=key,xui.isFun(this._propSetAction)&&this._propSetAction(key),xui.isFun(this.propSetAction)&&this.propSetAction(key)):this.properties[key]=value},_applySetAction:function(fun,value,ovalue,force,tag,tag2){return fun.call(this,value,ovalue,force,tag,tag2)},__gc:function(){var o,ns=this,args=xui.toArr(arguments);ns.$beforeDestroy&&(xui.each(ns.$beforeDestroy,(function(f){xui.tryF(f,args,ns)})),delete ns.$beforeDestroy),xui.tryF(ns.$ondestory,args,ns),ns.onDestroy&&ns.boxing().onDestroy(),ns.destroyTrigger&&ns.destroyTrigger(),ns.alias&&ns.host&&(o=ns.host[ns.alias])&&(o=o._nodes)&&(0===o.length||1===o.length&&o[0]==ns)&&delete ns.host[ns.alias],ns.unLinkAll(),xui.tryF(ns.clearCache,[],ns),ns.destroyed=!0,ns.$afterDestroy&&(xui.each(ns.$afterDestroy,(function(f){xui.tryF(f,args,ns)})),delete ns.$afterDestroy),ns.afterDestroy&&ns.boxing().afterDestroy(ns),xui.breakO([ns.properties,ns.events,ns],2),ns._dftProps=null,ns.destroyed=!0},boxing:function(){var t;return this.box?((t=this.Instace)&&t.get(0)==this&&1==t._nodes.length||(t=this.Instace=this.box.pack([this],!1)),t):null},serialize:function(rtnString,keepHost){var t,o=(t=this.box._beforeSerialized)?t(this):this,r={alias:o.alias,key:o.key,host:o.host};r.host===this?delete r.host:o.host&&!keepHost&&(!1!==rtnString?r.host="@this":delete r.host);var c={},p=o.box.$DataStruct,df2=o.box[o.$inDesign?"__resetDftProp_in_Desinger":"__resetDftProp"],map=xui.absObj.$specialChars;xui.merge(c,o.properties,(function(o,i){return(df2&&i in df2?df2:p)[i]!==o&&!map[i.charAt(0)]})),xui.isEmpty(c)||(r.properties=c),xui.isEmpty(t=this.getEvents())||(r.events=t);var eh=o.box.$EventHandlers;return xui.filter(r.events,(function(o,i){return o!=eh[i]})),xui.isEmpty(r.events)&&delete r.events,!1===rtnString?r:xui.serialize(r)}}}),xui.Class("xui.absObj","xui.absBox",{Constructor:function(){var upper=arguments.callee.upper,args=xui.toArr(arguments);if(upper.apply(this,args),upper=null,!1!==args[0]&&"function"==typeof this._ini)return this._ini.apply(this,args)},Before:function(key,parent_key,o){return xui.absBox.$type[key]=key,!0},After:function(){var temp,t,k,u,m,i,j,l,v,self=this,me=arguments.callee;for(self._nameId=0,self._nameTag=self.$nameTag||self.KEY.replace(/\./g,"_").toLowerCase(),self._cache=[],m=me.a1||(me.a1=xui.toArr("$Keys,$DataStruct,$EventHandlers,$DataModel")),j=0;v=m[j++];){if(k={},(t=self.$parent)&&(i=t.length))for(;i--;)xui.merge(k,t[i][v]);self[v]=k}for(self.setDataModel(self.DataModel),delete self.DataModel,self.setEventHandlers(self.EventHandlers),delete self.EventHandlers,m=me.a5||(me.a5=xui.toArr("RenderTrigger,LayoutTrigger")),j=0;v=m[j++];){if(temp=[],(t=self.$parent)&&(l=t.length))for(i=0;i<l;i++)(u=(u=t[i])["$"+v])&&temp.push.apply(temp,u);self[v]&&temp.push(self[v]),xui.arr.stableSort(temp,(function(x,y){return(x=x.$order||0)>(y=y.$order||0)?1:x==y?0:-1})),self["$"+v]=temp,delete self[v]}},Static:{$abstract:!0,$specialChars:{_:1,$:1},DataModel:{name:"",desc:"",tag:"",tagVar:{ini:{},action:function(){var r=this.properties.renderer;r&&/^\s*[a-zA-Z]+([\w]+\.?)+[\w]+\s*$/.test(r)&&this.boxing().refresh()}},propBinder:{hidden:1,ini:{}},dataBinder:{ini:"",set:function(value){var p=this.properties,ovalue=p.dataBinder;ovalue&&xui.DataBinder._unBind(ovalue,this),p.dataBinder=value,xui.DataBinder._bind(value,this)}},dataField:{ini:""}},get:function(index){return this.pack([this._cache[index||0]])},getAll:function(){return this.pack(this._cache)},pickAlias:function(){return xui.absObj.$pickAlias(this)},$pickAlias:function(cls){for(var t,a=cls._nameTag,p=cls._cache;t=a+ ++cls._nameId;){for(var i=0,l=p.length;i<l;i++)if(p[i].alias===t){t=-1;break}if(-1!=t)return t}},setDataModel:function(hash){var i,j,t,o,n,m,r,self=this,sc=xui.absObj.$specialChars,ds=self.$DataStruct,dm=self.$DataModel,ps=self.prototype;for(i in hash)if(dm[i]||(dm[i]={}),null===(o=hash[i])||undefined===o)r=xui.str.initial(i),delete ds[i],delete dm[i],ps[j="get"+r]&&ps[j].$auto$&&delete ps[j],ps[j="set"+r]&&ps[j].$auto$&&delete ps[j];else{for(j in"object"==(t=typeof o)&&o.constructor==Object||(o={ini:o}),ds[i]="ini"in o?o.ini:i in ds?ds[i]:"",t=dm[i])j in o||(o[j]=t[j]);dm[i]=o}return xui.each(hash,(function(o,i){if(null!==o&&undefined!==o&&!sc[i.charAt(0)]){if(r=xui.str.initial(i),n="set"+r,null===o.set||o&&(o.readonly||o.inner))delete ps[n];else{var $set=o.set;m=ps[n],ps[n]="function"!=typeof $set&&"function"==typeof m?m:xui.Class._fun((function(value,force,tag,tag2){return this.each((function(v){var t;if(v.properties&&(delete v._dftProps[i],force||dm[i]&&dm[i].$spaceunit&&v.$forceu&&"auto"!=value&&(t=xui.$us(v),value=v.$forceu(value,2==t?"em":-2==t?"px":null)),(v.properties[i]!==value||force)&&(!v.$beforePropSet||!1!==v.$beforePropSet(i,value,force,tag,tag2)))){var ovalue=v.properties[i];if(!v.beforePropertyChanged||!1!==v.boxing().beforePropertyChanged(v,i,value,ovalue)){if("function"==typeof $set)$set.call(v,value,force,tag,tag2);else{var m=xui.get(v.box.$DataModel,[i,"action"]);v.properties[i]=value,"function"==typeof m&&!1===v._applySetAction(m,value,ovalue,force,tag,tag2)&&(v.properties[i]=ovalue)}v.afterPropertyChanged&&v.boxing().afterPropertyChanged(v,i,value,ovalue),v.$afterPropertyChanged&&xui.tryF(v.$afterPropertyChanged,[v,i,value,ovalue],v)}}}))}),n,self.KEY,null,"instance"),ps[n]!==m&&(ps[n].$auto$=1)}if(n="get"+r,o&&o.inner)delete ps[n];else{var $get=o.get;m=ps[n],ps[n]="function"!=typeof $get&&"function"==typeof m?m:xui.Class._fun((function(){var t=this.get(0),args=xui.toArr(arguments),_get=function(){return"function"==typeof $get?$get.apply(t,args):t.properties[i]};return"function"==typeof t.$beforePropGet?t.$beforePropGet(i,_get):_get()}),n,self.KEY,null,"instance"),ps[n]!==m&&(ps[n].$auto$=1)}}})),self},setEventHandlers:function(hash){var self=this;return xui.each(hash,(function(o,i){if(null===o)delete self.$EventHandlers[i],delete self.prototype[i];else{self.$EventHandlers[i]=o;var f=function(fun){var j,l=arguments.length;if(1==l&&("function"==typeof fun||"string"==typeof fun||xui.isHash(fun)||xui.isArr(fun)))return this.each((function(v){v.renderId&&v.clearCache(),v.box._addEventHanlder&&v.box._addEventHanlder(v,i,fun),v[i]=fun}));if(1==l&&null===fun)return this.each((function(v){v.clearCache(),v.box._removeEventHanlder&&v.box._removeEventHanlder(v,i,v[i]),delete v[i]}));var args=[],prf=this.get(0);if(prf){var events=prf[i],host=prf.host||prf;if(events&&(!xui.isArr(events)||events.length)){if(prf.$inDesign&&!xui.get(prf,["host","_PASSEVTS",prf.alias,i]))return;for(prf.$lastEvent=i,arguments[0]!=prf&&(args[0]=prf),j=0;j<l;j++)args[args.length]=arguments[j];return(xui.isStr(events)||xui.isFun(events))&&(events=[events]),xui.isArr(events.actions||events)&&xui.isNumb(j=(events.actions||events)[0].event)&&(args[j]=args[j]?xui.Event.getEventPara(args[j]):{}),xui.pseudocode._callFunctions(events,args,host,null,prf.$holder,(host&&host.alias||prf.$holder&&prf.$holder.alias)+"."+prf.alias+"."+i)}}};f.$event$=1,f.$original$=o.$original$||self.KEY,f.$name$=i,f.$type$="event",self.plugIn(i,f)}})),self},unserialize:function(target,keepSerialId){"string"==typeof target&&(target=xui.unserialize(target));var f=function(o){xui.isArr(o)&&(o=o[0]),delete o.serialId,o.children&&xui.arr.each(o.children,f)},a=[];return xui.arr.each(target,(function(o){keepSerialId||f(o),a.push(new(xui.SC(o.key))(o).get(0))})),this.pack(a,!1)}},Instance:{clone:function(){var arr=[],clrItems=arguments,f=function(p){delete p.alias;for(var i=0;i<clrItems.length;i++)delete p[clrItems[i]];var c;if(p.children)for(i=0;c=p.children[i];i++)f(c[0])};return this.each((function(o){o=o.serialize(!1,!0),f(o),arr.push(o)})),this.constructor.unserialize(arr)},serialize:function(rtnString,keepHost){var a=[];return this.each((function(o){a[a.length]=o.serialize(!1,keepHost)})),!1===rtnString?a:1==a.length?" new "+a[0].key+"("+xui.serialize(a[0])+")":"xui.UI.unserialize("+xui.serialize(a)+")"},getProperties:function(key){var funName,h={},prop=this.get(0).properties;if(!0===key)return xui.copy(prop);if("string"==typeof key)return prop[key];for(var k in prop)"function"==typeof this[funName="get"+xui.str.initial(k)]&&(h[k]=this[funName].call(this));return h},setProperties:function(key,value,force){if("string"==typeof key){var h={};h[key]=value,key=h}return this.each((function(o){xui.each(key,(function(v,k){var funName="set"+xui.str.initial(k),ins=o.boxing();ins&&"function"==typeof ins[funName]?ins[funName].call(ins,v,!!force):o.properties[k]=v}))}))},getEvents:function(key){return this.get(0).getEvents(key)},setEvents:function(key,value){if("string"==typeof key){var h={};h[key]=value,key=h}return this.each((function(o){var ins=o.boxing();xui.each(key,(function(v,k){"function"==typeof ins[k]&&ins[k].call(ins,v)}))}))},alias:function(value){return value?this.setAlias(value):this.getAlias()},host:function(value,alias){return value?this.setHost(value,alias):this.getHost()},setHost:function(host,alias){return this._setHostAlias(host,alias)},_setHostAlias:function(host,alias){var prf=this.get(0),oldAlias=prf.alias;if(alias=alias||prf.alias,oldAlias&&prf.host&&prf.host!==prf){try{delete prf.host[oldAlias]}catch(e){prf.host[oldAlias]=undefined}prf.host._ctrlpool&&delete prf.host._ctrlpool[oldAlias]}return prf.alias=alias,prf.box&&prf.box._syncAlias&&prf.box._syncAlias(prf,oldAlias,alias),host&&(prf.host=host),prf.host&&prf.host!==prf&&(prf.host[alias]=this,prf.host._ctrlpool&&(prf.host._ctrlpool[alias]=this.get(0))),this},setAlias:function(alias){return this._setHostAlias(null,alias)},getAlias:function(){return this.get(0).alias},getHost:function(){return this.get(0).host},reBindProp:function(dataMap,scope_set,scope_clear,_scope_handled){var prop,ins,fn,r;_scope_handled||(scope_set=scope_set||xui._scope_set,scope_clear=scope_clear||xui._scope_clear);try{_scope_handled||scope_set.call(this,dataMap),this.each((function(prf){(prop=prf.properties).propBinder&&!xui.isEmpty(prop.propBinder)&&(ins=prf.boxing(),xui.each(prop.propBinder,(function(get_prop_value,key){if(xui.isDefined(r=xui.isFun(get_prop_value)?get_prop_value(prf):xui.adjustVar(get_prop_value))&&!1!==xui.tryF(ins._reBindProp,[prf,r,key,get_prop_value],ins))switch(key){case"CA":ins.setCustomAttr(r);break;case"CC":ins.setCustomClass(r);break;case"CS":ins.setCustomStyle(r);break;default:xui.isFun(ins[fn="set"+xui.str.initial(key)])&&ins[fn](r,!0)}})))}))}catch(e){_scope_handled||scope_clear.call(this)}return this}}}),xui.Class("xui.Timer","xui.absObj",{Instance:{_ini:function(properties,events,host){var profile,options,alias,temp,c=this.constructor;for(var i in properties&&properties["xui.Profile"]?alias=(profile=properties).alias||c.pickAlias():(properties&&properties.key&&xui.absBox.$type[properties.key]?(options=properties,properties=null,alias=options.alias||c.pickAlias()):alias=c.pickAlias(),profile=new xui.Profile(host,this.$key,alias,c,properties,events,options)),profile._n=profile._n||[],temp=c.$DataStruct)i in profile.properties||(profile.properties[i]=profile._dftProps[i]="object"==typeof temp[i]?xui.copy(temp[i]):temp[i]);return profile.link(c._cache,"self").link(xui._pool,"xui"),this._nodes.push(profile),profile.Instace=this,this.n0=profile,this._after_ini&&this._after_ini(profile,alias),this},_after_ini:function(profile){profile.$inDesign||xui.asyRun((function(){profile&&profile.box&&profile.properties.autoStart&&profile.boxing().start()}))},destroy:function(){this.each((function(profile){profile._threadid&&xui.Thread.abort(profile._threadid),profile.__gc()}))},start:function(){return this.each((function(profile){if(!profile.$inDesign)if(profile._threadid)xui.Thread.resume(profile._threadid);else{var p=profile.properties,box=profile.boxing(),t=xui.Thread.repeat((function(threadId){return(!profile.$onTime||!1!==profile.$onTime(profile,threadId))&&(!profile.onTime||!1!==box.onTime(profile,threadId))&&void 0}),p.interval,(function(threadId){profile.onStart&&box.onStart(profile,threadId)}),(function(threadId){profile.onEnd&&box.onEnd(profile,threadId)}));profile._threadid=t.id}}))},suspend:function(){return this.each((function(profile){profile._threadid&&xui.Thread.suspend(profile._threadid),profile.onSuspend&&profile.boxing().onSuspend(profile,profile._threadid)}))},getParent:function(){return this.parent&&this.parent.boxing()},getChildrenId:function(){return this.childrenId}},Static:{_objectProp:{tagVar:1,propBinder:1},_beforeSerialized:function(profile){var o={};xui.merge(o,profile,"all");var p=o.properties=xui.clone(profile.properties,!0);if(profile.box._objectProp)for(var i in profile.box._objectProp)i in p&&p[i]&&(xui.isHash(p[i])||xui.isArr(p[i]))&&xui.isEmpty(p[i])&&delete p[i];return o},DataModel:{autoStart:!0,interval:1e3},EventHandlers:{onTime:function(profile,threadId){},onStart:function(profile,threadId){},onSuspend:function(profile,threadId){},onEnd:function(profile,threadId){}}}}),xui.Class("xui.MessageService","xui.absObj",{Instance:{_ini:xui.Timer.prototype._ini,_after_ini:function(profile){if(!profile.$inDesign){var t,p=profile.properties;(t=p.recipientType||p.msgType)&&profile.boxing().setRecipientType(t,!0)}},destroy:function(){this.each((function(profile){if(!profile.$inDesign){var t,id=profile.$xid;(t=profile.properties.msgType)&&xui.arr.each(t.split(/[\s,;:]+/),(function(t){xui.unsubscribe(t,id)})),profile.__gc()}}))},broadcast:function(recipientType,msg1,msg2,msg3,msg4,msg5,msg6,msg7,msg8,msg9,readReceipt){return this.each((function(profile){var ins=profile.boxing();xui.arr.each(recipientType.split(/[\s,;:]+/),(function(t){xui.publish(t,[msg1,msg2,msg3,msg4,msg5,msg6,msg7,msg8,msg9,function(){xui.tryF(readReceipt),profile.onReceipt&&profile.boxing().onReceipt.apply(ins,[profile,t,xui.toArr(arguments)])}],null,ins)}))}))},getParent:xui.Timer.prototype.getParent,getChildrenId:xui.Timer.prototype.getChildrenId},Static:{_objectProp:xui.Timer._objectProp,_beforeSerialized:xui.Timer._beforeSerialized,DataModel:{dataBinder:null,dataField:null,recipientType:{ini:"",set:function(value){var t,profile=this,p=profile.properties,id=profile.$xid;(t=p.recipientType)&&xui.arr.each(t.split(/[\s,;:]+/),(function(t){xui.unsubscribe(t,id)})),(t=p.recipientType=value||"")&&xui.arr.each(t.split(/[\s,;:]+/),(function(t){xui.subscribe(t,id,(function(){var a=xui.toArr(arguments),ins=profile.boxing();a.unshift(profile),profile.onMessageReceived&&ins.onMessageReceived.apply(ins,a)}),p.asynReceive)}))}},asynReceive:!1},EventHandlers:{onMessageReceived:function(profile,msg1,msg2,msg3,msg4,msg5,msg6,msg7,msg8,msg9,readReceipt){},onReceipt:function(profile,recipientType,args){}}}}),xui.Class("xui.ExcelFormula",null,{Static:{MAXCOUNT:256,Supported:function(){var flatten=function(args){for(var t,arr=[],i=0,l=(args=xui.toArr(args)).length;i<l;i++)xui.isArr(t=args[i])?arr=arr.concat(t):arr.push(t);return arr};return{SUM:function(){for(var v,parsed,result=0,arr=flatten(arguments),i=0,l=arr.length;i<l;++i)"number"==typeof(v=arr[i])?result+=v:"string"==typeof v&&(parsed=parseFloat(v),xui.isNaN(parsed)||(result+=parsed));return result},AVERAGE:function(){for(var v,parsed,result=0,arr=flatten(arguments),i=0,l=arr.length;i<l;++i)"number"==typeof(v=arr[i])?result+=v:"string"==typeof v&&(parsed=parseFloat(v),xui.isNaN(parsed)||(result+=parsed));return result/l},COUNT:function(){for(var v,result=0,arr=flatten(arguments),i=0,l=arr.length;i<l;++i)"string"!=(v=typeof arr[i])&&"number"!==v||result++;return result},MIN:function(){return Math.min.apply(Math,flatten(arguments))},MAX:function(){return Math.max.apply(Math,flatten(arguments))},ROUND:function(){return Math.round.apply(Math,arguments)},FIXED:function(){return xui.toFixedNumber.apply(xui,arguments)},CHOOSE:function(){var a=arguments;return xui.isNumb(a[0])&&a[a[0]]||""},CONCATENATE:function(){return flatten(arguments).join("")},ABS:function(a){return Math.abs(a)},ISNUMBER:function(v){return xui.isFinite(v)},NOW:function(){return new Date},TODAY:function(){return xui.Date.getTimSpanStart(new Date,"DAY")},IF:function(a,b,c){return eval(a)?b:c},AND:function(){return!!eval(xui.toArr(arguments).join("&&"))},OR:function(){return!!eval(xui.toArr(arguments).join("||"))},NOT:function(a){return!a}}}(),toColumnChr:function(num){var s="";for(num-=1;num>=0;)s=String.fromCharCode(num%26+97)+s,num=Math.floor(num/26)-1;return s.toUpperCase()},toColumnNum:function(chr){chr=chr.split("");for(var base="ABCDEFGHIJKLMNOPQRSTUVWXYZ".split(""),i=0,j=chr.length-1,result=0;i<chr.length;i+=1,j-=1)result+=Math.pow(base.length,j)*(base.indexOf(chr[i])+1);return result},toCoordinate:function(cell,offset,rtnArr){var row,col,cellU=cell.toUpperCase();return offset||0===offset||(offset=-1),row=parseInt(cellU.match(/[0-9]+/)[0],10)+offset,col=this.toColumnNum(cellU.match(/[A-Z]+/)[0])+offset,rtnArr?[row,col]:{col:col,row:row}},toCellId:function(col,row,offset){return this.toColumnChr(col+(offset||1))+(row+(offset||1))},getCellRanges:function(cellFrom,cellEnd,colLimited,rowLimited){var ns=this,alpha=/[A-Z]+/,num=/[0-9]+/;alpha.test(cellFrom)||(cellFrom="A"+cellFrom),num.test(cellFrom)||(cellFrom+="1"),alpha.test(cellEnd)||(cellEnd=ns.toColumnChr(colLimited||ns.MAXCOUNT)+cellEnd),num.test(cellEnd)||(cellEnd+=rowLimited||ns.MAXCOUNT);var row,col,cellStart=ns.toCoordinate(cellFrom,0),cellStop=ns.toCoordinate(cellEnd,0),colStart=cellStart.col,colStop=cellStop.col,rowStart=cellStart.row,rowStop=cellStop.row,cellRange=[];if(colStart<colStop)for(col=colStart;col<=colStop;col++)if(rowStart<rowStop)for(row=rowStart;row<=rowStop;row++)cellRange.push(ns.toColumnChr(col)+row);else for(row=rowStart;row>=rowStop;row--)cellRange.push(ns.toColumnChr(col)+row);else for(col=colStart;col>=colStop;col--)if(rowStart<rowStop)for(row=rowStart;row<=rowStop;row++)cellRange.push(ns.toColumnChr(col)+row);else for(row=rowStart;row>=rowStop;row--)cellRange.push(ns.toColumnChr(col)+row);return cellRange},validate:function(formula){var str;if(xui.isFun(formula))str=formula+"";else{if(!/^\s*\=\s*/.test(formula))return!1;str=formula.replace(/^\s*\=\s*/,"")}if(str=str.replace(/(\b)([\?_])([0-9]+\b)/g,"1").replace(/(\b[A-Z]+)([\?_])(\b)/g,"1"),/function\s*\(/.test(str))try{str=xui.fun.body(str),new Function("",str)}catch(e){return xui._debugInfo("throw","#VALUE! ",formula,str,e),!1}else{var fake=function(){return 1},reg=new RegExp(xui.toArr(this.Supported,!0).join("|"),"g");if(str=xui.replace(str,[[/"(\\.|[^"\\])*"/,"1"],[/'(\\.|[^'\\])*'/,"1"],[/\{[^}]+\}/,"1"],[/([A-Z\d]+\s*\:\s*[A-Z\d]+)/,"1"],[/([A-Z]+[\d]+)/,"1"],[/[=<>]+/g,function(a){return"="==a[0]?"==":"<>"==a[0]?"!=":a[0]}]]),/[A-Z_$]/.test(str.replace(reg,"")))return!1;str=str.replace(reg,"fake");try{eval(str)}catch(e){return xui._debugInfo("throw","#VALUE! ",formula,str,e),!1}}return!0},getRefCells:function(formula,colLimited,rowLimited){return this._parse(formula,!1,colLimited,rowLimited)},parse:function(formula){return this._parse(formula,null)},calculate:function(formula,cellsMap,colLimited,rowLimited){return this._parse(formula,cellsMap||!0,colLimited,rowLimited)},_parse:function(formula,cellsMap,colLimited,rowLimited){var ret,ns=this,Supported=ns.Supported,RANGE=function(cellsMap,cellStart,cellStop){for(var arr=ns.getCellRanges(cellStart,cellStop,colLimited,rowLimited),i=0,l=arr.length;i<l;i++)arr[i]=cellsMap[arr[i]];return arr},doParse=function(formula,CELLS){var cellHash,rtn,str=formula,f=function(a){if(a[8])return cellHash&&(a[8]in cellHash||(cellHash[a[8]]=1)),'CELLS["'+a[8]+'"]';if(a[6]&&a[7]){if(cellHash)for(var arr=ns.getCellRanges(a[6],a[7],colLimited,rowLimited),i=0,l=arr.length;i<l;i++)arr[i]in cellHash||(cellHash[arr[i]]=1);return'RANGE(CELLS, "'+a[6]+'","'+a[7]+'")'}return a[10]&&a[11]?'Supported["'+a[10]+'"]'+a[11]:void 0};if(cellHash={},!ns.validate(str))return!1;if(xui.isFun(str)?str+="":str=str.replace(/^\s*\=\s*/,""),/function\s*\(/.test(str)){str=xui.fun.body(str),str=xui.replace(str,[[/\/\*[^*]*\*+([^\/][^*]*\*+)*\//,"$0"],[/\/\/[^\n]*/,"$0"],[/\/(\\[\/\\]|[^*\/])(\\.|[^\/\n\\])*\/[gim]*/,"$0"],[/"(\\.|[^"\\])*"/,"$0"],[/'(\\.|[^'\\])*'/,"$0"],[/\b([A-Z]+[\d]+)\b/,function(a){return cellHash[a[0]]=1,a[0]}]]);try{if(!1===cellsMap)rtn=cellHash;else{!0===cellsMap&&(cellsMap={});var pre="var map=arguments[0]";xui.each(cellHash,(function(o,i){pre+=", \n",pre+=i+" = map['"+i+"']"})),str=pre+";\n"+str,rtn=xui.isHash(cellsMap)?new Function("",str).call(null,CELLS,formula):str}}catch(e){xui._debugInfo("throw","#VALUE! ",formula,str,e)}finally{return rtn}}else{str=xui.replace(str,[[/"(\\.|[^"\\])*"/,"$0"],[/'(\\.|[^'\\])*'/,"$0"],[/([A-Z\d]+)\s*\:\s*([A-Z\d]+)/,f],[/[A-Z]+[\d]+/,f],[/([A-Z]+)(\s*\()/,f],[/[=<>]+/g,function(a){return"="==a[0]?"==":"<>"==a[0]?"!=":a[0]}]]);try{!1===cellsMap?rtn=cellHash:(!0===cellsMap&&(cellsMap={}),rtn=xui.isHash(cellsMap)?eval(str):str)}catch(e){xui._debugInfo("throw","#VALUE! ",formula,str,e)}finally{return rtn}}};return ret=doParse(formula,cellsMap),!xui.isNaN(ret)&&ret}}}),xui.Class("xui.APICaller","xui.absObj",{Instance:{_ini:xui.Timer.prototype._ini,_after_ini:function(profile,ins,alias){profile.name||profile.Instace.setName(alias)},destroy:function(){this.each((function(profile){if(!profile.destroyed){var box=profile.box,name=profile.properties.name;delete box._pool[name],profile.__gc()}}))},setHost:function(value,alias){var self=this;return value&&alias&&self.setName(alias),arguments.callee.upper.apply(self,arguments)},setQueryData:function(data,path){return this.each((function(prf){path?xui.set(prf.properties.queryData,(path||"").split("."),data):prf.properties.queryData=data||{}}))},setQueryArgs:function(data,path){return this.each((function(prf){path?xui.set(prf.properties.queryArgs,(path||"").split("."),data):prf.properties.queryArgs=data||{}}))},invoke:function(onSuccess,onFail,onStart,onEnd,mode,threadid,options){var ns=this,con=ns.constructor,prf=ns.get(0),prop=prf.properties,funs=xui.$cache.functions,t1=funs["$APICaller:beforeInvoke"],t2=funs["$APICaller:beforeData"],t3=funs["$APICaller:onError"];if(!(xui.isFun(t1)&&!1===t1(prf,requestId)||xui.isHash(t1)&&xui.isArr(t1.actions)&&!1===xui.pseudocode._callFunctions(t1,[prf,requestId],ns.getHost(),null,null,"$APICaller:beforeInvoke")||prf.beforeInvoke&&!1===prf.boxing().beforeInvoke(prf,requestId))){var responseType=prop.responseType,requestType=prop.requestType,requestId=prop.requestId,queryURL=prop.queryURL,proxyType=prop.proxyType.toLowerCase(),queryUserName=prop.queryUserName,queryPassword=prop.queryPassword,queryData=prop.queryData,queryArgs=xui.clone(prop.queryArgs),oAuth2Token=prop.oAuth2Token,queryOptions=xui.clone(prop.queryOptions),queryHeader=xui.clone(prop.queryHeader),requestDataSource=prop.requestDataSource,responseDataTarget=prop.responseDataTarget,responseCallback=prop.responseCallback;if(queryURL=xui.adjustVar(queryURL),"sajax"==proxyType?proxyType="jsonp":"iajax"==proxyType&&(proxyType="xdmi"),"FORM"!=requestType&&"JSON"!=requestType||(queryArgs="string"==typeof queryArgs?xui.unserialize(queryArgs):queryArgs),queryArgs||(queryArgs={}),prop.avoidCache){for(var i=0,rnd="_rand_";queryArgs.hasOwnProperty(rnd);)rnd="_rand_"+ ++i;queryArgs[rnd]=xui.rand()}if(requestDataSource&&requestDataSource.length)for(var i in requestDataSource){var v,path,o=requestDataSource[i];switch(o.type){case"databinder":if(t=xui.DataBinder.getFromName(o.name)){if("force"!==mode&&!t.updateDataFromUI())return;path=(o.path||"").split("."),xui.isHash(v=xui.get(queryArgs,path))?xui.merge(v,t.getData(),"without"):xui.set(queryArgs,path,t.getData())}break;case"form":if((t=xui.get(prf,["host",o.name]))&&t.Class["xui.absContainer"]&&t.getRootNode()){if(!("force"===mode||t.checkValid()&&t.checkRequired()))return;path=(o.path||"").split("."),xui.isHash(v=xui.get(queryArgs,path))?xui.merge(v,t.getFormValues(),"without"):xui.set(queryArgs,path,t.getFormValues())}}}var rMap={header:{}};if(xui.isEmpty(queryHeader)||xui.merge(rMap.header,queryHeader),queryOptions.header&&!xui.isEmpty(queryOptions.header)&&(xui.merge(rMap.header,queryOptions.header),delete queryOptions.header),("SOAP"==responseType||"SOAP"==requestType)&&(con.WDSLCache||(con.WDSLCache={}),!con.WDSLCache[queryURL])){var wsdl=xui.SOAP.getWsdl(queryURL,(function(rspData){prf.afterInvoke&&prf.boxing().afterInvoke(prf,rspData,requestId),xui.isFun(t3)?t3(rspData,requestId,prf):xui.isHash(t3)&&xui.isArr(t3.actions)&&xui.pseudocode._callFunctions(t3,[rspData,requestId,prf],ns.getHost(),null,null,"$APICaller:onError"),prf.onError&&prf.boxing().onError(prf,rspData,requestId),xui.tryF(onFail,arguments,this),xui.tryF(onEnd,arguments,this)}));if(!wsdl)return;con.WDSLCache[queryURL]=wsdl}switch(responseType){case"TEXT":rMap.rspType="text";break;case"JSON":rMap.rspType="json";break;case"XML":proxyType="ajax",rMap.rspType="xml";break;case"SOAP":proxyType="ajax",rMap.rspType="xml";var namespace=xui.SOAP.getNameSpace(con.WDSLCache[queryURL]),action=(namespace.lastIndexOf("/")!=namespace.length-1?namespace+"/":namespace)+(queryArgs.methodName||"");rMap.header.SOAPAction=action}switch(requestType){case"FORM":queryArgs="string"==typeof queryArgs?xui.unserialize(queryArgs):queryArgs;break;case"JSON":rMap.reqType="json","auto"==prop.queryMethod&&(rMap.method="POST"),queryArgs="string"==typeof queryArgs?queryArgs:xui.urlEncode(queryArgs);break;case"XML":rMap.reqType="xml",proxyType="ajax",rMap.method="POST",queryUserName&&queryPassword&&(rMap.username=queryUserName,rMap.password=queryPassword,rMap.header.Authorization="Basic "+con._toBase64(queryUserName+":"+queryPassword)),queryArgs="string"==typeof queryArgs?queryArgs:xui.XMLRPC.wrapRequest(queryArgs);break;case"SOAP":rMap.reqType="xml",proxyType="ajax",rMap.method="POST",queryUserName&&queryPassword&&(rMap.username=queryUserName,rMap.password=queryPassword,rMap.header.Authorization="Basic "+con._toBase64(queryUserName+":"+queryPassword)),queryArgs="string"==typeof queryArgs?queryArgs:xui.SOAP.wrapRequest(queryArgs,con.WDSLCache[queryURL])}oAuth2Token&&(rMap.header.Authorization="Bearer "+oAuth2Token),"ajax"!=proxyType&&(rMap.asy=!0),"jsonp"==proxyType&&(rMap.method="GET"),"asy"in(options=options||{})||(options.asy=!!prop.queryAsync),"method"in options||"auto"==prop.queryMethod||(options.method=prop.queryMethod),"onEnd"in options||(options.onEnd=onEnd),"onStart"in options||(options.onStart=onStart),xui.merge(options,queryOptions),xui.merge(options,rMap,"all"),options.proxyType=proxyType,queryData&&(options.data=queryData),xui.isEmpty(options.header)&&delete options.header;var t,cookies={};xui.isEmpty(prop.fakeCookies)||(options.$onStart=function(){xui.each(prop.fakeCookies,(function(v,k){xui.isSet(t=xui.Cookies.get(k))&&(cookies[k]=t,xui.Cookies.remove(k))})),xui.Cookies.set(prop.fakeCookies,1,"/")}),xui.isEmpty(prop.fakeCookies)||(options.$onEnd=function(){xui.each(prop.fakeCookies,(function(v,k){xui.Cookies.remove(k)})),xui.Cookies.set(cookies)});var ajax=xui._getrpc(queryURL,queryArgs,options).apply(null,[queryURL,queryArgs,function(rspData){var mapb;return"XML"!=responseType&&"SOAP"!=responseType||xui.isHash(rspData)||(xui.isStr(rspData)&&(rspData=xui.XML.parseXML(rspData)),"XML"==responseType?rspData=xui.XMLRPC.parseResponse(rspData):"SOAP"==responseType&&(rspData=xui.SOAP.parseResponse(rspData,queryArgs.methodName,con.WDSLCache[queryURL]))),prf.afterInvoke&&(mapb=prf.boxing().afterInvoke(prf,rspData,requestId),xui.isSet(mapb)&&(rspData=mapb),mapb=null),(!xui.isFun(t2)||!1!==t2(rspData,requestId,prf))&&(!xui.isHash(t2)||!xui.isArr(t2.actions)||!1!==xui.pseudocode._callFunctions(t2,[rspData,requestId,prf],ns.getHost(),null,null,"$APICaller:beforeData"))&&(!prf.beforeData||!1!==prf.boxing().beforeData(prf,rspData,requestId))&&(responseDataTarget&&responseDataTarget.length&&xui.arr.each(responseDataTarget,(function(o){var t,data=o.path?xui.get(rspData,o.path.split(".")):rspData;switch(o.type){case"alert":data=xui.stringify(data),xui.Coder&&(data=xui.Coder.formatText(data)),alert(data);break;case"log":xui.log(data,prf);break;case"databinder":(t=xui.DataBinder.getFromName(o.name))&&(t.setData(data),t.updateDataToUI());break;case"form":(t=xui.get(prf,["host",o.name]))&&t.Class["xui.absContainer"]&&t.setFormValues(data)}})),responseCallback&&responseCallback.length&&xui.arr.each(responseCallback,(function(o){var t,host;switch(o.type){case"host":(t=ns.getHost())&&(t=t.functions)&&(t=t[o.name])&&(host=ns.getHost());break;default:(t=xui.$cache.functions[o.name])&&(host=null)}t&&t.actions&&xui.isArr(t.actions)&&xui.pseudocode._callFunctions(t,[rspData,prf],host,null,null,(host&&host.alias)+"."+ns.alias+"."+o.name)})),prf.onData&&prf.boxing().onData(prf,rspData,requestId),void xui.tryF(onSuccess,arguments,this))},function(errMsg,rspType,tid,status,statusText,response){prf.afterInvoke&&prf.boxing().afterInvoke(prf,errMsg,requestId),responseDataTarget&&responseDataTarget.length&&xui.arr.each(responseDataTarget,(function(o,t){switch(o.type){case"alert":errMsg=xui.stringify(errMsg),xui.Coder&&(errMsg=xui.Coder.formatText(errMsg)),alert(errMsg);break;case"log":xui.log(errMsg)}})),xui.isFun(t3)?t3(errMsg,requestId,prf,status,statusText,response):xui.isHash(t3)&&xui.isArr(t3.actions)&&xui.pseudocode._callFunctions(t3,[errMsg,requestId,prf,status,statusText,response],ns.getHost(),null,null,"$APICaller:onError"),prf.onError&&prf.boxing().onError(prf,errMsg,requestId,status,statusText,response),xui.tryF(onFail,arguments,this)},threadid,options]);if("busy"==mode)xui.observableRun((function(threadid){ajax.threadid=threadid,ajax.start()}));else{if("return"==mode)return ajax;ajax.start()}}}},Static:{WDSLCache:{},$nameTag:"api_",_pool:{},_objectProp:{tagVar:1,propBinder:1,queryArgs:1,queryHeader:1,queryOptions:1,fakeCookies:1,requestDataSource:1,responseDataTarget:1,responseCallback:1},destroyAll:function(){this.pack(xui.toArr(this._pool,!1),!1).destroy(),this._pool={}},getFromName:function(name){var o=this._pool[name];return o&&o.boxing()},_toBase64:function(str){var c1,c2,c3,e1,e2,e3,e4,keyStr="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",arr=[],i=0;do{e1=(c1=str.charCodeAt(i++))>>2,e2=(3&c1)<<4|(c2=str.charCodeAt(i++))>>4,e3=(15&c2)<<2|(c3=str.charCodeAt(i++))>>6,e4=63&c3,isNaN(c2)?e3=e4=64:isNaN(c3)&&(e4=64),arr.push(keyStr.charAt(e1)+keyStr.charAt(e2)+keyStr.charAt(e3)+keyStr.charAt(e4))}while(i<str.length);return arr.join("")},_beforeSerialized:xui.Timer._beforeSerialized,DataModel:{dataBinder:null,dataField:null,requestId:"",queryAsync:!0,queryURL:"",avoidCache:!0,oAuth2Token:"",queryUserName:"",queryPassword:"",queryMethod:{ini:"GET",listbox:["auto","GET","POST","PUT","DELETE","HEAD","PATCH","OPTIONS"]},requestType:{ini:"FORM",listbox:["JSON","FORM","XML","SOAP","BLOB","STREAM","ASIS"]},responseType:{ini:"JSON",listbox:["JSON","TEXT","XML","SOAP","FORMDATA","BLOB","ARRAYBUFFER"]},requestDataSource:{ini:[]},responseDataTarget:{ini:[]},responseCallback:{ini:[]},queryArgs:{ini:{}},queryData:{ini:{}},queryHeader:{ini:{}},queryOptions:{ini:{}},fakeCookies:{ini:{}},proxyType:{ini:"FETCH",listbox:["auto","AJAX","JSONP","XDMI","FETCH"]},name:{set:function(value){var o=this,ovalue=o.properties.name,_p=o.box._pool,_old=_p[ovalue],_new=_p[value];_p[o.properties.name=value]=o,_new&&!_old&&(o._n=_new._n),_old&&delete _p[ovalue]}},proxyInvoker:{inner:!0,trigger:function(){var prop=this.get(0).properties,bak1=prop.responseDataTarget,bak2=prop.responseCallback,fun=function(d){prop.responseDataTarget=bak1,prop.responseCallback=bak2,d=xui.stringify(d),xui.Coder&&(d=xui.Coder.formatText(d)),alert(d)};prop.responseDataTarget=[],prop.responseCallback=[],this.invoke(fun,fun)}}},EventHandlers:{beforeInvoke:function(profile,requestId){},afterInvoke:function(profile,rspData,requestId){},onData:function(profile,rspData,requestId){},beforeData:function(profile,rspData,requestId){},onError:function(profile,errMsg,requestId,status,statusText,response){}}}}),xui.Class("xui.MQTT","xui.absObj",{Instance:{_ini:xui.Timer.prototype._ini,_after_ini:function(prf){var prop=prf.properties,fun=function(){xui.asyRun((function(){prf.$inDesign||prf.host&&prf.host.$inDesign||prop.autoConn&&prf.boxing().connect()}))};xui.get(window,"Paho.Client")?fun():xui.include("Paho.Client",prop.libCDN,(function(){prf&&prf.box&&fun&&fun()}),null,!1,{cache:!0})},destroy:function(){this.each((function(prf){prf.$inDesign||(prf.boxing().disconnect(),prf.__gc())}))},getParent:xui.Timer.prototype.getParent,getChildrenId:xui.Timer.prototype.getChildrenId,connect:function(){var t,p,prf=this.get(0),prop=prf.properties,path=xui.str.trim(prop.path),server=xui.str.trim(prop.server);path.length&&"/"!=path[0]&&(path="/"+path),(t=prf.$mqtt=new window.Paho.Client(server,parseInt(prop.port,10),path,prop.clientId)).onConnected=function(reconnect){prf.onConnSuccess&&prf.boxing().onConnSuccess(prf,reconnect)},t.onConnectionLost=function(err){prf&&prf.box&&(prf.boxing()._clear(),prf.onConnLost&&prf.boxing().onConnLost(prf,err))},t.onMessageDelivered=function(msgObj){prf.onMsgDelivered&&prf.boxing().onMsgDelivered(prf,msgObj.payloadString,msgObj)},t.onMessageArrived=function(msgObj){prf.onMsgArrived&&prf.boxing().onMsgArrived(prf,msgObj.payloadString,msgObj)};var opt={cleanSession:prop.cleanSession,useSSL:prop.useSSL,onSuccess:function(){prf.$mqtt_connected=1,prf.$mqtt_subed={},prop&&prop.autoSub&&xui.arr.each(prop.subscribers,(function(sub){var topic=sub.topic||sub+"",opt=xui.isHash(sub)?xui.copy(sub):{};delete opt.topic,opt.qos=parseInt(opt.qos)||0,prf.boxing().subscribe(topic,opt)}))},onFailure:function(e){prf&&prf.box&&(prf.onConnFailed?prf.boxing().onConnFailed(prf,e):xui.log(e.errorMessage+"["+e.errorCode+"]"),prf.boxing()._clear())}};if((p=prop.timeout)&&(opt.timeout=p),(p=prop.userName)&&(opt.userName=p),(p=prop.password)&&(opt.password=p),(p=prop.keepAliveInterval)&&(opt.keepAliveInterval=p),prop.willTopic&&prop.willMessage){var msg=new window.Paho.Message(prop.willTopic);msg.destinationName=prop.willMessage,msg.qos=parseInt(prop.willQos)||0,msg.retained=prop.willRetained,opt.willMessage=msg}t.connect(opt)},_clear:function(){var prf=this.get(0),t=prf.$mqtt;t&&(delete t.onConnected,delete t.onConnectionLost,delete t.onMessageDelivered,delete t.onMessageArrived),delete prf.$mqtt_connected,delete prf.$mqtt_subed,delete prf.$mqtt},disconnect:function(){var prf=this.get(0),t=prf.$mqtt;t&&prf.$mqtt_connected&&t.disconnect(),this._clear()},subscribe:function(topic,option){var prf=this.get(0),prop=prf.properties,t=prf.$mqtt;if(t&&prf.$mqtt_connected){var opt=xui.isHash(option)?xui.copy(option):{};prf.$mqtt_subed||(prf.$mqtt_subed={}),opt.qos=parseInt(opt.qos)||0,opt.onSuccess=function(){prf.$mqtt_subed[topic]=new Date,prf.onSubSuccess&&prf.boxing().onSubSuccess(prf,topic)},opt.onFailure=function(e){delete prf.$mqtt_subed[topic],prf.onSubFailed&&prf.boxing().onSubFailed(prf,e,topic)},opt.timeout=prop.timeout,t.subscribe(topic,opt)}},unsubscribe:function(topic,option){var prf=this.get(0),prop=prf.properties,t=prf.$mqtt;if(t&&prf.$mqtt_connected&&prf.$mqtt_subed&&prf.$mqtt_subed[topic]){var opt=xui.isHash(option)?xui.copy(option):{};opt.onSuccess=function(){delete prf.$mqtt_subed[topic],prf.onUnsubSuccess&&prf.boxing().onUnsubSuccess(prf,topic)},opt.onFailure=function(e){prf.onUnsubFailed&&prf.boxing().onUnsubFailed(prf,e,topic)},opt.timeout=prop.timeout,t.unsubscribe(topic,opt)}},publish:function(topic,payload,qos,retained){var prf=this.get(0),t=(prf.properties,prf.$mqtt);t&&prf.$mqtt_connected&&prf.$mqtt_subed&&prf.$mqtt_subed[topic]&&t.publish(topic,"string"==typeof payload?payload:xui.stringify(payload),parseInt(qos)||0,retained||!1)}},Static:{_objectProp:{tagVar:1,propBinder:1,subscribers:1},_beforeSerialized:xui.Timer._beforeSerialized,DataModel:{dataBinder:null,dataField:null,libCDN:"https://cdn.jsdelivr.net/npm/paho-mqtt@1.1.0/paho-mqtt-min.js",autoConn:!0,autoSub:!0,subscribers:[],server:"broker.mqttdashboard.com",port:"8000",path:"mqtt",clientId:"xui_mqtt_client",timeout:30,userName:"",password:"",keepAliveInterval:60,cleanSession:!0,useSSL:!1,reconnect:!0,willTopic:"",willMessage:"",willQos:{ini:0,listbox:[0,1,2]},willRetained:!1},EventHandlers:{onConnSuccess:function(profile,reconnect){},onConnFailed:function(profile,error){},onConnLost:function(profile,error){},onSubSuccess:function(profile,topic){},onSubFailed:function(profile,error,topic){},onUnsubSuccess:function(profile,topic){},onUnsubFailed:function(profile,error,topic){},onMsgDelivered:function(profile,payloadString,msgObj){},onMsgArrived:function(profile,payloadString,msgObj){}}}}),xui.Class("xui.DataBinder","xui.absObj",{Instance:{_ini:xui.Timer.prototype._ini,destroy:function(){this.each((function(profile){var box=profile.box,name=profile.properties.name;xui.arr.each(profile._n,(function(v){v&&box._unBind(name,v)})),delete box._pool[name],profile.__gc()}))},setHost:function(value,alias){var self=this;return value&&alias&&self.setName(alias),arguments.callee.upper.apply(self,arguments)},isDirtied:function(){for(var elems=this.constructor._getBoundElems(this.get(0)),i=0,l=elems.length;i<l;i++){var ins,profile=elems[i];if(profile.box["xui.absValue"]&&(ins=profile.boxing()).getUIValue()+" "!=ins.getValue()+" ")return!0}return!1},checkValid:function(ignoreAlert){var result=!0,profile=this.get(0);return!!this.checkRequired(ignoreAlert)&&(xui.absValue.pack(this.constructor._getBoundElems(profile),!1).each((function(prf){if(!prf.boxing().checkValid()){if(!ignoreAlert)return prf.beforeInputAlert&&!1===prf.boxing().prf.beforeInputAlert(profile,prf,"invalid")||xui.alert("$inline.invalid",xui.getRes("$inline.invalid")+(prf.properties.labelCaption?" : "+prf.properties.labelCaption:""),(function(){prf&&prf.renderId&&prf.boxing().activate()})),result=!1;result=!1}})),result)},checkRequired:function(ignoreAlert){var i,result=!0,profile=this.get(0);return xui.absValue.pack(this.constructor._getBoundElems(profile),!1).each((function(prf){if(prf.properties.required&&!(i=prf.boxing().getUIValue())&&0!==i){if(!ignoreAlert)return prf.beforeInputAlert&&!1===prf.boxing().prf.beforeInputAlert(profile,prf,"required")||xui.alert("$inline.required",xui.getRes("$inline.required")+(prf.properties.labelCaption?" : "+prf.properties.labelCaption:""),(function(){prf&&prf.renderId&&prf.boxing().activate()})),result=!1;result=!1}})),result},getUI:function(key){var r;return key?xui.arr.each(this.constructor._getBoundElems(this.get(0)),(function(profile){var p=profile.properties;if((p.dataField||p.name||profile.alias)==key)return r=profile.boxing(),!1})):r=xui.UI.pack(this.constructor._getBoundElems(this.get(0)),!1),r},getUIValue:function(withCaption,dirtied){var prf=this.get(0),hash={};return xui.arr.each(this.constructor._getBoundElems(prf),(function(profile){if(profile.box["xui.absValue"]){var keys,p=profile.properties,ins=profile.boxing(),uv=ins.getUIValue(),key=p.dataField||p.name||profile.alias;dirtied&&uv+" "==ins.getValue()+" "||(ins.getCaption?(-1!=key.indexOf(":")&&(keys=key.split(":")),keys&&keys[0]&&keys[1]?(hash[keys[0]]=uv,hash[keys[1]]=ins.getCaption()):withCaption?xui.set(hash,key,{value:uv,caption:ins.getCaption()},!0):xui.set(hash,key,uv,!0)):xui.set(hash,key,uv,!0))}})),hash},getDirtied:function(withCaption){return this.getUIValue(withCaption,!0)},getData:function(key,force,ignoreAlert){var prf=this.get(0);(prf.$inDesign||force)&&(prf.properties.data={},this.updateDataFromUI(!1,!1,!1,null,null,ignoreAlert,!1));var data=prf.properties.data;return xui.isSet(key)?xui.get(data,key,!0):data},setData:function(key,value,force){var prf=this.get(0),prop=prf.properties;return!1===key?xui.each(prop.data,(function(o,i){prop.data[i]=null})):xui.isSet(key)?xui.isHash(key)?prop.data=key:xui.set(prop.data,key,value,!0):prop.data={},(prf.$inDesign||force)&&this.updateDataToUI(),this},resetValue:function(){return xui.arr.each(this.constructor._getBoundElems(this.get(0)),(function(p,i){(i=p.properties.value)!==p.properties.$UIvalue&&p.boxing().resetValue(i)})),this},clearValue:function(){return xui.absValue.pack(this.constructor._getBoundElems(this.get(0)),!1).resetValue(null),this},updateValue:function(){return xui.absValue.pack(this.constructor._getBoundElems(this.get(0)),!1).updateValue(),this},updateDataFromUI:function(updateUIValue,withCaption,returnArr,adjustData,dataKeys,ignoreAlert,ignoreEvent){var mapb,prf=this.get(0),prop=prf.properties,map={};if(!ignoreAlert){if(!this.checkValid())return!1;if(!this.checkRequired())return!1}return xui.merge(map,prop.data,(function(v,t){return!dataKeys||dataKeys===t||!!xui.isArr(dataKeys)&&-1!=xui.arr.indexOf(dataKeys,t)})),xui.arr.each(this.constructor._getBoundElems(prf),(function(profile){var keys,cap,p=profile.properties,ins=(profile.box.$EventHandlers,profile.boxing()),key=p.dataField||p.name||profile.alias;if("function"==typeof ins.setCaption&&-1!=key.indexOf(":")&&(keys=key.split(":"))[1]&&keys[2]&&(key=keys[0],cap=keys[1]),!dataKeys||dataKeys===key||xui.isArr(dataKeys)&&-1!=xui.arr.indexOf(dataKeys,key)){var capv,b=profile.boxing(),uv=profile.box["xui.absValue"]?b.getUIValue(xui.isBool(returnArr)?returnArr:profile.__returnArray):null,target=xui.get(map,key,!0);if(xui.isHash(target)){var pp=target.properties,theme=target.theme,cc=target.CC,ca=target.CA,cs=target.CS;pp&&delete target.properties,theme&&delete target.theme,ca&&delete target.CA,cc&&delete target.CC,cs&&delete target.CS,xui.filter(target,(function(o,i){return!!(i in p)})),xui.isEmpty(target)||xui.each(target,(function(o,i){i in p&&(target[i]=p[i])})),xui.isHash(pp)&&(xui.filter(pp,(function(o,i){return i in p&&!(i in target)})),xui.isEmpty(pp)||(xui.each(pp,(function(o,i){i in p&&(pp[i]=p[i])})),target.properties=pp)),theme&&(target.theme=profile.theme),ca&&(target.CA=xui.clone(profile.CA,!0)),cc&&(target.CC=xui.clone(profile.CC,!0)),cs&&(target.CS=xui.clone(profile.CS,!0)),"caption"in p&&b.getCaption&&(cap?map[cap]=b.getCaption():("caption"in target||withCaption)&&(pp&&"caption"in pp?pp.caption=b.getCaption():target.caption=b.getCaption())),xui.isDefined(uv)&&"value"in p&&(pp&&"value"in pp?pp.value=uv:target.value=uv)}else profile.box["xui.UI.ComboInput"]&&"file"==p.type?target=profile:"caption"in p?(capv="function"==typeof b.getCaption?b.getCaption():p.caption,cap?(target=uv,map[cap]=capv):target=withCaption?!capv&&!uv||capv==uv?uv:{value:uv,caption:capv}:uv):target=uv,xui.set(map,key,target,!0);!1!==updateUIValue&&profile.renderId&&profile.box["xui.absValue"]&&b.updateValue()}})),adjustData&&(map=xui.tryF(adjustData,[map,prf],this)),!ignoreEvent&&prf.afterUpdateDataFromUI&&(mapb=this.afterUpdateDataFromUI(prf,map),xui.isHash(mapb)&&(map=mapb),mapb=null),xui.merge(prf.properties.data,map,"all"),!0},updateDataToUI:function(adjustData,dataKeys,ignoreEvent){var key,keys,cap,p,v,c,b,pp,uv,mapb,ns=this,prf=ns.get(0),prop=prf.properties,map={};return xui.merge(map,prop.data,(function(v,t){return!dataKeys||dataKeys===t||!!xui.isArr(dataKeys)&&-1!=xui.arr.indexOf(dataKeys,t)})),adjustData&&(map=xui.tryF(adjustData,[map,prf],ns)),!ignoreEvent&&prf.beforeUpdateDataToUI&&(mapb=ns.beforeUpdateDataToUI(prf,map),xui.isHash(mapb)&&(map=mapb),mapb=null),xui.arr.each(ns.constructor._getBoundElems(prf),(function(profile){p=profile.properties,profile.box.$EventHandlers,key=p.dataField||p.name||profile.alias,"function"==typeof profile.boxing().setCaption&&-1!=key.indexOf(":")&&(keys=key.split(":"))[1]&&keys[2]&&(key=keys[0],cap=keys[1]),(!dataKeys||dataKeys===key||xui.isArr(dataKeys)&&-1!=xui.arr.indexOf(dataKeys,key))&&map&&xui.isDefined(xui.get(map,key,!0))&&(v=xui.clone(xui.get(map,key,!0),null,2),uv=c=undefined,b=profile.boxing(),xui.isHash(v)?((pp=v.properties)&&(xui.filter(pp,(function(o,i){return i in p})),c=cap&&pp[cap]||(xui.isSet(pp.caption)?pp.caption:null),uv=xui.isSet(pp.value)?pp.value:null,delete pp.caption,delete pp.value,xui.isEmpty(pp)||b.setProperties(pp),delete v.properties),(pp=v.theme)&&("function"==typeof b.setTheme&&b.setTheme(pp),delete v.theme),(pp=v.CS)&&(xui.isEmpty(pp)||b.setCustomStyle(pp),delete v.CS),(pp=v.CC)&&(xui.isEmpty(pp)||b.setCustomClass(pp),delete v.CC),(pp=v.CA)&&(xui.isEmpty(pp)||b.setCustomAttr(pp),delete v.CA),xui.isEmpty(v)||(xui.filter(v,(function(o,i){return i in p||i in v})),xui.isEmpty(v)||(c=xui.isSet(c)?c:cap&&pp[cap]||xui.isSet(v.caption)?v.caption:null,uv=xui.isSet(uv)?uv:xui.isSet(v.value)?v.value:null,delete v.caption,delete v.value,xui.isEmpty(v)||b.setProperties(v)))):(uv=v,c=cap&&pp[cap]||undefined),xui.isDefined(uv)&&xui.isFun(b.resetValue)&&(b.resetValue(uv),profile.__returnArray=xui.isArr(uv)),xui.isDefined(c)&&xui.isFun(b.setCaption)&&xui.tryF(b.setCaption,[c,!0],b))})),ns}},Static:{$nameTag:"databinder_",_pool:{},_objectProp:{tagVar:1,propBinder:1,data:1},destroyAll:function(){this.pack(xui.toArr(this._pool,!1),!1).destroy(),this._pool={}},getFromName:function(name){var o=this._pool[name];return o&&o.boxing()},_beforeSerialized:xui.Timer._beforeSerialized,_getBoundElems:function(prf){var arr=[];return xui.arr.each(prf._n,(function(profile){profile.behavior.PanelKeys?xui.absValue.pack(profile.boxing().getChildren(null,!0)).each((function(p){arr.push(p)})):profile.box["xui.absValue"]&&arr.push(profile)})),xui.arr.removeDuplicate(arr)},_bind:function(name,profile){if(name){var b,o=this._pool[name];o||((b=new xui.DataBinder).setName(name),o=b.get(0)),profile&&-1==xui.arr.indexOf(o._n,profile)&&profile.link(o._n,"databinder."+name)}},_unBind:function(name,profile){profile&&profile.box&&this._pool[name]&&profile.unLink("databinder."+name)},DataModel:{dataBinder:null,dataField:null,name:{set:function(value){var o=this,ovalue=o.properties.name,_p=o.box._pool,_old=_p[ovalue],_new=_p[value];if(_p[o.properties.name=value]=o,_old&&!_new&&o._n.length)for(var i=0,l=o._n.length;i<l;i++)xui.set(o._n[i],["properties","dataBinder"],value);_new&&!_old&&(o._n=_new._n),_old&&delete _p[ovalue]}},data:{ini:{}}},EventHandlers:{beforeInputAlert:function(profile,ctrlPrf,type){},beforeUpdateDataToUI:function(profile,dataToUI){},afterUpdateDataFromUI:function(profile,dataFromUI){}}}}),(xui.Locale.en||(xui.Locale.en={})).inline={$_$:1,ok:"O K",cancel:"Cancel",set:"SET",today:"Today",now:"Now",yes:"Yes",no:"No",noFlash:"No Flash PlugIn!",transparent:"transparent",required:"Required field",required2:"There is required field need to be filled out",invalid:"Invalid field",invalid2:"There is invalid field"},xui.Locale.en.date={WEEKS:{0:"Su",1:"Mo",2:"Tu",3:"We",4:"Th",5:"Fr",6:"Sa",7:"WK"},VIEWS:{"10 ms":"10 millisecond","100 ms":"100 milliseconds","1 s":"1 second","10 s":"10 seconds","1 n":"1 minute","5 n":"5 minutes","10 n":"10 minutes","30 n":"30 minutes","1 h":"1 hour","2 h":"2 hours","6 h":"6 hours","1 d":"1 day","1 w":"1 week","15 d":"15 days","1 m":"1 month","1 q":"1 quarter","1 y":"1 year","1 de":"10 years","1 c":"1 century"},MONTHS:{1:"Jan.",2:"Feb.",3:"Mar.",4:"Apr.",5:"May.",6:"Jun.",7:"Jul.",8:"Aug.",9:"Sep.",10:"Oct.",11:"Nov.",12:"Dec."},MS:"ms",S:"s",N:"n",H:"h",D:"d",W:"w",M:"m",Q:"q",Y:"y",DE:"de",C:"c",HN:function(n,a,b){return(1==a.length?"0":"")+a+":"+(1==b.length?"0":"")+b},DHN:function(n,a,b,c){return a+"th "+(1==b.length?"0":"")+b+":"+(1==c.length?"0":"")+c},MDHN:function(n,a,b,c,d){return b+"th "+xui.getRes("date.MONTHS."+a)+" "+(1==c.length?"0":"")+c+":"+(1==d.length?"0":"")+d},HNS:function(n,a,b,c){return(1==a.length?"0":"")+a+":"+(1==b.length?"0":"")+b+":"+(1==c.length?"0":"")+c},HNSMS:function(n,a,b,c,d){return(1==a.length?"0":"")+a+":"+(1==b.length?"0":"")+b+":"+(1==c.length?"0":"")+c+" "+(1==d.length?"00":2==d.length?"0":"")+d},YM:function(n,a,b){return xui.getRes("date.MONTHS."+b)+" "+a},YQ:function(n,a,b){return b+"Q "+a},YMD:function(n,a,b,c){return a+"-"+(1==b.length?"0":"")+b+"-"+(1==c.length?"0":"")+c},YMD2:function(n,a,b,c){return xui.getRes("date.MONTHS."+b)+" "+c+", "+a},MD:function(n,a,b){return xui.getRes("date.MONTHS."+a)+" "+b},YMDH:function(n,a,b,c,d){return a+"-"+(1==b.length?"0":"")+b+"-"+(1==c.length?"0":"")+c+" "+(1==d.length?"0":"")+d+":00"},YMDHN:function(n,a,b,c,d,e){return a+"-"+(1==b.length?"0":"")+b+"-"+(1==c.length?"0":"")+c+" "+(1==d.length?"0":"")+d+":"+(1==e.length?"0":"")+e},YMDHNS:function(n,a,b,c,d,e,f){return a+"-"+(1==b.length?"0":"")+b+"-"+(1==c.length?"0":"")+c+" "+(1==d.length?"0":"")+d+":"+(1==e.length?"0":"")+e+":"+(1==f.length?"0":"")+f},ALL:function(n,a,b,c,d,e,f,g){return a+"-"+(1==b.length?"0":"")+b+"-"+(1==c.length?"0":"")+c+" "+(1==d.length?"0":"")+d+":"+(1==e.length?"0":"")+e+":"+(1==f.length?"0":"")+f+" "+(1==g.length?"00":2==g.length?"0":"")+g}},xui.Locale.en.color={LIST:{FFFFFF:"White",FFFFF0:"Ivory",FFFFE0:"Light Yellow",FFFF00:"Yellow",FFFAFA:"Snow",FFFAF0:"Floral White",FFFACD:"Lemon Chiffon",FFF8DC:"Cornislk",FFF5EE:"Sea Shell",FFF0F5:"Lavender Blush",FFEFD5:"Papaya Whip",FFEBCD:"Blanched Almond",FFE4E1:"Misty Rose",FFE4C4:"Bisque",FFE4B5:"Moccasin",FFDEAD:"Navajo White",FFDAB9:"Peach Puff",FFD700:"Gold",FFC0CB:"Pink","FFB6C1 ":"Light Pink",FFA500:"Orange",FFA07A:"Light Salmon",FF8C00:"Dark Orange",FF7F50:"Coral",FF69B4:"Hot Pink",FF6347:"Tomato",FF4500:"Orange Red",FF1493:"Deep Pink",FF00FF:"Magenta",FF0000:"Red",FDF5E6:"Old Lace",FAFAD2:"Light Goldenrod Yellow",FAF0E6:"Linen",FAEBD7:"Antique White",FA8072:"Salmon",F8F8FF:"Ghost White",F5FFFA:"Medium Spring Green",F5F5F5:"White Smoke",F5DEB3:"Wheat",F4A460:"Sandy Brown",F0FFFF:"Azure",F0FFF0:"Honeydew",F0F8FF:"Alice Blue",F0E68C:"Khaki",F08080:"Light Coral",EEE8AA:"Pale Godenrod",EE82EE:"Violet",E9967A:"Dark Salmon",E6E6FA:"Lavender",E1FFFF:"Light Cyan",DEB887:"Bruly Wood",DDA0DD:"plum",DCDCDC:"Gainsboro",DC143C:"Crimson",DB7093:"Pale Violet Red",DAA520:"Gold Enrod",DA70D6:"Orchid",D8BFD8:"Thistle",D3D3D3:"Light Grey",D2B48C:"Tan",D2691E:"Chocolate",CD853F:"Peru",CD5C5C:"Indian Red",C71585:"Medium Violet Red",C0C0C0:"Silver",BDB76B:"Dark Khaki",BC8F8F:"Rosy Brown",BA55D3:"Medium Orchid",B22222:"Fire Brick",B0E0E6:"Pow Der Blue",B0C4DE:"Light Steel Blue",AFEEEE:"Pale Turquoise",ADFF2F:"Green Yellow",ADD8E6:"Light BLue",A9A9A9:"Dark Gray",A52A2A:"Brown",A0522D:"Sienna","9932CC":"Dark Orchid","98FB98":"Pale Green","9400D3":"Dark Voilet","9370DB":"Medium Purple","90EE90":"Light Green","8FBC8F":"Dark Sea Green","8B4513":"Saddle Brown","8B008B":"Dark Magenta","8B0000":"Dark Red","8A2BE2":"Blue Violet","87CEFA":"Light Sky Blue","87CEEB":"Sky Blue",808080:"Gray",808e3:"Olive",800080:"Purple",8e5:"Maroon","7FFFAA":"Auqamarin","7FFF00":"Chartreuse","7CFC00":"Lawn Green","7B68EE":"Medium Slate Blue",778899:"Light Slate Gray",708090:"Slate Gray","6B8E23":"Beige","6A5ACD":"Slate Blue",696969:"Dim Gray","6495ED":"Cornflower Blue","5F9EA0":"Cadet Blue","556B2F":"Olive Drab","4B0082":"Indigo","48D1CC":"Medium Turquoise","483D8B":"Dark Slate Blue","4682B4":"Steel Blue","4169E1":"Royal Blue","40E0D0":"Turquoise","3CB371":"Spring Green","32CD32":"Lime Green","2F4F4F":"Dark Slate Gray","2E8B57":"Sea Green","228B22":"Forest Green","20B2AA":"Light Sea Green","1E90FF":"Doder Blue",191970:"Midnight Blue","00FFFF":"Aqua","00FF7F":"Mint Cream","00FF00":"Lime","00FA9A":"Medium Aquamarine","00CED1":"Dark Turquoise","00BFFF":"Deep Sky Blue","008B8B":"Dark Cyan","008080":"Teal","008000":"Green","006400":"Dark Green","0000FF":"Blue","0000CD":"Medium Blue","00008B":"Dark Blue","000080":"Navy","000000":"Black"}},xui.Locale.en.editor={bold:"Bold",italic:"Italic",underline:"Underline",strikethrough:"Strikethrough",subscript:"Subscript",superscript:"Superscript",forecolor:"Font Color",bgcolor:"Background Color",left:"Align Left",center:"Align Center",right:"Align Right",justify:"Justify",indent:"Indent",outdent:"Outdent",ol:"Ordered List",ul:"Unordered List",hr:"Insert Horizontal Rule",unlink:"Remove Link",removeformat:"Remove Formatting",html:"HTML Editor",insertimage:"Insert Image",insertimage2:"Image URL:",createlink:"Insert Link",createlink2:"Link URL:",fontsize:"Font Size",fontname:"Font Family",formatblock:"Font Block",fontsizeList:"1,1(8pt);2,2(10pt);3,3(12pt);4,4(14pt);5,5(18pt);6,6(24pt);...,...",fontnameList:"Arial;Arial Black;Comic Sans MS;Courier New;Impact;Tahoma;Times New Roman;Trebuchet MS;Verdana;...",formatblockList:"p,Normal;h1,Heading1;h2,Heading2;h3,Heading3;h4,Heading4;h5,Heading5;h6,Heading6;...,..."},xui.Class("xui.Event",null,{Constructor:function(event,node,fordrag,tid){var id,t,src,pre,obj,self=xui.Event,w=window,d=document,dd=0,dragdrop=xui.DragDrop;if(!(event=event||w.event)||!(src=node))return src=node=null,!1;node=null;var type=event.type,xuievent=event.$xuievent,xuitype=event.$xuitype,xuiall=event.$xuiall;if(xui.browser.fakeTouch&&"click"==type&&xui.getData(["!document","$fakescrolling"]))return!1;if("xuitouchdown"==type&&(type="mousedown",xuievent=1,xuiall=0,xuitype="beforeMousedown"),"mouseover"==type||"mouseout"==type){if(1!=(dd=dragdrop&&dragdrop._profile.isWorking?1:2)&&fordrag)return src=null,self.$FALSE;if(!self._handleMouseHover(event,src,1==dd))return src=null,self.$FALSE;1==dd&&(pre=dragdrop&&dragdrop._dropElement)}else if((obj=self._tabHookStack).length&&self._kb[type]&&9==(event.$key||event.keyCode||event.charCode)&&!1===self._handleTabHook(self.getSrc(event),obj=obj[obj.length-1]))return void(src=null);if(id=tid||self.getId(src),obj=self._getProfile(id)){if("DOMMouseScroll"==type&&(type="mousewheel"),"mousedown"==type||"mousewheel"==type)xui.tryF(xui.Dom._blurTrigger,[obj,event]);else if("resize"==type&&(type="size",xui.browser.ie&&w===src)){var width=xui.browser.contentBox&&d.documentElement.clientWidth||d.body.clientWidth,height=xui.browser.contentBox&&d.documentElement.clientHeight||d.body.clientHeight;if(obj._w==width&&obj._h==height)return void(src=null);obj._w=width,obj._h=height}var j,f,name,r=!0,funs=[];for(j=0;j<=2&&(1!=dd||0===j||event.$force);++j)2==dd&&0===j||(name=self._type[type+j]||(self._type[type+j]=self._getEventName(type,j)),xuievent&&!xuiall&&name!==xuitype||obj._getEV(funs,id,name,src.$xid));return(f=function(a,b){for(var v,i=0;v=arguments.callee.tasks[i++];)if(!1===v(obj,a,b))return!1;return!0}).tasks=funs,r=f(event,src.$xid),w===src&&"size"==type&&xui.asyRun((function(){f(event,src.$xid),f.tasks.length=0,delete f.tasks,f=src=null}),150),dragdrop?"drag"==type?dragdrop._onDrag=f:"dragover"==type&&(dragdrop._onDragover=f):"size"!==type&&(f.tasks.length=0,delete f.tasks,f=null),1==dd&&("mouseover"==type&&dragdrop._dropElement==src.$xid&&pre&&pre!=src.$xid&&(self({type:"mouseout",target:t=xui.use(pre).get(0),$xui:!0,$xuitype:"beforeMouseout",preventDefault:function(e){xui.Event.stopDefault(e)},stopPropagation:function(e){xui.Event.stopBubble(e)}},t),dragdrop.setDropElement(src.$xid)),"mouseout"==type&&!dragdrop._dropElement&&pre&&pre==src.$xid&&(self._preDroppable=id,xui.asyRun((function(){delete xui.Event._preDroppable}))),src.$xid==dragdrop._dropElement&&(r=!1)),!1===r&&self.stopBubble(event),r}},Static:{$FALSE:!!xui.browser.opr&&undefined,_type:{},_kb:{keydown:1,keypress:1,keyup:1},_reg:/(-[\w]+)|([\w]+$)/g,$eventhandler:function(){return xui.Event(arguments[0],this)},$eventhandler2:function(){return xui.Event(arguments[0],this,1)},$eventhandler3:function(){var a=arguments[0],t=xui.Event.getSrc(a||window.event),r=xui.Event(a,t);return!1===r?r:t!==this?xui.Event(a,this):void 0},$lastMouseupTime:0,$dblcInterval:500,$lastClickFunMark:0,_events:"mouseover,mouseout,mouseleave,mouseenter,mousedown,mouseup,mousemove,mousewheel,click,dblclick,contextmenu,keydown,keypress,keyup,scroll,blur,focus,load,unload,beforeunload,abort,change,select,submit,reset,error,move,size,dragbegin,drag,dragstop,dragleave,dragenter,dragover,drop,touchstart,touchmove,touchend,touchcancel,mspointerdown,mspointermove,mspointerup,mspointercancel,pointerdown,pointermove,pointerup,pointercancel".split(","),_addEventListener:function(node,evt,fnc){var f1,f2,f,name,force,getName=function(name){return name.replace(/^on|before|after/,"").toLowerCase()};if(node.addEventListener){var passiveSupported=!1;try{var options=Object.defineProperty({},"passive",{get:function(){passiveSupported=!0}});window.addEventListener("test",null,options)}catch(e){}return node.addEventListener(getName(evt),fnc,!!passiveSupported&&{passive:!1}),!0}return force=!0,name=getName(name=evt),"function"==typeof node[evt=force||!{touchstart:1,touchmove:1,touchend:1,touchcancel:1}[name]?"on"+name:name]&&(f1=node[evt],f2=fnc,(f=function(){for(var funs=arguments.callee._funs,i=0,l=funs.length;i<l;i++)funs[i].apply(this,arguments)})._funs=f1._funs||[f1],f1._funs=null,f._funs.push(f2),fnc=f),node[evt]=fnc,!0},_removeEventListener:function(node,evt,fnc){var name,force,getName=function(name){return name.replace(/^on|before|after/,"").toLowerCase()};if(node.removeEventListener){var passiveSupported=!1;try{var options=Object.defineProperty({},"passive",{get:function(){passiveSupported=!0}});window.addEventListener("test",null,options)}catch(e){}return node.removeEventListener(getName(evt),fnc,!!passiveSupported&&{passive:!1}),!0}return force=!0,name=getName(name=evt),node[evt=force||!{touchstart:1,touchmove:1,touchend:1,touchcancel:1}[name]?"on"+name:name]===fnc?(node[evt]=null,!0):!(!node[evt]||!node[evt]._funs||-1==xui.arr.indexOf(node[evt]._funs,fnc)||(xui.arr.removeValue(node[evt]._funs,fnc),0))},simulateEvent:function(target,type,options,fromtype){options=options||{},target[0]&&(target=target[0]),xui.tryF(xui.Event.$eventsforSimulation[fromtype||type],[target,type,options])},_getEventName:function(name,pos){return(name=this._map1[name])&&(0===pos||1==pos||2==pos?name[pos]:name)},_getProfile:function(id,a,b){return id&&"string"==typeof id&&((a=(b=xui.$cache.profileMap)[id])?a["xui.UIProfile"]?a:(b=b[id.replace(this._reg,"")])?b:a:b[id.replace(this._reg,"")])},_handleTabHook:function(src,target){if(src===document)return!0;var node=src,tabindex=node.tabIndex;do{if(xui.getId(node)==target[0])return node=src=null,!0}while(node&&(node=node.parentNode)&&node!==document&&node!==window);return xui.tryF(target[1],[target[0],tabindex],src),node=src=null,!1},_handleMouseHover:function(event,target,dd){if(target==document)return target=null,!0;var node=("mouseover"==event.type?event.fromElement:event.toElement)||event.relatedTarget;if(dd&&"mouseover"==event.type&&this._preDroppable)try{do{if(node&&node.id&&node.id==this._preDroppable)return target=node=null,!0}while(node&&(node=node.parentNode)&&node!==document&&node!==window)}catch(a){}if(xui.browser.gek)try{do{if(node==target)return target=node=null,!1}while(node&&(node=node.parentNode))}catch(a){node=xui([target]);var pos=this.getPos(event),p=node.offset(),s=node.cssSize(),out=pos.left<p.left||pos.left>p.left+s.width||pos.top<p.top||pos.top>p.top+s.height;return target=node=null,"mouseover"==event.type?!out:out}else do{if(node==target)return target=node=null,!1}while(node&&(node=node.parentNode));return target=node=null,!0},_tabHookStack:[],pushTabOutTrigger:function(boundary,trigger){return this._tabHookStack.push([xui(boundary)._nodes[0],trigger]),this},popTabOutTrigger:function(flag){return flag?this._tabHookStack=[]:this._tabHookStack.pop(),this},getSrc:function(event){var a;return(a=event.target||event.srcElement||null)&&xui.browser.kde&&3==a.nodeType?a.parentNode:a},getId:function(node){return window===node?"!window":document===node?"!document":node.id},getBtn:function(event){return xui.browser.ie?4==event.button?"middle":2==event.button?"right":"left":2==event.which?"middle":3==event.which?"right":"left"},getPos:function(event,original){if(event=event||window.event,xui.browser.isTouch&&event.changedTouches&&event.changedTouches[0]&&(event=event.changedTouches[0]),"pageX"in event){var scale=original?1:xui.ini.$zoomScale||1;return{left:event.pageX/scale,top:event.pageY/scale}}var t,d=document,doc=d.documentElement,body=d.body,_L=(xui.isSet(t=doc&&doc.scrollLeft)||xui.isSet(t=body&&body.scrollLeft)?t:0)-(xui.isSet(t=doc.clientLeft)?t:0),_T=(xui.isSet(t=doc&&doc.scrollTop)||xui.isSet(t=body&&body.scrollTop)?t:0)-(xui.isSet(t=doc.clientTop)?t:0);return{left:event.clientX+_L,top:event.clientY+_T}},getKey:function(event){if(event&&event.$xuievent)return event;var t,res=[],k=(event=event||window.event).$key||event.keyCode||event.charCode||0;if("string"==typeof k)res[0]=k;else{var key=String.fromCharCode(k),type=event.type;if("keypress"==type&&k>=33&&k<=128||k>=48&&k<=57||k>=65&&k<=90)res[0]=key;else{if(!(t=arguments.callee.map)){t=arguments.callee.map={};for(var arr="3,enter,8,backspace,9,tab,12,numlock,13,enter,19,pause,20,capslock,27,esc,32, ,33,pageup,34,pagedown,35,end,36,home,37,left,38,up,39,right,40,down,44,printscreen,45,insert,46,delete,50,down,52,left,54,right,56,up,91,win,92,win,93,apps,96,0,97,1,98,2,99,3,100,4,101,5,102,6,103,7,104,8,105,9,106,*,107,+,109,-,110,.,111,/,112,f1,113,f2,114,f3,115,f4,116,f5,117,f6,118,f7,119,f8,120,f9,121,f10,122,f11,123,f12,144,numlock,145,scroll,186,;,187,=,189,-,190,.,191,/,192,`,219,[,220,\\,221,],222,',224,meta,63289,numlock,63276,pageup,63277,pagedown,63275,end,63273,home,63234,left,63232,up,63235,right,63233,down,63272,delete,63302,insert,63236,f1,63237,f2,63238,f3,63239,f4,63240,f5,63241,f6,63242,f7,63243,f8,63244,f9,63245,f10,63246,f11,63247,f12,63248,print".split(","),i=1,l=arr.length;i<l;i+=2)t[arr[i-1]]=arr[i];arr.length=0,t[188]=","}res[0]=t[k]||key}}return(event.modifiers?event.modifiers&Event.CONTROL_MASK:event.ctrlKey||event.ctrlLeft||17==k||57391==k)?(17!=k&&57391!=k||(res[0]=""),res.push("1")):res.push(""),(event.modifiers?event.modifiers&Event.SHIFT_MASK:event.shiftKey||event.shiftLeft||16==k||57390==k)?(16!=k&&57390!=k||(res[0]=""),res.push("1")):res.push(""),event.modifiers||!event.altKey&&!event.altLeft&&18!=k&&57388!=k?res.push(""):(18!=k&&57388!=k||(res[0]=""),res.push("1")),res[0]=res[0],res.key=res[0],res.keyCode=k,res.type=type,res.ctrlKey=!!res[1],res.shiftKey=!!res[2],res.altKey=!!res[3],"keypress"==type?this.$keydownchar&&this.$keydownchar.length>1&&(res.key=this.$keydownchar):"keydown"==type?res[0].length>1?this.$keydownchar=res[0]:this.$keydownchar&&(this.$keydownchar=null):"keyup"==type&&this.$keydownchar&&(this.$keydownchar=null),res},getEventPara:function(event,mousePos){mousePos||(mousePos=xui.Event.getPos(event));var keys=this.getKey(event),h={button:this.getBtn(event),pageX:mousePos&&mousePos.left,pageY:mousePos&&mousePos.top,key:keys.key,keyCode:keys.keyCode,ctrlKey:keys.ctrlKey,shiftKey:keys.shiftKey,altKey:keys.altKey,$xuieventpara:!0};for(var i in event)"$"==i.charAt(0)&&(h[i]=event[i]);return h},stopBubble:function(event){(event=event||window.event).stopPropagation&&event.stopPropagation(),"cancelBubble"in event&&(event.cancelBubble=!0),this.stopDefault(event)},stopDefault:function(event){(event=event||window.event).preventDefault?event.preventDefault():"returnValue"in event&&(event.returnValue=!1)},_kbh:function(cache,key,ctrl,shift,alt,fun,id,args,scope,base){if(key){if(id=id||("string"==typeof fun?fun:null),cache[key=(key||"").toLowerCase()+":"+(ctrl?"1":"")+":"+(shift?"1":"")+":"+(alt?"1":"")]=cache[key]||[],"function"==typeof fun)return id?(delete cache[key][id],xui.arr.removeValue(cache[key],id)):id=xui.rand(),cache[key][id]=[fun,args,scope,base],cache[key].push(id),id;id?(delete cache[key][id],xui.arr.removeValue(cache[key],id)):delete cache[key]}return this},keyboardHook:function(key,ctrl,shift,alt,fun,id,args,scope,base){return this._kbh(xui.$cache.hookKey,key,ctrl,shift,alt,fun,id,args,scope,base)},keyboardHookUp:function(key,ctrl,shift,alt,fun,id,args,scope,base){return this._kbh(xui.$cache.hookKeyUp,key,ctrl,shift,alt,fun,id,args,scope,base)},getWheelDelta:function(e){return e.wheelDelta?e.wheelDelta/120:-e.detail/3},$TAGNAMES:{select:"input",change:"input",submit:"form",reset:"form",error:"img",load:"img",abort:"img"},_supportCache:{},isSupported:function(name,node){var c=this._supportCache,rn=(node?node.tagName.toLowerCase():"div")+":"+name;if(rn in c)return c[rn];node=node||document.createElement(this.$TAGNAMES[name]||"div");var isSupported=(name="on"+name)in node;return isSupported||(node.setAttribute||(node=document.createElement("div")),node.setAttribute&&(node.setAttribute(name,""),isSupported="function"==typeof node[name],void 0!==node[name]&&(node[name]=undefined),node.removeAttribute(name))),node=null,c[rn]=isSupported},_simulateMousedown:function(event){if(!event.touches)return!0;var E=xui.Event,first=event.changedTouches[0];return event.touches.length>1||(E.__simulatedMousedownNode=first.target,E.isSupported("mousedown")?E._xuitouchdowntime=xui.setTimeout((function(){E._xuitouchdowntime=0,E.simulateEvent(first.target,"xuitouchdown",{screenX:first.screenX,screenY:first.screenY,clientX:first.clientX,clientY:first.clientY},"mousedown")}),100):E.simulateEvent(first.target,"mousedown",{screenX:first.screenX,screenY:first.screenY,clientX:first.clientX,clientY:first.clientY})),!0},_simulateMouseup:function(event){if(!event.touches)return!0;var E=xui.Event,_now=(new Date).getTime(),interval=_now-E.$lastMouseupTime,first=event.changedTouches[0];return E._xuitouchdowntime&&xui.clearTimeout(E._xuitouchdowntime),E.__simulatedMouseupNode=first.target,E.isSupported("mouseup")||E.simulateEvent(first.target,"mouseup",{screenX:first.screenX,screenY:first.screenY,clientX:first.clientX,clientY:first.clientY}),E.__simulatedMouseupNode===E.__simulatedMousedownNode&&(E.isSupported("click")||E.simulateEvent(first.target,"click",{screenX:first.screenX,screenY:first.screenY,clientX:first.clientX,clientY:first.clientY}),interval<=E.$dblcInterval&&xui.asyRun((function(){E.$lastMouseupTime=0,E.simulateEvent(first.target,"dblclick",{screenX:first.screenX,screenY:first.screenY,clientX:first.clientX,clientY:first.clientY})}))),E.__simulatedMouseupNode=E.__simulatedMousedownNode=null,E.$lastMouseupTime=_now,!0},stopPageTouchmove:function(){xui.Event._addEventListener(document,xui.browser.ie&&xui.browser.ver>=11?"pointermove":xui.browser.ie&&xui.browser.ver>=10?"MSPointerMove":"touchmove",xui.Event.stopDefault)},allowPageTouchmove:function(){xui.Event._removeEventListener(document,xui.browser.ie&&xui.browser.ver>=11?"pointermove":xui.browser.ie&&xui.browser.ver>=10?"MSPointerMove":"touchmove",xui.Event.stopDefault)}},Initialize:function(){var t1,t2,s,ns=this,w=window,d=document,m1={move:null,size:null,drag:null,dragstop:null,dragover:null,mousewheel:null,dragbegin:"onmousedown",dragenter:"onmouseover",dragleave:"onmouseout",drop:"onmouseup"},a1=["before","on","after"];t1=ns._map1={},xui.arr.each(ns._events,(function(o){s=xui.str.initial(o),t1[o]=[a1[0]+s,a1[1]+s,a1[2]+s]})),t1=ns._eventMap={},t2=ns._eventHandler={},xui.arr.each(ns._events,(function(o){s=xui.str.initial(o),t1[o]=t1[a1[1]+o]=t1[a1[0]+s]=t1[a1[1]+s]=t1[a1[2]+s]=o,t2[o]=t2[a1[1]+o]=t2[a1[0]+s]=t2[a1[1]+s]=t2[a1[2]+s]=o in m1?m1[o]:"on"+o})),ns._addEventListener(w,"resize",ns.$eventhandler),ns._addEventListener(w,"DOMMouseScroll",ns.$eventhandler3),xui.browser.isTouch&&(ns._addEventListener(d,xui.browser.ie&&xui.browser.ver>=11?"pointerdown":xui.browser.ie&&xui.browser.ver>=10?"MSPointerDown":"touchstart",ns._simulateMousedown),ns._addEventListener(d,xui.browser.ie&&xui.browser.ver>=11?"pointerup":xui.browser.ie&&xui.browser.ver>=10?"MSPointerUp":"touchend",ns._simulateMouseup),ns._addEventListener(d,"xuitouchdown",ns.$eventhandler)),ns._addEventListener(w,"mousewheel",ns.$eventhandler3);var keyEvent=function(target,type,options){switch(type){case"textevent":type="keypress"}xui.merge(options,{bubbles:!0,cancelable:!0,view:w,ctrlKey:!1,altKey:!1,shiftKey:!1,metaKey:!1,keyCode:0,charCode:0},"without");var bubbles=options.bubbles,cancelable=options.cancelable,view=options.view,ctrlKey=options.ctrlKey,altKey=options.altKey,shiftKey=options.shiftKey,metaKey=options.metaKey,keyCode=options.keyCode,charCode=options.charCode,customEvent=null;if(d.createEvent){try{(customEvent=d.createEvent("KeyEvents")).initKeyEvent(type,bubbles,cancelable,view,ctrlKey,altKey,shiftKey,metaKey,keyCode,charCode)}catch(ex){try{customEvent=d.createEvent("Events")}catch(uierror){customEvent=d.createEvent("UIEvents")}finally{customEvent.initEvent(type,bubbles,cancelable),customEvent.view=view,customEvent.altKey=altKey,customEvent.ctrlKey=ctrlKey,customEvent.shiftKey=shiftKey,customEvent.metaKey=metaKey,customEvent.keyCode=keyCode,customEvent.charCode=charCode}}target.dispatchEvent(customEvent)}else{if(!d.createEventObject)throw type+" cant be simulated in "+navigator.userAgent;(customEvent=d.createEventObject()).bubbles=bubbles,customEvent.cancelable=cancelable,customEvent.view=view,customEvent.ctrlKey=ctrlKey,customEvent.altKey=altKey,customEvent.shiftKey=shiftKey,customEvent.metaKey=metaKey,customEvent.keyCode=charCode>0?charCode:keyCode,target.fireEvent("on"+type,customEvent)}},mouseEvent=function(target,type,options){options=options||{},xui.merge(options,{bubbles:!0,cancelable:!0,view:w,detail:1,ctrlKey:!1,altKey:!1,shiftKey:!1,metaKey:!1,screenX:0,screenY:0,clientX:0,clientY:0,button:0,relatedTarget:null},"without");var bubbles=options.bubbles,cancelable=options.cancelable,view=options.view,detail=options.detail,ctrlKey=options.ctrlKey,altKey=options.altKey,shiftKey=options.shiftKey,metaKey=options.metaKey,screenX=options.screenX,screenY=options.screenY,clientX=options.clientX,clientY=options.clientY,button=options.button,relatedTarget=options.relatedTarget,customEvent=null;if(d.createEvent)(customEvent=d.createEvent("MouseEvents")).initMouseEvent?customEvent.initMouseEvent(type,bubbles,cancelable,view,detail,screenX,screenY,clientX,clientY,ctrlKey,altKey,shiftKey,metaKey,button,relatedTarget):((customEvent=d.createEvent("UIEvents")).initEvent(type,bubbles,cancelable),customEvent.view=view,customEvent.detail=detail,customEvent.screenX=screenX,customEvent.screenY=screenY,customEvent.clientX=clientX,customEvent.clientY=clientY,customEvent.ctrlKey=ctrlKey,customEvent.altKey=altKey,customEvent.metaKey=metaKey,customEvent.shiftKey=shiftKey,customEvent.button=button,customEvent.relatedTarget=relatedTarget),relatedTarget&&!customEvent.relatedTarget&&("mouseout"===type?customEvent.toElement=relatedTarget:"mouseover"===type&&(customEvent.fromElement=relatedTarget)),target.dispatchEvent(customEvent);else{if(!d.createEventObject)throw type+" cant be simulated in "+navigator.userAgent;switch((customEvent=d.createEventObject()).bubbles=bubbles,customEvent.cancelable=cancelable,customEvent.view=view,customEvent.detail=detail,customEvent.screenX=screenX,customEvent.screenY=screenY,customEvent.clientX=clientX,customEvent.clientY=clientY,customEvent.ctrlKey=ctrlKey,customEvent.altKey=altKey,customEvent.metaKey=metaKey,customEvent.shiftKey=shiftKey,button){case 0:customEvent.button=1;break;case 1:customEvent.button=4;break;case 2:break;default:customEvent.button=0}customEvent.relatedTarget=relatedTarget,target.fireEvent("on"+type,customEvent)}},UIEvent=function(target,type,options){xui.merge(options,{bubbles:!0,cancelable:"submit"===type,view:w,detail:1},"without");var bubbles=options.bubbles,cancelable=options.cancelable,view=options.view,detail=options.detail,customEvent=null;if(d.createEvent)(customEvent=d.createEvent("UIEvents")).initUIEvent(type,bubbles,cancelable,view,detail),target.dispatchEvent(customEvent);else{if(!d.createEventObject)throw type+" cant be simulated in "+navigator.userAgent;(customEvent=d.createEventObject()).bubbles=bubbles,customEvent.cancelable=cancelable,customEvent.view=view,customEvent.detail=detail,target.fireEvent("on"+type,customEvent)}},gestureEvent=function(target,type,options){xui.merge(options,{bubbles:!0,cancelable:!0,detail:2,view:w,ctrlKey:!1,altKey:!1,shiftKey:!1,metaKey:!1,scale:1,rotation:0},"without");var customEvent,bubbles=options.bubbles,cancelable=options.cancelable,detail=options.detail,view=options.view,screenX=options.screenX,screenY=options.screenY,clientX=options.clientX,clientY=options.clientY,ctrlKey=options.ctrlKey,altKey=options.altKey,shiftKey=options.shiftKey,metaKey=options.metaKey,scale=options.scale,rotation=options.rotation;(customEvent=d.createEvent("GestureEvent")).initGestureEvent(type,bubbles,cancelable,view,detail,screenX,screenY,clientX,clientY,ctrlKey,altKey,shiftKey,metaKey,target,scale,rotation),target.dispatchEvent(customEvent)},touchEvent=function(target,type,options){if("touchstart"===type||"touchmove"===type){if(!options.touches||!options.touches.length)throw new Error("No touch object in touches.")}else if(!("touchend"!==type||options.changedTouches&&options.changedTouches.length))throw new Error("No touch object in changedTouches.");xui.merge(options,{bubbles:!0,cancelable:"touchcancel"!==type,detail:1,view:w,ctrlKey:!1,altKey:!1,shiftKey:!1,metaKey:!1,screenX:0,screenY:0,clientX:0,clientY:0,scale:1,rotation:0},"without");var customEvent,bubbles=options.bubbles,detail=options.detail,view=options.view,scale=options.scale,rotation=options.rotation,touches=options.touches,targetTouches=options.targetTouches,changedTouches=options.changedTouches,ctrlKey=options.ctrlKey,altKey=options.altKey,shiftKey=options.shiftKey,metaKey=options.metaKey,screenX=options.screenX,screenY=options.screenY,clientX=options.clientX,clientY=options.clientY,cancelable="touchcancel"!=type&&options.cancelable;if(!d.createEvent)throw type+" cant be simulated in "+navigator.userAgent;if(xui.browser.isAndroid)xui.browser.ver<4?((customEvent=d.createEvent("MouseEvents")).initMouseEvent(type,bubbles,cancelable,view,detail,screenX,screenY,clientX,clientY,ctrlKey,altKey,shiftKey,metaKey,0,target),customEvent.touches=touches,customEvent.targetTouches=targetTouches,customEvent.changedTouches=changedTouches):(customEvent=d.createEvent("TouchEvent")).initTouchEvent(touches,targetTouches,changedTouches,type,view,screenX,screenY,clientX,clientY,ctrlKey,altKey,shiftKey,metaKey);else{if(!xui.browser.isIOS)throw type+" cant be simulated in "+navigator.userAgent;if(!(xui.browser.ver>=2))throw type+" cant be simulated in "+navigator.userAgent;(customEvent=d.createEvent("TouchEvent")).initTouchEvent(type,bubbles,cancelable,view,detail,screenX,screenY,clientX,clientY,ctrlKey,altKey,shiftKey,metaKey,touches,targetTouches,changedTouches,scale,rotation)}target.dispatchEvent(customEvent)};ns.$eventsforSimulation={click:mouseEvent,dblclick:mouseEvent,mouseover:mouseEvent,mouseout:mouseEvent,mouseenter:mouseEvent,mouseleave:mouseEvent,mousedown:mouseEvent,mouseup:mouseEvent,mousemove:mouseEvent,pointerover:mouseEvent,pointerout:mouseEvent,pointerdown:mouseEvent,pointerup:mouseEvent,pointermove:mouseEvent,MSPointerOver:mouseEvent,MSPointerOut:mouseEvent,MSPointerDown:mouseEvent,MSPointerUp:mouseEvent,MSPointerMove:mouseEvent,keydown:keyEvent,keyup:keyEvent,keypress:keyEvent,submit:UIEvent,blur:UIEvent,change:UIEvent,focus:UIEvent,resize:UIEvent,scroll:UIEvent,select:UIEvent,touchstart:touchEvent,touchmove:touchEvent,touchend:touchEvent,touchcancel:touchEvent,gesturestart:gestureEvent,gesturechange:gestureEvent,gestureend:gestureEvent}}}),xui.Class("xui.Date",null,{Initialize:function(){this._mapKeys(this.$TIMEUNIT);for(var a=this._key1,b=this._key2,u=this.$UNIT={},i=0,l=a.length;i<l;i++)u[a[i]]=1;for(i=0,l=b.length;i<l;i++)u[b[i]]=1;u.w=1},Static:{_key1:"MILLISECOND,SECOND,MINUTE,HOUR,DAY,WEEK,MONTH,QUARTER,YEAR,DECADE,CENTURY".split(","),_key2:"ms,s,n,h,d,ww,m,q,y,de,c".split(","),$TIMEUNIT:{MILLISECOND:1,SECOND:1e3,MINUTE:6e4,HOUR:36e5,DAY:864e5,WEEK:6048e5,MONTH:2592e6,QUARTER:7776e6,YEAR:315576e5,DECADE:315576e6,CENTURY:315576e7},$TEXTFORMAT:{utciso:function(d,w,f){return f=xui.Date._fix,d.getUTCFullYear()+"-"+f(d.getUTCMonth()+1)+"-"+f(d.getUTCDate())+"T"+f(d.getUTCHours())+":"+f(d.getUTCMinutes())+":"+f(d.getUTCSeconds())+"Z"},iso:function(d,w,f){return f=xui.Date._fix,d.getFullYear()+"-"+f(d.getMonth()+1)+"-"+f(d.getDate())+"T"+f(d.getHours())+":"+f(d.getMinutes())+":"+f(d.getSeconds())},ms:function(d,w){return xui.Date._fix(d.getMilliseconds(),3)+(w?"":xui.wrapRes("date.MS"))},s:function(d,w){return d.getSeconds()+(w?"":xui.wrapRes("date.S"))},ss:function(d,w){return xui.Date._fix(d.getSeconds())+(w?"":xui.wrapRes("date.S"))},n:function(d,w){return d.getMinutes()+(w?"":xui.wrapRes("date.N"))},nn:function(d,w){return xui.Date._fix(d.getMinutes())+(w?"":xui.wrapRes("date.N"))},h:function(d,w){return d.getHours()+(w?"":xui.wrapRes("date.H"))},hh:function(d,w){return xui.Date._fix(d.getHours())+(w?"":xui.wrapRes("date.H"))},d:function(d,w){return d.getDate()+(w?"":xui.wrapRes("date.D"))},dd:function(d,w){return xui.Date._fix(d.getDate())+(w?"":xui.wrapRes("date.D"))},w:function(d,w,firstDayOfWeek){var a=(d.getDay()-firstDayOfWeek+7)%7;return w?a:xui.wrapRes("date.WEEKS."+a)},ww:function(d,w,firstDayOfWeek){return xui.Date.getWeek(d,firstDayOfWeek)+(w?"":xui.wrapRes("date.W"))},m:function(d,w){return d.getMonth()+1+(w?"":xui.wrapRes("date.M"))},mm:function(d,w){return xui.Date._fix(d.getMonth()+1)+(w?"":xui.wrapRes("date.M"))},q:function(d,w){return parseInt((d.getMonth()+3)/3-1,10)+1+(w?"":xui.wrapRes("date.Q"))},y:function(d,w){return d.getYear()+(w?"":xui.wrapRes("date.Y"))},yyyy:function(d,w){return d.getFullYear()+(w?"":xui.wrapRes("date.Y"))},de:function(d,w){return parseInt(d.getFullYear()/10,10)+(w?"":xui.wrapRes("date.DE"))},c:function(d,w){return parseInt(d.getFullYear()/100,10)+(w?"":xui.wrapRes("date.C"))},hn:function(d,w){return xui.wrapRes("date.HN-"+d.getHours()+"-"+d.getMinutes())},dhn:function(d,w){return xui.wrapRes("date.DHN-"+d.getDate()+"-"+d.getHours()+"-"+d.getMinutes())},mdhn:function(d,w){return xui.wrapRes("date.MDHN-"+(d.getMonth()+1)+"-"+d.getDate()+"-"+d.getHours()+"-"+d.getMinutes())},hns:function(d,w){return xui.wrapRes("date.HNS-"+d.getHours()+"-"+d.getMinutes()+"-"+d.getSeconds())},hnsms:function(d,w){return xui.wrapRes("date.HNSMS-"+d.getHours()+"-"+d.getMinutes()+"-"+d.getSeconds()+"-"+d.getMilliseconds())},yq:function(d,w){return xui.wrapRes("date.YQ-"+d.getFullYear()+"-"+(parseInt((d.getMonth()+3)/3-1,10)+1))},ym:function(d,w){return xui.wrapRes("date.YM-"+d.getFullYear()+"-"+(d.getMonth()+1))},md:function(d,w){return xui.wrapRes("date.MD-"+(d.getMonth()+1)+"-"+d.getDate())},ymd:function(d,w){return xui.wrapRes("date.YMD-"+d.getFullYear()+"-"+(d.getMonth()+1)+"-"+d.getDate())},ymd2:function(d,w){return xui.wrapRes("date.YMD2-"+d.getFullYear()+"-"+(d.getMonth()+1)+"-"+d.getDate())},ymdh:function(d,w){return xui.wrapRes("date.YMDH-"+d.getFullYear()+"-"+(d.getMonth()+1)+"-"+d.getDate()+"-"+d.getHours())},ymdhn:function(d,w){return xui.wrapRes("date.YMDHN-"+d.getFullYear()+"-"+(d.getMonth()+1)+"-"+d.getDate()+"-"+d.getHours()+"-"+d.getMinutes())},ymdhns:function(d,w){return xui.wrapRes("date.YMDHNS-"+d.getFullYear()+"-"+(d.getMonth()+1)+"-"+d.getDate()+"-"+d.getHours()+"-"+d.getMinutes()+"-"+d.getSeconds())},all:function(d,w){return xui.wrapRes("date.ALL-"+d.getFullYear()+"-"+(d.getMonth()+1)+"-"+d.getDate()+"-"+d.getHours()+"-"+d.getMinutes()+"-"+d.getSeconds()+"-"+d.getMilliseconds())}},$TIMEZONE:[{id:"Asia(East,North)",sub:[{id:"Brunei",v:"+0800"},{id:"Burma",v:"+0630"},{id:"Cambodia",v:"+0700"},{id:"China",v:"+0800"},{id:"China(HK,Macau)",v:"+0800"},{id:"China(TaiWan)",v:"+0800"},{id:"China(Urumchi)",v:"+0700"},{id:"East Timor",v:"+0800"},{id:"Indonesia",v:"+0700"},{id:"Japan",v:"+0900"},{id:"Kazakhstan(Aqtau)",v:"+0400"},{id:"Kazakhstan(Aqtobe)",v:"+0500"},{id:"Kazakhstan(Astana)",v:"+0600"},{id:"Kirghizia",v:"+0500"},{id:"Korea",v:"+0900"},{id:"Laos",v:"+0700"},{id:"Malaysia",v:"+0800"},{id:"Mongolia",v:"+0800",tag:"03L03|09L03"},{id:"Philippines",v:"+0800"},{id:"Russia(Anadyr)",v:"+1300",tag:"03L03|10L03"},{id:"Russia(Kamchatka)",v:"+1200",tag:"03L03|10L03"},{id:"Russia(Magadan)",v:"+1100",tag:"03L03|10L03"},{id:"Russia(Vladivostok)",v:"+1000",tag:"03L03|10L03"},{id:"Russia(Yakutsk)",v:"+0900",tag:"03L03|10L03"},{id:"Singapore",v:"+0800"},{id:"Thailand",v:"+0700"},{id:"Vietnam",v:"+0700"}]},{id:"Asia(South,West)",sub:[{id:"Afghanistan",v:"+0430"},{id:"Arab Emirates",v:"+0400"},{id:"Bahrain",v:"+0300"},{id:"Bangladesh",v:"+0600"},{id:"Bhutan",v:"+0600"},{id:"Cyprus",v:"+0200"},{id:"Georgia",v:"+0500"},{id:"India",v:"+0530"},{id:"Iran",v:"+0330",tag:"04 13|10 13"},{id:"Iraq",v:"+0300",tag:"04 13|10 13"},{id:"Israel",v:"+0200",tag:"04F53|09F53"},{id:"Jordan",v:"+0200"},{id:"Kuwait",v:"+0300"},{id:"Lebanon",v:"+0200",tag:"03L03|10L03"},{id:"Maldives",v:"+0500"},{id:"Nepal",v:"+0545"},{id:"Oman",v:"+0400"},{id:"Pakistan",v:"+0500"},{id:"Palestine",v:"+0200"},{id:"Qatar",v:"+0300"},{id:"Saudi Arabia",v:"+0300"},{id:"Sri Lanka",v:"+0600"},{id:"Syria",v:"+0200",tag:"04 13|10 13"},{id:"Tajikistan",v:"+0500"},{id:"Turkey",v:"+0200"},{id:"Turkmenistan",v:"+0500"},{id:"Uzbekistan",v:"+0500"},{id:"Yemen",v:"+0300"}]},{id:"North Europe",sub:[{id:"Denmark",v:"+0100",tag:"04F03|10L03"},{id:"Faroe Is.(DK)",v:"+0100"},{id:"Finland",v:"+0200",tag:"03L01|10L01"},{id:"Iceland",v:"+0000"},{id:"Jan Mayen(Norway)",v:"-0100"},{id:"Norwegian",v:"+0100"},{id:"Svalbard(NORWAY)",v:"+0100"},{id:"Sweden",v:"+0100",tag:"03L01|10L01"}]},{id:"Eastern Europe",sub:[{id:"Armenia",v:"+0400"},{id:"Austria",v:"+0100",tag:"03L01|10L01"},{id:"Azerbaijan",v:"+0400"},{id:"Belarus",v:"+0200",tag:"03L03|10L03"},{id:"Czech",v:"+0100"},{id:"Estonia",v:"+0200"},{id:"Georgia",v:"+0500"},{id:"Germany",v:"+0100",tag:"03L01|10L01"},{id:"Hungarian",v:"+0100"},{id:"Latvia",v:"+0200"},{id:"Liechtenstein",v:"+0100"},{id:"Lithuania",v:"+0200"},{id:"Moldova",v:"+0200"},{id:"Poland",v:"+0100"},{id:"Rumania",v:"+0200"},{id:"Russia(Moscow)",v:"+0300",tag:"03L03|10L03"},{id:"Slovakia",v:"+0100"},{id:"Switzerland",v:"+0100",tag:"03L01|10L01"},{id:"Ukraine",v:"+0200"},{id:"Ukraine(Simferopol)",v:"+0300"}]},{id:"Western Europe",sub:[{id:"Andorra",v:"+0100",tag:"03L01|10L01"},{id:"Belgium",v:"+0100",tag:"03L01|10L01"},{id:"Channel Is.(UK)",v:"+0000",tag:"03L01|10L01"},{id:"France",v:"+0100",tag:"03L01|10L01"},{id:"Gibraltar(UK)",v:"+0100",tag:"03L01|10L01"},{id:"Ireland",v:"+0000",tag:"03L01|10L01"},{id:"Isle of Man(UK)",v:"+0000",tag:"03L01|10L01"},{id:"Luxembourg",v:"+0100",tag:"03L01|10L01"},{id:"Monaco",v:"+0100"},{id:"Netherlands",v:"+0100",tag:"03L01|10L01"},{id:"United Kingdom",v:"+0000",tag:"03L01|10L01"}]},{id:"South Europe",sub:[{id:"Albania",v:"+0100"},{id:"Bosnia",v:"+0100"},{id:"Bulgaria",v:"+0200"},{id:"Croatia",v:"+0100"},{id:"Greece",v:"+0200",tag:"03L01|10L01"},{id:"Holy See",v:"+0100"},{id:"Italy",v:"+0100",tag:"03L01|10L01"},{id:"Macedonia",v:"+0100"},{id:"Malta",v:"+0100"},{id:"Montenegro",v:"+0100"},{id:"Portugal",v:"+0000",tag:"03L01|10L01"},{id:"San Marino",v:"+0100"},{id:"Serbia",v:"+0100"},{id:"Slovenia",v:"+0100"},{id:"Span",v:"+0100",tag:"03L01|10L01"}]},{id:"North America",sub:[{id:"Canada(AST)",v:"-0400",tag:"04F02|10L02"},{id:"Canada(CST)",v:"-0600",tag:"04F02|10L02"},{id:"Canada(EST)",v:"-0500",tag:"04F02|10L02"},{id:"Canada(MST)",v:"-0700",tag:"04F02|10L02"},{id:"Canada(NST)",v:"-0330",tag:"04F02|10L02"},{id:"Canada(PST)",v:"-0800",tag:"04F02|10L02"},{id:"Greenland(DK)",v:"-0300"},{id:"US(Central)",v:"-0600",tag:"03S02|11F02"},{id:"US(Eastern)",v:"-0500",tag:"03S02|11F02"},{id:"US(Mountain)",v:"-0700",tag:"03S02|11F02"},{id:"US(Pacific)",v:"-0800",tag:"03S02|11F02"},{id:"US(Alaska)",v:"-0900"},{id:"US(Arizona)",v:"-0700"}]},{id:"South America",sub:[{id:"Anguilla(UK)",v:"-0400"},{id:"Antigua&amp;Barbuda",v:"-0400"},{id:"Antilles(NL)",v:"-0400"},{id:"Argentina",v:"-0300"},{id:"Aruba(NL)",v:"-0400"},{id:"Bahamas",v:"-0500"},{id:"Barbados",v:"-0400"},{id:"Belize",v:"-0600"},{id:"Bolivia",v:"-0400"},{id:"Brazil(AST)",v:"-0500",tag:"10F03|02L03"},{id:"Brazil(EST)",v:"-0300",tag:"10F03|02L03"},{id:"Brazil(FST)",v:"-0200",tag:"10F03|02L03"},{id:"Brazil(WST)",v:"-0400",tag:"10F03|02L03"},{id:"British Virgin Is.(UK)",v:"-0400"},{id:"Cayman Is.(UK)",v:"-0500"},{id:"Chilean",v:"-0300",tag:"10F03|03F03"},{id:"Chilean(Hanga Roa)",v:"-0500",tag:"10F03|03F03"},{id:"Colombia",v:"-0500"},{id:"Costa Rica",v:"-0600"},{id:"Cuba",v:"-0500",tag:"04 13|10L03"},{id:"Dominican",v:"-0400"},{id:"Ecuador",v:"-0500"},{id:"El Salvador",v:"-0600"},{id:"Falklands",v:"-0300",tag:"09F03|04F03"},{id:"Grenada",v:"-0400"},{id:"Guadeloupe(FR)",v:"-0400"},{id:"Guatemala",v:"-0600"},{id:"Guiana(FR)",v:"-0300"},{id:"Guyana",v:"-0400"},{id:"Haiti",v:"-0500"},{id:"Honduras",v:"-0600"},{id:"Jamaica",v:"-0500"},{id:"Martinique(FR)",v:"-0400"},{id:"Mexico(Mazatlan)",v:"-0700"},{id:"Mexico(Tijuana)",v:"-0800"},{id:"Mexico(Mexico)",v:"-0600"},{id:"Montserrat(UK)",v:"-0400"},{id:"Nicaragua",v:"-0500"},{id:"Panama",v:"-0500"},{id:"Paraguay",v:"-0400",tag:"10F03|02L03"},{id:"Peru",v:"-0500"},{id:"Puerto Rico(US)",v:"-0400"},{id:"So. Georgia&amp;So. Sandwich Is.(UK)",v:"-0200"},{id:"St. Kitts&amp;Nevis",v:"-0400"},{id:"St. Lucia",v:"-0400"},{id:"St. Vincent&amp;Grenadines",v:"-0400"},{id:"Suriname",v:"-0300"},{id:"Trinidad&amp;Tobago",v:"-0400"},{id:"Turks&amp;Caicos Is.(UK)",v:"-0500"},{id:"Uruguay",v:"-0300"},{id:"Venezuela",v:"-0400"},{id:"Virgin Is.(US)",v:"-0400"}]},{id:"Africa(North)",sub:[{id:"Algeria",v:"+0100"},{id:"Egypt",v:"+0200",tag:"04L53|09L43"},{id:"Libyan",v:"+0200"},{id:"Morocco",v:"+0000"},{id:"Sudan",v:"+0200"},{id:"Tunisia",v:"+0100"}]},{id:"Africa(Western)",sub:[{id:"Benin",v:"+0100"},{id:"Burkina Faso",v:"+0000"},{id:"Canary Is.(SP)",v:"-0100"},{id:"Cape Verde",v:"-0100"},{id:"Chad",v:"+0100"},{id:"Gambia",v:"+0000"},{id:"Ghana",v:"+0000"},{id:"Guinea",v:"+0000"},{id:"Guinea-Bissau",v:"+0000"},{id:"Ivory Coast",v:"+0000"},{id:"Liberia",v:"+0000"},{id:"Mali",v:"+0000"},{id:"Mauritania",v:"+0000"},{id:"Niger",v:"+0100"},{id:"Nigeria",v:"+0100"},{id:"Senegal",v:"+0000"},{id:"Sierra Leone",v:"+0000"},{id:"Togo",v:"+0000"},{id:"Western Sahara",v:"+0000"}]},{id:"Africa(Central)",sub:[{id:"Cameroon",v:"+0100"},{id:"Cen.African Rep.",v:"+0100"},{id:"Congo,Democratic",v:"+0100"},{id:"Congo,Republic",v:"+0100"},{id:"Equatorial Guinea",v:"+0100"},{id:"Gabon",v:"+0100"},{id:"Sao Tome&amp;Principe",v:"+0000"}]},{id:"Africa(East)",sub:[{id:"Burundi",v:"+0200"},{id:"Comoros",v:"+0300"},{id:"Djibouti",v:"+0300"},{id:"Eritrea",v:"+0300"},{id:"Ethiopia",v:"+0300"},{id:"Kenya",v:"+0300"},{id:"Madagascar",v:"+0300"},{id:"Malawi",v:"+0200"},{id:"Mauritius",v:"+0400"},{id:"Mayotte(FR)",v:"+0300"},{id:"Mozambique",v:"+0200"},{id:"Reunion(FR)",v:"+0400"},{id:"Rwanda",v:"+0200"},{id:"Seychelles",v:"+0300"},{id:"Somalia",v:"+0300"},{id:"Tanzania",v:"+0300"},{id:"Uganda",v:"+0300"}]},{id:"Africa(South)",sub:[{id:"Angola",v:"+0100"},{id:"Botswana",v:"+0200"},{id:"Lesotho",v:"+0200"},{id:"Namibia",v:"+0200",tag:"09F03|04F03"},{id:"Saint Helena(UK)",v:"-0100"},{id:"South Africa",v:"+0200"},{id:"Swaziland",v:"+0200"},{id:"Zambia",v:"+0200"},{id:"Zimbabwe",v:"+0200"}]},{id:"Oceania",sub:[{id:"American Samoa(US)",v:"-1100"},{id:"Australia(Adelaide)",v:"+0930",sub:"10L03|03L03"},{id:"Australia(Brisbane)",v:"+1000"},{id:"Australia(Darwin)",v:"+0930"},{id:"Australia(Hobart)",v:"+1000",sub:"10L03|03L03"},{id:"Australia(Perth)",v:"+0800"},{id:"Australia(Sydney)",v:"+1000",sub:"10L03|03L03"},{id:"Cook Islands(NZ)",v:"-1000"},{id:"Eniwetok",v:"-1200"},{id:"Fiji",v:"+1200",sub:"11F03|02L03"},{id:"Guam",v:"+1000"},{id:"Hawaii(US)",v:"-1000"},{id:"Kiribati",v:"+1100"},{id:"Marshall Is.",v:"+1200"},{id:"Micronesia",v:"+1000"},{id:"Midway Is.(US)",v:"-1100"},{id:"Nauru Rep.",v:"+1200"},{id:"New Calednia(FR)",v:"+1100"},{id:"New Zealand",v:"+1200",sub:"10F03|04F63"},{id:"New Zealand(CHADT)",v:"+1245",sub:"10F03|04F63"},{id:"Niue(NZ)",v:"-1100"},{id:"Nor. Mariana Is.",v:"+1000"},{id:"Palau",v:"+0900"},{id:"Papua New Guinea",v:"+1000"},{id:"Pitcairn Is.(UK)",v:"-0830"},{id:"Polynesia(FR)",v:"-1000"},{id:"Solomon Is.",v:"+1100"},{id:"Tahiti",v:"-1000"},{id:"Tokelau(NZ)",v:"-1100"},{id:"Tonga",v:"+1300",tag:"10F63|04F63"},{id:"Tuvalu",v:"+1200"},{id:"Vanuatu",v:"+1100"},{id:"Western Samoa",v:"-1100"},{id:"Data Line",v:"-1200"}]}],_mapKeys:function(obj){for(var t=this._key2,m=this._key1,i=0,l=m.length;i<l;i++)obj[t[i]]=obj[m[i]]},_validUnit:function(datepart){return this.$UNIT[datepart]?datepart:"d"},_date:function(value,df){return xui.isDate(value)?value:(value||0===value)&&isFinite(value)?new Date(parseInt(value,10)):xui.isDate(df)?df:new Date},_isNumb:function(target){return"number"==typeof target&&isFinite(target)},_numb:function(value,df){return this._isNumb(value)?value:this._isNumb(df)?df:0},_timeZone:-(new Date).getTimezoneOffset()/60,isDayLightTime:function(date){var start=this.getTimSpanStart(date,"y"),middle=new Date(start.getTime());return middle.setMonth(6),middle.getTimezoneOffset()-start.getTimezoneOffset()!=0&&date.getTimezoneOffset()==(date.getTimezoneOffset()<0?start:middle).getTimezoneOffset()},get:function(date,datepart,firstDayOfWeek){var self=this;date=self._date(date),datepart=self._validUnit(datepart),firstDayOfWeek=self._numb(firstDayOfWeek);var map=arguments.callee.map||(arguments.callee.map={ms:function(d){return d.getMilliseconds()},s:function(d){return d.getSeconds()},n:function(d){return d.getMinutes()},h:function(d){return d.getHours()},d:function(d){return d.getDate()},ww:function(d,fd){return xui.Date.getWeek(d,fd)},w:function(d,fd){return(7+d.getDay()-fd)%7},m:function(d){return d.getMonth()},q:function(d){return parseInt((d.getMonth()+3)/3-1,10)},y:function(d){return d.getFullYear()},de:function(d){return parseInt(d.getFullYear()/10,10)},c:function(d){return parseInt(d.getFullYear()/100,10)}});return map[datepart](date,firstDayOfWeek)},_fix:function(str,len,chr){if(chr=chr||"0",(str+="").length<(len=len||2))for(var i=str.length;i<len;i++)str=chr+str;return str},add:function(date,datepart,count){var map,date2,self=this,tu=self.$TIMEUNIT;return date=self._date(date),datepart=self._validUnit(datepart),(map=arguments.callee.map)||(map=arguments.callee.map={MILLISECOND:function(date,count){date.setTime(date.getTime()+count*tu.ms)},SECOND:function(date,count){date.setTime(date.getTime()+count*tu.s)},MINUTE:function(date,count){date.setTime(date.getTime()+count*tu.n)},HOUR:function(date,count){date.setTime(date.getTime()+count*tu.h)},DAY:function(date,count){date.setDate(date.getDate()+count)},WEEK:function(date,count){date.setDate(date.getDate()+7*count)},MONTH:function(date,count){var b,a=date.getDate();count=date.getMonth()+count,this.YEAR(date,Math.floor(count/12)),date.setMonth((count%12+12)%12),(b=date.getDate())!=a&&this.DAY(date,-b)},QUARTER:function(date,count){this.MONTH(date,3*count)},YEAR:function(date,count){var b,a=date.getDate();date.setFullYear(date.getFullYear()+count),(b=date.getDate())!=a&&this.DAY(date,-b)},DECADE:function(date,count){this.YEAR(date,10*count)},CENTURY:function(date,count){this.YEAR(date,100*count)}},self._mapKeys(map)),map[datepart](date2=new Date(date),count),date2},diff:function(startdate,enddate,datepart,firstDayOfWeek){var self=this;startdate=self._date(startdate),enddate=self._date(enddate),datepart=self._validUnit(datepart),firstDayOfWeek=self._numb(firstDayOfWeek);var map,tu=self.$TIMEUNIT;return(map=arguments.callee.map)||(map=arguments.callee.map={MILLISECOND:function(startdate,enddate){return enddate.getTime()-startdate.getTime()},SECOND:function(startdate,enddate){return startdate=self.getTimSpanStart(startdate,"s"),((enddate=self.getTimSpanStart(enddate,"s")).getTime()-startdate.getTime())/tu.s},MINUTE:function(startdate,enddate){return startdate=self.getTimSpanStart(startdate,"n"),((enddate=self.getTimSpanStart(enddate,"n")).getTime()-startdate.getTime())/tu.n},HOUR:function(startdate,enddate){return startdate=self.getTimSpanStart(startdate,"h"),((enddate=self.getTimSpanStart(enddate,"h")).getTime()-startdate.getTime())/tu.h},DAY:function(startdate,enddate){return startdate=self.getTimSpanStart(startdate,"d",1),enddate=self.getTimSpanStart(enddate,"d",1),Math.floor((enddate.getTime()-startdate.getTime())/tu.d)},WEEK:function(startdate,enddate,firstDayOfWeek){return startdate=self.getTimSpanStart(startdate,"ww",1,firstDayOfWeek),enddate=self.getTimSpanStart(enddate,"ww",1,firstDayOfWeek),Math.floor((enddate.getTime()-startdate.getTime())/tu.ww)},MONTH:function(startdate,enddate){return 12*(enddate.getFullYear()-startdate.getFullYear())+(enddate.getMonth()-startdate.getMonth())},QUARTER:function(startdate,enddate){return 4*(enddate.getFullYear()-startdate.getFullYear())+parseInt((enddate.getMonth()-startdate.getMonth())/3,10)},YEAR:function(startdate,enddate){return parseInt(enddate.getFullYear()-startdate.getFullYear(),10)},DECADE:function(startdate,enddate){return parseInt((enddate.getFullYear()-startdate.getFullYear())/10,10)},CENTURY:function(startdate,enddate){return parseInt((enddate.getFullYear()-startdate.getFullYear())/100,10)}},self._mapKeys(map)),map[datepart](new Date(startdate),new Date(enddate),firstDayOfWeek)},getTimSpanStart:function(date,datepart,count,firstDayOfWeek){var map,date2,self=this,tu=self.$TIMEUNIT;if(date=self._date(date),datepart=self._validUnit(datepart),firstDayOfWeek=self._numb(firstDayOfWeek),count=self._numb(count,1),!(map=arguments.callee.map)){var clearInDay=function(d){d.setMilliseconds(0),d.setSeconds(0),d.setMinutes(0),d.setHours(0)},clearInYear=function(d){clearInDay(d),d.setDate(1),d.setMonth(0)};map=arguments.callee.map={MILLISECOND:function(date,count){var x=date.getMilliseconds();date.setMilliseconds(x-x%count)},SECOND:function(date,count){date.setMilliseconds(0);var x=date.getSeconds();date.setSeconds(x-x%count)},MINUTE:function(date,count){date.setMilliseconds(0),date.setSeconds(0);var x=date.getMinutes();date.setTime(date.getTime()-x%count*tu.n)},HOUR:function(date,count){date.setMilliseconds(0),date.setSeconds(0),date.setMinutes(0);var x=date.getHours();date.setHours(x-x%count)},DAY:function(date,count){clearInDay(date);var x=date.getDate();date.setDate(x-x%count)},WEEK:function(date,count,firstDayOfWeek){clearInDay(date);var d=(date.getDay()+7-firstDayOfWeek)%7;date.setDate(date.getDate()-d-7*(count-1))},MONTH:function(date,count){clearInDay(date),date.setDate(1);var x=date.getMonth();date.setMonth(x-x%count)},QUARTER:function(date,count){return count=self._numb(count,1),this.MONTH(date,3*count)},YEAR:function(date,count){clearInYear(date);var x=date.getFullYear();date.setFullYear(x-x%count)},DECADE:function(date,count){clearInYear(date),date.setFullYear(10*Math.floor(date.getFullYear()/10))},CENTURY:function(date,count){clearInYear(date),date.setFullYear(100*Math.floor(date.getFullYear()/100))}},self._mapKeys(map)}return map[datepart](date2=new Date(date),count,firstDayOfWeek),date2},getTimSpanEnd:function(date,datepart,count,firstDayOfWeek){date=this._date(date),datepart=this._validUnit(datepart),firstDayOfWeek=this._numb(firstDayOfWeek),count=this._numb(count,1);var originalTime=date.getTime(),date2=this.getTimSpanStart(date,datepart,count,firstDayOfWeek);return date2.getTime()<originalTime&&(date2=this.add(date2,datepart,count)),date2},offsetTimeZone:function(date,targetTimeZone,back){return date=this._date(date),new Date(date.getTime()+(back?-1:1)*(targetTimeZone-this._timeZone)*this.$TIMEUNIT.h)},getWeek:function(date,firstDayOfWeek){var date2,y,tz1,tz2,tz=xui.Date._timeZone;return date=this._date(date),firstDayOfWeek=this._numb(firstDayOfWeek),y=date.getFullYear(),tz1=-date.getTimezoneOffset()/60,(date=this.add(this.getTimSpanStart(date,"ww",1,firstDayOfWeek),"d",6)).getFullYear()!=y?1:(tz2=-(date2=this.getTimSpanStart(date,"y",1)).getTimezoneOffset()/60,date2=this.add(this.getTimSpanStart(date2,"ww",1,firstDayOfWeek),"d",6),this.diff(date2,date,"ww")+1+(tz1>tz?1:0)-(tz2>tz?1:0))},parse:function(str,format){var rtn;if(xui.isDate(str))rtn=str;else if(str+="",isFinite(str))rtn=new Date(parseInt(str,10));else if("string"==typeof format){var a=format.split(/[^ymdhns]+/),b=str.split(/[^0-9]+/),n={y:0,m:0,d:0,h:0,n:0,s:0,ms:0};if(a.length&&a.length===b.length){for(var i=0;i<a.length;i++)a[i].length&&(n["ms"==a[i]?"ms":a[i].charAt(0)]=parseInt(b[i].replace(/^0*/,""),10));rtn=new Date(n.y,n.m-1,n.d,n.h,n.n,n.s,n.ms)}else rtn=null}else{var utc,me=arguments.callee,dp=me.dp||(me.dp={FullYear:2,Month:4,Date:6,Hours:8,Minutes:10,Seconds:12,Milliseconds:14}),match=str.match(me.iso||(me.iso=/^((-\d+|\d{4,})(-(\d{2})(-(\d{2}))?)?)?T((\d{2})(:(\d{2})(:(\d{2})(\.(\d{1,3})(\d)?\d*)?)?)?)?(([+-])(\d{2})((\d{2}))?|Z)?$/)),date=new Date(0);if(match){for(var i in match[4]&&match[4]--,match[15]>=5&&match[14]++,utc=match[16]||match[18]?"UTC":"",dp){var v=match[dp[i]];v&&(date["set"+utc+i](v),date["get"+utc+i]()!=match[dp[i]]&&(rtn=null))}if(match[18]){var h=Number(match[17]+match[18]),m=Number(match[17]+(match[20]||0));date.setUTCMinutes(date.getUTCMinutes()+60*h+m)}rtn=date}else{/^((-\d+|\d{4,})(-(\d{1,2})(-(\d{1,2}))))/.test(str)&&(str=str.replace(/-/g,"/"));var r=Date.parse(str);rtn=r?date.setTime(r)&&date:null}}return null===rtn?null:isFinite(+rtn)?rtn:null},getText:function(date,datepart,firstDayOfWeek){var map=this.$TEXTFORMAT;return date=this._date(date),firstDayOfWeek=this._numb(firstDayOfWeek),map[datepart]?map[datepart](date,!1,firstDayOfWeek):xui.Date.format(date,datepart)},format:function(date,format,firstDayOfWeek){var map=this.$TEXTFORMAT;return date=this._date(date),firstDayOfWeek=this._numb(firstDayOfWeek),format.replace(/(utciso|iso|yyyy|mm|ww|dd|hh|nn|ss|ms|de|c|y|q|m|w|d|h|n|s)/g,(function(a,b){return map[b]?map[b](date,!0,firstDayOfWeek):xui.Date.format(date,b)}))}}}),xui.Class("xui.CSS",null,{Static:{_r:xui.browser.ie?"rules":"cssRules",_baseid:"xui:css:base",_firstid:"xui:css:first",_lastid:"xui:css:last",_reg1:/\.(\w+)\[CLASS~="\1"\]/g,_reg2:/\[ID"([^"]+)"\]/g,_reg3:/\*([.#])/g,_reg4:/\s+/g,_reg5:/\*\|/g,_reg6:/(\s*,\s*)/g,_rep:function(str){var ns=this;return str.replace(ns._reg1,".$1").replace(ns._reg2,"#$1").replace(ns._reg3,"$1").replace(ns._reg4," ").replace(ns._reg5,"").replace(ns._reg6,",").toLowerCase()},_appendSS:function(container,txt,id,before,attr){var fc=document.createElement("style");if(fc.type="text/css",id&&(fc.id=id),xui.browser.ie&&fc.styleSheet&&"cssText"in fc.styleSheet)fc.styleSheet.cssText=txt||"";else try{fc.appendChild(document.createTextNode(txt||""))}catch(p){fc.styleSheet.cssText=txt||""}return attr&&xui(fc).attr(attr),before?xui(container).prepend(fc):xui(container).append(fc),fc},_createCss:function(id,txt,last){var fc,c,head=this._getHead(),fid=this._firstid,lid=this._lastid;if((fc=document.createElement("style")).type="text/css",fc.id=id,txt)if(xui.browser.ie&&fc.styleSheet&&"cssText"in fc.styleSheet)fc.styleSheet.cssText=txt||"";else try{fc.appendChild(document.createTextNode(txt||""))}catch(p){fc.styleSheet.cssText=txt||""}if(last)head.appendChild(fc);else{for(c=document.getElementById(fid)||head.firstChild;(c=c.nextSibling)&&!/^(script|link|style)$/i.test(""+c.tagName););c||(c=document.getElementById(lid))?head.insertBefore(fc,c):head.appendChild(fc)}return fc},_getCss:function(id,css,last){return document.getElementById(id)||this._createCss(id,css,last)},_getBase:function(){return this._getCss(this._baseid)},_getFirst:function(){return this._getCss(this._firstid)},_getLast:function(){return this._getCss(this._lastid,null,!0)},_getHead:function(){return this._head||(this._head=document.getElementsByTagName("head")[0]||document.documentElement)},_check:function(){if(xui.browser.ie){for(var l,count=0,i=0,t=this._getHead().childNodes;l=t[i++];)"text/css"==l.type&&count++;return count>20}},get:function(property,value){for(var l,i=0,t=this._getHead().childNodes;l=t[i++];)if("text/css"==l.type&&property in l&&l[property]==value)return l},addStyleSheet:function(txt,id,backOf,force){var e,ns=this,head=ns._getHead();if(id&&(id=id.replace(/[^\w\-\_\.\:]/g,"_"))&&(e=ns.get("id",id))){if(!force)return e;e.disabled=!0,head.removeChild(e)}return ns._check()?function(txt,backOf){var e=backOf?ns._getLast():ns._getBase();return e.styleSheet.cssText+=txt,e}(txt,backOf):function(txt,id,backOf){var e=document.createElement("style");if(e.type="text/css",id&&(e.id=id),xui.browser.ie&&e.styleSheet&&"cssText"in e.styleSheet)e.styleSheet.cssText=txt||"";else try{e.appendChild(document.createTextNode(txt||""))}catch(p){e.styleSheet.cssText=txt||""}return-1===backOf?head.firstChild?head.insertBefore(e,head.firstChild):head.appendChild(e):1===backOf?head.appendChild(e):head.insertBefore(e,backOf?ns._getLast():ns._getBase()),e.disabled=!0,e.disabled=!1,e}(txt,id,backOf)},includeLink:function(href,id,front,attrs){var e,head=this._getHead();return href&&(e=this.get("href",href))||((e=document.createElement("link")).type="text/css",e.rel="stylesheet",e.href=href,id&&(e.id=id),e.media="all",xui.each(attrs,(function(o,i){e.setAttribute(i,o)}))),head.insertBefore(e,front?this._getBase():this._getLast()),e.disabled=!0,e.disabled=!1,e},remove:function(property,value){var head=this._getHead();(value=this.get(property,value))&&(value.disabled=!0,head.removeChild(value))},replaceLink:function(href,property,oValue,nValue){var e,v,head=this._getHead(),attr={};attr[property]=nValue,e=this.includeLink(href,null,!1,attr),(v=this.get(property,oValue))&&head.replaceChild(e,v),e.disabled=!0,e.disabled=!1},_build:function(selector,value,flag){var t="";return xui.each(value,(function(o,i){t+=i.replace(/([A-Z])/g,"-$1").toLowerCase()+":"+o+";"})),flag?t:selector+"{"+t+"}"},setStyleRules:function(selector,value,force){var target,target2,selectorText,bak,t,_t,ns=this,add=!0,ds=document.styleSheets;return selector=xui.str.trim(selector.replace(/\s+/g," ")),value&&force||(bak=selector.toLowerCase(),xui.arr.each(xui.toArr(ds),(function(o){try{o[ns._r]}catch(e){return}if(xui.arr.each(xui.toArr(o[ns._r]),(function(v,i){if(v.selectorText&&!v.disabled)if(selectorText=ns._rep(v.selectorText),_t=selectorText.split(","),value){if(selectorText==bak)return target=v,!1;if(-1!=xui.arr.indexOf(_t,bak))return target2=v,!1}else add=!1,-1!=xui.arr.indexOf(_t,bak)&&_t.length>1?(_t=xui.arr.removeFrom(_t,xui.arr.indexOf(_t,bak)).join(","),t=v.cssText.slice(v.cssText.indexOf("{")+1,v.cssText.lastIndexOf("}")),o.insertRule?o.insertRule(_t+"{"+t+"}",o[ns._r].length):o.addRule&&o.addRule(_t,t||"{}"),o.deleteRule?o.deleteRule(i):o.removeRule(i),o.disabled=!0,o.disabled=!1):selectorText==bak&&(o.deleteRule?o.deleteRule(i):o.removeRule(i),o.disabled=!0,o.disabled=!1)}),null,!0),target){add=!1;try{xui.each(value,(function(o,i){i=i.replace(/(-[a-z])/gi,(function(m,a){return a.charAt(1).toUpperCase()})),target.style[i]="function"==typeof o?o(target.style[i]):o}))}catch(e){}return o.disabled=!0,o.disabled=!1,!1}if(target2)return add=!1,o.insertRule(ns._build(selector,value),o[ns._r].length),o.disabled=!0,o.disabled=!1,!1}),null,!0)),(force||add)&&ns._addRules(selector,value),ns},$getCSSValue:function(selector,cssKey,cssValue,ownerNode){var css,o,v,i,j,selectorText,k=this._r,ds=document.styleSheets,l=ds.length;for(selector=xui.str.trim(selector.replace(/\s+/g," ").toLowerCase()),i=l-1;i>=0;i--){try{o=ds[i][k]}catch(e){continue}if(!ds[i].disabled&&(o=ds[i][k]))for(j=o.length-1;j>=0;j--)if((v=o[j]).selectorText&&!v.disabled&&(selectorText=this._rep(v.selectorText),-1!=xui.arr.indexOf(selectorText.split(/\s*,\s*/g),selector)))if(cssKey){if(cssValue){if(cssValue===v.style[cssKey])return ds[i].ownerNode||ds[i].owningElement}else if((!ownerNode||ownerNode==ds[i].ownerNode||ds[i].owningElement)&&""!==v.style[cssKey])return(v.style[cssKey]||"").replace(/^\"|\"$/g,"")}else(css=css||[]).push(v)}return css},_addRules:function(selector,value){var ns=this,target=ns._getLast(),changed=target.sheet||target.styleSheet;return changed.insertRule?changed.insertRule(ns._build(selector,value),changed[ns._r].length):changed.addRule&&changed.addRule(selector,ns._build(selector,value,!0)||"{}"),target.disabled=!0,target.disabled=!1,ns},adjustFont:function(fontSize,fontFamily,fontWeight,fontStyle){fontSize&&xui("html").css("font-size",fontSize),fontFamily&&xui("html").css("font-family",fontFamily),fontWeight&&xui("html").css("font-weight",fontWeight),fontStyle&&xui("html").css("font-style",fontStyle),this._dftEmStr="",this._getDftEmSize(!0),this._dftRemStr="",this._getDftRemSize(!0),xui.UI&&xui.UI.getAll().reLayout(!0)},_dftEmStr:"",_dftEm:0,_getDftEmSize:function(force){var ns=this;if(force||!ns._dftEm){var num,fz=ns.$getCSSValue(".xui-ui-ctrl","fontSize");if(!ns._dftEmStr||ns._dftEmStr!=fz)if((num=parseFloat(fz))&&ns.$isPx(fz))ns._dftEm=num,ns._dftEmStr=fz;else if(num&&ns.$isRem(fz))ns._dftEm=num*ns._getDftRemSize(),ns._dftEmStr=fz;else{var div;xui("body").append(div=xui.create('<div class="xui-ui-ctrl" style="height:1em;visibility:hidden;position:absolute;border:0;margin:0;padding:0;left:-10000px;"></div>')),ns._dftEm=div.get(0).offsetHeight,div.remove(),ns._dftEmStr=ns._dftEm+"px"}}return ns._dftEm},$resetEm:function(){delete xui.CSS._dftEm},_dftRemStr:"",_dftRem:0,_getDftRemSize:function(force){return!force&&this._dftRem||(this._dftRem=parseFloat(xui("html").css("font-size"))||16),this._dftRem},$resetRem:function(){delete xui.CSS._dftRem},$isEm:function(value){return value&&"auto"!=value?/^-?((\d\d*\.\d*)|(^\d\d*)|(^\.\d\d*))em$/i.test(xui.str.trim(value+"")):1==xui.$us()},$isRem:function(value){return value&&"auto"!=value?/^-?((\d\d*\.\d*)|(^\d\d*)|(^\.\d\d*))rem$/i.test(xui.str.trim(value+"")):1==xui.$us()},$isPx:function(value){return value&&"auto"!=value?/^-?((\d\d*\.\d*)|(^\d\d*)|(^\.\d\d*))px$/i.test(xui.str.trim(value+"")):1==xui.$us()},$em2px:function(value,node,roundPx){return value=value&&"auto"!=value&&(xui.isFinite(value)||this.$isEm(value))?(parseFloat(value)||0)*(node?xui.isFun(node)?node():xui.isFinite(node)?node:xui(node)._getEmSize():this._getDftEmSize()||this._getDftEmSize()):value,roundPx?Math.round(parseFloat(value)||0):value},$px2em:function(value,node,roundPx){return value&&"auto"!=value&&(xui.isFinite(value)||this.$isPx(value))?(roundPx?Math.round(parseFloat(value)||0):parseFloat(value)||0)/(node?xui.isFun(node)?node():xui.isFinite(node)?node:xui(node)._getEmSize():this._getDftEmSize()||this._getDftEmSize()):value},$rem2px:function(value,roundPx){return value=value&&"auto"!=value&&(xui.isFinite(value)||this.$isRem(value))?(parseFloat(value)||0)*this._getDftRemSize():value,roundPx?Math.round(parseFloat(value)||0):value},$px2rem:function(value,roundPx){return value&&"auto"!=value&&(xui.isFinite(value)||this.$isPx(value))?(roundPx?Math.round(parseFloat(value)||0):parseFloat(value)||0)/this._getDftRemSize():value},$em2rem:function(value,node){return value&&"auto"!=value&&(xui.isFinite(value)||this.$isEm(value))?(parseFloat(value)||0)*(node?xui.isFinite(node)?node:xui(node)._getEmSize():this._getDftEmSize()||this._getDftEmSize())/this._getDftRemSize():value},$rem2em:function(value,node){return value&&"auto"!=value&&(xui.isFinite(value)||this.$isRem(value))?(parseFloat(value)||0)*this._getDftRemSize()/(node?xui.isFinite(node)?node:xui(node)._getEmSize():this._getDftEmSize()||this._getDftEmSize()):value},$px:function(value,node,roundPx){return value=!xui.isFinite(value)&&this.$isRem(value)?this.$rem2px(value,roundPx):this.$isEm(value)?this.$em2px(value,node,roundPx):value&&"auto"!=value?parseFloat(value)||0:value,roundPx?Math.round(parseFloat(value)||0):value},$em:function(value,node,roundPx){return xui.isFinite(value)||this.$isPx(value)?this.$px2em(value,node,roundPx):this.$isRem(value)?this.$rem2em(value,node):value&&"auto"!=value?parseFloat(value)||0:value},$rem:function(value,node,roundPx){return xui.isFinite(value)||this.$isPx(value)?this.$px2rem(value,roundPx):this.$isEm(value)?this.$em2rem(value,node):value&&"auto"!=value?parseFloat(value)||0:value},$addpx:function(a,b,node){return"auto"==a?a:this.$isRem(a)?this.$px2rem(Math.round(this.$rem2px(a)+(parseFloat(b)||0)))+"rem":this.$isEm(a)?this.$px2em(Math.round(this.$em2px(a,!1,node)+(parseFloat(b)||0)))+"em":Math.round((parseFloat(a)||0)+(parseFloat(b)||0))+"px"},$forceu:function(v,u,node,roundPx){return null===v||v===undefined||""===v||"auto"==v?v:(u?"rem"==u:0===xui.$us())?this.$rem(v,node,!1!==roundPx)+"rem":(u?"em"==u:1==xui.$us())?this.$em(v,node,!1!==roundPx)+"em":Math.round(this.$px(v,node,!1!==roundPx))+"px"},$picku:function(v){return v&&"auto"!=v&&(v+"").replace(/[-\d\s.]*/g,"")||(1==xui.$us()?"em":"px")},$addu:function(v){return"auto"==v?v:xui.isFinite(v)||this.$isPx(v)?Math.round(parseFloat(v)||0)+"px":v+""}},Initialize:function(){var b=xui.browser,inlineblock=(b.gek?b.ver<3?(b.ver<3?"-moz-outline-offset:-1px !important;":"")+"display:-moz-inline-block;display:-moz-inline-box;display:inline-block;":"display:inline-block;":b.ie6?"display:inline-box;display:inline;":"display:inline-block;")+(b.ie?"zoom:1;":""),css=".xui-node{margin:0;padding:0;line-height:1.22;-webkit-text-size-adjust:none;}.xui-node-highlight{color:#000;}.xui-title-node{}.xuifont-hover, .xuicon-hover{ color: #686868; }"+(xui.browser.fakeTouch||"touchOnly"==xui.browser.deviceType?"":".xuifont-active, .xuicon-active{ color: #3393D2; }")+".xuifont-checked, .xuicon-checked{ color: #3393D2; }.xui-wrapper{color:#000;font-family:arial,helvetica,clean,sans-serif;font-style:normal;font-weight:normal;vertical-align:middle;}.xui-cover{cursor:wait;background:url("+xui.ini.img_bg+") transparent repeat;opacity:1;}.xui-node-table{border-collapse:collapse;border-spacing:0;empty-cells:show;font-size:inherit;"+(b.ie?"font:100%;":"")+"}.xui-node-fieldset,.xui-node-img{border:0;}.xui-node-ol,.xui-node-ul,.xui-node-li{list-style:none;}.xui-node-caption,.xui-node-th{text-align:left;}.xui-node-th{font-weight:normal;}.xui-node-q:before,.xui-node-q:after{content:'';}.xui-node-abbr,.xui-node-acronym{border:0;font-variant:normal;}.xui-node-sup{vertical-align:text-top;}.xui-node-sub{vertical-align:text-bottom;}.xui-node-input,.xui-node-textarea,.xui-node-select{cursor:text;font-family:inherit;font-size:inherit;font-weight:inherit;"+(b.ie?"font-size:100%;":"")+"}.xui-node-del,.xui-node-ins{text-decoration:none;}.xui-node-pre,.xui-node-code,.xui-node-kbd,.xui-node-samp,.xui-node-tt{font-family:monospace;"+(b.ie?"font-size:108%;":"")+"line-height:100%;}.xui-node-select,.xui-node-input,.xui-node-textarea{font-family:arial,helvetica,clean,sans-serif;border-width:1px;}"+(b.ie&&b.ver<=8?".xui-node-input{overflow:hidden;}":"")+".xui-node-a, .xui-node-a .xui-node{cursor:pointer;color:#0000ee;text-decoration:none;}.xui-node-a:hover, .xui-node-a:hover .xui-node{color:red}"+(b.gek?".xui-node-a:focus{outline-offset:-1px;"+(b.ver<3?"-moz-outline-offset:-1px !important":"")+"}":"")+".xui-node-span, .xui-node-div{border:0;}"+(b.ie&&b.ver<=8?"":".xui-node-span:not(.xui-showfocus):focus, .xui-node-div:not(.xui-showfocus):focus{outline:0;}.xui-showfocus:focus{outline-width: 1px;outline-style: dashed;}")+".xui-node-span, .xui-wrapper span"+(b.ie&&b.ver<=7?"":", .xui-v-wrapper:before, .xui-v-wrapper > .xui-v-node")+"{outline-offset:-1px;"+inlineblock+"}.xui-node-h1,.xui-node-h2,.xui-node-h3,.xui-node-h4,.xui-node-h5,.xui-node-h6{font-size:100%;font-weight:normal;}.xui-node-h1{font-size:138.5%;}.xui-node-h2{font-size:123.1%;}.xui-node-h3{font-size:108%;}.xui-node-h1,.xui-node-h2,.xui-node-h3{margin:1em 0;}.xui-node-h1,.xui-node-h2,.xui-node-h3,.xui-node-h4,.xui-node-h5,.xui-node-h6,.xui-node-strong{font-weight:bold;}.xui-node-em{font-style:italic;}.xui-node-legend{color:#000;}"+(b.ie6?"#"+xui.$localeDomId+"{vertical-align:baseline;}":"")+".xui-nofocus:focus{outline:0;}.xui-cls-wordwrap{white-space: pre-wrap;word-break: break-all;"+(b.gek?"white-space: -moz-pre-wrap;":"")+(b.opr?"white-space: -pre-wrap;":"")+(b.opr?"white-space: -o-pre-wrap;":"")+(b.ie?"word-wrap: break-word;":"")+"}"+(b.ie&&b.ver<=8?"":".xui-v-wrapper:before{content:'';height:100%;font-size:0;vertical-align:middle;}.xui-v-wrapper > .xui-v-node{vertical-align:middle;}.xui-v-top > .xui-v-wrapper:before{vertical-align:top;}.xui-v-top > .xui-v-wrapper > .xui-v-node{vertical-align:top;}.xui-v-bottom > .xui-v-wrapper:before{vertical-align:bottom;}.xui-v-bottom > .xui-v-wrapper > .xui-v-node{vertical-align:bottom;}")+".xui-node-tips{background-color:#FDF8D2;}.xuifont, .xuicon{font-size:1.3333333333333333em;line-height:1em;}.xuicon{margin: 0 .25em;"+inlineblock+"}.xuicon:before{height:1em;width:1em;}.xui-ui-ctrl, .xui-ui-reset{font-family:arial,helvetica,clean,sans-serif; font-style:normal; font-weight:normal; vertical-align:middle; color:#000; }.xui-ui-reset{font-size: inherit;}.xui-ui-ctrl{cursor:default;font-size:.875rem;}.xui-title-node{font-size:1.1667em  !important;}.setting-uikey{font-family:'default'}";this.addStyleSheet(css,"xui.CSS")}}),xui.Class("xui.DomProfile","xui.absProfile",{Constructor:function(domId){var upper=arguments.callee.upper;upper&&upper.call(this),upper=null,xui.$cache.profileMap[this.domId=domId]=this},Instance:{__gc:function(){delete xui.$cache.profileMap[this.domId]},_getEV:function(funs,id,name){var t=xui.$cache.profileMap[id];if(t&&(t=t.events)&&(t=t[name]))for(var i=0,l=t.length;i<l;i++)"function"==typeof t[t[i]]&&(funs[funs.length]=t[t[i]])}},Static:{get:function(id){return xui.$cache.profileMap[id]},$abstract:!0}}),xui.Class("xui.Dom","xui.absBox",{Instance:{get:function(index){var s,purge=xui.$cache.domPurgeData,t=this._nodes;if(xui.isNumb(index))return(s=t[index])&&(s=purge[s])&&s.element;for(var a=[],l=t.length,i=0;i<l;i++)a[a.length]=(s=purge[t[i]])&&s.element;return a},each:function(fun,desc){var n,i,purge=xui.$cache.domPurgeData,j=this._nodes,l=j.length;if(desc)for(i=l;i>=0&&(!(n=purge[j[i]])||!(n=n.element)||!1!==fun.call(this,n,i));i--);else for(i=0;i<l&&(!(n=purge[j[i]])||!(n=n.element)||!1!==fun.call(this,n,i));i++);return n=null,this},serialize:function(){var a=[];return this.each((function(o){a[a.length]=o.id})),"xui(['"+a.join("','")+"'])"},xid:function(){return xui.getId(this.get(0))},id:function(value,ignoreCache){var t,i,cache=xui.$cache.profileMap;return"string"==typeof value?this.each((function(o){(i=o.id)!==value&&(!ignoreCache&&(t=cache[i])&&(cache[value]=t,delete cache[i]),o.id=value)})):this.get(0)&&this.get(0).id},$sum:function(fun,args){var r,i,arr=[];return this.each((function(o){if(r=fun.apply(o,args||[]))if(xui.isArr(r))for(i=0;o=r[i];i++)arr[arr.length]=o;else arr[arr.length]=r})),xui(arr)},children:function(){return this.$sum((function(){return xui.toArr(this.childNodes)}))},clone:function(deep){return this.$sum((function(){var o,n=this.cloneNode(!!deep),children=n.getElementsByTagName("*"),ie=xui.browser.ie&&xui.browser.ver<9,i=0;for(ie?n.removeAttribute("$xid"):delete n.$xid;o=children[i];i++)ie?o.removeAttribute("$xid"):delete o.$xid;return n}),arguments)},$iterator:function(type,dir,inn,fun,top){return this.$sum((function(type,dir,inn,fun,top){var self=arguments.callee;if("function"!=typeof fun){var count=fun||0;fun=function(n,index){return index==count}}for(var m,t,index=0,n=this,flag=0;n&&(1!=n.nodeType||!0!==fun(n,index++));)if("x"==type)n=dir?n.nextSibling:n.previousSibling;else if("y"==type)n=dir?self.call(1===dir?n.lastChild:n.firstChild,"x",1!==dir,!0,0,top):n.parentNode;else{if(inn=!xui.isBool(inn)||inn,m=null,n=dir?(t=inn&&n.firstChild)||(t=n.nextSibling)?t:m=n.parentNode:(t=inn&&n.lastChild)||(t=n.previousSibling)?t:m=n.parentNode,m){for(;!(m=dir?n.nextSibling:n.previousSibling);)if(!(n=n.parentNode)){if(flag)return null;flag=!0,m=dir?document.body.firstChild:document.body.lastChild;break}n=m}inn=!0}return n}),arguments)},query:function(tagName,property,expr){tagName=tagName||"*";var f="getElementsByTagName",me=arguments.callee,f1=me.f1||(me.f1=function(tag,attr,expr){var all=this[f](tag),arr=[];expr.test(this[attr])&&(arr[arr.length]=this);for(var o,i=0;o=all[i];i++)expr.test(o[attr])&&(arr[arr.length]=o);return arr}),f2=me.f2||(me.f2=function(tag,attr,expr){var all=this[f](tag),arr=[];this[attr]==expr&&(arr[arr.length]=this);for(var o,i=0;o=all[i];i++)o[attr]==expr&&(arr[arr.length]=o);return arr}),f3=me.f3||(me.f3=function(tag,attr,expr){var all=this[f](tag),arr=[];this[attr]&&(arr[arr.length]=this);for(var o,i=0;o=all[i];i++)o[attr]&&(arr[arr.length]=o);return arr}),f4=me.f4||(me.f4=function(tag){return xui.toArr(this[f](tag))}),f5=me.f5||(me.f5=function(tag,attr){var all=this[f](tag),arr=[];attr(this)&&(arr[arr.length]=this);for(var o,i=0;o=all[i];i++)attr(o)&&(arr[arr.length]=o);return arr});return this.$sum(property?"function"==typeof property?f5:expr?xui.isReg(expr)?f1:f2:f3:f4,[tagName,property,expr])},querySelector:function(selectors){return this.$sum((function(){return this.querySelector(selectors)}))},querySelectorAll:function(selectors){return this.$sum((function(){return xui.toArr(this.querySelectorAll(selectors))}))},$add:function(fun,target,reversed){if((xui.isHash(target)||xui.isStr(target))&&(target=xui.create(target)),reversed?(reversed=xui(target),target=this):(target=xui(target),reversed=this),target._nodes.length){var fragment,p,i,o,j,v,uiObj,one=reversed.get(0),ns=target.get(),dom=xui.Dom,cache=xui.$cache.profileMap,arr=[];if(target.each((function(o){(uiObj=(p=o.id)&&(p=cache[p])&&p.LayoutTrigger&&(one===xui("body").get(0)||"none"!=dom.getStyle(one,"display"))&&p.LayoutTrigger)&&arr.push([uiObj,p])})),1==ns.length)fragment=ns[0];else for(fragment=document.createDocumentFragment(),i=0;o=ns[i];i++)fragment.appendChild(o);for(fun.call(one,fragment),i=0;o=arr[i];i++){for(j=0;v=o[0][j];j++)v.call(o[1]);o[1].onLayout&&o[1].boxing().onLayout(o[1])}arr.length=0,one=o=fragment=null}return this},prepend:function(target,reversed){return this.$add((function(node){this.previousSibling!=node&&(this.firstChild?this.insertBefore(node,this.firstChild):this.appendChild(node))}),target,reversed)},append:function(target,reversed,force){return this.$add((function(node){(force||this!=node.parentNode)&&this.appendChild(node)}),target,reversed)},addPrev:function(target,reversed){return this.$add((function(node){this.firstChild!=node&&this.parentNode.insertBefore(node,this)}),target,reversed)},addNext:function(target,reversed){return this.$add((function(node){this.nextSibling!=node&&(this.nextSibling?this.parentNode.insertBefore(node,this.nextSibling):this.parentNode.appendChild(node))}),target,reversed)},replace:function(target,triggerGC){(xui.isHash(target)||xui.isStr(target))&&(target=xui.create(target)),target=xui(target);var v,i,c=this.get(0),ns=target.get(),l=ns.length;if(l>0&&(v=ns[l-1])){for(c.parentNode.replaceChild(v,c),i=0;i<l-1;i++)v.parentNode.insertBefore(ns[i],v);triggerGC&&this.remove()}return c=v=null,target},swap:function(target){var t=xui.Dom.getEmptyDiv().html("*",!1);return(xui.isHash(target)||xui.isStr(target))&&(target=xui.create(target)),target=xui(target),this.replace(t,!1),target.replace(this,!1),t.replace(target,!1),t.get(0).innerHTML="",document.body.insertBefore(t.get(0),document.body.firstChild),this},remove:function(triggerGC,purgeNow,callback){if(!1===triggerGC)this.each((function(o,i){o.raphael&&o.remove?o.remove():o.parentNode&&o.parentNode.removeChild(o)}));else{var c=xui.$getGhostDiv();this.each((function(o){c.appendChild(o)}),!0);var f=function(){xui.$purgeChildren(c),callback&&(xui.tryF(callback),callback=null),c=null};purgeNow?f():xui.asyRun(f)}return this},empty:function(triggerGC,purgeNow){return this.each((function(o){xui([o]).html("",triggerGC,null,purgeNow)}))},html:function(content,triggerGC,loadScripts,purgeNow,callback){var i,s="",o=this.get(0);if(triggerGC=!1!==triggerGC,content!==undefined){if(o){if(3==o.nodeType)o.nodeValue=content;else{if(!o.firstChild&&""===content)return this;if(triggerGC){var c=xui.$getGhostDiv();for(i=o.childNodes.length-1;i>=0;i--)c.appendChild(o.childNodes[i]);var f=function(){xui.$purgeChildren(c),callback&&(xui.tryF(callback),callback=null),c=null};purgeNow?f():xui.asyRun(f)}var scripts;if(loadScripts){var matched,attr,src,reg1=/(?:<script([^>]*)?>)((\n|\r|.)*?)(?:<\/script>)/gi,reg3=/\ssrc=([\'\"])(.*?)\1/i;for(scripts=[];matched=reg1.exec(content);)(src=!!(attr=matched[1])&&attr.match(reg3))&&src[2]?scripts.push([1,src[2]]):matched[2]&&matched[2].length>0&&scripts.push([2,matched[2]]);content=content.replace(/(?:<script.*?>)((\n|\r|.)*?)(?:<\/script>)/gi,"")}o.innerHTML=content,scripts&&scripts.length>0&&xui.arr.each(scripts,(function(s){1==s[0]?xui.include(null,s[1]):xui.exec(s[1])}))}o=null}return this}return o&&(s=3==o.nodeType?o.nodeValue:o.innerHTML,o=null),s},loadHtml:function(options,onStart,onEnd){var ns=this;"string"==typeof options&&(options={url:options}),xui.tryF(onStart),xui.Ajax(options.url,options.query,(function(rsp){var n=xui.create("div");n.html(rsp,!1,!0),ns.append(n.children()),xui.tryF(onEnd)}),(function(err){ns.append("<div>"+err+"</div>"),xui.tryF(onEnd)}),null,options.options).start()},loadIframe:function(options,domId){"string"==typeof options&&(options={url:options});var t,id=domId||"aiframe_"+xui.stamp();(t=xui.Dom.byId(domId))&&xui(t).remove();var e=xui.browser.ie&&xui.browser.ver<9,ifr=document.createElement(e?"<iframe name='"+id+"'>":"iframe");ifr.id=ifr.name=id,ifr.src=options.url,ifr.frameBorder="0",ifr.marginWidth="0",ifr.marginHeight="0",ifr.vspace="0",ifr.hspace="0",ifr.allowTransparency="true",ifr.width="100%",ifr.height="100%",this.append(ifr),xui.Dom.submit(options.url,options.query,options.method,ifr.name,options.enctype)},outerHTML:function(content,triggerGC){var s="",o=this.get(0);if(o.id,content!==undefined){var n=this.replace(xui.str.toDom(content),!1);return this._nodes[0]=n._nodes[0],xui([o]).remove(triggerGC),this}if(xui.browser.gek){var m=xui.$getGhostDiv();m.appendChild(this.get(0).cloneNode(!0)),s=m.innerHTML,m.innerHTML="",m=null}else s=o.outerHTML;return o=null,s},text:function(content){return content!==undefined?(this.each((function(o){for(var t,i=o.childNodes.length-1;i>=0;i--)(t=o.childNodes[i])&&3==t.nodeType&&(t.nodeValue="");o.appendChild(document.createTextNode(content))})),this):(o=this.get(0))?o.textContent||o.innerText:"";var o},attr:function(name,value){var self=this,me=arguments.callee,map1=me.map1||(me.map1={class:"className",readonly:"readOnly",tabindex:"tabIndex",for:"htmlFor",maxlength:"maxLength",cellspacing:"cellSpacing",rowspan:"rowSpan",value:"value"}),map2=me.map2||(me.map2={href:1,src:1,style:1});if("object"==typeof name){for(var i in name)me.call(self,i,name[i]);return self}var iestyle=xui.browser.ie&&"style"==name,normal=!map2[name=map1[name]||name];if(value!==undefined)return self.each((function(o){if(null===value){if(iestyle)o.style.cssText="";else if(normal)try{o[name]=null,1==o.nodeType&&o.removeAttribute(name)}catch(e){}}else value="style"==name?(value+"").replace(/[;]+/g,";").replace(/^;/,""):value,iestyle?o.style.cssText=""+value:normal?(o[name]=value,1==o.nodeType&&"value"!=name&&"string"==typeof value&&o.setAttribute(name,value)):o.setAttribute(name,value)}));var r,o=self.get(0);return iestyle?o.style.cssText:"selected"==name&&xui.browser.kde?o.parentNode.selectedIndex:(r=name in o&&normal?o[name]:o.getAttribute(name,xui.browser.ie&&!normal?2:undefined),o=null,"style"==name?(r||"").replace(/[;]+/g,";").replace(/^;/,""):r)},$touchscroll:function(type){if(xui.browser.fakeTouch||xui.browser.isTouch&&(xui.browser.isAndroid||xui.browser.isBB)){var hash={x:1,y:1,xy:1},nodes=this._nodes,getD=function(t){var o=xui.getNodeData(t,"_wheelscroll");return o||xui.setNodeData(t,"_wheelscroll",o={}),o},doSwipe=function(t){var wheel=getD(t);if((wheel._speedx||wheel._speedy)&&(new Date).getTime()-wheel._lastTime<50){var m,params={},sl=t.scrollLeft,st=t.scrollTop;if(wheel._speedx&&(m=[Math.max(0,sl),Math.max(0,sl+Math.sign(wheel._speedx)*Math.min(50,Math.abs(wheel._speedx))*40)])[0]!==m[1]&&(params.scrollLeft=m),wheel._speedy&&(m=[Math.max(0,st),Math.max(0,st+Math.sign(wheel._speedy)*Math.min(50,Math.abs(wheel._speedy))*40)])[0]!==m[1]&&(params.scrollTop=m),!xui.isEmpty(params)){var tid=xui.getNodeData(t,"_inthread");tid&&(xui.Thread.abort(tid),xui.setNodeData(t,"_inthread"),xui.setData(["!document","$fakescroll"])),xui(t).animate(params,null,null,2e3,null,"expoOut").start()}}wheel._opx=wheel._opy=wheel._ox=wheel._oy=wheel._lastTime=wheel._speedx=wheel._speedy=null};hash[type]||(type=null),xui(nodes)[xui.browser.fakeTouch?"onMousedown":"onTouchstart"](hash[type]?function(p,e,src){if(xui.DragDrop._profile.isWorking)return!0;if(!xui(src).scrollable("x")&&!xui(src).scrollable("y"))return!0;var s,t=xui(src).get(0),tid=xui.getNodeData(t,"_inthread");tid&&(xui.Thread.abort(tid),xui.setNodeData(t,"_inthread"));var wheel=getD(t);if(xui.browser.fakeTouch){if("left"!==xui.Event.getBtn(e))return!0;s=e}else{if(e.touches.length>1)return!0;s=e.touches[0]}return t&&("xy"!=type&&"x"!=type||(wheel._ox=t.scrollLeft,wheel._opx=s.pageX),"xy"!=type&&"y"!=type||(wheel._oy=t.scrollTop,wheel._opy=s.pageY)),!xui.browser.fakeTouch||(xui.setData(["!document","$fakescroll"],src),xui.doc.onMouseup((function(p,e,src){xui.setData(["!document","$fakescroll"]),xui.asyRun((function(){xui.setData(["!document","$fakescrolling"])})),xui.doc.onMouseup(null,"touchscroll"),doSwipe(t)}),"touchscroll"),!0)}:null,"touchscroll"),xui(nodes)[xui.browser.fakeTouch?"onMousemove":"onTouchmove"](hash[type]?function(p,e,src){if(xui.DragDrop._profile.isWorking)return!0;if(xui.browser.fakeTouch&&xui.getData(["!document","$fakescroll"])!=src)return!0;var s,x1,y1,t=xui(src).get(0);if(xui.browser.fakeTouch){if("left"!==xui.Event.getBtn(e))return!0;s=e}else{if(e.touches.length>1)return!0;s=e.touches[0]}if(t){var wheel=getD(t);return wheel._lastTime=(new Date).getTime(),x1=t.scrollLeft,y1=t.scrollTop,"xy"!=type&&"x"!=type||(t.scrollLeft=wheel._ox+wheel._opx-s.pageX,x1==t.scrollLeft?(wheel._ox=t.scrollLeft,wheel._opx=s.pageX):wheel._speedx=t.scrollLeft-x1),"xy"!=type&&"y"!=type||(null===wheel._oy&&(wheel._oy=t.scrollTop+wheel._opy),t.scrollTop=wheel._oy+wheel._opy-s.pageY,y1==t.scrollTop?(wheel._oy=t.scrollTop,wheel._opy=s.pageY):wheel._speedy=t.scrollTop-y1),xui.browser.fakeTouch&&(x1===t.scrollLeft&&y1===t.scrollTop||xui.setData(["!document","$fakescrolling"],1)),x1==t.scrollLeft&&y1==t.scrollTop}}:null,"touchscroll"),xui(nodes).onTouchend(hash[type]?function(p,e,src){return!!xui.DragDrop._profile.isWorking||e.touches.length>1||void doSwipe(xui(src).get(0))}:null,"touchscroll")}return this},isScrollBarShowed:function(type){var n=this.get(0);if(n)return"y"==type?(n.offsetWidth||0)>(n.clientWidth||0):(n.offsetHeight||0)>(n.clientHeight||0)},scrollable:function(type){return 0!==this[type="x"==type?"scrollLeft":"scrollTop"]()||(this[type](1),0!==this[type]()&&(this[type](0),!0))},scrollIntoView:function(){return this.each((function(o){o.scrollIntoView()}))},css:function(name,value,force){return"object"==typeof name||value!==undefined?(this.each((function(o){xui.Dom.setStyle(o,name,value)})),(xui.browser.fakeTouch||xui.browser.isTouch&&(xui.browser.isAndroid||xui.browser.isBB))&&("overflow"!=name&&"overflow-x"!=name&&"overflow-y"!=name||("auto"==value||"scroll"==value?this.$touchscroll("overflow"==name?"xy":"overflow-x"==name?"x":"y"):this.$touchscroll(null))),this):xui.Dom.getStyle(this.get(0),name,force)},_getEmSize:function(rate){return this.get(0)?(parseFloat(xui.Dom.getStyle(this.get(0),"fontSize",!0))||xui.CSS._getDftEmSize())*(rate||1):null},rotate:function(v){if(xui.isSet(v))return v=parseFloat(v)||0,(v%=360)<0&&(v+=360),this.each((function(o){if(o.raphael&&o.id){var prf=xui.Event._getProfile(o.id);(prf=prf&&prf.parent&&prf.parent._paper)&&(o=prf.getById(o.raphaelid))&&o.transform("r"+v)}else{v+="deg";var transform=o.style.transform||"";/rotate\([^)]*\)/i.test(transform)?transform=transform.replace(/(rotate\()([^)]+)/i,"$1"+v):transform+=" rotate("+v+")",xui.Dom.setStyle(o,"transform",transform)}}));var o=this.get(0);if(o.raphael&&o.id){var prf=xui.Event._getProfile(o.id);if((prf=prf&&prf.parent&&prf.parent._paper)&&(o=prf.getById(o.raphaelid))){o=o.transform(),o=xui.isArr(o)?o.length?o.join():"":o?window.Raphael.parseTransformString(o).join():"";var arr=/r,([-\d.]+)/i.exec(o);return v=arr?parseFloat(arr[1]||0):0,(v%=360)<0&&(v+=360),v}return 0}return(arr=/rotate\(([-\d.]+)/i.exec(o.style.transform))?parseFloat(arr[1]||0):0},scaleX:function(v){if(xui.isSet(v))return this.each((function(o){if(v=parseFloat(v),o.raphael&&o.id){v=v||0;var t,prf=xui.Event._getProfile(o.id);(prf=prf&&prf.parent&&prf.parent._paper)&&(o=prf.getById(o.raphaelid))&&((t=xui.clone(window.Raphael.parseTransformString(o.transform()),!0))&&t[0]&&"s"==t[0][0]?t[0][1]=v:(t=t||[]).unshift(["s",v,1]),o.transform(t))}else{xui.isNaN(v)&&(v=1);var transform=o.style.transform||"";/(scale\()([^,]+),([^)]+)/i.test(transform)?transform=transform.replace(/(scale\()([^,]+),([^)]+)/i,"$1"+v+",$3"):/scale\([-\d.]*\)/i.test(transform)?transform=transform.replace(/scale\([-\d.]*\)/i,"scale("+v+",1)"):transform+=" scale("+v+",1)",xui.Dom.setStyle(o,"transform",transform)}}));var o=this.get(0);if(o.raphael&&o.id){v=1;var prf=xui.Event._getProfile(o.id);return(prf=prf&&prf.parent&&prf.parent._paper)&&(o=prf.getById(o.raphaelid))&&xui.arr.each(window.Raphael.parseTransformString(o.transform()),(function(t){"s"==t[0]&&(v*=t[1])})),v}var arr=/(scale\()([^,]+),([^)]+)/i.exec(this.get(0).style.transform);return arr?parseFloat(arr[2]||1):(arr=/scale\(([-\d.]*)\)/i.exec(this.get(0).style.transform))?arr[1]:1},scaleY:function(v){if(xui.isSet(v))return this.each((function(o){if(v=parseFloat(v),o.raphael&&o.id){v=v||0;var t,prf=xui.Event._getProfile(o.id);(prf=prf&&prf.parent&&prf.parent._paper)&&(o=prf.getById(o.raphaelid))&&((t=xui.clone(window.Raphael.parseTransformString(o.transform()),!0))&&t[0]&&"s"==t[0][0]?t[0][2]=v:(t=t||[]).unshift(["s",1,v]),o.transform(t))}else{xui.isNaN(v)&&(v=1);var transform=o.style.transform||"";/(scale\()([^,]+),([^)]+)/i.test(transform)?transform=transform.replace(/(scale\()([^,]+),([^)]+)/i,"$1$2,"+v):/scale\([-\d.]*\)/i.test(transform)?transform=transform.replace(/scale\([-\d.]*\)/i,"scale(1,"+v+")"):transform+=" scale(1,"+v+")",xui.Dom.setStyle(o,"transform",transform)}}));var o=this.get(0);if(o.raphael&&o.id){v=1;var prf=xui.Event._getProfile(o.id);return(prf=prf&&prf.parent&&prf.parent._paper)&&(o=prf.getById(o.raphaelid))&&xui.arr.each(window.Raphael.parseTransformString(o.transform()),(function(t){"s"==t[0]&&(v*=t[2])})),v}var arr=/(scale\()([^,]+),([^)]+)/i.exec(this.get(0).style.transform);return arr?parseFloat(arr[3]||1):(arr=/scale\(([-\d.]*)\)/i.exec(this.get(0).style.transform))?arr[1]:1},translateX:function(v){if(xui.isSet(v))return this.each((function(o){if(o.raphael&&o.id){v=parseFloat(v)||0;var t,prf=xui.Event._getProfile(o.id);(prf=prf&&prf.parent&&prf.parent._paper)&&(o=prf.getById(o.raphaelid))&&((t=xui.clone(window.Raphael.parseTransformString(o.transform()),!0))&&t.length&&t[t.length-1]&&"t"==t[t.length-1][0]?t[t.length-1][1]=v:(t=t||[]).push(["t",v,0]),o.transform(t))}else{v=xui.CSS.$addu(v);var transform=o.style.transform||"";/translate\([^)]*\)/i.test(transform)?transform=transform.replace(/(translate\()([^,]+),([^)]+)/i,"$1"+v+",$3"):transform+=" translate("+v+",0)",xui.Dom.setStyle(o,"transform",transform)}}));var o=this.get(0);if(o.raphael&&o.id){v=0;var prf=xui.Event._getProfile(o.id);return(prf=prf&&prf.parent&&prf.parent._paper)&&(o=prf.getById(o.raphaelid))&&xui.arr.each(window.Raphael.parseTransformString(o.transform()),(function(t){"t"==t[0]&&(v+=t[1])})),v}var arr=/(translate\()([^,]+),([^)]+)/i.exec(this.get(0).style.transform);return arr?(arr[2]||"").replace(/\s/g,""):""},translateY:function(v){if(xui.isSet(v))return this.each((function(o){if(o.raphael&&o.id){v=parseFloat(v)||0;var t,prf=xui.Event._getProfile(o.id);(prf=prf&&prf.parent&&prf.parent._paper)&&(o=prf.getById(o.raphaelid))&&((t=xui.clone(window.Raphael.parseTransformString(o.transform()),!0))&&t.length&&t[t.length-1]&&"t"==t[t.length-1][0]?t[t.length-1][2]=v:(t=t||[]).push(["t",0,v]),o.transform(t))}else{v=xui.CSS.$addu(v);var transform=o.style.transform||"";/translate\([^)]*\)/i.test(transform)?transform=transform.replace(/(translate\()([^,]+),([^)]+)/i,"$1$2,"+v):transform+=" translate(0,"+v+")",xui.Dom.setStyle(o,"transform",transform)}}));var o=this.get(0);if(o.raphael&&o.id){v=0;var prf=xui.Event._getProfile(o.id);return(prf=prf&&prf.parent&&prf.parent._paper)&&(o=prf.getById(o.raphaelid))&&xui.arr.each(window.Raphael.parseTransformString(o.transform()),(function(t){"t"==t[0]&&(v+=t[2])})),v}var arr=/(translate\()([^,]+),([^)]+)/i.exec(this.get(0).style.transform);return arr?(arr[3]||"").replace(/\s/g,""):""},skewX:function(v){if(xui.isSet(v))return xui.isFinite(v)&&(v+="deg"),this.each((function(o){var transform=o.style.transform||"";/skew\([^)]*\)/i.test(transform)?transform=transform.replace(/(skew\()([^,]+),([^)]+)/i,"$1"+(v||0)+",$3"):transform+=" skew("+v+",0deg)",xui.Dom.setStyle(o,"transform",transform)}));var arr=/(skew\()([^,]+),([^)]+)/i.exec(this.get(0).style.transform);return arr?parseFloat(arr[2]||0):0},skewY:function(v){if(xui.isSet(v))return xui.isFinite(v)&&(v+="deg"),this.each((function(o){var transform=o.style.transform||"";/skew\([^)]*\)/i.test(transform)?transform=transform.replace(/(skew\()([^,]+),([^)]+)/i,"$1$2,"+(v||0)):transform+=" skew(0deg,"+v+")",xui.Dom.setStyle(o,"transform",transform)}));var arr=/(skew\()([^,]+),([^)]+)/i.exec(this.get(0).style.transform);return arr?parseFloat(arr[3]||0):0},caret:function(begin,end){var input=this.get(0),tn=input.nodeName.toLowerCase(),type=typeof begin,ie=xui.browser.ie;if(/^(input|textarea)$/i.test(tn)&&("input"!=tn||"text"==input.type.toLowerCase()||"password"==input.type.toLowerCase())){if(input.focus(),"number"==type)return ie?((r=input.createTextRange()).collapse(!0),r.moveEnd("character",end),r.moveStart("character",begin),r.select()):(input.focus(),input.setSelectionRange(begin,end)),this;if("string"==type){var ret,r=this.caret(),l=0,m=0,v=input.value,reg1=/\r/g;return ie&&(l=(l=v.substr(0,r[0]).match(reg1))&&l.length||0,m=(m=begin.match(reg1))&&m.length||0),xui.browser.opr&&(m=(l=(l=begin.match(/\n/g))&&l.length||0)-(m=(m=begin.match(/\r\n/g))&&m.length||0),l=0),input.value=v.substr(0,r[0])+begin+v.substr(r[1],v.length),ret=r[0]-l+m+begin.length,this.caret(ret,ret),ret}if(ie&&document.selection){var e;if(l=(r=document.selection.createRange()).text.length,"input"==tn.toLowerCase())return r.moveStart("character",-input.value.length),[(e=r.text.length)-l,e];var rb=r.duplicate();return rb.moveToElementText(input),rb.setEndPoint("EndToEnd",r),[(e=rb.text.length)-l,e]}return[input.selectionStart,input.selectionEnd]}},show:function(left,top,callback,showEffects,ignoreEffects){var style,t,vv;return this.each((function(o){if(1==o.nodeType){var tid=xui.getNodeData(o,"_inthread");tid&&(xui.Thread.abort(tid),xui.setNodeData(o,"_inthread")),style=o.style,(vv=xui.getNodeData(o))._xuihide&&("_left"in vv&&style.left!=(t=vv._left)&&(style.left=t),"_top"in vv&&style.top!=(t=vv._top)&&(style.top=t),"_position"in vv&&style.position!=(t=vv._position)&&(style.position=t),"visible"!=style.visibility&&(style.visibility="visible"),xui(o).removeClass("xui-ui-hidden"),vv._xuihide=0),xui.isSet(left)&&(style.left=left),xui.isSet(top)&&(style.top=top),(showEffects=ignoreEffects?null:showEffects||xui.get(xui.UIProfile.getFromDom(o),["properties","showEffects"]))&&(showEffects=xui.Dom._getEffects(showEffects,1)),showEffects?xui.Dom._vAnimate(o,showEffects,callback):callback&&callback()}}))},hide:function(callback,hideEffects,ignoreEffects){var style,vv;return this.each((function(o){if(1==o.nodeType){var tid=xui.getNodeData(o,"_inthread");tid&&(xui.Thread.abort(tid),xui.setNodeData(o,"_inthread")),style=o.style,vv=xui.getNodeData(o);var fun=function(){1!==vv._xuihide&&(vv._position=style.position,vv._visibility=style.visibility,vv._top=style.top,vv._left=style.left,vv._xuihide=1),"absolute"!=style.position&&(style.position="absolute"),style.visibility="hidden",xui(o).addClass("xui-ui-hidden"),callback&&callback()};(hideEffects=ignoreEffects?null:hideEffects||xui.get(xui.UIProfile.getFromDom(o),["properties","hideEffects"]))&&(hideEffects=xui.Dom._getEffects(hideEffects,0)),hideEffects?xui.Dom._vAnimate(o,hideEffects,fun):fun()}}))},cssRegion:function(region,triggerEvent){if("object"==typeof region){for(var i,node=this.get(0),dom=xui.Dom,f=dom._setUnitStyle,m={},j=0,c=dom._boxArr;i=c[j++];)m[i]=i in region&&null!==region[i]&&f(node,i,region[i]);return triggerEvent&&((f=dom.$hasEventHandler)(node,"onsize")&&(m.width||m.height)&&this.onSize(!0,{width:m.width,height:m.height}),f(node,"onmove")&&(m.left||m.top)&&this.onMove(!0,{left:m.left,top:m.top})),this}var parent=triggerEvent,pos=region?this.offset(null,parent):this.cssPos(),size=this.cssSize();return{left:pos.left,top:pos.top,width:size.width,height:size.height}},cssSize:function(size,triggerEvent){var r,b1,b2,node=this.get(0),dom=xui.Dom,f=dom._setUnitStyle;return node?(size?(b1=null!==size.width&&f(node,"width",size.width),b2=null!==size.height&&f(node,"height",size.height),triggerEvent&&(b1||b2)&&dom.$hasEventHandler(node,"onsize")&&this.onSize(!0,{width:b1,height:b2}),r=this):r={width:this._W(node,1)||0,height:this._H(node,1)},r):size?this:{}},cssPos:function(pos,triggerEvent){var b1,b2,r,node=this.get(0),dom=xui.Dom,css=xui.CSS,f=dom._setUnitStyle;return pos?(b1=null!=pos.left&&f(node,"left",pos.left),b2=null!==pos.top&&f(node,"top",pos.top),triggerEvent&&(b1||b2)&&dom.$hasEventHandler(node,"onmove")&&this.onMove(!0,{left:b1,top:b2}),r=this):(f=dom.getStyle,r={left:css.$px(f(node,"left"),node),top:css.$px(f(node,"top"),node)}),node=null,r},offset:function(pos,boundary,original){var r,t,browser=xui.browser,ns=this,node=ns.get(0),keepNode=node,parent=node.parentNode,op=node.offsetParent,doc=node.ownerDocument,dd=doc.documentElement,db=doc.body,_d=/^inline|table.*$/i,getStyle=xui.Dom.getStyle,fixed="fixed"==getStyle(node,"position"),me=arguments.callee,add=me.add||(me.add=function(pos,l,t){pos.left+=parseFloat(l)||0,pos.top+=parseFloat(t)||0}),border=me.border||(me.border=function(node,pos){add(pos,getStyle(node,"borderLeftWidth"),getStyle(node,"borderTopWidth"))}),TTAG=me.TTAG||(me.TTAG={TABLE:1,TD:1,TH:1}),HTAG=me.HTAG||(me.HTAG={BODY:1,HTML:1}),posDiff=me.posDiff||(me.posDiff=function(o,target){var cssPos=o.cssPos(),absPos=o.offset(null,target);return{left:absPos.left-cssPos.left,top:absPos.top-cssPos.top}});if(boundary=boundary?xui(boundary).get(0):doc,pos){if(null===pos.left&&null===pos.top)return ns;var d=posDiff(ns,boundary);ns.cssPos({left:null===pos.left?null:pos.left-d.left,top:null===pos.top?null:pos.top-d.top}),r=ns}else{if(xui.browser.gek&&node===document.body||!node.getBoundingClientRect){for(add(pos={left:0,top:0},node.offsetLeft,node.offsetTop);op&&op!=boundary&&op!=boundary.offsetParent;)add(pos,op.offsetLeft,op.offsetTop),(browser.kde||browser.gek&&!TTAG[op.nodeName])&&border(op,pos),fixed||"fixed"!=getStyle(op,"position")||(fixed=!0),"BODY"!=op.nodeName&&(keepNode="BODY"==op.nodeName?keepNode:op),op=op.offsetParent;for(;parent&&parent.nodeName&&parent!=boundary&&!HTAG[parent.nodeName];)_d.test(getStyle(parent,"display"))||add(pos,-parent.scrollLeft,-parent.scrollTop),browser.gek&&"visible"!=getStyle(parent,"overflow")&&border(parent,pos),parent=parent.parentNode;browser.gek&&"absolute"!=getStyle(keepNode,"position")&&add(pos,-db.offsetLeft,-db.offsetTop),fixed&&add(pos,dd.scrollLeft||db.scrollLeft||0,dd.scrollTop||db.scrollTop||0)}else if(pos={left:(t=xui.Dom.$getBoundingClientRect(node,original)).left,top:t.top},1==boundary.nodeType&&boundary!==document.body)add(pos,-(t=xui.Dom.$getBoundingClientRect(boundary,original)).left+boundary.scrollLeft,-t.top+boundary.scrollTop);else{var base=xui.Dom.getEmptyDiv();base.css({left:0,top:0,position:"absolute"});var basRect=xui.Dom.$getBoundingClientRect(base.get(0),original);base.css({left:xui.Dom.HIDE_VALUE,top:xui.Dom.HIDE_VALUE}),add(pos,-basRect.left,-basRect.top)}r=pos}return r},hasClass:function(name){var i,l,isReg=xui.isReg(name),arr=xui.Dom._getClass(this.get(0)).split(/\s+/);if(!isReg)return-1!=xui.arr.indexOf(arr,name+"");for(i=0,l=arr.length;i<l;i++)if(name.test(arr[i]))return!0;return!1},addClass:function(name){if(!name)return this;var arr,i,l,t,ok,me=arguments.callee,reg=me.reg||(me.reg=/\s+/),arr2=(name+"").split(reg);return arr2.length?this.each((function(o){for(ok=0,arr=xui.Dom._getClass(o).split(reg),t=[],i=0,l=arr.length;i<l;i++)arr[i]&&t.push(arr[i]);for(i=0,l=arr2.length;i<l;i++)arr2[i]&&-1==xui.arr.indexOf(arr,arr2[i])&&(ok=1,t.push(arr2[i]));ok&&xui.Dom._setClass(o,t.join(" "))})):this},removeClass:function(name){var arr,i,l,ok,arr2,isReg=xui.isReg(name),me=arguments.callee,reg=me.reg||(me.reg=/\s+/);return isReg||(arr2=(name+"").split(reg)).length?this.each((function(o){if(ok=0,arr=xui.Dom._getClass(o).split(reg),isReg)xui.filter(arr,(function(o,i){if(name.test(o))return ok=1,!1}));else for(i=0,l=arr2.length;i<l;i++)-1!=xui.arr.indexOf(arr,arr2[i])&&(ok=1,xui.arr.removeValue(arr,arr2[i]));ok&&xui.Dom._setClass(o,arr.join(" "))})):this},replaceClass:function(regexp,replace){var n,r;return this.each((function(o){r=(n=xui.Dom._getClass(o)).replace(regexp,replace),n!=r&&xui.Dom._setClass(o,r)}))},tagClass:function(tag,isAdd){var self=this,me=arguments.callee,r1=me["_r1_"+tag]||(me["_r1_"+tag]=new RegExp("([-\\w]+"+tag+"[-\\w]*)")),r2=me._r2||(me._r2=/([-\w]+)/g);self.removeClass(r1);var r=(isAdd=!1!==isAdd)?self.replaceClass(r2,"$1 $1"+tag):self;return!xui.__iefix2||"-checked"!=tag&&"-fold"!=tag&&"-expand"!=tag||this.each((function(n){var arr=xui.Dom._getClass(n).split(/\s+/);-1==xui.arr.indexOf(arr,"xuifont")&&-1==xui.arr.indexOf(arr,"xuicon")||xui.arr.each(arr,(function(s){if(xui.__iefix2[s+(isAdd?"":tag)]&&xui.__iefix2[isAdd?s.replace(new RegExp(tag+"$"),""):s])return xui(n).html(xui.__iefix2[s.replace(new RegExp(tag+"$"),"")+(isAdd?tag:"")]),!1}))})),r},$addEventHandler:function(name){var type,event=xui.Event,handler=event.$eventhandler;return this.each((function(o){3!=o.nodeType&&(xui.setNodeData(o,["eHandlers","on"+event._eventMap[name]],handler),(type=event._eventHandler[name])&&(xui.setNodeData(o,["eHandlers",type],handler),event._addEventListener(o,event._eventMap[name],handler),xui.browser.isTouch&&"onmousedown"==type&&(xui.setNodeData(o,["eHandlers","onxuitouchdown"],handler),event._addEventListener(o,"xuitouchdown",handler))))}))},$removeEventHandler:function(name){var type,event=xui.Event,handler=event.$eventhandler,handler3=event.$eventhandler3;return this.each((function(o){(type=event._eventHandler[name])&&(event._removeEventListener(o,type,handler),event._removeEventListener(o,type,handler3),xui.browser.isTouch&&"onmousedown"==type&&event._removeEventListener(o,"xuitouchdown",handler)),(o=xui.getNodeData(o,"eHandlers"))&&(delete o[type="on"+event._eventMap[name]],xui.browser.isTouch&&"onmousedown"==type&&delete o.onxuitouchdown)}))},$addEvent:function(name,fun,label,index){var id,c,t,k,m,event=xui.Event,arv=xui.arr.removeValue,ari=xui.arr.insertAny;return index||0===index||(index=-1),label="string"==typeof label?"$"+label:undefined,this.$addEventHandler(name).each((function(o){3!=o.nodeType&&((id=event.getId(o))||o===window||o===document||(id=o.id=xui.Dom._pickDomId()),(c=xui.$cache.profileMap[id])||(c=new xui.DomProfile(id)),t=c.events||(c.events={}),m=t[name]||(t[name]=[]),label===undefined&&(m.length=0,m=t[name]=[],index=-1,label="_"),m[label]=fun,arv(m,label),-1==index?m[m.length]=label:ari(m,label,index),xui.Event&&(c=xui.Event._getProfile(id))&&(t=c.$_egetter)&&(k=t[id+"+"+name])&&(k.length=0,delete t[id+"+"+name]))})),this},$removeEvent:function(name,label,bAll){var c,t,k,id,event=xui.Event,dom=xui.$cache.profileMap,type=event._eventMap[name];return this.each((function(o){(id=event.getId(o))&&(c=dom[id])&&(t=c.events)&&(bAll?xui.arr.each(event._getEventName(type),(function(o){delete t[o]})):"string"==typeof label?(label="$"+label,(k=t[name])&&(delete k[label],-1!=xui.arr.indexOf(k,label)&&xui.arr.removeValue(k,label))):delete t[name],xui.Event&&(c=xui.Event._getProfile(id))&&(t=c.$_egetter)&&(k=t[id+"+"+name])&&(k.length=0,delete t[id+"+"+name]))})),this},$getEvent:function(name,label){var id;if(id=xui.Event.getId(this.get(0))){if(label)return xui.get(xui.$cache.profileMap,[id,"events",name,"$"+label]);var r=[],arr=xui.get(xui.$cache.profileMap,[id,"events",name]);return xui.arr.each(arr,(function(o,i){r[r.length]={o:arr[o]}})),r}},$clearEvent:function(){return this.each((function(o,i){var type,event=xui.Event,handler=event.$eventhandler,handler3=event.$eventhandler3;(i=event.getId(o))&&(i=xui.$cache.profileMap[i])&&(i.events&&(xui.each(i.events,(function(f,name){(type=xui.Event._eventMap[name])&&(event._removeEventListener(o,type,handler),event._removeEventListener(o,type,handler3))})),xui.breakO(i.events,2),delete i.events),xui.set(xui.$cache.domPurgeData,[o.$xid,"eHandlers"],{}))}))},$fireEvent:function(name,args){var handler,hash,type=xui.Event._eventMap[name],s="on"+type,me=arguments.callee,f1=(xui.Event.$eventhandler,me.f1||(me.f1=function(){this.returnValue=!1})),f2=me.f2||(me.f2=function(){this.cancelBubble=!0});return this.each((function(o){if(handler=xui.getNodeData(o,["eHandlers",s]))if("blur"==type||"focus"==type)try{o[type]()}catch(e){}else hash=xui.copy(args),xui.merge(hash,{type:type,target:o,button:1,$xuievent:!0,$xuitype:name,preventDefault:f1,stopPropagation:f2},"all"),handler.call(o,hash)}))},nativeEvent:function(name){return this.each((function(o){if(3!==o.nodeType&&8!==o.nodeType)try{o[name]()}catch(e){}}))},$canFocus:function(){var t,node,me=arguments.callee,getStyle=xui.Dom.getStyle,map=me.map||(me.map={a:1,input:1,select:1,textarea:1,button:1,object:1});return!!((node=this.get(0))&&node.focus&&((t=map[node.nodeName.toLowerCase()])&&!(parseInt(node.tabIndex,10)<=-1)||!t&&parseInt(node.tabIndex,10)>=(xui.browser.ie?1:0))&&"none"!=getStyle(node,"display")&&"hidden"!=getStyle(node,"visibility")&&node.offsetWidth>0&&node.offsetHeight>0)},focus:function(force){if(force||this.$canFocus())try{this.get(0).focus()}catch(e){}return this},blur:function(){var n=this.get(0);n&&(n.blur(),document.activeElement===n&&xui.asyRun((function(){xui("body").append(n=xui.create("<button style='position:absolute;width:1px;height:1px;left:-1000px;'></button>")),n.focus(),n.remove()})))},setSelectable:function(value){return this.removeClass("xui-ui-selectable").removeClass("xui-ui-unselectable"),this.addClass(value?"xui-ui-selectable":"xui-ui-unselectable"),this.each((function(o){xui.browser.ie&&xui.browser.ver<10&&xui.setNodeData(o,"_onxuisel",value?"true":"false")}))},contentBox:function(d){return xui.browser.ie||xui.browser.opr?!/BackCompat|QuirksMode/.test((d||document).compatMode):"content-box"==(this.css("box-sizing")||this.css("-moz-box-sizing"))},setInlineBlock:function(){var ns=this;return xui.browser.gek?xui.browser.ver<3?ns.css("display","-moz-inline-block").css("display","-moz-inline-box").css("display","inline-block"):ns.css("display","inline-block"):xui.browser.ie&&xui.browser.ver<=6?ns.css("display","inline-block").css({display:"inline",zoom:"1"}):ns.css("display","inline-block"),ns},topZindex:function(flag){var k,t,o,style,i=1e3,j=0,node=this.get(0),p=node.offsetParent||node.parentNode;if(!xui.browser.ie||p&&"HTML"!=(p.nodeName+"").toUpperCase()||(p=xui("body").get(0)),1!=node.nodeType||!p)return 1;for(t=p.childNodes,k=0;o=t[k];k++)style=o.style,o==node||1!=o.nodeType||!o.$xid||style&&"none"==style.display||style&&"hidden"==style.visibility||o.zIndexIgnore||xui.getNodeData(o,"zIndexIgnore")||(i=i>(j=parseInt(style&&style.zIndex,10)||0)?i:j);return++i>=xui.Dom.TOP_ZINDEX&&(xui.Dom.TOP_ZINDEX=i+1),flag?(node.style.zIndex=i,this):i>(j=parseInt(node.style.zIndex,10)||0)?i:j},nextFocus:function(downwards,includeChild,setFocus,pattern){downwards=!xui.isBool(downwards)||downwards;var self=this.get(0),node=this.$iterator("",downwards,includeChild,(function(node){return node!==self&&(!pattern||node.id&&pattern.test(node.id))&&xui([node]).$canFocus()}));return node.isEmpty()||!1===setFocus||node.focus(),self=null,node},fullScreen:function(full){var e=this.get(0),d=document;if(e){e===d&&(e=d.documentElement);var requestMethod=!1!==full?e.requestFullScreen||e.webkitRequestFullScreen||e.mozRequestFullScreen||e.msRequestFullScreen:d.exitFullscreen||d.mozCancelFullScreen||d.webkitExitFullscreen||d.webkitExitFullscreen;if(requestMethod)requestMethod.call(!1!==full?e:d);else if(void 0!==window.ActiveXObject){var wscript=new ActiveXObject("WScript.Shell");null!==wscript&&wscript.SendKeys("{F11}")}}},animate:function(endpoints,onStart,onEnd,duration,step,type,threadid,unit,restore,times,_goback){var self=this,map={left:1,top:1,right:1,bottom:1,width:1,height:1},prf=xui.$cache.profileMap[self.id()],ctrl=prf?prf["xui.DomProfile"]?xui(prf):prf.boxing():null,css=xui.CSS,tween=xui.Dom.$AnimateEffects,_get=function(node,ctrl,key,t){return map[key]&&ctrl&&xui.isFun(ctrl[t="get"+xui.str.initial(key)])?ctrl[t](key):node[key]?node[key]():node.css(key)};if(endpoints){xui.each(endpoints,(function(o,i){xui.isFun(o)||(xui.isArr(o)&&1!==o.length||(o=[_get(self,ctrl,i),o]),endpoints[i]=o)}));var parmsBak=endpoints;endpoints=xui.clone(endpoints),duration=(step||0)>0?16*step:duration||200,times=times||1,-1!=(type||"").indexOf("-")&&(type=type.replace(/\-(\w)/g,(function(a,b){return b.toUpperCase()}))),type=type in tween?type:"circIn";var starttime,node=self.get(0),fun=function(tid){var curvalue,u,eu,su,s,e,offtime=xui.stamp()-starttime;if(offtime>=duration&&(offtime=duration),xui.each(endpoints,(function(o,i){curvalue=tween[type](duration,offtime),"function"==typeof o?o.call(self,curvalue):(s=o[0],e=o[1],u=o[2],xui.str.endWith(i.toLowerCase(),"color")?curvalue=function(from,to,curvalue){return"string"!=typeof from||"string"!=typeof to?"#fff":curvalue<0?from:curvalue>1?to:(from=(f=function(str){return"#"!=str.charAt(0)?"#"+str:str})(from),to=f(to),f1=function(str,i,j){return parseInt(str.slice(i,j),16)||0},"#"+(f3=function(from,to,value,c){var r=from[c]+Math.round(parseFloat(value*(to[c]-from[c]))||0);return(r<16?"0":"")+r.toString(16)})(from=(f2=function(o){return{red:f1(o,1,3),green:f1(o,3,5),blue:f1(o,5,7)}})(from),to=f2(to),curvalue,"red")+f3(from,to,curvalue,"green")+f3(from,to,curvalue,"blue"));var f,f1,f2,f3}(s,e,curvalue):(xui.isFinite(e)||(u=e.replace(/[-\d.]*/,""),eu=u||"px",xui.isFinite(s)||(su=s.replace(/[-\d.]*/,"")||"px")!=eu&&("em"==su&&"px"==eu?s=css.$em2px(s,node):"px"==su&&"em"==eu&&(s=css.$px2em(s,node)))),s=parseFloat(s)||0,e=parseFloat(e)||0,curvalue=xui.toFixedNumber(s+(e-s)*curvalue,6)),function(node,ctrl,key,value,t){map[key]&&ctrl&&xui.isFun(ctrl[t="set"+xui.str.initial(key)])?ctrl[t](value):node[key]?node[key](value):node.css(key,value)}(self,ctrl,i,curvalue+=u||unit||""))})),offtime==duration)return restore&&!_goback?(starttime=xui.stamp(),_goback=1,xui.each(endpoints,(function(v,k){xui.isFun(v)||(k=v[0],v[0]=v[1],v[1]=k)}))):(-1==times||times>0)&&(starttime=xui.stamp(),times>0&&(times-=1),_goback&&(_goback=0,xui.each(endpoints,(function(v,k){xui.isFun(v)||(k=v[0],v[0]=v[1],v[1]=k)})))),times||xui.Thread.abort(tid,"normal"),!1},funs=[fun],tid=xui.getNodeData(node,"_inthread");tid&&xui.Thread.isAlive(tid)&&(xui.Thread.abort(tid,"force"),xui.setNodeData(node,"_inthread",null));var reset=xui.getNodeData(node,"_animationreset");return"function"==typeof reset&&(reset(),xui.setNodeData(node,"_animationreset",null)),xui.Thread(!threadid||xui.Thread.get(threadid)?xui.id():threadid,funs,0,null,(function(tid){return xui.setNodeData(node,"_inthread",tid),starttime=xui.stamp(),xui.setNodeData(node,"_animationreset",(function(){xui.merge(endpoints,parmsBak,"all"),starttime=xui.stamp(),fun()})),xui.tryF(onStart,arguments,this)}),(function(tid,flag){node&&node.$xid&&(xui.setNodeData(node,"_inthread",null),xui.setNodeData(node,"_animationreset",null)),"force"!=flag&&xui.tryF(onEnd,arguments,this)}),!0)}onEnd&&xui.tryF(onEnd)},pop:function(pos,type,parent,trigger,group){var ns=this,id=xui.stamp()+":"+ns.xid();return ns.popToTop(pos,type||"outer",parent).setBlurTrigger(id,(function(){"function"==typeof trigger?xui.tryF(trigger):ns.hide()})),id},popUp:function(pos,type,parent,trigger,group){return this.pop.apply(this,arguments)},popToTop:function(pos,type,parent,callback,showEffects,ignoreEffects){return(parent=xui(parent)).isEmpty()&&(parent=xui("body")),this.css({position:"absolute",display:"block",zIndex:xui.Dom.TOP_ZINDEX++,visibility:"hidden"}),parent.append(this),pos&&this.cssPos(xui.Dom.getPopPos(pos,type,this,parent)),this.css({visibility:"visible"}),this.removeClass("xui-ui-hidden"),(showEffects=ignoreEffects?null:showEffects||xui.get(xui.UIProfile.getFromDom(this),["properties","showEffects"]))&&(showEffects=xui.Dom._getEffects(showEffects,1)),showEffects?xui.Dom._vAnimate(this,showEffects,callback):callback&&callback(),this},hoverPop:function(node,type,beforePop,beforeHide,parent,groupid,showEffects,hideEffects){node=xui(node),showEffects&&(showEffects=xui.Dom._getEffects(showEffects,1)),hideEffects&&(hideEffects=xui.Dom._getEffects(hideEffects,0)),xui.isDefined(type)||(type="outer");var aysid=groupid||this.xid()+":"+node.xid(),self=this;return this.onMouseover(null===type?null:function(prf,e,src){e.$force||(xui.resetRun(aysid,null),xui.getData([aysid,"$ui.hover.pop"])&&xui.getNodeData(node.get(0)||"empty","$ui.hover.parent")==src||(xui.setData([aysid,"$ui.hover.pop"],1),xui.setNodeData(node.get(0)||"empty","$ui.hover.parent",src),beforePop&&!1===beforePop(prf,node,e,src)||(node.popToTop(src,type,parent,showEffects),node.onMouseover((function(){self.onMouseover(!0)}),"hoverPop").onMouseout((function(){self.onMouseout(!0)}),"hoverPop"))))},aysid).onMouseout(null===type?null:function(prf,e,src){e.$force||xui.resetRun(aysid,(function(){xui.setData([aysid,"$ui.hover.pop"]),xui.setNodeData(node.get(0)||"empty","$ui.hover.parent",0),beforeHide&&!1===beforeHide(prf,node,e,src,"host")||(node.hide(null,hideEffects),node.onMouseover(null,"hoverPop").onMouseout(null,"hoverPop"))}))},aysid),node&&node.onMouseover(null===type?null:function(e){e.$force||xui.resetRun(aysid,null)},aysid).onMouseout(null===type?null:function(prf,e,src){e.$force||xui.resetRun(aysid,(function(){xui.setData([aysid,"$ui.hover.pop"]),xui.setNodeData(node.get(0)||"empty","$ui.hover.parent",0),beforeHide&&!1===beforeHide(prf,node,e,src,"pop")||(node.hide(null,hideEffects),node.onMouseover(null,"hoverPop").onMouseout(null,"hoverPop"))}))},aysid),node.css("display","none"),this},setBlurTrigger:function(id,trigger,group,checkChild,triggerNext){var target,doc=document,fun=xui.Dom._blurTrigger||(xui.Dom._blurTrigger=function(prf,e){var b,pos,w,h,v,p=xui.Event.getPos(e),arr=arguments.callee.arr,srcN=xui.Event.getSrc(e),a=xui.copy(arr);xui.arr.each(a,(function(i){b=!0,(v=arr[i].target)?v.each((function(o){if(o!==window&&o!==document&&!xui.Dom.byId(o.id))return b=!1})):b=!1,b||(delete arr[i],xui.arr.removeValue(arr,i))})),a=xui.copy(arr),xui.arr.each(a,(function(i){if(v=arr[i]){b=!0;var isChild=function(){for(var nds=v.target.get();srcN&&srcN.nodeName&&"BODY"!=srcN.nodeName&&"HTML"!=srcN.nodeName;){if(-1!=xui.arr.indexOf(nds,srcN))return!0;srcN=srcN.parentNode}};if(v.checkChild&&!isChild()||v.target.each((function(o){if(o.parentNode&&(w=o.offsetWidth)&&(h=o.offsetHeight)&&(pos=xui([o]).offset(),p.left>=pos.left&&p.top>=pos.top&&p.left<=pos.left+w&&p.top<=pos.top+h))return b=!1})),isChild=null,!b&&!xui.isFun(v.trigger))return!1;if(b)delete arr[i],xui.arr.removeValue(arr,i),xui.tryF(v.trigger,[p,e],v.target),v=null;else if(v.stopNext)return!1}}),null,!0),srcN=null,a.length=0}),arr=fun.arr||(fun.arr=[]);return arr[id]&&(!0===trigger&&(xui.tryF(arr[id].trigger),trigger=!1),delete arr[id],xui.arr.removeValue(arr,id)),trigger&&(group?(group["xui.Dom"]?target=group:xui.isArr(group)&&((target=xui())._nodes=group),target.merge(this)):target=this,target.each((function(o){o.id||o===window||o===document||(o.id=xui.Dom._pickDomId())})),arr[id]={trigger:trigger,target:target,checkChild:!!checkChild,stopNext:!triggerNext},arr.push(id),doc.onmousedown||(doc.onmousedown=xui.Event.$eventhandler),doc=fun=null),this},$firfox2:function(){if(!xui.browser.gek2)return this;var ns=this;return ns.css("overflow","hidden"),xui.asyRun((function(){ns.css("overflow","auto")})),ns},ieRemedy:function(){if(xui.browser.ie&&xui.browser.ver<=6){for(var style,a1=this.get(),a2=[],a3=[],l=a1.length,i=0;i<l;i++)style=a1[i].style,xui.isSet(a1[i].$ieRemedy)||xui.isSet(style.width)&&(a1[i].$ieRemedy=style.width,style.width=(xui.CSS.$px(a1[i].$ieRemedy,a1[i])||0)+1+"px");xui.asyRun((function(){for(var i=0;i<l;i++)xui.isSet(a1[i].$ieRemedy)&&(a1[i].style.width=a1[i].$ieRemedy,a1[i].removeAttribute("$ieRemedy"));a1.length=a2.length=a3.length=0}))}return this}},Static:{HIDE_VALUE:"-10000px",TOP_ZINDEX:1e4,_boxArr:xui.toArr("width,height,left,top,right,bottom"),_cursor:{},_pickDomId:function(){var id;do{id="xui_"+xui.id()}while(document.getElementById(id));return id},_map:{html:1,head:1,body:1},fixPng:function(n){if(xui.browser.ie&&xui.browser.ver<=6){if("IMG"==n.nodeName&&-1!=n.src.toLowerCase().search(/\.png$/)){var style=n.style;style.height=n.height,style.width=n.width,style.backgroundImage="none";var t=((style.filter?style.filter+",":"")+"progid:DXImageTransform.Microsoft.AlphaImageLoader(enabled=true, src="+n.src+"', sizingMethod='image')").replace(/(^[\s,]*)|([\s,]*$)/g,"").replace(/[,\s]+/g,", ");xui.browser.ie8&&(style.msfilter=t),style.filter=t,n.src=xui.ini.img_bg}var bgmatch=(n.currentStyle.backgroundImage||style.backgroundImage||"").toLowerCase().match(/^url[("']+(.*\.png[^\)"']*)[\)"']+[^\)]*$/i);bgmatch&&(style.backgroundImage="none",t=((style.filter?style.filter+",":"")+"progid:DXImageTransform.Microsoft.AlphaImageLoader(enabled=true, src="+bgmatch[1]+"', sizingMethod='crop')").replace(/(^[\s,]*)|([\s,]*$)/g,"").replace(/[,\s]+/g,", "),xui.browser.ie8&&(style.msfilter=t),style.filter=t)}},_getTag:function(n){return n?n.$xid?n.$xid:1==n.nodeType?xui.$registerNode(n).$xid:0:0},_ensureValues:function(obj){var t,i,map=this._map,a=[],arr=obj===window?["!window"]:obj===document?["!document"]:xui.isArr(obj)?obj:"[object NodeList]"==obj||"[object HTMLCollection]"==obj?xui.toArr(obj):obj["xui.Dom"]?obj._nodes:obj._toDomElems?obj._toDomElems():"function"==typeof obj?obj():[obj];for(i=0;i<arr.length;i++)(t=(t=arr[i])?t===window?"!window":t===document?"!document":"string"==typeof t||t["xui.DomProfile"]&&(t=t.domId)?"!"==t.charAt(0)?t:this._getTag(map[t]?document.getElementsByTagName(t)[0]:document.getElementById(t)):(t=arr[i])["xui.UIProfile"]||t["xui.Template"]?(t.renderId||t.boxing().render())&&t.renderId:this._getTag(t):0)&&(a[a.length]=t);return a.length<=1?a:this._unique(a)},_getClass:function(o){return"string"==typeof o.className&&o.className||"string"==typeof o.className.baseVal&&o.className.baseVal||void 0!==o.getAttribute&&o.getAttribute("class")||""},_setClass:function(o,v){"string"==typeof o.className?o.className=v:"string"==typeof o.className.baseVal?o.className.baseVal=v:void 0!==o.getAttribute&&o.setAttribute(v)},getPopPos:function(pos,type,target,parent){var result={left:0,top:0};if(pos){if(xui.isEvent(pos))return xui.Event.getPos(pos);var region,node,abspos,t,box;if((parent=xui(parent)).isEmpty()&&(parent=xui("body")),pos["xui.UI"]||pos["xui.UIProfile"]||pos["xui.Dom"]||1==pos.nodeType||"string"==typeof pos?("function"!=typeof type&&(type=(type||12)+""),abspos=(node=xui(pos)).offset(null,parent),region={left:abspos.left,top:abspos.top,width:node.offsetWidth(),height:node.offsetHeight()}):("function"!=typeof type&&(type=type?"3":"0"),t="0"==type?0:8,region=pos.region||{left:pos.left-t,top:pos.top-t,width:2*t,height:2*t}),t=parent.get(0)===document.body||parent.get(0)===document||parent.get(0)===window?xui.win:parent,(box={}).left=t.scrollLeft(),box.top=t.scrollTop(),box.width=t.width()+box.left,box.height=t.height()+box.top,t==xui.win&&xui.ini.$zoomScale)for(var i in box)box[i]/=xui.ini.$zoomScale;if("function"==typeof type)result=type(region,box,target,t);else{var a=type.split(":"),w=target?target.offsetWidth():0,h=target?target.offsetHeight():0,arr=a[0].split(/-/g),border=parseInt(a[1])||0;if(type=a[0],2==arr.length){var hp=arr[0];switch(arr[1]){case"outertop":result.top=region.top-h;break;case"top":result.top=region.top;break;case"middle":result.top=region.top+region.height/2-h/2;break;case"bottom":result.top=region.top+region.height-h;break;default:result.top=region.top+region.height}switch(hp){case"outerleft":result.left=region.left-w;break;case"left":result.left=region.left;break;case"center":result.left=region.left+region.width/2-w/2;break;case"right":result.left=region.left+region.width-w;break;default:result.left=region.left+region.width}}else{var adjust=function(type){var hi,wi;switch(type){case"2":hi=!0,wi=!1;break;case"3":hi=wi=!1;break;case"4":hi=wi=!0;break;default:hi=!1,wi=!0}hi?region.top+h<box.height?result.top=region.top:result.top=region.top+region.height-h:region.top+region.height+h<box.height?result.top=region.top+region.height:result.top=region.top-h,wi?region.left+w<box.width?result.left=region.left:result.left=region.left+region.width-w:region.left+region.width+w<box.width?result.left=region.left+region.width:result.left=region.left-w,result.left+w>box.width&&(result.left=box.width-w),result.left<box.left&&(result.left=box.left),result.top+h>box.height&&(result.top=box.height-h),result.top<box.top&&(result.top=box.top)};"12"==(type="inner"==type?"4":"outer_tb"==type?"1":"outer_lr"==type?"2":"outer"==type?"12":type)?(adjust("1"),result.top<region.top+region.height&&result.top+h>region.top&&adjust("2")):"21"==type?(adjust("2"),result.left<region.left+region.width&&result.left+w>region.left&&adjust("1")):adjust(type)}border&&(result.left+=border,result.top+=border,result.width-=2*border,result.height-=2*border)}return result}return result},_scrollBarSize:0,getScrollBarSize:function(force){var div;return!force&&this._scrollBarSize||(xui("body").append(div=xui.create('<div style="width:50px;height:50px;visibility:hidden;position:absolute;margin:0;padding:0;left:-100%;top:-100%;overflow:scroll;"></div>')),this._scrollBarSize=div.get(0).offsetWidth-div.get(0).clientWidth,div.remove()),this._scrollBarSize},_dpi:0,getDPI:function(force){var div;return!force&&this._dpi||(xui("body").append(div=xui.create('<div style="width:1in;height:1in;visibility:hidden;position:absolute;margin:0;padding:0;left:-100%;top:-100%;overflow:scroll;"></div>')),this._dpi=div.get(0).offsetHeight,div.remove()),this._dpi},getStyle:function(node,name,force){if(!node||1!=node.nodeType)return"";if("rotate"==name)return xui(node).rotate();var value,b,ns=xui.Dom,css3prop=xui.Dom._css3prop,style=node.style;if("opacity"==name&&!ns.css3Support("opacity")&&xui.browser.ie&&(b=name="filter"),value=style[name],force||!value||"initial"===value){var t,name3,name4,me=xui.Dom.getStyle,brs=xui.browser,map=me.map||(me.map={float:1,cssFloat:1,styleFloat:1}),c1=me._c1||(me._c1={}),c2=me._c2||(me._c2={}),name1=(me._c3||(me._c3={}),c1[name]||(c1[name]=name.replace(/\-(\w)/g,(function(a,b){return b.toUpperCase()})))),name2=c2[name1]||(c2[name1]=name1.replace(/([A-Z])/g,"-$1").toLowerCase()),n1=name1;if(0===n1.indexOf("border")&&(n1=n1.replace(/[-]?(left|top|right|bottom)/gi,"")),-1!=xui.arr.indexOf(css3prop,n1)){if(!ns.css3Support(name1))return"";"textShadow"!=name1&&(name3=brs.cssTag2+name2.charAt(0).toUpperCase()+name2.substr(1),name4=brs.cssTag1+name2)}map[name1]&&(name1=xui.browser.ie?"styleFloat":"cssFloat"),value=(t=document.defaultView)&&t.getComputedStyle?(t=t.getComputedStyle(node,null))?t.getPropertyValue(name2)||name4&&t.getPropertyValue(name4):"":node.currentStyle?node.currentStyle[name1]||node.currentStyle[name2]||name3&&(node.currentStyle[name3]||node.currentStyle[name4]):style&&(style[name1]||name3&&style[name3])||""}return!b&&xui.browser.ie678&&(("fontSize"==name||"font-size"==name2)&&/%/.test(value)&&node.parentNode?value=(node.parentNode.currentStyle[name]||node.parentNode.currentStyle[name2])*(parseFloat(value)||0):xui.CSS.$isEm(value)&&(value=xui.CSS.$px(value,node))),b?value?(parseFloat(value.match(/alpha\(opacity=(.*)\)/)[1])||0)/100:1:value||""},$getBoundingClientRect:function(node,original){var t,rect=node.getBoundingClientRect();if(!original&&(t=xui.ini.$transformScale))for(var i in rect)rect[i]/=t;return rect},$transformIE:function(node,value){var style=node.style,t=(style.filter||"").replace(/progid\:DXImageTransform\.Microsoft\.Matrix\([^)]+\)/gi,"").replace(/(^[\s,]*)|([\s,]*$)/g,"").replace(/,[\s]+/g,","+(8==xui.browser.ver?"":" "));if(xui.browser.ie8&&(style.msfilter=t),style.filter=t,style.marginTop=style.marginLeft="",value){var tmatrix=function(){var current,degRat=Math.PI/180,matrix=function(m11,m12,m21,m22,dx,dy){var m={};return m.m11=xui.isSet(m11)?parseFloat(m11):1,m.m12=xui.isSet(m12)?parseFloat(m12):0,m.m21=xui.isSet(m21)?parseFloat(m21):0,m.m22=xui.isSet(m22)?parseFloat(m22):1,m.dx=xui.isSet(dx)?parseFloat(dx):0,m.dy=xui.isSet(dy)?parseFloat(dy):0,m},multiply=function(newMatrix,currentMatrix){var m={};return m.m11=roundNumber(newMatrix.m11*currentMatrix.m11+newMatrix.m21*currentMatrix.m12,10),m.m12=roundNumber(newMatrix.m12*currentMatrix.m11+newMatrix.m22*currentMatrix.m12,10),m.m21=roundNumber(newMatrix.m11*currentMatrix.m21+newMatrix.m21*currentMatrix.m22,10),m.m22=roundNumber(newMatrix.m12*currentMatrix.m21+newMatrix.m22*currentMatrix.m22,10),m.dx=roundNumber(currentMatrix.dx+newMatrix.dx,10),m.dy=roundNumber(currentMatrix.dy+newMatrix.dy,10),m},deg2rad=function(deg){return degRat*deg},roundNumber=function(num,dec){return Math.round(num*Math.pow(10,dec))/Math.pow(10,dec)};this.rotate=function(deg){var rad=xui.isSet(deg)?parseFloat(deg2rad(parseFloat(deg))):0,m=matrix(Math.cos(rad),-Math.sin(rad),Math.sin(rad),Math.cos(rad),0,0);current=multiply(m,current)},this.translate=function(x,y){var m=matrix(1,0,0,1,parseFloat(x),parseFloat(y));current=multiply(m,current)},this.translateX=function(x){this.translate(x,0)},this.translateY=function(y){this.translate(0,y)},this.scale=function(x,y){var m=matrix(xui.isSet(x)?parseFloat(x):1,0,0,xui.isSet(y)?parseFloat(y):1,0,0);current=multiply(m,current)},this.scaleX=function(x){this.scale(x,1)},this.scaleY=function(y){this.scale(1,y)},this.skew=function(xAng,yAng){xAng=xui.isSet(xAng)?parseFloat(deg2rad(parseFloat(xAng))):0,yAng=xui.isSet(yAng)?parseFloat(deg2rad(parseFloat(yAng))):0;var m=matrix(1,Math.tan(xAng),Math.tan(yAng),1,0,0);current=multiply(m,current)},this.skewX=function(xAng){this.skew(xAng,0)},this.skewY=function(yAng){this.skew(0,yAng)},this.matrix=function(m11,m12,m21,m22,dx,dy){current=multiply(matrix(m11,m12,m21,m22,dx,dy),current)},this.getMatrix=function(){return current},this.getFilter=function(){return"progid:DXImageTransform.Microsoft.Matrix(M11="+current.m11+", M12="+current.m12+", M21="+current.m21+", M22="+current.m22+", Dx="+current.dx+", Dy="+current.dy+", SizingMethod='auto expand')"},this.getX=function(){return current.dx},this.getY=function(){return current.dy},this.reset=function(){current=matrix(1,0,0,1,0,0)},this.reset()},matrix=function(transform){for(var m=new tmatrix,functions=transform.match(/[A-z]+\([^\)]+/g)||[],k=0;k<functions.length;k++){var values,arr=functions[k].split("("),func=arr[0],value=arr[1];switch(func){case"rotate":m.rotate(value);break;case"scale":values=value.split(","),m.scale(values[0],values[1]);break;case"scaleX":m.scaleX(value);break;case"scaleY":m.scaleY(value);break;case"skew":values=value.split(","),m.skew(values[0],values[1]);break;case"skewX":m.skewX(value);break;case"skewY":m.skewY(value);break;case"translate":values=value.split(","),m.translate(values[0],values[1]);break;case"translateX":m.translateX(value);break;case"translateY":m.translateY(value)}}return m}(value),ow=node.offsetWidth,oh=node.offsetHeight,filter=matrix.getFilter();if(t=((style.filter?style.filter+",":"")+filter).replace(/(^[\s,]*)|([\s,]*$)/g,"").replace(/,[\s]+/g,","+(8==xui.browser.ver?"":" ")),xui.browser.ie8&&(style.msfilter=t),style.filter=t,node.getBoundingClientRect){var transX=matrix.getX(),transY=matrix.getY(),rect=xui.Dom.$getBoundingClientRect(node),w=rect.right-rect.left,h=rect.bottom-rect.top;style.marginLeft=Math.round(parseFloat((ow-w)/2+10+transX))+"px",style.marginTop=Math.round(parseFloat((oh-h)/2+10+transY))+"px"}style.transform=value}},$textShadowIE:function(node,value,box){var style=node.style;if(value){f=function(x,y,r,c){return(box?"":"progid:DXImageTransform.Microsoft.Chroma(Color=#cccccc) ")+"progid:DXImageTransform.Microsoft.DropShadow(Color="+c+", OffX="+x+", OffY="+y+") "+(parseFloat(r)>0?"progid:DXImageTransform.Microsoft.Glow(Strength="+r+", Color="+c+")":"")};var r=value.match(/([\d\.-]+)px\s+([\d\.-]+)px(\s+([\d\.-]+)px)?(\s+([#\w]+))?/);if(r){var t=((style.filter?style.filter+",":"")+f(r[1],r[2],r[4],r[6]||"#000000")).replace(/(^[\s,]*)|([\s,]*$)/g,"").replace(/,[\s]+/g,","+(8==xui.browser.ver?"":" "));xui.browser.ie8&&(style.msfilter=t),style.filter=t,box||(style.backgroundColor="#C5C5C5")}}else{var f=function(s){return(s||"").replace(/progid\:DXImageTransform\.Microsoft\.(Chroma|DropShadow|Glow)\([^)]+\)/gi,"").replace(/(^[\s,]*)|([\s,]*$)/g,"").replace(/,[\s]+/g,","+(8==xui.browser.ver?"":" "))},s1=style.filter;s1&&(xui.browser.ie8&&(style.msfilter=f(s1)),style.filter=f(s1)),box||(style.backgroundColor="")}},$setGradients:function(node,value,xb){xb=xb||xui.browser;var ns=this,ver=xb.ver,c16="0123456789ABCDEF",_toFF=function(n,b){return n=parseInt(n*b,10)||0,c16.charAt(((n=n>255||n<0?0:n)-n%16)/16)+c16.charAt(n%16)},_to255=function(s){return s=s.split(""),16*c16.indexOf(s[0].toUpperCase())+c16.indexOf(s[1].toUpperCase())};window.btoa=window.btoa||function(text){if(!/([^\u0000-\u00ff])/.test(text)){for(var cur,prev,byteNum,table="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",i=0,result=[];i<text.length;){switch(cur=text.charCodeAt(i),byteNum=(i+1)%3){case 1:result.push(table.charAt(cur>>2));break;case 2:result.push(table.charAt((3&prev)<<4|cur>>4));break;case 0:result.push(table.charAt((15&prev)<<2|cur>>6)),result.push(table.charAt(63&cur))}prev=cur,i++}return 1==byteNum?(result.push(table.charAt((3&prev)<<4)),result.push("==")):2==byteNum&&(result.push(table.charAt((15&prev)<<2)),result.push("=")),result.join("")}};var svgcracker1=function(node,orient,stops,shape,size,rate){if(orient){rate=rate||1;var id="svg:"+xui.id(),cx="0%",cy="0%",r=100*rate+"%";if(xui.isObj(orient))cx=orient.left||cx,cy=orient.left||cy;else switch(orient){case"T":cx="50%",cy="0%";break;case"B":cx="50%",cy="100%";break;case"L":cx="0%",cy="50%";break;case"R":cx="100%",cy="50%";break;case"LT":cx="0%",cy="0%";break;case"RT":cx="100%",cy="0%";break;case"RB":cx="100%",cy="100%";break;case"LB":cx="0%",cy="100%";break;case"C":cx="50%",cy="50%"}for(var svg='<svg xmlns="http://www.w3.org/2000/svg" width="100%" height="100%" viewBox="0 0 1 1" preserveAspectRatio="none"><radialGradient id="'+id+'" gradientUnits="userSpaceOnUse" cx="'+cx+'" cy="'+cy+'" r="'+r+'">',i=0,l=stops.length;i<l;i++)svg+='<stop stop-color="'+stops[i].clr+'" offset="'+stops[i].pos+'" '+(xui.isSet(stops[i].opacity)?' stop-opacity="'+stops[i].opacity+'"':"")+" />";svg+='</radialGradient><rect x="-50" y="-50" width="101" height="101" fill="url(#'+id+')" /></svg>',node.style.backgroundImage='url("data:image/svg+xml;base64,'+window.btoa(svg)+'")'}else node.style.backgroundImage=""},type=value?(value.type||value||"linear").toLowerCase():null,rate=value?value.rate||1:null,shape=value?(value.shape||"circle").toLowerCase():null,size=value?(value.size||"farthest-corner").toLowerCase():null,orient=value?value.orient:null,stops=value?value.stops:null;if("linear"!=type&&(type="radial"),stops){if(!(stops.length>1))return;xui.arr.stableSort(stops,(function(x,y){return(x=parseFloat(x.pos)||0)>(y=parseFloat(y.pos)||0)?1:x==y?0:-1}))}xb.ie678&&("linear"==type?function(node,orient,stops){var t;if(node&&1==node.nodeType&&node.style){var style=node.style;if(orient){var innerColor=stops[0].clr,outerColor=stops[stops.length-1].clr,ori=1;switch(stops[0].opacity&&(innerColor=innerColor.replace("#","#"+_toFF(stops[0].opacity,255))),stops[stops.length-1].opacity&&(outerColor=outerColor.replace("#","#"+_toFF(stops[stops.length-1].opacity,255))),orient){case"LT":case"RT":case"LB":case"RB":return void function(node,orient,stops){var t,id="xui.s-ie8gdfix";if(node&&1==node.nodeType&&node.style){var style=node.style,tmp1=ns.getStyle(node,"overflow"),tmp2=ns.getStyle(node,"display");if("hidden"!=tmp1&&ns.setStyle(node,"overflow","hidden"),"block"!=tmp2&&"relative"!=tmp2&&ns.setStyle(node,"display","relative"),orient){var innerColor=stops[0].clr,outerColor=stops[stops.length-1].clr,ew=node.offsetWidth||0,eh=node.offsetHeight||0,size=Math.min(ew,eh),xs=0,xe=size,ys=0,ye=size;switch(orient){case"LT":xs=0,ys=0,xe=size,ye=size;break;case"RT":xs=size,ys=0,xe=0,ye=size;break;case"LB":xs=0,ys=size,xe=size,ye=0;break;case"RB":xs=size,ys=size,xe=0,ye=0}var at=document.createElement("div"),s=at.style;at.id=id,s.position="absolute",s.zIndex="0",s.top=0,s.left=0,s.width=ew,s.height=eh,s.backgroundColor=innerColor;var starto=stops[0].opacity?100*parseFloat(stops[0].opacity):100;t=((s.filter?s.filter+",":"")+"progid:DXImageTransform.Microsoft.Alpha(style=1, opacity="+starto+", finishopacity=0, startX="+xs+",finishX="+xe+",startY="+ys+",finishY="+ye+")").replace(/(^[\s,]*)|([\s,]*$)/g,"").replace(/,[\s]+/g,","+(8==xui.browser.ver?"":" ")),xui.browser.ie8&&(s.msfilter=t),s.filter=t,node.firstChild?node.insertBefore(at,node.firstChild):node.appendChild(at),style.backgroundColor=outerColor,stops[stops.length-1].opacity&&(t=((style.filter?style.filter+",":"")+"progid:DXImageTransform.Microsoft.Alpha(opacity="+100*parseFloat(stops[stops.length-1].opacity)+")").replace(/(^[\s,]*)|([\s,]*$)/g,"").replace(/,[\s]+/g,","+(8==xui.browser.ver?"":" ")),xui.browser.ie8&&(style.msfilter=t),style.filter=t)}else{var i,a=node.childNodes,l=a.length;for(i=0;i<l;i++)if(1==a[i].nodeType&&a[i].id==id){node.removeChild(a[i]);break}style.backgroundColor="",t=(style.filter||"").replace(/progid\:DXImageTransform\.Microsoft\.Alpha\([^)]+\)/gi,"").replace(/(^[\s,]*)|([\s,]*$)/g,"").replace(/,[\s]+/g,","+(8==xui.browser.ver?"":" ")),xui.browser.ie8&&(style.msfilter=t),style.filter=t}}}(node,orient,stops);case"L":ori=1;break;case"R":ori=1,t=innerColor,innerColor=outerColor,outerColor=t;break;case"T":ori=0;break;case"B":ori=0,t=innerColor,innerColor=outerColor,outerColor=t}t=((style.filter?style.filter+",":"")+"progid:DXImageTransform.Microsoft.Gradient(StartColorstr='"+innerColor+"',EndColorstr='"+outerColor+"',GradientType="+ori+")").replace(/(^[\s,]*)|([\s,]*$)/g,"").replace(/,[\s]+/g,","+(8==xui.browser.ver?"":" ")),xui.browser.ie8&&(style.msfilter=t),style.filter=t}else{t=(style.filter||"").replace(/progid\:DXImageTransform\.Microsoft\.Gradient\([^)]+\)/gi,"").replace(/(^[\s,]*)|([\s,]*$)/g,"").replace(/,[\s]+/g,","+(8==xui.browser.ver?"":" ")),xui.browser.ie8&&(style.msfilter=t),style.filter=t;var i,a=node.childNodes,l=a.length;for(i=0;i<l;i++)if(1==a[i].nodeType&&"xui.s-ie8gdfix"==a[i].id){node.removeChild(a[i]);break}style.backgroundColor="",t=(style.filter||"").replace(/progid\:DXImageTransform\.Microsoft\.Alpha\([^)]+\)/gi,"").replace(/(^[\s,]*)|([\s,]*$)/g,"").replace(/,[\s]+/g,","+(8==xui.browser.ver?"":" ")),xui.browser.ie8&&(style.msfilter=t),style.filter=t}}}(node,orient,stops):function(node,orient,stops,shape,size,rate){var t,id="xui.s-ie8gdfix";if(node&&1==node.nodeType&&node.style){var style=node.style,tmp1=ns.getStyle(node,"overflow"),tmp2=ns.getStyle(node,"display");if("hidden"==tmp1&&("block"==tmp2||"relative"==tmp2))if(orient){rate=rate||1;var innerColor=stops[0].clr,outerColor=stops[stops.length-1].clr,ew=node.offsetWidth||0,eh=node.offsetHeight||0,aw=ew*rate*2,ah=eh*rate*2;"circle"==shape&&(aw=ah=Math.min(aw,ah)),l=-aw/2;var w=aw,h=ah;if(t=-ah/2,xui.isObj(orient))l=orient.left||Math.round(parseFloat(l)||0)+"px",t=orient.top||Math.round(parseFloat(t)||0)+"px";else{switch(orient){case"LT":l=-aw/2,t=-ah/2;break;case"T":l=(ew-aw)/2,t=-ah/2;break;case"RT":l=ew-aw/2,t=-ah/2;break;case"L":l=-aw/2,t=(eh-ah)/2;break;case"C":l=(ew-aw)/2,t=(eh-ah)/2;break;case"R":l=ew-aw/2,t=(eh-ah)/2;break;case"LB":l=-aw/2,t=eh-ah/2;break;case"B":l=(ew-aw)/2,t=eh-ah/2;break;case"RB":l=ew-aw/2,t=eh-ah/2}l+="px",t+="px"}var at=document.createElement("div"),s=at.style;at.id=id,s.position="absolute",s.zIndex="0",s.top=t,s.left=l,s.width=Math.round(parseFloat(w)||0)+"px",s.height=Math.round(parseFloat(h)||0)+"px",s.backgroundColor=innerColor;var starto=stops[0].opacity?100*parseFloat(stops[0].opacity):100;t=((s.filter?s.filter+",":"")+"progid:DXImageTransform.Microsoft.Alpha(opacity="+starto+", finishopacity=0, style=2)").replace(/(^[\s,]*)|([\s,]*$)/g,"").replace(/,[\s]+/g,","+(8==xui.browser.ver?"":" ")),xui.browser.ie8&&(s.msfilter=t),s.filter=t,node.firstChild?node.insertBefore(at,node.firstChild):node.appendChild(at),style.backgroundColor=outerColor,stops[stops.length-1].opacity&&(t=((style.filter?style.filter+",":"")+"progid:DXImageTransform.Microsoft.Alpha(opacity="+100*parseFloat(stops[stops.length-1].opacity)+")").replace(/(^[\s,]*)|([\s,]*$)/g,"").replace(/,[\s]+/g,","+(8==xui.browser.ver?"":" ")),xui.browser.ie8&&(style.msfilter=t),style.filter=t)}else{var i,a=node.childNodes,l=a.length;for(i=0;i<l;i++)if(1==a[i].nodeType&&a[i].id==id){node.removeChild(a[i]);break}style.backgroundColor="",t=(style.filter||"").replace(/progid\:DXImageTransform\.Microsoft\.Alpha\([^)]+\)/gi,"").replace(/(^[\s,]*)|([\s,]*$)/g,"").replace(/,[\s]+/g,","+(8==xui.browser.ver?"":" ")),xui.browser.ie8&&(style.msfilter=t),style.filter=t}}}(node,orient,stops,shape,0,rate)),(xb.ie9||xb.opr&&ver<11.1)&&("linear"==type?function(node,orient,stops){if(orient){var id="svg"+xui.id(),x1="0%",y1="0%",x2="0%",y2="100%";switch(orient){case"T":x1="50%",y1="0%",x2="50%",y2="100%";break;case"B":x1="50%",y1="100%",x2="50%",y2="0%";break;case"L":x1="0%",y1="50%",x2="100%",y2="50%";break;case"R":x1="100%",y1="50%",x2="0%",y2="50%";break;case"LT":x1="0%",y1="0%",x2="100%",y2="100%";break;case"RT":x1="100%",y1="0%",x2="0%",y2="100%";break;case"RB":x2="0%",y2="0%",x1="100%",y1="100%";break;case"LB":x1="0%",y1="100%",x2="100%",y2="0%"}for(var svg='<svg xmlns="http://www.w3.org/2000/svg" width="100%" height="100%" viewBox="0 0 1 1" preserveAspectRatio="none"><linearGradient id="'+id+'" gradientUnits="userSpaceOnUse" x1="'+x1+'" y1="'+y1+'" x2="'+x2+'" y2="'+y2+'">',i=0,l=stops.length;i<l;i++)svg+='<stop stop-color="'+stops[i].clr+'" offset="'+stops[i].pos+'" '+(xui.isSet(stops[i].opacity)?' stop-opacity="'+stops[i].opacity+'"':"")+"/>";svg+='</linearGradient><rect x="0" y="0" width="1" height="1" fill="url(#'+id+')" /></svg>',node.style.backgroundImage='url("data:image/svg+xml;base64,'+window.btoa(svg)+'")'}else node.style.backgroundImage=""}(node,orient,stops):svgcracker1(node,orient,stops,0,0,rate)),(xb.gek&&ver>=3.6||xb.isChrome&&ver>=10||xb.isSafari&&ver>=5.1||xb.ie&&ver>=10||xb.opr&&ver>=11.1)&&("linear"==type?function(node,orient,stops){var arr1=[],arr2=[],style=node.style;if(xui.arr.each(stops,(function(o){var clr=o.clr;xui.isSet(o.opacity)&&"#"==clr.charAt(0)&&(clr=clr.slice(1),clr="rgba("+_to255(clr.substr(0,2))+","+_to255(clr.substr(2,2))+","+_to255(clr.substr(4,2))+","+(parseFloat(o.opacity)||1)+")"),arr1.push(clr+" "+o.pos),xb.isWebKit&&arr2.push("color-stop("+o.pos+","+clr+")")})),orient){var direction="to bottom",directionmoz="top",directionwebkit="left top, left bottom";switch(orient){case"LT":direction="135deg",directionmoz="-45deg",directionwebkit="left top, right bottom";break;case"T":direction="to bottom",directionmoz="top",directionwebkit="left top, left bottom";break;case"RT":direction=directionmoz="-135deg",directionwebkit="right top, left bottom";break;case"L":direction="to right",directionmoz="left",directionwebkit="left top, right top";break;case"R":direction="to left",directionmoz="right",directionwebkit="right top, left top";break;case"LB":direction=directionmoz="45deg",directionwebkit="left bottom, right top";break;case"B":direction="to top",directionmoz="bottom",directionwebkit="left bottom, left top";break;case"RB":direction="-45deg",directionmoz="135deg",directionwebkit="right bottom, left top";break;default:direction=orient,directionmoz=orient,directionwebkit="left top, right bottom"}xb.isWebKit&&(style.backgroundImage="-webkit-gradient(linear,"+directionwebkit+", "+arr2.join(",")+")");var v1="linear-gradient({#},"+arr1.join(",")+")";xb.cssTag1&&(style.backgroundImage=xb.cssTag1+v1.replace("{#}",directionmoz)),style.backgroundImage=v1.replace("{#}",direction)}else style.backgroundImage=""}(node,orient,stops):xb.opr&&ver<12?svgcracker1(node,orient,stops,0,0,rate):function(node,orient,stops,shape,size,rate){var arr1=[],arr2=[],style=node.style;if(xui.arr.each(stops,(function(o){var clr=o.clr;xui.isSet(o.opacity)&&"#"==clr.charAt(0)&&(clr=clr.slice(1),clr="rgba("+_to255(clr.substr(0,2))+","+_to255(clr.substr(2,2))+","+_to255(clr.substr(4,2))+","+(parseFloat(o.opacity)||1)+")"),arr1.push(clr+" "+o.pos),xb.isWebKit&&arr2.push("color-stop("+o.pos+","+clr+")")})),orient){var position;if(xui.isObj(orient))position=orient.left+" "+orient.top;else switch(orient){case"LT":position="left top";break;case"T":position="center top";break;case"RT":position="right top";break;case"L":position="left center";break;case"C":position="center center";break;case"R":position="right center";break;case"LB":position="left bottom";break;case"B":position="center bottom";break;case"RB":position="right bottom";break;default:position="left top"}xb.isWebKit&&(style.backgroundImage="-webkit-gradient(radial,"+position+", 0px, "+position+", 100%,"+arr2.join(",")+")");var v1="radial-gradient("+position+","+shape+" "+size+","+arr1.join(",")+")";xb.cssTag1&&(style.backgroundImage=xb.cssTag1+v1),style.backgroundImage="radial-gradient("+size+" "+shape+" at "+position+","+arr1.join(",")+")"}else style.backgroundImage=""}(node,orient,stops,shape,size))},$setZoom:function(node,scale,transx,transy,origin){scale=parseFloat(scale),(xui.isNaN(scale)||scale<=0)&&(scale="");var b=xui.browser,h={};h[b.cssTag1+"transform"]=h.transform=""===scale?"":(xui.isNumb(transx)&&xui.isNumb(transy)?"translate("+transx+"px,"+transy+"px) ":"")+"scale("+scale+","+scale+")",h[b.cssTag1+"transform-origin"]=h["transform-origin"]=""===scale?"":origin||"0 0 0",xui(node).css(h)},_vAnimate:function(node,setting,callback){if(setting&&setting.endpoints&&!xui.isEmpty(setting.endpoints)){var endpoints=setting.endpoints,begin={},end={};return node=xui(node),xui.each(endpoints,(function(o,i){xui.isFun(o)||(begin[i]=o[0],end[i]=o[1])})),node.animate(endpoints,(function(threadid){node.css(begin)}),(function(threadid){node.css(end),callback&&xui.tryF(callback)}),setting.duration,0,setting.type).start()}callback&&xui.tryF(callback)},$adjustCss:function(hash,returnStr){var fack={nodeType:1,style:{}},style=fack.style;if(xui.Dom.setStyle(fack,hash),returnStr){var arr=[];return xui.browser.ie&&8==xui.browser.ver&&(style.filter&&(style["-ms-filter"]=style.filter),"none"==style["background-image"]&&(style["background-image"]="url(about:blank)")),xui.each(style,(function(o,i){arr.push(i.replace(/([A-Z])/g,"-$1").toLowerCase()+":"+o)})),arr.join(";").replace(/[;]+/g,";")}return style},_cssfake:{rotate:1,scaleX:1,scaleY:1,translateX:1,translateY:1,skewX:1,skewY:1},setStyle:function(node,name,value){if("rotate"==name)return xui(node).rotate(value),this;var ns=xui.Dom,css3prop=xui.Dom._css3prop,xb=xui.browser,fake=ns._cssfake,style=node.style;if(1==node.nodeType)if("string"==typeof name)if(fake[name])xui(node)[name](value);else{var name2,name3,name4,me=this.getStyle,c1=me._c1||(me._c1={}),r1=me._r1||(me._r1=/alpha\([^\)]*\)/gi),map=me.map||(me.map={float:1,cssFloat:1,styleFloat:1}),n1=name=c1[name]||(c1[name]=name.replace(/\-(\w)/g,(function(a,b){return b.toUpperCase()})));if(0===n1.indexOf("border")&&(n1=n1.replace(/[-]?(left|top|right|bottom)/gi,"")),"$gradient"==name)return ns.$setGradients(node,value);if("$zoom"==name)return ns.$setZoom(node,value);if("opacity"==name){if(value=(value=xui.isFinite(value)?parseFloat(value)>1?1:parseFloat(value)<=0?0:parseFloat(value):1)>.9999?"":value,!ns.css3Support("opacity")&&xb.ie){""===value&&(value=1),style.opacity=value,style.zoom=1,value="alpha(opacity="+100*value+")";var ov=(style.filter||"").replace(r1,"");value=(ov?ov+",":"")+value,name="filter",8==xb.ver&&(name2="msfilter")}}else if(-1!=xui.arr.indexOf(css3prop,n1)){if(!ns.css3Support(name)){if(xb.ie&&xb.ver<9)switch(name){case"transform":xui.Dom.$transformIE(node,value);break;case"boxShadow":xui.Dom.$textShadowIE(node,value,!0)}return"textShadow"==name&&xb.ie&&xb.ver<10&&xui.Dom.$textShadowIE(node,value),this}xb.cssTag2&&"textShadow"!=name&&(name2=xb.cssTag2+name.charAt(0).toUpperCase()+name.substr(1))}else map[name]&&(name=xb.ie?"styleFloat":"cssFloat");"filter"==name&&(value=value.replace(/(^[\s,]*)|([\s,]*$)/g,"").replace(/,[\s]+/g,","+(8==xui.browser.ver?"":" "))),style[name]=value,name2&&(style[name2]=value),name3&&(style[name3]=value),name4&&(style[name4]=value)}else for(var i in name)arguments.callee.call(this,node,i,name[i])},_css3prop:"opacity,textShadow,animationName,columnCount,flexWrap,boxDirection,backgroundSize,perspective,boxShadow,borderImage,borderRadius,boxReflect,transform,transition".split(","),css3Support:function(key){var self=arguments.callee,_c=self._c||(self._c={});if((key=key.replace("$","").replace(/\-(\w)/g,(function(a,b){return b.toUpperCase()})))in _c)return _c[key];var n=document.createElement("div"),s=n.style,rt=!1,xb=xui.browser,f=function(k){return k=k.replace(/\-(\w)/g,(function(a,b){return b.toUpperCase()})),s[k]!==undefined||!(!xui.browser.cssTag2||(k=xui.browser.cssTag2+k.charAt(0).toUpperCase()+k.substr(1),s[k]===undefined))};switch(n.id="xui_css3_"+xui.stamp(),0===key.indexOf("border")&&(key=key.replace(/[-]?(left|top|right|bottom)/gi,"")),key){case"opacity":case"textShadow":rt=""===s[key];break;case"generatedContent":var id="tmp_css3_test"+xui.id(),css="#"+n.id+"{line-height:auto;margin:0;padding:0;border:0;font:0/0 a}#"+n.id+":after{content:'a';visibility:hidden;line-height:auto;margin:0;padding:0;border:0;font:3px/1 a}";xui.CSS.addStyleSheet(css,id),xui("body").append(n);var v=n.offsetHeight;xui.CSS.remove("id",id),xui(n.id).remove(n),rt=v>=3;break;case"fontFace":if(xb.ie&&xb.ver>=6)rt=!0;else{id="tmp_css3_test"+xui.id(),css='@font-face{font-family:"font";src:url("https://")}';var style=xui.CSS.addStyleSheet(css,id),sh=style.sheet||style.styleSheet,ctxt=sh?sh.cssRules&&sh.cssRules[0]?sh.cssRules[0].cssText:sh.cssText||"":"";rt=/src/i.test(ctxt)&&0===ctxt.indexOf("@font-face"),xui.CSS.remove("id",id)}break;case"rgba":s.cssText="background-color:rgba(0,0,0,0.1)",rt=-1!=s.backgroundColor.indexOf("rgba");break;case"hsla":s.cssText="background-color:hsla(120,40%,100%,.5)",rt=-1!=s.backgroundColor.indexOf("hsla")||-1!=s.backgroundColor.indexOf("rgba");break;case"multiplebgs":s.cssText="background:url(//:),url(//:),red url(//:)",rt=/(url\s*\(.*?){3}/.test(s.background);break;case"gradient":var k="background-image:",v1="-webkit-gradient(linear,left top,right bottom,from(#000),to(#fff));",arr=[k,v2="linear-gradient(left top,#000,#fff);"];xui.browser.cssTag1&&(arr.push(k),arr.push(xui.browser.cssTag1+v2)),xui.browser.isWebKit&&(arr.push(k),arr.push(v1)),s.cssText=arr.join(""),rt=!!s.backgroundImage;break;case"transform3d":var r=f("perspective");if(r&&"webkitPerspective"in document.documentElement.style){id="tmp_css3_test"+xui.id(),css="@media (transform-3d),(-webkit-transform-3d){#"+n.id+"{font:0/0;line-height:0;margin:0;padding:0;border:0;left:9px;position:absolute;height:3px;}}",xui.CSS.addStyleSheet(css,id),xui("body").append(n),v1=n.offsetLeft;var v2=n.offsetHeight;xui.CSS.remove("id",id),xui(n.id).remove(n),rt=9===v1&&3===v2}rt=r;break;default:rt=f(key)}return _c[key]=rt},supportPromise:function(){var dom=xui.Dom;if("$supportPromise"in dom)return dom.$supportPromise;try{return new Promise((function(x,y){})),dom.$supportPromise=!0}catch(e){}return dom.$supportPromise=!1},supportDropzone:function(){if("$supportDropzone"in xui.Dom)return xui.Dom.$supportDropzone;var div=document.createElement("div");return xui.Dom.$supportDropzone=("draggable"in div||"ondragstart"in div&&"ondrop"in div)&&"FileReader"in window},$AnimateEffects:{linear:function(s,c){return 1/s*c},sineIn:function(s,c){return-1*Math.cos(c/s*(Math.PI/2))+1},sineOut:function(s,c){return Math.sin(c/s*(Math.PI/2))},sineInOut:function(s,c){return-.5*(Math.cos(Math.PI*c/s)-1)},quadIn:function(s,c){return(c/=s)*c},quadOut:function(s,c){return-1*(c/=s)*(c-2)},quadInOut:function(s,c){return(c/=s/2)<1?.5*c*c:-.5*(--c*(c-2)-1)},cubicIn:function(s,c){return(c/=s)*c*c},cubicOut:function(s,c){return(c=c/s-1)*c*c+1},cubicInOut:function(s,c){return(c/=s/2)<1?.5*c*c*c:.5*((c-=2)*c*c+2)},quartIn:function(s,c){return(c/=s)*c*c*c},quartOut:function(s,c){return-1*((c=c/s-1)*c*c*c-1)},quartInOut:function(s,c){return(c/=s/2)<1?.5*c*c*c*c:-.5*((c-=2)*c*c*c-2)},quintIn:function(s,c){return(c/=s)*c*c*c*c},quintOut:function(s,c){return(c=c/s-1)*c*c*c*c+1},quintInOut:function(s,c){return(c/=s/2)<1?.5*c*c*c*c*c:.5*((c-=2)*c*c*c*c+2)},expoIn:function(s,c){return 0==c?0:Math.pow(2,10*(c/s-1))},expoOut:function(s,c){return c==s?1:1-Math.pow(2,-10*c/s)},expoInOut:function(s,c){return 0==c?0:c==s?1:(c/=s/2)<1?.5*Math.pow(2,10*(c-1)):.5*(2-Math.pow(2,-10*--c))},circIn:function(s,c){return-1*(Math.sqrt(1-(c/=s)*c)-1)},circOut:function(s,c){return Math.sqrt(1-(c=c/s-1)*c)},circInOut:function(s,c){return(c/=s/2)<1?-.5*(Math.sqrt(1-c*c)-1):.5*(Math.sqrt(1-(c-=2)*c)+1)},bounceIn:function(s,c){return 1-xui.Dom.$AnimateEffects.bounceOut(s,s-c)},bounceOut:function(s,c){var k=7.5625;return(c/=s)<1/2.75?k*c*c:c<2/2.75?k*(c-=1.5/2.75)*c+.75:c<2.5/2.75?k*(c-=2.25/2.75)*c+.9375:k*(c-=2.625/2.75)*c+.984375},bounceInOut:function(s,c){return c<s/2?.5*xui.Dom.$AnimateEffects.bounceIn(s,2*c):.5*xui.Dom.$AnimateEffects.bounceOut(s,2*c-s)+.5},backIn:function(s,c){var k=1.70158;return(c/=s)*c*((k+1)*c-k)},backOut:function(s,c){var k=1.70158;return(c=c/s-1)*c*((k+1)*c+k)+1},backInOut:function(s,c){var k=1.70158;return(c/=s/2)<1?c*c*((1+(k*=1.525))*c-k)*.5:.5*((c-=2)*c*((1+(k*=1.525))*c+k)+2)},elasticIn:function(s,c,p,a,z){if(0==c)return 0;if(1==(c/=s))return 1;if(z||(z=.3*s),!a||a<1){a=1;var k=z/4}else k=z/(2*Math.PI)*Math.asin(1/a);return-a*Math.pow(2,10*(c-=1))*Math.sin((c*s-k)*(2*Math.PI)/z)},elasticOut:function(s,c,p,a,z){if(0==c)return 0;if(1==(c/=s))return 1;if(z||(z=.3*s),!a||a<1){a=1;var k=z/4}else k=z/(2*Math.PI)*Math.asin(1/a);return a*Math.pow(2,-10*c)*Math.sin((c*s-k)*(2*Math.PI)/z)+1},elasticInOut:function(s,c,p,a,z){if(0==c)return 0;if(2==(c/=s/2))return 1;if(z||(z=s*(.3*1.5)),!a||a<1){a=1;var k=z/4}else k=z/(2*Math.PI)*Math.asin(1/a);return c<1?a*Math.pow(2,10*(c-=1))*Math.sin((c*s-k)*(2*Math.PI)/z)*-.5:a*Math.pow(2,-10*(c-=1))*Math.sin((c*s-k)*(2*Math.PI)/z)*.5+1}},$preDefinedAnims:{blinkAlert:{endpoints:{opacity:[1,0]},duration:200,restore:!0,times:3},blinkAlertLoop:{endpoints:{opacity:[1,0]},duration:500,restore:!0,times:-1},rotateAlert:{endpoints:{rotate:[0,360]},duration:400,restore:!1},rotateAlertLoop1:{endpoints:{rotate:[0,360]},duration:2e3,restore:!1,times:-1},rotateAlertLoop2:{endpoints:{rotate:[0,-360]},duration:2e3,returned:!1,times:-1},zoomAlert:{endpoints:{scaleX:[1,1.1],scaleY:[1,1.1]},duration:100,restore:!0,times:3},translateXAlert:{endpoints:{translateX:[0,5]},duration:100,restore:!0,times:3},translateYAlert:{endpoints:{translateY:[0,5]},duration:100,restore:!0,times:3}},$preDefinedEffects:{Classic:[{type:"circOut",duration:200,endpoints:{opacity:[0,1],scaleX:[.75,1],scaleY:[.75,1]}},{type:"circIn",duration:200,endpoints:{opacity:[1,0],scaleX:[1,.75],scaleY:[1,.75]}}],Blur:[{type:"circOut",duration:200,endpoints:{opacity:[0,1]}},{type:"circIn",duration:200,endpoints:{opacity:[1,0]}}],Drop:[{type:"circOut",duration:200,endpoints:{opacity:[0,1],translateY:["-25%","0%"],scaleY:[.5,1]}},{type:"circIn",duration:200,endpoints:{opacity:[1,0],translateY:["0%","-25%"],scaleY:[1,.5]}}],"From Below":[{type:"circOut",duration:200,endpoints:{opacity:[0,1],scaleX:[0,1],scaleY:[0,1]}},{type:"circIn",duration:200,endpoints:{opacity:[1,0],scaleX:[1,0],scaleY:[1,0]}}],"From Above":[{type:"circOut",duration:200,endpoints:{opacity:[0,1],scaleX:[2,1],scaleY:[2,1]}},{type:"circIn",duration:200,endpoints:{opacity:[1,0],scaleX:[1,2],scaleY:[1,2]}}],"Slide In LR":[{type:"circOut",duration:200,endpoints:{opacity:[0,1],translateX:["-150%","0%"]}},{type:"circIn",duration:200,endpoints:{opacity:[1,0],translateX:["0%","150%"]}}],"Slide In TB":[{type:"circOut",duration:200,endpoints:{opacity:[0,1],translateY:["-150%","0%"]}},{type:"circIn",duration:200,endpoints:{opacity:[1,0],translateY:["0%","150%"]}}],"Flip V":[{type:"circOut",duration:200,endpoints:{opacity:[0,1],scaleY:[0,1]}},{type:"circIn",duration:200,endpoints:{opacity:[1,0],scaleY:[1,0]}}],"Flip H":[{type:"circOut",duration:200,endpoints:{opacity:[0,1],scaleX:[0,1]}},{type:"circIn",duration:200,endpoints:{opacity:[1,0],scaleX:[1,0]}}]},_getEffects:function(key,isIn){return key&&"string"==typeof key&&(key=(key=this.$preDefinedEffects[key])?isIn?key[0]:key[1]:null),key&&xui.browser.ie&&xui.browser.ver<=8&&xui.filter(key,(function(o,i){return!!xui.Dom._cssfake[i]})),key},_setUnitStyle:function(node,key,value){if(!node||1!=node.nodeType)return!1;var style=node.style;return!(!value&&0!==value||(!(value=xui.CSS.$addu(value))||"width"!=key&&"height"!=key||"-"!=value.charAt(0)||(value="0"),style[key]==value)||(style[key]=value,0))},_emptyDivId:"xui.empty:",getEmptyDiv:function(pid,sequence){var id,rt,o,i=1,count=0,doc=document,body=pid&&(pid=xui(pid)).get(0)||doc.body,ini=function(o){o.id=id,xui([o]).attr("style","position:absolute;visibility:hidden;overflow:visible;left:"+xui.Dom.HIDE_VALUE+";top:"+xui.Dom.HIDE_VALUE+";")};for(sequence=sequence||1,pid=body==doc.body?"":pid.n0.replace("!","");;){if(id=this._emptyDivId+pid+":"+i,!(o=xui.Dom.byId(id)))return ini(o=doc.createElement("div")),body.firstChild?body.insertBefore(o,body.firstChild):body.appendChild(o),rt=xui([o]),body=o=null,rt;if((!o.firstChild||3==o.firstChild.nodeType&&!o.firstChild.nodeValue)&&++count==sequence)return xui([o]);i++}body=o=null},setCover:function(visible,label,busyIcon,cursor,bgStyle){var o1,o2,me=arguments.callee,id="xui.temp:cover:",id2="xui.temp:message:",content="string"==typeof visible||"function"==typeof visible?visible:"";if((o1=xui(id)).isEmpty()&&(xui("body").prepend(o1=xui.create('<button id="'+id+'" class="xui-node xui-node-div xui-cover xui-cover-global xui-custom" style="position:absolute;display:none;text-align:center;left:0;top:0;border:0;padding:0;margin:0;padding-top:2em;"><div id="'+id2+'" class="xui-node xui-node-div xui-coverlabel xui-custom"></div></button>')),o1.setSelectable(!1),xui.setNodeData(o1.get(0),"zIndexIgnore",1)),xui.Dom.byId(id2)&&(o2=xui(id2)),visible){"string"==typeof label&&(me._label=label);var t=xui.win;me._showed||(o1.css({zIndex:10*xui.Dom.TOP_ZINDEX,display:"",width:t.scrollWidth()+"px",height:t.scrollHeight()+"px",cursor:cursor||"progress"}),busyIcon?o1.addClass("xuicon xui-icon-loading"):o1.removeClass("xuicon xui-icon-loading"),me._showed=!0),o1.query("style").remove(!1),bgStyle&&xui.CSS._appendSS(o1.get(0),".xui-cover-global{"+bgStyle+"}","",!0),content&&("function"==typeof content?content(o1,o2):o2&&o2.html(content+"",!1))}else{if("string"==typeof me._label&&me._label!==label)return;me._showed&&(o2&&o2.empty(!1),o1.css({zIndex:0,cursor:"",display:"none"}),o1.query("style").remove(!1),me._showed=!1),delete me._label}},byId:function(id){return document.getElementById(id||"")},$hasEventHandler:function(node,name){return xui.getNodeData(node,["eHandlers",name])},submit:function(action,data,method,target,enctype){data=xui.isHash(data)?data:{},data=xui.clone(data,(function(o){return o!==undefined})),action=action||"",target=target||("mailto"==action.substring(0,6).toLowerCase()?"_self":"_blank");var _t=[];if(xui.isEmpty(data))window.open(action,target);else{var file,files=[];xui.each(data,(function(o,i){o&&o["xui.UIProfile"]&&o.$xuiFileCtrl&&(file=o.boxing().getUploadObj())&&(files.push({id:o.$xid,file:file}),file.id=file.name=i,data[i]=file)})),"get"==(method=method||(file?"post":"get")).toLowerCase()?window.open(action+"?"+xui.urlEncode(data),target):(xui.each(data,(function(o,i){xui.isDefined(o)&&!xui.isElem(o)&&_t.push('<textarea name="'+i+'">'+("object"==typeof o?xui.serialize(o):o)+"</textarea>")})),_t.push('<input type="hidden" name="rnd" value="'+xui.rand()+'">'),_t=xui.str.toDom('<form target="'+target+'" action="'+action+'" method="'+method+(enctype?'" enctype="'+enctype:"")+'">'+_t.join("")+"</form>"),xui.Dom.getEmptyDiv().append(_t),files.length&&xui.arr.each(files,(function(o,i){_t.append(o.file)})),_t.get(0).submit(),_t.remove(),_t=null),files.length&&xui.arr.each(files,(function(o,i){(i=xui.getObject(o.id))&&i["xui.UIProfile"]&&i.boxing()&&i.boxing().setUploadObj&&i.boxing().setUploadObj(o.file)}))}},selectFile:function(callback,accept,multiple){var fileInput=document.createElement("input");if(fileInput.type="file",accept&&(fileInput.accept=accept),multiple&&(fileInput.multiple="multiple"),fileInput.onchange=function(e){var t=e.target||window.event.srcElement;xui.tryF(callback,[this,t.files[0],t.files],this)},window.ActiveXObject||"ActiveXObject"in window){var label=document.createElement("div");fileInput.appendChild(label),label.click(),fileInput.removeChild(label)}else fileInput.click()},busy:function(id,busyMsg,busyIcon,cursor,bgStyle){xui.Dom.setCover(busyMsg||!0,id,busyIcon,cursor,bgStyle)},free:function(id){xui.Dom.setCover(!1,id)},animate:function(css,endpoints,onStart,onEnd,duration,step,type,threadid,unit,restore,times){var node=document.createElement("div");return xui.merge(css,{position:"absolute",left:this.HIDE_VALUE,zIndex:this.TOP_ZINDEX++}),xui.Dom.setStyle(node,css),document.body.appendChild(node),xui([node]).animate(endpoints,onStart,(function(){xui.tryF(onEnd),node.parentNode&&node.parentNode.removeChild(node),node=null}),duration,step,type,threadid,unit,restore,times)},$enableEvents:function(name){xui.isArr(name)||(name=[name]);var f,self=this;xui.arr.each(name,(function(o){(f=function(fun,label,flag){if("function"==typeof fun)return this.$addEvent(o,fun,label,flag);if(null===fun)return this.$removeEvent(o,label,flag);var args=arguments[1]||{};return args.$xuiall=!0===arguments[0],this.$fireEvent(o,args)}).$event$=1,self.plugIn(o,f)}))}},After:function(d){var self=this;xui.each({parent:["y",!1],prev:["x",!1],next:["x",!0],first:["y",!0],last:["y",1]},(function(o,i){self.plugIn(i,(function(index){return this.$iterator(o[0],o[1],!0,index||1)}))})),xui.arr.each(xui.toArr("offsetLeft,offsetTop,scrollWidth,scrollHeight"),(function(o){self.plugIn(o,(function(){var t=this.get(0),d=document;if(t==window||t==d){if("scrollWidth"==o||"scrollHeight"==o){var a=d.documentElement,b=d.body;return Math.max(a[o],b[o])}t=xui.browser.contentBox?d.documentElement:d.body}return t[o]}))}));var p="padding",m="margin",b="border",c="inner",o="offset",r="outer",w="width",h="height",W="Width",H="Height",T="Top",L="Left",l="left",R="Right",B="Bottom";xui.arr.each([["_"+p+"H",p+T,p+B],["_"+p+"W",p+L,p+R],["_"+b+"H",b+T+W,b+B+W],["_"+b+"W",b+L+W,b+R+W],["_"+m+"W",m+L,m+R],["_"+m+"H",m+T,m+B]],(function(o){var node,fun=xui.Dom.getStyle;self.plugIn(o[0],(function(type){return type=type||"both",node=this.get(0),("both"==type||"left"==type||"top"==type?xui.CSS.$px(fun(node,o[1]),node):0)+("both"==type||"right"==type||"bottom"==type?xui.CSS.$px(fun(node,o[2]),node):0)||0}))})),xui.arr.each([["_W",w,"_"+p+"W","_"+b+"W","_"+m+"W",c+W,o+W],["_H",h,"_"+p+"H","_"+b+"H","_"+m+"H",c+H,o+H]],(function(o){var _size=function(node,index,value,_in){var n,r,t,style=node.style,contentBox=xui.browser.contentBox,getStyle=xui.Dom.getStyle,f=xui.Dom._setUnitStyle,type=typeof value;if("undefined"==type||"boolean"==type){if(!0===value&&(n="none"==getStyle(node,"display")||0===node.offsetHeight)){var b,p,d,temp=xui.Dom.getEmptyDiv().html("*",!1);xui([node]).swap(temp),b=style.visibility,p=(p=style.position)||"",b=b||"",d=(d=style.display)||"",style.visibility="hidden",style.position="absolute",style.display="block"}switch(t=xui([node]),index){case 1:r=getStyle(node,o[1]),!isNaN(parseFloat(r))&&!/%$/.test(r)||_in||(r=_size(node,2,undefined,!0)-(contentBox?t[o[2]]():0)),r=xui.CSS.$px(r,node)||0;break;case 2:node===document||node===window?r=xui(node)[o[1]]():(r=node[o[6]])?r-=t[o[3]]():_in||(r=_size(node,1,undefined,!0)+(contentBox?t[o[2]]():0));break;case 3:node===document||node===window?r=xui(node)[o[1]]():(r=node[o[6]])||(r=_size(node,1,value,!0)+(contentBox?t[o[2]]():0)+t[o[3]]());break;case 4:r=_size(node,3,value),r+=t[o[4]]()}return n&&(style.display=d,style.position=p,style.visibility=b,t.swap(temp),temp.empty(!1)),parseFloat(r)||0}switch(index){case 1:if(f(node,o[1],value)&&xui.Dom.$hasEventHandler(node,"onsize")){var args={};args[o[1]]=1,xui([node]).onSize(!0,args)}break;case 2:_size(node,1,value-(contentBox?xui([node])[o[2]]():0));break;case 3:_size(node,1,value-(t=xui([node]))[o[3]]()-(contentBox?t[o[2]]():0));break;case 4:_size(node,1,value-(t=xui([node]))[o[4]]()-t[o[3]]()-(contentBox?t[o[2]]():0))}};self.plugIn(o[0],_size)})),xui.arr.each([[c+W,"_W",2],[o+W,"_W",3],[r+W,"_W",4],[c+H,"_H",2],[o+H,"_H",3],[r+H,"_H",4]],(function(o){self.plugIn(o[0],(function(value){var type=typeof value;return"undefined"==type||"boolean"==type?this[o[1]](this.get(0),o[2],value):this.each((function(v){this[o[1]](v,o[2],value)}))}))})),xui.arr.each([[l+"By",l],["topBy","top"],[w+"By",w],[h+"By",h]],(function(o){self.plugIn(o[0],(function(offset,triggerEvent){if(0===offset)return this;var m,args,k=o[1];return this.each((function(node){if(m=xui.use(node.$xid)[k](),m=(parseFloat(m)||0)+offset,"width"!=k&&"height"!=k||(m=m>0?m:0),node.style[k]=xui.CSS.$forceu(m,null,node),triggerEvent){(args={})[k]=1;var f=xui.Dom.$hasEventHandler;"left"!=k&&"top"!=k||!f(node,"onmove")||xui([node]).onMove(!0,args),"width"!=k&&"height"!=k||!f(node,"onsize")||xui([node]).onSize(!0,args)}}),this)}))})),xui.arr.each(["scrollLeft","scrollTop"],(function(o){self.plugIn(o,(function(value){var v,a=document.documentElement,b=document.body;return value!==undefined?this.each((function(v){v===window||v===document?(a&&(a[o]=value),b&&(b[o]=value)):v&&(v[o]=value)})):(v=this.get(0))?v===window||v===document?window["scrollTop"==o?"pageYOffset":"pageXOffset"]||a[o]||b[o]||0:v[o]:0}))})),xui.arr.each("width,height,left,top".split(","),(function(o){self.plugIn(o,(function(value){var t,style,self=this,node=self.get(0),b=xui.browser,type=typeof value,doc=document;if(node&&3!=node.nodeType){if("undefined"==type||"boolean"==type){if("width"==o&&(t="Width")||"height"==o&&(t="Height")){if(doc===node)return Math.max(doc.body["scroll"+t],doc.body["offset"+t],doc.documentElement["scroll"+t],doc.documentElement["offset"+t]);if(window===node)return b.opr?Math.max(doc.body["client"+t],window["inner"+t]):b.kde?window["inner"+t]:xui.browser.contentBox&&doc.documentElement["client"+t]||doc.body["client"+t]}return style=node.style,"auto"==(value="width"==o?xui.CSS.$isPx(style.width)&&parseFloat(style.width)||self._W(node,1,value):"height"==o?xui.CSS.$isPx(style.height)&&parseFloat(style.height)||self._H(node,1,value):xui.Dom.getStyle(node,o,!0))||""===value?value:value||0}var a,f=xui.Dom._setUnitStyle,av=xui.CSS.$addu(value);return self.each((function(v){1==v.nodeType&&v.style[o]!==av&&("width"==o?self._W(v,1,value):"height"==o?self._H(v,1,value):f(v,o,value)&&("top"!=o&&"left"!=o||!xui.Dom.$hasEventHandler(node,"onmove")||((a={})[o]=1,xui([v]).onMove(!0,a))))}))}}))})),xui.arr.each(xui.Event._events,(function(o){xui.arr.each(xui.Event._getEventName(o),(function(o){self.$enableEvents(o)}))}))},Initialize:function(){var w=window,d=document;xui.browser.contentBox=xui(d.documentElement).contentBox(),xui.set(xui.$cache.domPurgeData,"!window",{$xid:"!window",element:w}),xui.set(xui.$cache.domPurgeData,"!document",{$xid:"!document",element:d}),xui.win=xui(["!window"],!1),xui.doc=xui(["!document"],!1),xui.frame=xui.win,xui.busy=xui.Dom.busy,xui.free=xui.Dom.free,xui.$inlineBlock=xui.browser.gek?xui.browser.ver<3?["-moz-inline-block","-moz-inline-box","inline-block"]:["inline-block"]:xui.browser.ie&&xui.browser.ver<=6?["inline-block","inline"]:["inline-block"];var fun=function(p,e,cache,keydown){var set,rtnf,rst,f,arr,event=xui.Event,remove={},ks=event.getKey(e);if(ks){if(1==ks[0].length&&(ks[0]=ks[0].toLowerCase()),(arr=cache[ks.join(":")])&&(xui.arr.each(arr,(function(key,i){if(set=arr[key]){if(set[3]&&("function"==typeof set[3]?!1===set[3]():!xui(set[3]).size()))return delete arr[key],void(remove[i]=1);if(!1===(rst=xui.tryF(set[0],set[1]||[arr,i,key],set[2])))return rtnf=1,!1;!0===rst&&(delete arr[key],remove[i]=1)}}),null,!0),xui.filter(arr,(function(key,i){return!remove[i]})),rtnf))return event.stopBubble(e),!1;xui.Module&&xui.arr.each(xui.Module._cache,(function(m){m._evsClsBuildIn&&"onHookKey"in m._evsClsBuildIn?(xui.isFun(f=m._evsClsBuildIn.onHookKey)||xui.isArr(f)&&f[0].type)&&m.fireEvent("onHookKey",[m,ks,keydown,e]):m._evsPClsBuildIn&&"onHookKey"in m._evsPClsBuildIn&&(xui.isFun(f=m._evsPClsBuildIn.onHookKey)||xui.isArr(f)&&f[0].type)&&m.fireEvent("onHookKey",[m,ks,keydown,e])}))}return!0};xui.doc.onKeydown((function(p,e){xui.Event.$keyboard=xui.Event.getKey(e),fun(0,e,xui.$cache.hookKey,!0)}),"document").onKeyup((function(p,e){delete xui.Event.$keyboard,fun(0,e,xui.$cache.hookKeyUp,!1)}),"document"),xui.doc.onClick((function(p,e,src){var b,href,o=xui.Event.getSrc(e),i=0;do{if("A"==o.nodeName){b=!0;break}if(++i>8)break}while(o=o.parentNode);if(b){if(href=xui.str.trim(o.href||"").toLowerCase(),xui.History){var s=location.href.split("#")[0];xui.Event.getKey(e).shiftKey||"left"!=xui.Event.getBtn(e)||0!=href.indexOf(s+"#")&&0!=href.indexOf("#")||xui.History.setFI(o.href.replace(s,""))}if(xui.browser.ie&&(0==href.indexOf("javascript:")||-1!==href.indexOf("#")))return!1}}),"hookA",0);var _ieselectstart=function(n,v){for(n=window.event.srcElement;n&&n.nodeName&&"BODY"!=n.nodeName&&"HTML"!=n.nodeName;){if(v=xui.getNodeData(n,"_onxuisel"))return"false"!=v;if("INPUT"==n.nodeName||"TEXTAREA"==n.nodeName)break;n=n.parentNode}return!0};xui.browser.ie&&xui.browser.ver<10&&d.body&&xui.Event._addEventListener(d.body,"selectstart",_ieselectstart),xui.win.afterUnload(xui._destroy=function(){var t,lowie=xui.browser.ie&&xui.browser.ver<=8,e=xui.Event,_cw=function(w,k){w[k]=undefined,lowie||delete w[k]};for(var i in xui.History&&xui.History._checker&&e._removeEventListener(w,"hashchange",xui.History._checker),e._removeEventListener(d.body,"selectstart",_ieselectstart),e._removeEventListener(w,"resize",e.$eventhandler),e._removeEventListener(w,"mousewheel",e.$eventhandler3),e._removeEventListener(d,"mousewheel",e.$eventhandler3),e._removeEventListener(w,"DOMMouseScroll",e.$eventhandler3),xui.browser.isTouch&&(e._removeEventListener(d,xui.browser.ie&&w.PointerEvent?"pointerdown":xui.browser.ie&&w.MSPointerEvent?"MSPointerDown":"touchstart",e._simulateMousedown),e._removeEventListener(d,xui.browser.ie&&xui.browser.ver>=11?"pointerup":xui.browser.ie&&xui.browser.ver>=10?"MSPointerUp":"touchend",e._simulateMouseup)),t=xui.$cache.domPurgeData)t[i].eHandlers&&xui(i).$clearEvent();for(var i in t=xui._pool)t[i]&&t[i].destroy&&t[i].destroy(1,1),t[i]&&t[i].Instace&&t[i].Instace.destroy&&t[i].Instace.destroy(1,1);if(_cw(w,xui.ini.rootModuleName),w.Raphael&&w.Raphael._in_xui&&_cw(w,"Raphael"),xui.SC.__gc(),xui.Thread.__gc(),xui.Class.__gc(),/xui\.Class\.apply/.test(w.Class)&&_cw(w,"Class"),t=xui.Namespace._all)for(var i in t)_cw(w,t[i]);xui.breakO(xui.$cache,2),xui.breakO([xui.Class,xui],3),_cw(w,"xui_ini"),_cw(w,"xui"),w=d=null},"window",-1)}}),xui.Class("xui.Template","xui.absProfile",{Constructor:function(template,properties,events,domId){var upper=arguments.callee.upper,args=xui.toArr(arguments);upper.apply(this,args),upper=null;var self=this;return self.$domId=self.KEY+":"+(self.serialId=self._pickSerialId())+":",self.domId="string"==typeof domId?domId:self.$domId,self._links={},self.template={root:[["<div></div>"],[]]},self.properties={},self.events={},self.$template={},self.link(self.constructor._cache,"self").link(xui._pool,"xui"),self.Class=self.constructor,self.box=self.constructor,self.boxing=function(){return this},template&&self.setTemplate("string"==typeof template?{root:template}:template),events&&self.setEvents(events),properties&&self.setProperties(properties),self},Instance:{renderId:null,__gc:function(){var t=xui.$cache.reclaimId;this.$noReclaim?delete this.$noReclaim:(t[this.KEY]||(t[this.KEY]=[])).push(this.serialId),delete xui.$cache.profileMap[this.domId],delete xui.$cache.profileMap[this.$domId],this.unLinkAll(),xui.breakO([this.properties,this.event,this],2)},_reg0:/^\w[\w_-]*$/,show:function(parent){return parent||(parent=xui("body")),(parent=xui(parent)).append(this),this},getRootNode:function(){return xui.getNodeData(this.renderId,"element")},getRoot:function(){return xui([this.renderId],!1)},setDomId:function(id){var t=this,c=xui.$cache.profileMap,reg=t._reg0;return"string"==typeof id&&reg.test(id)&&!document.getElementById(id)&&(t.domId!=t.$domId&&delete c[t.domId],t.domId=id,t.renderId&&(t.getRootNode().id=id),c[t.$domId]&&(c[id]=t)),t},destroy:function(){if(this.renderId){var rn=this.getRootNode();xui.$purgeChildren(rn),rn.parentNode&&rn.parentNode.removeChild(rn),rn=null}else this.__gc()},setEvents:function(key,value){return"object"==typeof key?this.events=key:this.events[key]=value,this},setTemplate:function(key,value){var h,t=this.template,$t=this.$template;if("object"==typeof key){for(var i in this.template=key,h={},key)h[i||"root"]=this._buildTemplate(key[i]);this.$template=h}else"string"==typeof value?$t[key]=this._buildTemplate(t[key]=value):$t.root=this._buildTemplate(t.root=key);return this},setProperties:function(key,value){return"object"==typeof key?this.properties=key:this.properties[key]=value,this},getItem:function(src){var obj=xui.getNodeData(src);if(obj){var id=obj.tpl_evid,tpl_evkey=obj.tpl_evkey;if(id&&tpl_evkey){var me=arguments.callee,f=me.f||(me.f=function(data,tpl_evkey,id){var i,o,j,v;for(j in data)if(o=data[j],xui.isArr(o)&&(tpl_evkey==j||0===tpl_evkey.indexOf((data.tpl_evkey||j)+".")))for(i=0;v=o[i];i++){if(v.tpl_evkey==tpl_evkey&&v.id==id)return v;if(v=f(v,tpl_evkey,id))return v}});return f(this.properties,tpl_evkey,id)}}},_pickSerialId:function(){var arr=xui.$cache.reclaimId[this.KEY];return arr&&arr[0]?arr.shift():this.constructor._ctrlId.next()},render:function(){if(!this.renderId){var div=xui.$getGhostDiv();xui.$cache.profileMap[this.domId]=xui.$cache.profileMap[this.$domId]=this,div.innerHTML=this.toHtml();var i,l,j,k,o,key,id,t,v,ch=this.events,eh=xui.Event._eventHandler,children=div.getElementsByTagName("*"),f=(this.$domId,xui.Event.$eventhandler);if(l=children.length){for(i=0;i<l;i++)if(1==(o=children[i]).nodeType&&(key=o.getAttribute("tpl_evkey"),id=o.getAttribute("tpl_evid"),null!==key&&null!==id)){if((v=xui.$registerNode(o)).tpl_evkey=key,v.tpl_evid=id,t=ch[key])for(j in v=v.eHandlers||(v.eHandlers={}),t)v[j]=f,(k=eh[j])&&(v[k]=f,xui.Event._addEventListener(o,k,f));o.removeAttribute("tpl_evkey"),o.removeAttribute("tpl_evid")}div.firstChild.$xid||xui.$registerNode(div.firstChild),this.renderId=div.firstChild.$xid}o=div=null}return this},refresh:function(){var ns=this;if(ns.renderId){var proxy=document.createElement("span"),rn=ns.getRootNode(),cache=xui.$cache.profileMap;delete cache[ns.domId],delete cache[ns.$domId],rn.parentNode&&rn.parentNode.replaceChild(proxy,rn),ns.destroy(),delete ns.renderId,ns.render(),proxy.parentNode&&proxy.parentNode.replaceChild(ns.getRootNode(),proxy),proxy=rn=null}return ns},renderOnto:function(node){var id,domNode,t;"string"==typeof node&&(node=document.getElementById(node)),id=node.id||this.domId,this.renderId||this.render(),domNode=this.getRootNode(),node.parentNode.replaceChild(domNode,node),domNode.tabIndex!==node.tabIndex&&(domNode.tabIndex=node.tabIndex),node.className&&(domNode.className+=node.className),xui.browser.ie&&(t=node.style.cssText)?domNode.style.cssText+=t+"":(t=node.getAttribute("style"))&&domNode.setAttribute("style",(domNode.getAttribute("style")||"")+t),this.setDomId(id)},toHtml:function(properties){var p=xui.copy(properties||this.properties||{});return p.tpl_evkey="root",this._doTemplate(p)},_reg1:/([^{}]*)\{([\w]+)\}([^{}]*)/g,_reg2:/\[event\]/g,_buildTemplate:function(str){if("string"==typeof str){var obj=[[],[]],a0=obj[0],a1=obj[1];return(str=str.replace(this._reg2,' tpl_evid="{id}" tpl_evkey="{tpl_evkey}" ')).replace(this._reg1,(function(a,b,c,d){return b&&(a0[a0.length]=b),a1[a0.length]=a0[a0.length]=c,d&&(a0[a0.length]=d),""})),obj}return str},_getEV:function(funs,id,name,xid){var obj=xui.getNodeData(xid);if(obj){var evs=this.events,tpl_evkey=obj.tpl_evkey,evg=tpl_evkey&&evs&&evs[tpl_evkey]||evs,ev=evg&&evg[name];ev&&funs.push(ev)}},_reg3:/(^\s*<\w+)(\s|>)(.*)/,_doTemplate:function(properties,tag,result){if(!properties)return"";var s,t,n,self=this,me=arguments.callee,isA=xui.isArr(properties),template=self.$template,temp=template[tag||"root"],r=!result;if(result=result||[],isA){"function"!=typeof temp&&(temp=me);for(var i=0;t=properties[i++];)t.tpl_evkey=tag,temp.call(self,t,tag,result)}else if("function"==typeof temp)temp.call(self,properties,tag,result);else{tag=tag?tag+".":"";for(var a0=temp[0],a1=temp[1],l=(i=0,a0.length);i<l;i++)(n=a1[i])?n in properties&&(t="function"==typeof properties[n]?properties[n].call(self,n,properties):properties[n],template[s=tag+n]?me.call(self,t,s,result):result[result.length]=t):result[result.length]=a0[i]}return r?result.join("").replace(self._reg3,'$1 id="'+self.$domId+'" $2$3'):void 0},serialize:function(){var s=xui.serialize,t=xui.absObj.$specialChars,properties=xui.isEmpty(this.properties)?null:xui.clone(this.properties,(function(o,i){return!t[(i+"").charAt(0)]}));return"new xui.Template("+s(this.template||null)+","+s(properties)+","+s(xui.isEmpty(this.events)?null:this.events)+","+s(this.$domId!=this.domId?this.domId:null)+")"}},Static:{getFromDom:function(id){if((id="string"==typeof id?id:id&&id.id)&&(id=xui.$cache.profileMap[id])&&id["xui.Template"])return id.boxing()},_cache:[],_ctrlId:new xui.id}}),xui.Class("xui.Module","xui.absProfile",{Initialize:function(){var ns=this;xui.launch=function(cls,onEnd,lang,theme,showUI,parent,subId,onCreated,onDomReady){ns.load.apply(ns,[cls,function(err,module){module&&module.setHost(window,xui.ini.rootModuleName),xui.tryF(onEnd,[err,module],module)},lang,theme,showUI,parent,subId,onCreated,onDomReady])},ns["xui.Com"]=ns.prototype["xui.Com"]=1,xui.Com=ns,ns.$activeClass$="xui.Module",xui.broadcast=function(id,msg1,msg2,msg3,msg4,msg5,msg6,msg7,msg8,msg9){var arr=xui.toArr(arguments);xui.arr.each(xui.Module._cache,(function(o){o.fireEvent("onGlobalMessage",arr)}))}},After:function(){var k,e,t,b,i,self=this;if(xui.arr.each(["$DataModel","$EventHandlers"],(function(v){if(k=self[v]||{},(t=self.$parent)&&(e=t.length))for(;e--;)for(i in b=t[e][v])i in k||(k[i]=b[i]);self[v]=k})),"_evsClsBuildIn"in(e=self.prototype)){for(i in b=e._evsClsBuildIn,t=e._evsPClsBuildIn||(e._evsPClsBuildIn={}),b)t[i]?(xui.isArr(t[i])||(t[i]=[t[i]]),xui.arr.insertAny(t[i],b[i])):t[i]=xui.clone(b[i]);e._evsClsBuildIn=null}"events"in e&&(e._evsClsBuildIn=e.events,e.events={}),self._nameId=0,self._nameTag=self.$nameTag||self.KEY.replace(/\./g,"_").toLowerCase(),self._cache=[]},Constructor:function(properties,events,host){var opt,alias,t,self=this;properties&&properties.constructor==self.constructor&&properties.$xid&&(self.$xid=properties.$xid);var upper=arguments.callee.upper;if(upper&&upper.call(self),upper=null,properties&&properties.constructor==self.constructor){var oldm=properties;events=oldm.events||{},alias=oldm.alias,host=oldm.host,properties=oldm.properties||{},self=oldm}else properties&&properties.key&&properties["xui.Module"]?(properties=(opt=properties)&&opt.properties||{},events=opt&&opt.events||{},alias=opt.alias,host=opt.host):(properties||(self.properties?(properties=xui.clone(self.properties,!0),(t=self.properties.__inner_coms_prf__)&&(properties.__inner_coms_prf__=t)):properties={}),events=events||(self.events?xui.clone(self.events):{}));return self.Class=self.constructor,self.box=self.constructor,self.key=self.KEY,alias||(alias=self.constructor.pickAlias()),xui.isEmpty(self.constructor.$DataModel)||xui.merge(properties,xui.clone(self.constructor.$DataModel),"without"),self._links={},self.link(self.constructor._cache,"self"),self.link(xui.Module._cache,"xui.module"),self.link(xui._pool,"xui"),self.host=host||self,self.alias=alias,self.$UIvalue="",self._nodes=[],self._ctrlpool={},self.events=events,self.properties={},self.hooks={},self._evsClsBuildIn&&(self._evsClsBuildIn=xui.clone(self._evsClsBuildIn)),self._evsPClsBuildIn&&(self._evsPClsBuildIn=xui.clone(self._evsPClsBuildIn)),self.setProperties(properties,null,!0),self._innerCall("initialize"),self},Instance:{autoDestroy:!0,background:"",get:function(index){return xui.isNumb(index)?this:[this]},size:function(){return 1},boxing:function(){return this},each:function(fun,scope){return fun.call(scope,this),this},getRoot:function(rtnPrf){this._innerModulesCreated||this._createInnerModules();var fun=function(m){if(m["xui.Module"])for(var o,i=0;o=m._nodes[i];i++){if(o["xui.Module"])return fun(o);if(o["xui.UIProfile"]&&!o.box.$initRootHidden)return rtnPrf?o:o.getRoot()}};return fun(this)},getRootNode:function(){var ui=this.getRoot();if(!ui.isEmpty())return ui.get(0)},getModule:function(top){var getUpperModule=function(module){if(module.moduleClass&&module.moduleXid){var pm=xui.SC.get(module.moduleClass);if(pm&&(pm=pm.getInstance(module.moduleXid)))return getUpperModule(pm)}return module};return top?getUpperModule(this):this},_toDomElems:function(){var ns=this,innerUI=ns.getUIComponents();return ns.created||ns.create(null,!1),ns.render(),innerUI.each((function(o,i){(o=o.getModule())&&o!=ns&&o._toDomElems()})),innerUI._toDomElems()},setAlias:function(alias){return xui.absObj.prototype._setHostAlias.call(this,null,alias)},getAlias:function(){return this.alias},setHost:function(host,alias){return xui.absObj.prototype._setHostAlias.call(this,host,alias)},getName:function(){return this.properties.name||this.alias},setName:function(name){this.properties.name=name},getDesc:function(){return this.properties.desc},setDesc:function(desc){this.properties.desc=desc},getTabindex:function(){return this.properties.tabindex},setTabindex:function(tabindex){this.properties.tabindex=tabindex},getHost:function(){return this.host},setFunctions:function(key,value){key?"string"==typeof key?this.functions[key]=value:xui.isHash(key)&&(value?this.functions=xui.clone(key):xui.merge(this.functions,key,"all")):delete this.functions},getFunctions:function(key){var fs=this.functions;if(fs&&xui.isHash(fs))return key?fs[key]:fs},setProperties:function(key,value,ignoreEvent,innerDataOnly){var t,h=this.properties,oDataBinder="dataBinder"in h?h.dataBinder:null;return key?"string"==typeof key?h[key]=value:xui.isHash(key)&&(value?h=xui.copy(key):(h=xui.clone(h,!0),(t=this.properties.__inner_coms_prf__)&&(h.__inner_coms_prf__=t),xui.merge(h,key,"all"),value&&xui.isHash(value)&&xui.merge(h,value,"all"))):h={},this.properties=h,ignoreEvent||(innerDataOnly||"dataBinder"in h&&oDataBinder!==(t=h.dataBinder||null)&&(oDataBinder&&xui.DataBinder._unBind(oDataBinder,this),t&&xui.DataBinder._bind(t,this)),this._innerModulesCreated&&((t=this.properties.__inner_coms_prf__)&&this.setProfile(t),xui.isFun(this._propSetAction)&&this._propSetAction(this.properties)),xui.isFun(this.propSetAction)&&this.propSetAction(this.properties),innerDataOnly||this._fireEvent("onModulePropChange",[this.properties])),this},_propSetAction:function(prop){var r,t,f,mdl=this,reg=/^\s*([^>\s]+)\s*>\s*([^>\s]+)\s*$/;xui.each(prop,(function(o,i){xui.isSet(o)&&(r=reg.exec(i))&&(t=mdl[r[1]])&&(xui.isFun(t[f="set"+xui.str.initial(r[2])])?t[f](o):xui.set(mdl,[r[1],"properties",r[2]],o))}))},getProperties:function(key){var prop=this.properties;return xui.isFun(this._propGetter)&&(prop=this._propGetter(prop)),xui.isFun(this.propGetter)&&(prop=this.propGetter(prop)),key?prop[key]:xui.copy(prop)},setEvents:function(key,value){return key?"string"==typeof key?this.events[key]=value:xui.isHash(key)&&(value?this.events=xui.clone(key):xui.merge(this.events,key,"all")):this.events={},this},getEvents:function(key){return key?this.events[key]:this.events},setHooks:function(key,value){return key?"string"==typeof key?this.hooks[key]=value:xui.isHash(key)&&(value?this.hooks=xui.clone(key):xui.merge(this.hooks,key,"all")):this.hooks={},this},getHooks:function(key){return key?this.hooks[key]:this.hooks},notifyHooks:function(key,msg1,msg2,msg3,msg4,msg5,msg6,msg7,msg8,msg9){var hook,ns=this,hooks=ns.hooks;if(key&&hooks&&(hook=hooks[key])&&xui.isFun(hook))return xui.tryF(hook,xui.toArr(arguments).slice(1),ns)},postMessage:function(msg1,msg2,msg3,msg4,msg5,msg6,msg7,msg8,msg9,sender){var arr=xui.toArr(arguments);return arr.unshift(this),this.fireEvent("onMessage",arr)},serialize:function(rtnString,keepHost,oldDftProps){var t,o=(t=this.constructor._beforeSerialized)?t(this):this,r={"xui.Module":!0,alias:o.alias,key:o.KEY,host:o.host};r.host===this?delete r.host:o.host&&!keepHost&&(!1!==rtnString?r.host="@this":delete r.host);var c={},p=o.box.$DataModel;xui.merge(c,o.properties,(function(o,i){return p[i]!==o})),oldDftProps&&xui.each(oldDftProps,(function(v,k){v===c[k]&&delete c[k]})),(t=o.properties.__inner_coms_prf__)&&(c.__inner_coms_prf__=t),xui.isEmpty(c)||(r.properties=c),xui.isEmpty(r.properties)&&delete r.properties,xui.isEmpty(c=o.functions)||(r.functions=c),xui.isEmpty(r.functions)&&delete r.functions,xui.isEmpty(t=this.getEvents())||(r.events=t);var eh=o.box.$EventHandlers;return xui.filter(r.events,(function(o,i){return o!==eh[i]})),xui.isEmpty(t=this.getEvents())||(r.events=t),xui.isEmpty(r.events)&&delete r.events,!1===rtnString?r:xui.serialize(r)},clone:function(){var ns=this.serialize(!1,!0);return delete ns.alias,this.constructor.unserialize(ns)},fireEvent:function(name,args,host){if(!(this.$inDesign||this.host&&this.host.$inDesign)||xui.get(this,["_PASSEVTS",name])){var r,tp=this._evsPClsBuildIn&&this._evsPClsBuildIn[name],ti=this._evsClsBuildIn&&this._evsClsBuildIn[name],tt=this.events&&this.events[name],applyEvents=function(prf,events,host,args){var j;return args=xui.isSet(args)?xui.isArr(args)?args:[args]:[],(xui.isStr(events)||xui.isFun(events))&&(events=[events]),xui.isNumb(j=(events.actions||events)[0].event)&&xui.isObj(args[j])&&(args[j]=xui.Event.getEventPara(args[j])),xui.pseudocode._callFunctions(events,args,host,null,prf.$holder,(host&&host.alias||prf.$holder&&prf.$holder.alias)+"."+prf.alias+"."+name)};return this.$lastEvent=name,!tp||xui.isArr(tp)&&!tp.length||(r=applyEvents(this,tp,this,args)),!ti||xui.isArr(ti)&&!ti.length||(r=applyEvents(this,ti,this,args)),!tt||xui.isArr(tt)&&!tt.length||(r=applyEvents(this,tt,host||this.host||this,args)),r}},_fireEvent:function(name,args){return(args=args||[]).splice(0,0,this,this.threadid),this.fireEvent(name,args)},_innerCall:function(name){return xui.tryF(this[name],[this,this.threadid],this)},customAppend:function(parent,subId,left,top,threadid){return!1},popUp:function(pos,type,parent,trigger,group){var module=this,f=function(){module.getUIComponents(!0).popUp(pos,type,parent,trigger,group)};self.created?f():this.show(f)},show:function(onEnd,parent,subId,threadid,left,top){if(xui.UI.$trytoApplyCSS(),!1===this._fireEvent("beforeShow"))return!1;(parent=parent||xui("body"))["xui.UIProfile"]&&(parent=parent.boxing());var self=this,f=function(){var style=self.customStyle;if(style&&!xui.isEmpty(style)){var arr=[];xui.each(style,(function(v,k){arr.push(k+" : "+v+";")}));var txt=".xui-module-"+self.$xid+"{\r\n"+arr.join("\r\n")+"\r\n}";xui.CSS.addStyleSheet(txt,"xui:css:module-"+self.$xid,1)}self.getUIComponents().isEmpty()?(xui.tryF(self.customAppend,[parent,subId,left,top,threadid],self),xui.tryF(onEnd,[null,self,threadid],self)):(parent&&parent["xui.UI"]&&!parent.get(0).renderId||self.render(),!1===xui.tryF(self.customAppend,[parent,subId,left,top,threadid],self)&&(parent.append(self.getUIComponents(!1),subId),self.getUIComponents(!0).each((function(o){o.boxing().show(parent,subId,null,null,null,(function(){if("xui.UIProfile"==o.KEY&&xui.get(o,["properties","defaultFocus"]))try{xui.asyRun((function(){o.boxing().activate()}))}catch(e){}}))}))),self.renderId="ok",xui.tryF(onEnd,[null,self,threadid],self)),self._showed=1,self._fireEvent("afterShow")};return self.threadid=threadid,self.created?f():self.create(f,threadid),self},hide:function(){this.getUIComponents(!0).each((function(prf){prf.boxing().hide()})),this._showed=0},render:function(triggerLayout){var checkSubMdls=function(m){xui.arr.each(m._nodes,(function(o){o["xui.Module"]&&(o._fireEvent("onRender"),checkSubMdls(o))}))};return this.created||this.create(null,!1),"ok"!=this.renderId&&(this.renderId="ok",this.getUIComponents().render(triggerLayout),this._fireEvent("onRender"),checkSubMdls(this)),this},refresh:function(callback,ignoreEffects,purgeNow,oldDftProps){var b,p,s,inm,firstUI,childId,o=this,box=o.box,host=o.host,alias=o.alias,$xid=o.$xid,hashIn=o._render_conf,pPrf=o._render_holder,rt=o.$refreshTrigger,mcls=o.moduleClass,mxid=o.moduleXid;if(o.renderId&&!(inm=o.getUIComponents()).isEmpty())return firstUI=inm.get(0),host&&host["xui.Module"]&&(host.$ignoreAutoDestroy=!0),(b=!!firstUI.parent)?(p=firstUI.parent.boxing(),childId=firstUI.childrenId):(p=firstUI.getParent())||(p=firstUI.getRoot().parent()),s=o.serialize(!1,!0,oldDftProps),o.destroy(!1!==ignoreEffects,!1!==purgeNow,!0),oldDftProps&&o.properties&&xui.each(oldDftProps,(function(v,k){v===o.properties[k]&&delete o.properties[k]})),xui.merge(o,s,"all"),delete o.destroyed,o.$xid=$xid,hashIn&&(o._render_conf=hashIn),pPrf&&(o._render_holder=pPrf),new box(o),host&&o.setHost(host,alias),o.moduleClass=mcls,o.moduleXid=mxid,o.create((function(){var f=function(t,m){callback&&xui.tryF(callback)};rt&&rt.call(rt.target,o),b?o.show(f,p,childId):p.isEmpty()||o.show(f,p)})),o.host&&o.host["xui.Module"]&&delete o.host.$ignoreAutoDestroy,this},getParent:function(){var prf=this.getUIComponents().get(0);if(prf)return prf.parent&&prf.parent.boxing()},getChildrenId:function(){var prf=this.getUIComponents().get(0);if(prf)return prf.childrenId},create:function(onEnd,threadid){var self=this;if(self.created)xui.tryF(onEnd,[null,self,threadid],self);else{var funs=[];if(self.threadid=threadid,!1!==self._fireEvent("beforeCreated")){funs.push((function(threadid){threadid&&(self.threadid=threadid),self._fireEvent("onCreated")}));var required=[],required2=[];if(xui._collectClassRequired(self.Class,required,required2),required.length||required2.length){var attrs,id,uri,layer=0,fetchRequired=function(threadid,funs,index){if(required2.length){for(var j=0,m=required2.length;j<m;j++)id=attrs=null,xui.isHash(required2[j])?(id=required2[j].id||null,uri=required2[j].uri,delete(attrs=xui.copy(required2[j])).id,delete attrs.uri):uri=required2[j],id&&!xui.Dom.byId(id)?(xui.CSS.includeLink(uri,id,!1,attrs),self._fireEvent("onLoadRequiredCSS",[uri,j,layer])):xui.querySelector('link[href="'+uri+'"]').get(0)||(xui.CSS.includeLink(uri,id,!1,attrs),self._fireEvent("onLoadRequiredCSS",[uri,j,layer]));required2=[]}if(required.length){var requireDeep=[];xui.filter(required,(function(path){if(xui.isArr(path))return Array.prototype.push.apply(requireDeep,path),!1})),xui.require(required,(function(results){layer++,(required.length||required2.length)&&xui.Thread(threadid).insert(fetchRequired)}),(function(uri,key){var obj;key&&(obj=xui.SC.get(key))&&obj.$xuiclass$&&xui._collectClassRequired(obj,required,required2),self._fireEvent("onLoadRequiredClass",[uri,key,layer])}),(function(e){self._fireEvent("onLoadRequiredClassErr",[e,layer])}),null,!1,threadid,{stopRecursive:1,sync:!0}),required=[],requireDeep.length&&Array.prototype.push.apply(required,requireDeep)}};funs.push(fetchRequired)}return self.iniComponents&&funs.push((function(tid){self._createInnerModules(tid)})),self.iniResource&&funs.push((function(){self._fireEvent("onIniResource"),self._innerCall("iniResource")})),self.iniExComs&&(self.iniExModules=self.iniExComs,delete self.iniExComs),self.iniExModules&&funs.push((function(){self._innerCall("iniExModules")})),funs.push((function(threadid){self.background&&xui.SC.runInBG(self.background),self._fireEvent("onReady")})),funs.push((function(threadid){self.created=!0,xui.tryF(onEnd,[null,self,threadid],self)})),!1===threadid?xui.arr.each(funs,(function(fun){fun.call()})):xui.Thread.observableRun(funs,null,threadid),self}}},_createInnerModules:function(tid){var self=this;if(!self._recursived&&!self._innerModulesCreated){var stop,checkCycle=function(h){if(h&&h["xui.Module"]&&h.moduleClass&&h.moduleXid)if(self.KEY==h.moduleClass){if(self.$xid==h.moduleXid)return;self._recursived=h._recursived=!0,h.destroy(),self.destroy(),stop=1}else checkCycle(h.host)};if(checkCycle(self.host),stop)alert("There's a ["+self.KEY+"] in another ["+self.KEY+"], check this recursive call please!");else if(!1!==self._fireEvent("beforeIniComponents")){Array.prototype.push.apply(self._nodes,self._innerCall("iniComponents")||[]),xui.arr.each(self._nodes,(function(o){xui.Module.$attachModuleInfo(self,o),o["xui.Module"]&&o.create((function(){}),tid)}));var autoDestroy=self.autoDestroy||self.properties.autoDestroy;autoDestroy&&xui.arr.each(self._nodes,(function(o){if(o.box&&o.box["xui.UI"]&&!o.box["xui.UI.MoudluePlaceHolder"]&&!o.box.$initRootHidden)return(o.$afterDestroy=o.$afterDestroy||{}).moduleDestroyTrigger=function(ignoreEffects,purgeNow){!autoDestroy||self.destroyed||self.$ignoreAutoDestroy||self.destroy(ignoreEffects,purgeNow),self=null},!1})),self._fireEvent("afterIniComponents"),self._innerModulesCreated=!0,self.setProperties({})}}},iniComponents:function(){},applyExcelFormula:function(profileTo){var colMax,rowMax,ns=this,xformula=xui.ExcelFormula,formula=profileTo&&profileTo.properties.excelCellFormula,cellsMap={},cell2alias={},alias2cell={};if(formula){xui.each(this._ctrlpool,(function(prf){var t;(t=prf.properties.excelCellId)&&/^\s*[a-zA-Z]+[\d]+\s*$/.test(t)&&(cell2alias[t]=prf.alias,alias2cell[prf.alias]=t,t=xformula.toCoordinate(t,0),colMax=Math.max(colMax,t[0]),rowMax=Math.max(rowMax,t[1]))}));var refs=xformula.getRefCells(formula,colMax,rowMax);if(!refs)return;xui.each(cell2alias,(function(o,i){i in refs&&(i in cellsMap||(cellsMap[i]=ns[o].getExcelCellValue()))})),profileTo.boxing()._applyExcelFormula(cellsMap)}return ns},triggerExcelFormulas:function(profileFrom){var ns=this,formulaCells={},cell2alias={},alias2cell={},xformula=xui.ExcelFormula,rowMax=0,colMax=0,cellId=profileFrom&&profileFrom.alias;if(xui.each(this._ctrlpool,(function(prf){var t,p=prf.properties;(t=p.excelCellFormula)&&(formulaCells[prf.alias]=[prf,t]),(t=p.excelCellId)&&/^\s*[a-zA-Z]+[\d]+\s*$/.test(t)&&(t.replace(/\s/g,""),cell2alias[t]=prf.alias,alias2cell[prf.alias]=t,t=xformula.toCoordinate(t,0),colMax=Math.max(colMax,t.col),rowMax=Math.max(rowMax,t.row))})),cellId&&delete formulaCells[cellId],!xui.isEmpty(formulaCells)){var refs={};xui.each(formulaCells,(function(a,alias,hash,hash1){(hash=xformula.getRefCells(a[1],colMax,rowMax))&&(hash1={},xui.each(hash,(function(o,i){hash1[cell2alias[i]]=o})),refs[alias]=hash1)}));var count,noFormulaRef,needRec,cellsMap={},changed={};cellId&&(changed[cellId]=1);do{count=0,xui.filter(refs,(function(v,alias){if(needRec=0,cellId){for(var i in v)if(i in changed){needRec=1;break}}else needRec=1;if(!needRec)return!1;for(var i in noFormulaRef=!0,v)!cellId&&i in formulaCells?noFormulaRef=!1:alias2cell[i]in cellsMap||(cellsMap[alias2cell[i]]=ns[i].getExcelCellValue());return noFormulaRef?(ns[alias]._applyExcelFormula(cellsMap),cellId&&(changed[alias]=1),delete formulaCells[alias],count++,!1):void 0}))}while(!xui.isEmpty(formulaCells)&&count>0);return ns}},getProfile:function(){this._innerModulesCreated||this._createInnerModules();var t,hash={};return xui.each(this._ctrlpool,(function(prf){delete(t=hash[prf.alias]=prf.serialize(!1,!1,!1)).key,delete t.alias,delete t.events,delete t["xui.Module"]})),hash},setProfile:function(profiles){return this._innerModulesCreated||this._createInnerModules(),xui.each(this._ctrlpool,(function(prf,i){if(prf.alias in profiles){i=profiles[prf.alias];var ins=prf.boxing();i&&xui.isHash(i)&&!xui.isEmpty(i)?(i.theme&&"function"==typeof ins.setTheme&&ins.setTheme(i.theme),i.properties&&!xui.isEmpty(i.properties)&&ins.setProperties(i.properties),i.CA&&!xui.isEmpty(i.CA)&&ins.setCustomAttr(i.CA),i.CC&&!xui.isEmpty(i.CC)&&ins.setCustomClass(i.CC),i.CS&&!xui.isEmpty(i.CS)&&ins.setCustomStyle(i.CS)):ins.setValue(i)}})),this},getPropBinderKeys:function(scope_set,scope_clear){this._innerModulesCreated||this._createInnerModules(),scope_set=scope_set||xui._scope_set,scope_clear=scope_clear||xui._scope_clear;var hash={};try{scope_set.call(this),xui.each(this._ctrlpool,(function(prf){var prop=prf.properties;prop.propBinder&&xui.each(prop.propBinder,(function(fun,key){key in prop&&xui.isFun(fun)&&fun()}))}))}catch(e){}finally{scope_clear.call(this)}return xui.each(hash,(function(v,k){hash[k]=xui.toArr(v,!0)})),hash},reBindProp:function(dataMap,scope_set,scope_clear){this._innerModulesCreated||this._createInnerModules(),scope_set=scope_set||xui._scope_set,scope_clear=scope_clear||xui._scope_clear;try{scope_set.call(this,dataMap),xui.each(this._ctrlpool,(function(prf){prf.boxing().reBindProp(dataMap,scope_set,scope_clear,!0)}))}catch(e){scope_clear.call(this)}},getData:function(withValue){this._innerModulesCreated||this._createInnerModules();var hash={};return xui.each(this._ctrlpool,(function(prf){var prop=prf.properties,ins=prf.boxing(),ih=hash[prf.alias]={};xui.arr.each(["src","html","items","listKey","header","rows","target","toggle","attr","JSONData","XMLData","JSONUrl","XMLUrl","name","labelCaption"],(function(k){k in prop&&(ih[k]=prop[k])})),withValue&&"value"in prop&&(ih.value=prop.value),"caption"in prop&&xui.isSet(prop.caption)&&(ih.caption="function"==typeof ins.getCaption?ins.getCaption():prop.caption)})),hash},setData:function(data){return this._innerModulesCreated||this._createInnerModules(),xui.each(this._ctrlpool,(function(prf){var ih,prop=prf.properties,ins=prf.boxing();prf.alias in data&&((ih=data[prf.alias])&&xui.isHash(ih)&&!xui.isEmpty(ih)?xui.arr.each(["src","html","items","listKey","header","rows","target","toggle","attr","JSONData","XMLData","JSONUrl","XMLUrl","name","value","labelCaption","caption"],(function(k){k in prop&&k in ih&&ins["set"+xui.str.initial(k)](ih[k])})):ins.setValue(ih))})),this},getValue:function(innerUI){if(innerUI){this._innerModulesCreated||this._createInnerModules();var cap,uv,hash={};return xui.each(this._ctrlpool,(function(prf){"value"in prf.properties&&(xui.isSet(prf.properties.caption)?(cap=prf.properties.caption,uv=prf.properties.value,hash[prf.alias]=!cap&&!uv||cap==uv?uv:{value:uv,caption:cap}):hash[prf.alias]=prf.properties.value)})),hash}return this.properties.value},setValue:function(values,innerUI){return innerUI?(this._innerModulesCreated||this._createInnerModules(),xui.isEmpty(values)||xui.each(this._ctrlpool,(function(prf){if("value"in prf.properties&&prf.alias in values){var v=values[prf.alias],b=xui.isHash(v);prf.boxing().setValue(b&&"value"in v?v.value:v,!0,"module"),"function"==typeof prf.boxing().setCaption&&b&&"caption"in v&&prf.boxing().setCaption(v.caption,null,!0,"module")}}))):this.properties.value=values,this},getUIValue:function(innerUI){if(innerUI){this._innerModulesCreated||this._createInnerModules();var hash={};return xui.each(this._ctrlpool,(function(prf){"$UIvalue"in prf.properties&&(hash[prf.alias]=prf.properties.$UIvalue)})),hash}return this.$UIvalue},setUIValue:function(values,innerUI){return innerUI?(this._innerModulesCreated||this._createInnerModules(),xui.isEmpty(values)||xui.each(this._ctrlpool,(function(prf){if("value"in prf.properties&&prf.alias in values){var v=values[prf.alias],b=xui.isHash(v);prf.boxing().setUIValue(b&&"value"in v?v.value:v,!0,!1,"module"),"function"==typeof prf.boxing().setCaption&&b&&"caption"in v&&prf.boxing().setCaption(v.caption,null,!0,"module")}}))):this.$UIvalue=values,this},resetValue:function(innerUI){return innerUI?(this._innerModulesCreated||this._createInnerModules(),xui.each(this._ctrlpool,(function(prf){prf.boxing().resetValue&&prf.boxing().resetValue()}))):this.$UIvalue=this.properties.value,this},updateValue:function(innerUI){return innerUI?(this._innerModulesCreated||this._createInnerModules(),xui.each(this._ctrlpool,(function(prf){prf.boxing().updateValue&&prf.boxing().updateValue()})),this):(this.properties.value=this.$UIvalue,this)},isDirtied:function(innerUI){return innerUI?(this._innerModulesCreated||this._createInnerModules(),xui.each(this._ctrlpool,(function(prf){if(prf.boxing().isDirtied&&prf.boxing().isDirtied())return!1})),!1):this.properties.value===this.$UIvalue},checkValid:function(innerUI){if(!innerUI)return!0;this._innerModulesCreated||this._createInnerModules(),xui.each(this._ctrlpool,(function(prf){if(prf.boxing().checkValid&&!prf.boxing().checkValid())return!1}))},getDataBinders:function(){this._innerModulesCreated||this._createInnerModules();var nodes=xui.copy(this._nodes);return xui.filter(nodes,(function(o){return!!o.box["xui.DataBinder"]})),nodes},getForms:function(){this._innerModulesCreated||this._createInnerModules();var nodes=xui.copy(this._ctrlpool);return xui.filter(nodes,(function(o){return!!o.box["xui.absContainer"]})),nodes},getAllComponents:function(){this._innerModulesCreated||this._createInnerModules();var nodes=[],fun=function(m){m["xui.Module"]&&xui.each(m._ctrlpool,(function(o){o["xui.Module"]?fun(o):nodes.push(o)}))};return fun(this),xui.absObj.pack(nodes,!1)},getComponents:function(){this._innerModulesCreated||this._createInnerModules();var nodes=[],fun=function(m){m["xui.Module"]&&xui.arr.each(m._nodes,(function(o){o["xui.Module"]?fun(o):nodes.push(o)}))};return fun(this),xui.absObj.pack(nodes,!1)},getUIComponents:function(flag){var nodes=this.getComponents().get(),n="$initRootHidden";return xui.filter(nodes,(function(o){return!!(o&&o.box&&o.box["xui.UI"]&&(!0===flag?!o.box[n]:!1!==flag||o.box[n]))})),xui.UI.pack(nodes,!1)},setComponents:function(obj){var t,self=this;return xui.arr.each(self._nodes,(function(o){(t=self[o.alias])&&t.get(0)==o&&delete self[o.alias]})),xui.arr.each(self._nodes=obj.get(),(function(o){o.boxing().setHost(self,o.alias)})),xui.arr.each(self._nodes,(function(o){xui.Module.$attachModuleInfo(self,o)})),self},AddComponents:function(obj){var self=this;return xui.arr.each(obj.get(),(function(o){o.boxing().setHost(self,o.alias),self._nodes.push(o),xui.Module.$attachModuleInfo(self,o)})),self},isDestroyed:function(){return!!this.destroyed},destroy:function(ignoreEffects,purgeNow,keepStructure){var self=this,ns=(self.constructor,self._nodes);if(!self.destroyed){if(self._fireEvent("onDestroy"),self.alias&&self.host&&self.host[self.alias])try{delete self.host[self.alias]}catch(e){self.host[self.alias]=null}self.destroyed=!0,ns&&ns.length&&xui.arr.each(ns,(function(o){o&&o.box&&o.boxing().destroy(ignoreEffects,purgeNow)}),null,!0),ns&&ns.length&&(self._nodes.length=0),self._ctrlpool=null,self.unLinkAll(),keepStructure?(delete self.renderId,delete self.created,delete self._innerModulesCreated):xui.breakO(self),self.$afterDestroy&&(xui.each(self.$afterDestroy,(function(f){xui.tryF(f,[ignoreEffects,purgeNow],self)})),xui.breakO(self.$afterDestroy,2)),self.destroyed=!0}},applyPseudo:function(funConf,args,scope){return xui.isStr(funConf)&&(funConf=this.functions&&this.functions[funConf]),xui.isObj(funConf)?xui.pseudocode._callFunctions(funConf,args||[],scope||this):null}},Static:{"xui.absValue":!0,refresh:function(code){var n,s,m=this,keep={$children:m.$children,_cache:m._cache,_nameId:m._nameId},key=m.KEY,path=key.split(".");return(s=xui.get(window,["xui","$cache","SC"]))&&delete s[key],xui.set(window,path),xui.exec(code),n=xui.get(window,path),xui.merge(m,n,(function(o,i){return n.hasOwnProperty(i)})),xui.merge(m.prototype,n.prototype,(function(o,i){return n.prototype.hasOwnProperty(i)})),xui.merge(m,keep,"all"),xui.breakO(n.prototype,1),xui.breakO(n,1),xui.set(window,path,m),m},pickAlias:function(){return xui.absObj.$pickAlias(this)},getFromDom:function(id){var prf=xui.UIProfile.getFromDom(id);if(prf&&(prf=prf.host))return!prf.destroyed&&prf},getClsFromDom:function(id){return xui.get(this.getFromDom(id),["KEY"])},getAllInstance:function(){var hash={};return xui.arr.each(this._cache,(function(o){hash[o.$xid]=o})),hash},getInstance:function(module,xid){var m=this;if(!xid&&module&&(module["xui.Profile"]&&module.moduleClass&&module.moduleXid?(xid=module.moduleXid,module=module.moduleClass):(xid=module,module=null)),module){if(!(m=xui.SC.get(module))||!m["xui.Module"])return}else m=this;var c=m._cache;if(!xid)return c[0];for(var i in m._cache)if(xui.isFinite(i)?xid+""==i:"$"+xid==i)return m._cache[i]},postMessage:function(cls,msg1,msg2,msg3,msg4,msg5,msg6,msg7,msg8,msg9,sender){var arr,m=xui.SC.get(cls);m&&m["xui.Module"]&&((arr=xui.toArr(arguments))[0]=m,xui.arr.each(m._cache,(function(o){m.fireEvent("onMessage",arr)})))},destroyAll:function(ignoreEffects,purgeNow){xui.arr.each(this._cache,(function(o){o.destroyed||o.destroy(ignoreEffects,purgeNow)}))},load:function(cls,onEnd,lang,theme,showUI,parent,subId,onCreated,onDomReady){if(!cls){var e=new Error("No cls");throw xui.tryF(onEnd,[e,null]),e}"function"==typeof theme&&(showUI=theme);var applyEnv=function(setting){var t;if((t=setting.theme)&&(theme=t),(t=setting.SpaceUnit)&&(xui.SpaceUnit=t),(t=xui.ini.$DefaultProp)&&xui.isHash(t)){var ctl,allp={};xui.each(t,(function(v,k){/^xui\.UI\./.test(k)&&xui.isHash(v)&&(ctl=xui.get(window,k.split(".")))?ctl.setDftProp(v):allp[k]=v})),xui.isEmpty(allp)||xui.UI.setDftProp(allp)}if(setting.zoom){var zoom=function(type,width,height){var rw=parseInt(width,10)||800,rh=parseInt(height,10)||600;if(!xui.isNumb(type)){var cl,win=xui.win,ww=win&&win.width(),wh=win&&win.height();if(ww&&wh){var r_w=ww/rw,r_h=wh/rh;switch(type.split("-")[0]){case"width":type=r_w,cl="xui-css-noscrollx";break;case"height":type=r_h,cl="xui-css-noscrolly";break;case"cover":type=Math.max(r_w,r_h),cl="xui-css-noscroll"+(r_w>=r_h?"x":"y");break;case"contain":type=Math.min(r_w,r_h),cl="xui-css-noscroll"}xui("html").removeClass(/^xui-css-noscroll(x|y)?$/).addClass(cl),xui.ini.$fixFrame=1}}(type=parseFloat(type))&&1!=type&&(xui.ini.$fixFrame&&(xui("html").css({width:rw+"px",height:rh+"px"}),xui.frame=xui("html")),xui.ini.$zoomScale=type,xui.Dom.$setZoom(xui("html").get(0),type),xui.ini.$transformScale=type)};(t=xui.ini.$frame)&&(zoom(t.zoom,t.width,t.height),!xui.isNumb(t.zoom)&&/-resize$/.test(t.zoom+"")&&xui.win.onSize((function(){var t=xui.ini.$frame;xui.resetRun("_xui_auto_zoom",zoom,0,[t.zoom,t.width,t.height])}),"_xui_auto_zoom"))}(t=setting.background)&&xui.isHash(t)&&xui.each(t,(function(v,k){xui("html").css(k,xui.adjustRes(v))})),(t=xui.ini.$ElementStyle)&&xui.isHash(t)&&xui.CSS.setStyleRules(".xui-custom",t,!0),(t=xui.ini.$FontIconsCDN)&&xui.isHash(t)&&xui.asyRun((function(){xui.each(t,(function(o,i){if(o.href&&!o.disabled){var attr={crossorigin:"anonymous"};xui.merge(attr,o,(function(v,j){return"href"!==j&&"disabled"!==j})),xui.CSS.includeLink(xui.adjustRes(o.href),"xui_app_fscdn-"+i,!1,attr)}}))}),20)},createModule=function(path){var t,clsObj=this,setting={},showModule=function(i,l,flag){if(!xui.isFun(clsObj)){var e=new Error("'"+cls+"' is not a constructor");throw xui.tryF(onEnd,[e,null]),e}var o=new clsObj;clsObj._callfrom=cls,xui.set(xui.ModuleFactory,["_cache",cls],o),onCreated&&xui.tryF(onCreated,[o]),!1!==showUI?o.show(onEnd,parent,subId):xui.tryF(onEnd,[null,o],o)};if(!path){var e=new Error("No class name");throw xui.tryF(onEnd,[e,null]),e}(t=this.designViewConf)&&xui.isHash(t)&&xui.merge(setting,t),(t=this.viewStyles)&&xui.isHash(t)&&xui.each(t,(function(o,i){/^background/.test(i)?(setting.background||(setting.background={}))[i]=o:setting[i]=o})),setting.zoom&&xui.set(xui.ini,["$frame","zoom"],setting.zoom),setting.width&&xui.set(xui.ini,["$frame","width"],setting.width),setting.height&&xui.set(xui.ini,["$frame","height"],setting.height),xui.isEmpty(setting)||applyEnv(setting),theme&&"default"!=theme?xui.setTheme(theme,!0,(function(){xui.setLang(lang||"en",showModule)}),(function(){xui.alert("Can't load theme - "+theme),xui.setLang(lang||"en",showModule)})):xui.setLang(lang||"en",showModule)},domReady=function(){onDomReady&&xui.tryF(onDomReady);var t,setting={};(t=xui.ini.$DevEnv)&&xui.isHash(t)&&(t.SpaceUnit&&(setting.SpaceUnit=t.SpaceUnit),(t=t.designViewConf)&&xui.merge(setting,t,"all")),(t=xui.ini.$PageAppearance)&&xui.isHash(t)&&xui.merge(setting,t,"all"),setting.zoom&&xui.set(xui.ini,["$frame","zoom"],setting.zoom),setting.width&&xui.set(xui.ini,["$frame","width"],setting.width),setting.height&&xui.set(xui.ini,["$frame","height"],setting.height),xui.isEmpty(setting)||applyEnv(setting),"function"==typeof cls&&cls.$xui$?createModule.apply(["ok"],cls):cls+="",/\//.test(cls)&&!/\.js$/i.test(cls)&&(cls+=".js"),/\.js$/i.test(cls)?xui.fetchClass(cls,createModule,(function(e){xui.tryF(onEnd,[e,null])})):xui.SC(cls,createModule,!0,null,{retry:0,onFail:function(e){xui.tryF(onEnd,[e,null])}})};xui.isDomReady?domReady():xui.main(domReady)},unserialize:function(hash){return new this(hash)},$attachModuleInfo:function(module,prf){if(prf.moduleClass&&prf.moduleXid){var t=xui.SC.get(prf.moduleClass);if((t=t.getInstance(prf.moduleXid))!==module)return t.moduleClass=module.KEY,void(t.moduleXid=module.$xid)}prf.moduleClass=module.KEY,prf.moduleXid=module.$xid,xui.arr.each(prf.children,(function(v){xui.Module.$attachModuleInfo(module,v[0])}))},$DataModel:{autoDestroy:!0,dataBinder:"",value:""},$EventHandlers:{onHookKey:function(module,key,e,keyDown){},onFragmentChanged:function(module,fragment,init,newAdd){},onMessage:function(module,msg1,msg2,msg3,msg4,msg5,msg6,msg7,msg8,msg9,source){},onGlobalMessage:function(id,msg1,msg2,msg3,msg4,msg5,msg6,msg7,msg8,msg9,source){},beforeCreated:function(module,threadid){},beforeShow:function(module,threadid){},afterShow:function(module,threadid){},onLoadRequiredCSS:function(module,threadid,uri,index,layer){},onLoadRequiredClass:function(module,threadid,uri,key,layer){},onLoadRequiredClassErr:function(module,threadid,err,layer){},onIniResource:function(module,threadid){},beforeIniComponents:function(module,threadid){},afterIniComponents:function(module,threadid){},onModulePropChange:function(module,threadid,prop){},onReady:function(module,threadid){},onRender:function(module,threadid){},onDestroy:function(module){}}}}),xui.Class("xui.Cookies",null,{Static:{set:function(name,value,days,path,domain,isSecure){if(xui.isHash(name))for(var i in name)this.set(i,name[i],days,path,domain,isSecure);else"string"!=typeof value&&(value=xui.serialize(value)),document.cookie=escape(name+"")+"="+escape(value)+(days?"; expires="+new Date((new Date).getTime()+864e5*days).toGMTString():"")+(path?"; path="+path:"")+(domain?"; domain="+domain:"")+(isSecure?"; secure":"");return this},get:function(name){var i,a,s,v,ca=document.cookie.split("; "),hash={};for(i=0;i<ca.length;i++)if(s=(a=ca[i].split("="))[1]?unescape(a[1]):"",hash[a[0]]=(/^\s*\{[\s\S]*\}$/.test(v=s)||/^\s*\[[\s\S]*\]$/.test(v)?xui.unserialize(v):v)||s,name&&a[0]==escape(name))return hash[a[0]];return name?null:hash},remove:function(name){return this.set(name,"",-1).set(name,"/",-1)},clear:function(){xui.arr.each(document.cookie.split(";"),(function(o){xui.Cookies.remove(xui.str.trim(o.split("=")[0]))}))}}}),xui.Class("xui.XML",null,{Static:{json2xml:function(jsonObj,kf,vf){var arr=[],_f=function(key,value,arr){if("object"==typeof value)if(xui.isArr(value))if(value.length)for(var i=0,l=value.length;i<l;i++)arr.push(_f(key,value[i],arr));else arr.push("<"+(kf?kf(key):key)+">__[]__</"+(kf?kf(key):key)+">");else{var b;for(var i in arr.push("<"+(kf?kf(key):key)),value)"@"==i.charAt(0)?arr.push(" "+i.substr(1)+'="'+(vf?vf(value[i]):value[i])+'"'):b=1;if(arr.push(b?">":"/>"),b){for(var i in value)"#text"==i?arr.push(vf?vf(value[i]):value[i]):"#cdata"==i?arr.push("<![CDATA["+(vf?vf(value[i]):value[i])+"]]>"):"@"!=i.charAt(0)&&arr.push(_f(i,value[i],arr));arr.push("</"+(kf?kf(key):key)+">")}}else arr.push("<"+(kf?kf(key):key)+">"+(vf?vf(value):value)+"</"+(kf?kf(key):key)+">")};for(var i in jsonObj)_f(i,jsonObj[i],arr);return'<?xml version="1.0" encoding="UTF-8" ?>'+arr.join("")},xml2json:function(xmlObj){9==xmlObj.nodeType&&(xmlObj=xmlObj.documentElement);var o={},M={"\b":"\\b","\t":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},R=/^-?(\d\d*\.\d*$)|(^-?\d\d*$)|(^-?\.\d\d*$)/,_map={"__[]__":[],null:null,false:!1,true:!0},_es=function(str){return str.replace(/[\s\S]/g,(function(a,b){return(b=M[a])?b:a}))},_clear=function(xml){var n,k;for(xml.normalize(),n=xml.firstChild;n;)k=n,1==n.nodeType&&_clear(n),n=n.nextSibling,3!=k.nodeType||k.nodeValue.match(/\S/)||xml.removeChild(k);return xml},_xml=function(n){if("innerHTML"in n)n=(n=n.innerHTML)in _map?_map[n]:R.test(n)?parseFloat(n):n;else{for(var arr=[],_in=function(n){if(1==n.nodeType){arr.push("<"+n.nodeName);for(var m=n.attributes,i=0,l=m.length;i<l;i++)arr.push(" "+m[i].nodeName+'="'+(m[i].nodeValue||"")+'"');if(n.firstChild){for(arr.push(">"),m=n.firstChild;m;m=m.nextSibling)arr.push(_in(m));arr.push("</"+n.nodeName+">")}else arr.push("/>")}else 3==n.nodeType?(n=n.nodeValue,arr.push(n in _map?_map[n]:R.test(n)?parseFloat(n):n)):4==n.nodeType&&arr.push("<![CDATA["+n.nodeValue+"]]>")},m=n.firstChild;m;m=m.nextSibling)_in(m);n=1==arr.length?arr[0]:arr.join("")}return"string"==typeof n?_es(n):n},_f=function(xml){var t,tt,o=null;if(1==xml.nodeType&&((t=xml.attributes).length||xml.firstChild)){if(o={},t.length)for(var i=0,l=t.length;i<l;i++)o["@"+t[i].nodeName]=(t[i].nodeValue||"")+"";if(xml.firstChild){var n,text=0,cdata=0,children=0;for(n=xml.firstChild;n;n=n.nextSibling)1==(tt=n.nodeType)?children++:3==tt?text++:4==tt&&cdata++;if(children)if(text<2&&cdata<2)for(n=xml.firstChild;n;n=n.nextSibling)3==n.nodeType?o["#text"]=_es(n.nodeValue):4==n.nodeType?o["#cdata"]=_es(n.nodeValue):o[tt=n.nodeName]?o[tt]instanceof Array?o[tt][o[tt].length]=_f(n):o[tt]=[o[tt],_f(n)]:o[tt]=_f(n);else t.length?o["#text"]=_xml(xml):o=_xml(xml);else if(text)t.length?o["#text"]=_xml(xml):o=_xml(xml);else if(cdata)if(cdata>1)o=_xml(xml);else for(n=xml.firstChild;n;n=n.nextSibling)o["#cdata"]=_es(n.nodeValue)}}return o};return o[xmlObj.nodeName]=_f(_clear(xmlObj)),o},parseXML:function(xmlText){var dom=null;if("undefined"==typeof DOMParser)try{(dom=new ActiveXObject("Microsoft.XMLDOM")).async=!1,dom.loadXML(xmlText||"")}catch(e){dom=null}else try{var p=new DOMParser;dom=p.parseFromString(xmlText||"","text/xml")}catch(e){dom=null}finally{p=null}return dom}}}),xui.Class("xui.XMLRPC",null,{Static:{wrapRequest:function(methodName,params){if("object"==typeof methodName&&(params=methodName.params,methodName=methodName.methodName),!methodName)return null;if(params&&!(params instanceof Array))return null;var xml=['<?xml version="1.0"?><methodCall><methodName>'+methodName+"</methodName>"];if(params){xml.push("<params>");for(var i=0,j=params.length;i<j;i++)xml.push("<param>"+this._wrapParam(params[i])+"</param>");xml.push("</params>")}return xml.push("</methodCall>"),xml.join("")},parseResponse:function(xmlObj){if(!xmlObj||!xmlObj.documentElement)return null;var doc=xmlObj.documentElement;if("methodResponse"!=doc.nodeName)return null;var err,elem,json={};if("param"==(elem=doc.getElementsByTagName("value")[0]).parentNode.nodeName&&"params"==elem.parentNode.parentNode.nodeName)json.result=this._parseElem(elem);else{if("fault"!=elem.parentNode.nodeName)return null;err=this._parseElem(elem),json.error={code:err.faultCode,message:err.faultString}}return json.result||json.error?json:null},_dateMatcher:/^(?:(\d\d\d\d)-(\d\d)(?:-(\d\d)(?:T(\d\d)(?::(\d\d)(?::(\d\d)(?:\.(\d+))?)?)?)?)?)$/,_parseElem:function(elem){var typeElem,dateElem,name,value,tmp,nodes=elem.childNodes;if(1==nodes.length&&3==nodes.item(0).nodeType)return nodes.item(0).nodeValue;for(var i=0,l=nodes.length;i<l;i++)if(1==nodes.item(i).nodeType)switch((typeElem=nodes.item(i)).nodeName.toLowerCase()){case"i4":case"int":return value=parseInt(typeElem.firstChild.nodeValue,10),isNaN(value)?null:value;case"double":return value=parseFloat(typeElem.firstChild.nodeValue),isNaN(value)?null:value;case"boolean":return Boolean(0!==parseInt(typeElem.firstChild.nodeValue,10));case"string":return typeElem.firstChild?typeElem.firstChild.nodeValue:"";case"datetime.iso8601":return(tmp=typeElem.firstChild.nodeValue.match(this._dateMatcher))?(value=new Date,tmp[1]&&value.setUTCFullYear(parseInt(tmp[1],10)),tmp[2]&&value.setUTCMonth(parseInt(tmp[2]-1,10)),tmp[3]&&value.setUTCDate(parseInt(tmp[3],10)),tmp[4]&&value.setUTCHours(parseInt(tmp[4],10)),tmp[5]&&value.setUTCMinutes(parseInt(tmp[5],10)),tmp[6]&&value.setUTCSeconds(parseInt(tmp[6],10)),tmp[7]&&value.setUTCMilliseconds(parseInt(tmp[7],10)),value):null;case"base64":case"nil":return null;case"struct":value={};for(var mElem,j=0;mElem=typeElem.childNodes.item(j);j++)if(1==mElem.nodeType&&"member"==mElem.nodeName){name="",elem=null;for(var child,k=0;child=mElem.childNodes.item(k);k++)1==child.nodeType&&("name"==child.nodeName?name=child.firstChild.nodeValue:"value"==child.nodeName&&(elem=child));name&&elem&&(value[name]=this._parseElem(elem))}return value;case"array":for(value=[],dateElem=typeElem.firstChild;dateElem&&(1!=dateElem.nodeType||"data"!=dateElem.nodeName);)dateElem=dateElem.nextSibling;if(!dateElem)return null;for(elem=dateElem.firstChild;elem;)1==elem.nodeType&&value.push("value"==elem.nodeName?this._parseElem(elem):null),elem=elem.nextSibling;return value;default:return null}return null},_map:{"<":"&lt;",">":"&gt;","&":"&amp;",'"':"&quot;","'":"&apos;"},_date2utc:function(d){var r=this._zeroPad;return d.getUTCFullYear()+"-"+r(d.getUTCMonth()+1)+"-"+r(d.getUTCDate())+"T"+r(d.getUTCHours())+":"+r(d.getUTCMinutes())+":"+r(d.getUTCSeconds())+"."+r(d.getUTCMilliseconds(),3)},_zeroPad:function(v,w){for(w||(w=2),v=v||0===v?""+v:"";v.length<w;)v="0"+v;return v},_wrapParam:function(value){var sign,map=this._map,xml=["<value>"];switch(typeof value){case"number":xml.push(isFinite(value)?parseInt(value,10)===Math.ceil(value)?"<int>"+value+"</int>":"<double>"+value+"</double>":"<nil/>");break;case"boolean":xml.push("<boolean>"+(value?"1":"0")+"</boolean>");break;case"string":xml.push("<string>"+value.replace(/[<>&"']/g,(function(a){return map[a]}))+"</string>");break;case"undefined":xml.push("<nil/>");case"function":xml.push("<string>"+(""+value).replace(/[<>&"']/g,(function(a){return map[a]}))+"</string>");case"object":if(sign=Object.prototype.toString.call(value),null===value)xml.push("<nil/>");else if("[object Array]"===sign){xml.push("<array><data>");for(var i=0,j=value.length;i<j;i++)xml.push(this._wrapParam(value[i]));xml.push("</data></array>")}else if("[object Date]"===sign&&isFinite(+value))xml.push("<dateTime.iso8601>"+this._date2utc(value)+"</dateTime.iso8601>");else{for(var key in xml.push("<struct>"),value)value.hasOwnProperty(key)&&xml.push("<member><name>"+key+"</name>"+this._wrapParam(value[key])+"</member>");xml.push("</struct>")}}return xml.push("</value>"),xml.join("")}}}),xui.Class("xui.SOAP",null,{Static:{RESULT_NODE_NAME:"return",getNameSpace:function(wsdl){var ns=wsdl.documentElement.attributes.targetNamespace;return ns===undefined?wsdl.documentElement.attributes.getNamedItem("targetNamespace").nodeValue:ns.value},getWsdl:function(queryURL,onFail){var rst=!1;return xui.Ajax(queryURL+"?wsdl",null,(function(rspData){rst=rspData}),(function(){xui.tryF(onFail,arguments,this)}),null,{method:"GET",rspType:"xml",asy:!1}).start(),rst},wrapRequest:function(methodName,params,wsdl){return"object"==typeof methodName&&(wsdl=params,params=methodName.params,methodName=methodName.methodName),'<soap:Envelope xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:soap="http://schemas.xmlsoap.org/soap/envelope/"><soap:Body><'+methodName+' xmlns="'+this.getNameSpace(wsdl)+'">'+this._wrapParams(params)+"</"+methodName+"></soap:Body></soap:Envelope>"},parseResponse:function(xmlObj,methodName,wsdl){"object"==typeof methodName&&(methodName=methodName.methodName);var hash={},nd=xmlObj.getElementsByTagName(methodName+"Result");return nd.length||(nd=xmlObj.getElementsByTagName(this.RESULT_NODE_NAME)),nd.length?hash.result=this._rsp2Obj(nd[0],wsdl):hash.fault={faultcode:xmlObj.getElementsByTagName("faultcode")[0].childNodes[0].nodeValue,faultstring:xmlObj.getElementsByTagName("faultstring")[0].childNodes[0].nodeValue},hash},_rsp2Obj:function(xmlNode,wsdl){var types=this._getTypesFromWsdl(wsdl);return this._node2obj(xmlNode,types)},_getTypesFromWsdl:function(wsdl){var ell,useNamedItem,types=[];(ell=wsdl.getElementsByTagName("s:element")).length?useNamedItem=!0:(ell=wsdl.getElementsByTagName("element"),useNamedItem=!1);for(var i=0,l=ell.length;i<l;i++)useNamedItem?null!=ell[i].attributes.getNamedItem("name")&&null!=ell[i].attributes.getNamedItem("type")&&(types[ell[i].attributes.getNamedItem("name").nodeValue]=ell[i].attributes.getNamedItem("type").nodeValue):null!=ell[i].attributes.name&&null!=ell[i].attributes.type&&(types[ell[i].attributes.name.value]=ell[i].attributes.type.value);return types},_getTypeFromWsdl:function(elems,types){return types[elems]==undefined?"":types[elems]},_node2obj:function(xmlNode,types){if(null==xmlNode)return null;var value,tmp,ns=this;if(3!=xmlNode.nodeType&&4!=xmlNode.nodeType){if(1!=xmlNode.childNodes.length||3!=xmlNode.childNodes[0].nodeType&&4!=xmlNode.childNodes[0].nodeType){if(-1==ns._getTypeFromWsdl(xmlNode.nodeName,types).toLowerCase().indexOf("arrayof")){for(var obj=xmlNode.hasChildNodes()?{}:null,i=0,l=xmlNode.childNodes.length;i<l;i++)obj[xmlNode.childNodes[i].nodeName]=ns._node2obj(xmlNode.childNodes[i],types);return obj}var arr=[];for(i=0,l=xmlNode.childNodes.length;i<l;i++)arr.push(ns._node2obj(xmlNode.childNodes[i],types));return arr}return ns._node2obj(xmlNode.childNodes[0],types)}switch(value=xmlNode.nodeValue,ns._getTypeFromWsdl(xmlNode.parentNode.nodeName,types).toLowerCase()){case"s:boolean":return value+""=="true";case"s:int":case"s:long":return null===value?0:parseInt(value+"",10);case"s:double":return null===value?0:parseFloat(value+"");case"s:datetime":if(null==value)return null;if(tmp=value.match(ns._dateMatcher)){var d=new Date;return tmp[1]&&d.setUTCFullYear(parseInt(tmp[1],10)),tmp[2]&&d.setUTCMonth(parseInt(tmp[2]-1,10)),tmp[3]&&d.setUTCDate(parseInt(tmp[3],10)),tmp[4]&&d.setUTCHours(parseInt(tmp[4],10)),tmp[5]&&d.setUTCMinutes(parseInt(tmp[5],10)),tmp[6]&&d.setUTCSeconds(parseInt(tmp[6],10)),tmp[7]&&d.setUTCMilliseconds(parseInt(tmp[7],10)),d}return null;default:return null===value?"":value+""}return null},_wrapParams:function(params){var arr=[];for(var p in params)switch(typeof params[p]){case"string":case"number":case"boolean":case"object":arr.push("<"+p+">"+this._wrapParam(params[p])+"</"+p+">")}return arr.join("")},_map:{"<":"&lt;",">":"&gt;","&":"&amp;",'"':"&quot;","'":"&apos;"},_wrapParam:function(param){var sign,sign2,type,value,s="",map=this._map;switch(typeof param){case"string":s+=param.replace(/[<>&"']/g,(function(a){return map[a]}));break;case"number":case"boolean":s+=param+"";break;case"object":if("[object Date]"===(sign=Object.prototype.toString.call(param))&&isFinite(+param))s+=this._date2utc(param);else if("[object Array]"===sign)for(var p in param){switch(typeof(value=param[p])){case"number":type=parseInt(value,10)===Math.ceil(value)?"int":"double";break;case"boolean":type="bool";break;case"string":type="string";break;case"object":type="[object Array]"===(sign2=Object.prototype.toString.call(value))?"Array":"[object Date]"===sign2&&isFinite(+value)?"DateTime":"object"}s+="<"+type+">"+this._wrapParam(param[p])+"</"+type+">"}else for(var p in param)param.hasOwnProperty(p)&&(s+="<"+p+">"+this._wrapParam(param[p])+"</"+p+">")}return s},_date2utc:function(d){var r=this._zeroPad;return d.getUTCFullYear()+"-"+r(d.getUTCMonth()+1)+"-"+r(d.getUTCDate())+"T"+r(d.getUTCHours())+":"+r(d.getUTCMinutes())+":"+r(d.getUTCSeconds())+"."+r(d.getUTCMilliseconds(),3)},_zeroPad:function(v,w){for(w||(w=2),v=v||0===v?""+v:"";v.length<w;)v="0"+v;return v}}}),xui.Class("xui.DragDrop",null,{Static:{_eh:"_dd",_id:"xui.dd:proxy:",_idi:"xui.dd:td:",_type:{blank:1,move:1,shape:1,deep_copy:1,copy:1,icon:1,none:1},_Icons:{none:"0 0",move:"0 -16px",link:"0 -32px",add:"0 -48px"},_profile:{},_left:function(value){var proxySize=this.$proxySize,prf=this._profile;if(prf.magneticDistance>0&&prf.xMagneticLines.length)for(var l=prf.xMagneticLines.length;l--;)if(Math.abs(value+proxySize-prf.xMagneticLines[l])<=prf.magneticDistance)return prf.xMagneticLines[l]-proxySize;return prf.widthIncrement>1?Math.floor((value+proxySize)/prf.widthIncrement)*prf.widthIncrement-proxySize:value},_top:function(value){var proxySize=this.$proxySize,prf=this._profile;if(prf.magneticDistance>0&&prf.yMagneticLines.length)for(var l=prf.yMagneticLines.length;l--;)if(Math.abs(value+proxySize-prf.yMagneticLines[l])<=prf.magneticDistance)return prf.yMagneticLines[l]-proxySize;return prf.heightIncrement>1?Math.floor((value+proxySize)/prf.heightIncrement)*prf.heightIncrement-proxySize:value},_ini:function(o){var d=this,p=d._profile,_t=xui.win;d._box={width:_t.width()+_t.scrollLeft(),height:_t.height()+_t.scrollTop()},p.ox=p.x,p.oy=p.y,(d._proxy=o)&&(d._proxystyle=o.get(0).style,d._profile.curPos=d._cssPos=d._proxy.cssPos(),d._cssPos_x=p.x-d._cssPos.left,d._cssPos_y=p.y-d._cssPos.top,p.restrictedLeft=p.x-(p.maxLeftOffset||0),p.restrictedRight=p.x+(p.maxRightOffset||0),p.restrictedTop=p.y-(p.maxTopOffset||0),p.restrictedBottom=p.y+(p.maxBottomOffset||0),d._proxyLeft=d._pre.left=d._cssPos.left,d._proxyTop=d._pre.top=d._cssPos.top,"move"!==p.dragType&&(d._proxy.css("zIndex",10*xui.Dom.TOP_ZINDEX),xui.setNodeData(d._proxy.get(0),"zIndexIgnore",1)))},_reset:function(){var d=this;return xui.tryF(d.$reset),d.setDropFace(),d._resetProxy(),d.$proxySize=50,d.$mousemove=d.$mouseup=d.$onselectstart=d.$ondragstart="*",d._cursor="",d._pre={},d._proxyLeft=d._proxyTop=d._cssPos_x=d._cssPos_y=0,d._stop=!1,d._onDrag&&d._onDrag.tasks&&(d._onDrag.tasks.length=0,delete d._onDrag.tasks),d._onDragover&&d._onDragover.tasks&&(d._onDragover.tasks.length=0,delete d._onDragover.tasks),d._c_droppable&&(d._c_droppable.length=0),d._c_droppable=d._c_dropactive=d._cssPos=d._box=d._dropElement=d._source=d._proxy=d._proxystyle=d._onDrag=d._onDragover=null,d._profile={$id:xui.rand(),dragType:"shape",dragCursor:"move",targetReposition:!0,dragIcon:xui.ini.img_dd,magneticDistance:0,xMagneticLines:[],yMagneticLines:[],widthIncrement:0,heightIncrement:0,dragDefer:0,horizontalOnly:!1,verticalOnly:!1,maxBottomOffset:null,maxLeftOffset:null,maxRightOffset:null,maxTopOffset:null,targetNode:null,targetCSS:null,dragKey:null,dragData:null,targetLeft:null,targetTop:null,targetWidth:null,targetHeight:null,targetOffsetParent:null,targetCallback:null,tagVar:null,shadowFrom:null,proxyNode:null,x:0,y:0,ox:0,oy:0,curPos:{},offset:{},isWorking:!1,restrictedLeft:null,restrictedRight:null,restrictedTop:null,restrictedBottom:null,dropElement:null},d.__touchingfordd=0,d},abort:function(){this._stop=!0},_end:function(){var mm2,mu2,d=this,win=window,doc=document,body=doc.body;return xui.browser.isTouch&&(mm2=xui.browser.ie&&win.PointerEvent?"onpointermove":xui.browser.ie&&win.MSPointerEvent?"onmspointermove":"ontouchmove",mu2=xui.browser.ie&&win.PointerEvent?"onpointerup":xui.browser.ie&&win.MSPointerEvent?"onmspointerup":"ontouchend"),d._proxy&&d._unpack(),"*"!=d.$onselectstart&&(body.onselectstart=d.$onselectstart),"*"!=d.$ondragstart&&(doc.ondragstart=d.$ondragstart),"*"!=d.$mousemove&&(doc.onmousemove=d.$mousemove),"*"!=d.$mouseup&&(doc.onmouseup=d.$mouseup),xui.browser.isTouch&&("*"!=d.$touchmove&&(doc[mm2]=d.$touchmove),"*"!=d.$touchend&&(doc[mu2]=d.$touchend)),d},startDrag:function(e,targetNode,profile,dragKey,dragData){var t,d=this,win=window;if(d._profile.isWorking)return!1;if(d._end()._reset(),d._profile.isWorking=!0,d.__touchingfordd="xuitouchdown"==e.type,profile=xui.isHash(profile)?profile:{},e=e||win.event,"left"!==xui.Event.getBtn(e))return!0;d._source=profile.targetNode=xui(targetNode),d._cursor=d._source.css("cursor"),(t=profile.targetNode.get(0))&&!t.id&&(t.id=xui.Dom._pickDomId(),t=null),d._defer=profile.dragDefer=xui.isNumb(profile.dragDefer)?profile.dragDefer:0,!0===profile.dragCursor&&(profile.dragCursor=d._cursor),"string"==typeof profile.dragIcon&&(profile.dragType="icon");var mm2,mu2,doc=document,body=doc.body,_pos=xui.Event.getPos(e),mm="onmousemove",mu="onmouseup";xui.browser.isTouch&&(mm2=xui.browser.ie&&win.PointerEvent?"onpointermove":xui.browser.ie&&win.MSPointerEvent?"onmspointermove":"ontouchmove",mu2=xui.browser.ie&&win.PointerEvent?"onpointerup":xui.browser.ie&&win.MSPointerEvent?"onmspointerup":"ontouchend"),profile.x=_pos.left,profile.y=_pos.top,profile.dragKey=dragKey||profile.dragKey||null,profile.dragData=dragData||profile.dragData||null;var fromN=xui.Event.getSrc(e);if(d._start=function(e){var p=d._profile;if(xui.merge(p,profile,"with"),d._source.beforeDragbegin(),d._stop)return d._end()._reset(),!1;if(xui.Event&&(t=d._source.get(0))&&(xui.Event._preDroppable=t.id,t=null),"icon"==p.dragType&&(p.targetReposition=!1),d._ini("none"==p.dragType?null:d._pack(_pos,p.targetNode)),profile.x>=d._box.width||profile.y>=d._box.height)return d._end()._reset(),!0;if(d._source.onDragbegin(),p.dragDefer<1&&(d.$mousemove=doc[mm],d.$mouseup=doc[mu],xui.browser.isTouch&&(d.$touchmove=doc[mm2],d.$touchend=doc[mu2])),xui.browser.ie&&xui.setTimeout((function(){fromN.releaseCapture&&fromN.releaseCapture()})),doc[mm]=d.$onDrag,doc[mu]=d.$onDrop,xui.browser.isTouch&&(doc[mm2]=d.$onDrag,doc[mu2]=d.$onDrop),d._source.afterDragbegin(),p.dragDefer>0&&d.$onDrag.call(d,e),xui.browser.isTouch&&d.__touchingfordd){d._c_droppable=[];var cdata=xui.$cache.droppable[p.dragKey],purge=[];xui.arr.each(cdata,(function(i){if(xui.use(i).get(0)){var hash,ni=xui.use(i),h=ni.offsetHeight(),w=ni.offsetWidth(),v=ni.css("visibility");w&&h&&"hidden"!=v&&((hash=ni.offset()).width=w,hash.height=h,hash.id=i,d._c_droppable.unshift(hash))}else purge.push(i)})),purge.length&&xui.arr.each(purge,(function(key){xui.arr.removeValue(cdata,key)}))}},xui.browser.ie&&(d.$ondragstart=doc.ondragstart,d.$onselectstart=body.onselectstart,doc.ondragstart=body.onselectstart=null,doc.selection&&doc.selection.empty))try{doc.selection.empty()}catch(e){}if(xui.Event.stopBubble(e),profile.targetNode.get(0)!==doc&&xui(doc).onMousedown(!0,xui.Event.getEventPara(e,_pos)),profile.dragDefer<1)return xui.tryF(d._start,[e],d),!1;d.$mouseup=doc[mu],doc[mu]=function(e){return xui.DragDrop._end()._reset(),xui.tryF(document.onmouseup,[e],null,!0)},xui.browser.isTouch&&(d.$touchend=doc[mu2],doc[mu2]=doc[mu]);var pbak={};d.$mousemove=doc[mm],doc[mm]=function(e){var p=xui.Event.getPos(e);if(p.left!==pbak.left||p.top!==pbak.top)return pbak=p,--d._defer<=0&&xui.DragDrop._start(e),!1},xui.browser.isTouch&&(d.$touchmove=doc[mm2],doc[mm2]=doc[mm])},$onDrag:function(e){var d=xui.DragDrop,p=d._profile;if(d.$SimulateMousemoveInMobileDevice)return!1;if(e=e||window.event,!p.isWorking||d._stop)return d.$onDrop(e),!0;var _pos=xui.Event.getPos(e);if(p.x=_pos.left,p.y=_pos.top,!p.isWorking)return!1;if(d._proxy?(p.verticalOnly||(d._proxyLeft=Math.floor(d._left((null!==p.maxLeftOffset&&p.x<=p.restrictedLeft?p.restrictedLeft:null!==p.maxRightOffset&&p.x>=p.restrictedRight?p.restrictedRight:p.x)-d._cssPos_x)),d._proxyLeft-d._pre.left&&(d._proxystyle.left=Math.round(parseFloat(d._proxyLeft))+"px"),d._pre.left=d._proxyLeft,p.curPos.left=d._proxyLeft+d.$proxySize),p.horizontalOnly||(d._proxyTop=Math.floor(d._top((null!==p.maxTopOffset&&p.y<=p.restrictedTop?p.restrictedTop:null!==p.maxBottomOffset&&p.y>=p.restrictedBottom?p.restrictedBottom:p.y)-d._cssPos_y)),d._proxyTop-d._pre.top&&(d._proxystyle.top=Math.round(parseFloat(d._proxyTop))+"px"),d._pre.top=d._proxyTop,p.curPos.top=d._proxyTop+d.$proxySize)):(p.curPos.left=p.x,p.curPos.top=p.y),1!=d._onDrag&&(d._onDrag?d._onDrag(e,d._source._get(0)):(d._onDrag=1,d._source.onDrag(!0,xui.Event.getEventPara(e,_pos)))),xui.browser.isTouch&&d.__touchingfordd&&d._c_droppable)for(var i=0,l=d._c_droppable.length;i<l;i++){var o=d._c_droppable[i],target=xui.use(o.id).get(0),oactive=d._c_dropactive,otarget=xui.use(oactive).get(0);if(p.x>=o.left&&p.y>=o.top&&p.x<=o.left+o.width&&p.y<=o.top+o.height){if(oactive==o.id){var first=e.changedTouches[0];d.$SimulateMousemoveInMobileDevice=1,xui.Event.simulateEvent(target,"mousemove",{screenX:first.screenX,screenY:first.screenY,clientX:first.clientX,clientY:first.clientY}),delete d.$SimulateMousemoveInMobileDevice}else xui.Event.simulateEvent(target,"mouseover",{screenX:p.left,screenY:p.top,clientX:p.left,clientY:p.top}),d._c_dropactive=o.id,oactive&&otarget&&xui.Event.simulateEvent(otarget,"mouseout",{screenX:p.left,screenY:p.top,clientX:p.left,clientY:p.top});break}if(oactive==o.id){otarget&&xui.Event.simulateEvent(otarget,"mouseout",{screenX:p.left,screenY:p.top,clientX:p.left,clientY:p.top}),d._c_dropactive=null;break}}return!1},$onDrop:function(e){var d=xui.DragDrop,p=d._profile,evt=xui.Event;if(e=e||window.event,d._end(),p.isWorking){d.setDropFace();var r=d._source.onDragstop(!0,evt.getEventPara(e));d._dropElement&&xui.use(d._dropElement).onDrop(!0,evt.getEventPara(e))}return d._reset(),evt.stopBubble(e),xui.tryF(document.onmouseup,[e]),!!r},setDropElement:function(id){return this._profile.dropElement=this._dropElement=id,this},getProfile:function(){var d=this,p=d._profile;return p.offset=d._proxy?{x:d._proxyLeft-p.ox+d._cssPos_x,y:d._proxyTop-p.oy+d._cssPos_y}:{x:p.x-p.ox,y:p.y-p.oy},p},setDropFace:function(target,dragIcon){var st,sl,d=this,s1='<div style="position:absolute;z-index:'+xui.Dom.TOP_ZINDEX+";font-size:0;line-height:0;border-",s2=":dashed 1px #ff6600;",region=d._Region,rh=d._rh,bg="backgroundColor";return region&&region.parent()&&region.remove(!1),d._R&&(d._R.css(bg,d._RB),delete d._R,delete d._RB),target?(region&&region.get(0)||(region=d._Region=xui.create(s1+'top:solid 2px #ff6600;left:0;top:0;width:100%;height:0;"></div>'+s1+"right"+s2+'right:0;top:0;height:100%;width:0;"></div>'+s1+"bottom"+s2+'bottom:0;left:0;width:100%;height:0;"></div>'+s1+"left"+s2+'width:0;left:0;top:0;height:100%;"></div>'),rh=d._rh=xui([region.get(1),region.get(3)])),target=xui(target),xui.browser.ie6&&rh.height("100%"),"block"==target.css("display")?(xui.setNodeData(region.get(0),"zIndexIgnore",1),target.append(region),region.top(st=target.scrollTop()).left(sl=target.scrollLeft()),region.get(2).style.top="auto",region.get(1).style.left="auto",region.get(2).style.bottom="-"+st+"px",region.get(1).style.right="-"+sl+"px",xui.browser.ie6&&!rh.get(0).offsetHeight&&rh.height(target.get(0).offsetHeight)):(d._RB=target.get(0).style[bg],d._R=target,target.css(bg,"#FA8072")),d.setDragIcon(dragIcon||"move")):d.setDragIcon("none"),d},setDragIcon:function(key){xui.resetRun("setDropFace",null);var d=this,p=d._profile,i=p.proxyNode,ic=d._Icons;return i&&"icon"==p.dragType&&i.first(4).css("object"==typeof key?key:{backgroundPosition:ic[key]||key}),d},_setProxy:function(child,pos){var t,temp,d=this,p=d._profile,dom=xui.Dom;return dom.byId(d._id)||xui("body").prepend(xui.create('<div id="'+d._id+'" style="left:0;top:0;border:0;font-size:0;line-height:0;padding:'+d.$proxySize+"px;position:absolute;background:url("+xui.ini.img_bg+') repeat;"><div style="font-size:0;line-height:0;" id="'+d._idi+'">'+(xui.browser.ie6?"&nbsp;":"")+"</div></div>")),t=xui(d._id),p.dragKey?(d.$proxySize=0,t.css("padding",0)):(pos.left-=d.$proxySize,pos.top-=d.$proxySize,p.targetOffsetParent||dom.setCover(!0,null,!1,p.dragCursor)),(temp=p.targetOffsetParent)&&xui(temp).append(t),child?(xui(d._idi).empty(!1).append(child),p.proxyNode=child):p.proxyNode=xui(d._idi),t.css({display:"",zIndex:10*dom.TOP_ZINDEX,cursor:p.dragCursor}).offset(pos,temp),xui.setNodeData(t.get(0),"zIndexIgnore",1),t},_resetProxy:function(){var d=this,p=d._profile,dom=xui.Dom,id1=d._id,id2=d._idi;if(dom.byId(id1)){var o=xui(id2),t=xui(id1);xui.browser.ie6?o.html("&nbsp;"):o.empty(),o.attr("style","font-size:0;line-height:0;"),xui("body").prepend(t.css({zIndex:0,cursor:"",display:"none",padding:Math.round(parseFloat(d.$proxySize))+"px"})),p.proxyNode=d._proxystyle=null,dom.setCover(!1)}},_pack:function(mousePos,targetNode){var target,t,pos={},size={},d=this,p=d._profile;switch(null!==p.targetLeft&&null!==p.targetTop||(t=targetNode.offset(null,p.targetOffsetParent)),pos.left=null!==p.targetLeft?p.targetLeft:t.left,pos.top=null!==p.targetTop?p.targetTop:t.top,p.dragType){case"deep_copy":case"copy":size.width=xui.isNumb(p.targetWidth)?p.targetWidth:targetNode.cssSize().width||0,size.height=xui.isNumb(p.targetHeight)?p.targetHeight:targetNode.cssSize().height||0;var n=targetNode.clone("deep_copy"==p.dragType).css({position:"relative",margin:"0",left:"0",top:"0",right:"",bottom:"",cursor:p.dragCursor,cssFloat:"none"}).cssSize(size).id("",!0).css("opacity",.8);p.targetCallback&&p.targetCallback(n),n.query("*").id("",!0),p.targetCSS&&n.css(p.targetCSS),target=d._setProxy(n,pos);break;case"shape":size.width=null!==p.targetWidth?p.targetWidth:targetNode.offsetWidth(),size.height=null!==p.targetHeight?p.targetHeight:targetNode.offsetHeight(),size.width-=2,size.height-=2,target=d._setProxy(xui.create("div").css({border:"dashed 1px",fontSize:"0",lineHeight:"0"}).cssSize(size),pos);break;case"blank":target=d._setProxy(null,pos);break;case"icon":pos.left=xui.isNumb(p.targetLeft)?p.targetLeft:mousePos.left+16,pos.top=xui.isNumb(p.targetTop)?p.targetTop:mousePos.top+16,t='<table border="0" class="xui-node xui-node-table"><tr><td valign="top"><span class="xui-node xui-node-span" style="background:url('+p.dragIcon+") no-repeat left top;width:"+(xui.isNumb(p.targetWidth)?p.targetWidth:16)+"px;height:"+(xui.isNumb(p.targetHeight)?p.targetHeight:16)+'px;" ></span></td><td id="xui:dd:shadow" '+(p.shadowFrom?'style="border:solid 1px #e5e5e5;background:#fff;font-size:12px;line-height:14px;"':"")+">"+(p.shadowFrom?xui(p.shadowFrom).clone(!0).css({left:"auto",top:"auto",position:"relative"}).outerHTML().replace(/\s*id\=[^\s\>]*/g,""):"")+"</td></tr></table>",target=d._setProxy(xui.create(t).css("opacity",.8),pos);break;case"move":d.$proxySize=0,"absolute"!=(target=targetNode).css("position")&&target.css("position","absolute").offset(pos),target.css("cursor",p.dragCursor)}return target},_unpack:function(){var t,d=this,p=d._profile;p.targetReposition&&"move"!=p.dragType&&(t=xui(d._source))&&(t.isEmpty()||("absolute"!=t.css("position")&&t.css("position","absolute").cssPos(t.offset(null,t.get(0).offsetParent)),xui.browser.ie&&t.cssRegion({right:"",bottom:""}),t.offset(p.curPos,p.targetOffsetParent||document.body))),"move"==p.dragType&&d._source.css("cursor",d._cursor)},_unRegister:function(node,key){var eh=this._eh;xui([node]).$removeEvent("beforeMouseover",eh).$removeEvent("beforeMouseout",eh).$removeEvent("beforeMousemove",eh);var o=xui.getNodeData(node.$xid,["_dropKeys"]),c=xui.$cache.droppable;if(o)for(var i in o)c[i]&&xui.arr.removeValue(c[i],node.$xid);xui.setNodeData(node.$xid,["_dropKeys"])},_register:function(node,key){var eh=this._eh;xui(node).beforeMouseover((function(p,e,i){var t=xui.DragDrop;(p=t._profile).dragKey&&xui.getNodeData(i,["_dropKeys",p.dragKey])&&(t.setDropElement(i),t._onDragover=null,xui.use(i).onDragenter(!0),t._dropElement&&xui.resetRun("setDropFace",t.setDropFace,0,[i],t))}),eh).beforeMouseout((function(p,e,i){var t=xui.DragDrop;(p=t._profile).dragKey&&xui.getNodeData(i,["_dropKeys",p.dragKey])&&(xui.use(i).onDragleave(!0),t._dropElement==i&&(t.setDropElement(t._onDragover=null),xui.resetRun("setDropFace",t.setDropFace,0,[null],t)))}),eh).beforeMousemove((function(a,e,i){var t=xui.DragDrop,h=t._onDragover,p=t._profile;1!=h&&t._dropElement==i&&p.dragKey&&xui.getNodeData(i,["_dropKeys",p.dragKey])&&(h?h(e,i):(t._onDragover=1,xui.use(i).onDragover(!0,xui.Event.getEventPara(e))))}),eh);var o=xui.getNodeData(node.$xid,["_dropKeys"]),c=xui.$cache.droppable;if(o)for(var i in o)c[i]&&xui.arr.removeValue(c[i],node.$xid);for(var h={},a=key.split(/[^\w-]+/),l=(i=0,a.length);i<l;i++)h[a[i]]=1,c[a[i]]=c[a[i]]||[],c[a[i]].push(node.$xid);xui.setNodeData(node.$xid,["_dropKeys"],h)}},After:function(){this._reset(),xui.each({startDrag:function(e,profile,dragKey,dragData){return xui.DragDrop.startDrag(e,this.get(0),profile,dragKey||"",dragData||null),this},draggable:function(flag,profile,dragKey,dragData,target){var dd=xui.DragDrop;return(target=target?"function"==typeof target?xui.tryF(this.getTarget,[],this):xui(target):null)&&target.get(0)||(target=this),this.removeClass("xui-ui-selectable").addClass("xui-ui-unselectable"),flag===undefined?flag=!0:"object"==typeof flag&&(profile=flag,flag=!0),flag?this.$addEvent("beforeMousedown",(function(p,e,src){if(xui.getId(xui.Event.getSrc(e))!=src)return!0;target.startDrag(e,profile,dragKey,dragData)}),dd._eh,-1):this.$removeEvent("beforeMousedown",dd._eh),this},droppable:function(flag,key){flag===undefined&&(flag=!0),key=key||"default";var d=xui.DragDrop;return this.each((function(o){flag?d._register(o,key):d._unRegister(o,key)}))}},(function(o,i){xui.Dom.plugIn(i,o)}))}}),xui.Class("xui.Tips",null,{Constructor:function(){return null},Initialize:function(){if(!xui.ini.disableTips){var dd=xui.DragDrop,tips=this;dd&&(dd.$reset=function(){tips._pos={left:dd._profile.x,top:dd._profile.y}}),xui.browser.fakeTouch&&(tips.HTMLTips=!1),tips.HTMLTips?xui.CSS.addStyleSheet(".xui-tips{position:absolute;overflow:visible;visibility:hidden;left:-10000px;border-radius:1px;} .xui-tips-i{overflow:hidden;position:relative;}.xui-tips-i span{display:inline;}.xui-tips-c{padding:.125em .25em .25em .25em;}.xui-tips-c *{line-height:1.22em;}.xui-tips .xui-tips-c{border-radius:1px;}",this.KEY):tips.MOVABLE=!1,xui.doc.afterMousedown((function(){tips._cancel()}),"$Tips",-1).afterMousemove((function(obj,e){if(!dd.isWorking){var p,n,event=xui.Event;(p=xui.resetRun.$cache)&&p.$Tips&&(tips._pos=event.getPos(e)),tips._from?(tips._pos=event.getPos(e),tips._showF(),xui.resetRun("$Tips3")):tips.MOVABLE&&tips._showed&&tips._Node&&(p=event.getPos(e),(n=tips._Node.style).left=Math.min(tips._tpl._ww-tips._tpl._w,Math.max(0,Math.round((parseFloat(n.left)||0)+(p.left-tips._pos.left),10)))+"px",n.top=Math.min(tips._tpl._hh-tips._tpl._h,Math.max(0,Math.round((parseFloat(n.top)||0)+(p.top-tips._pos.top),10)))+"px",tips._pos=p)}}),"$Tips",-1).afterMouseover((function(obj,e){var id,_from,tempid,event=xui.Event,rt=event.$FALSE,node=event.getSrc(e),index=0,rtn=function(rt){return tips._markId&&tips._cancel(),rt};if(!node)return rtn(rt);try{for(;(!node.id||node.id==xui.$localeDomId)&&node.parentNode!==document&&index++<10;)node=node.parentNode;if(!(id="string"==typeof node.id?node.id:null))return node=null,rtn(rt)}catch(e){}if((_from=event._getProfile(id))&&_from.box&&"xui.UIProfile"==_from.KEY){if(_from.properties.disableTips||_from.behavior.disableTips)return node=null,rtn(!1);var nt=_from.behavior.NoTips;if(nt)for(var i=0,l=nt.length;i<l;i++)if(0===id.indexOf(_from.keys[nt[i]]))return rtn(!1);if(nt=_from.behavior.PanelKeys)for(i=0,l=nt.length;i<l;i++)if(0===id.indexOf(_from.keys[nt[i]]))return rtn(!1);if(nt=_from.behavior.HoverEffected,tempid=_from.onShowTips?id:id.replace(tips._reg,(function(a,b){return nt&&b in nt?a:":"})),tips._markId&&tempid==tips._markId)return rt;tips._markId=tempid,tips._pos=event.getPos(e),tips._activeNode=xui(node),tips._activePrf=_from,tips._showed?(tips._from=_from,tips._enode=id,tips._showF()):tips.HTMLTips?xui.resetRun("$Tips",(function(){tips._from=_from,tips._enode=id,xui.resetRun("$Tips3",(function(){tips._from&&tips._showF()}))}),tips.DELAYTIME):(tips._from=_from,tips._enode=id,tips._from&&tips._showF())}else tips._cancel();return node=null,rt}),"$Tips",-1).afterMouseout((function(obj,e){if(tips._markId){var clear,event=xui.Event,index=0,node=e.toElement||e.relatedTarget;if(node)try{for(;(!node.id||node.id==xui.$localeDomId)&&node.parentNode!==document&&index++<10;)node=node.parentNode;"string"==typeof node.id&&node.id||(node=null,clear=1)}catch(e){clear=1}else clear=1;return clear&&tips._cancel(),event.$FALSE}}),"$Tips",-1).afterMouseup((function(obj,e){tips._cancel()}),"$Tips",-1),this._Types={default:new function(){this.show=function(item,pos,key){if(pos){var t,node,_ruler,w,h,s="object"==typeof item?item[key||xui.Tips.TIPSKEY]:item;if("function"==typeof s&&(s=s()),xui.Tips.HTMLTips)if((node=this.node)&&node.get(0)||(node=this.node=xui.create('<div class="xui-node xui-node-div xui-tips  xui-ui-shadow xui-custom"><div class="xui-node xui-wrapper xui-node-div xui-tips-i xui-custom"></div></div>'),_ruler=this._ruler=xui.create('<div class="xui-node xui-wrapper xui-node-div xui-tips  xui-ui-shadow xui-custom"><div class="xui-node xui-node-div xui-tips-i xui-custom"></div></div>'),this.n=node.first(),this._n=_ruler.first(),xui("body").append(_ruler)),_ruler=this._ruler,document.body.lastChild!=node.get(0)&&xui("body").append(node,!1,!0),s+=""){var html=/^\s*\</.test(s);s=xui.adjustRes(s),xui.Tips._curTips=s,item.transTips&&html||(s='<div class="xui-ui-ctrl xui-node xui-node-div  xui-uiborder-flat xui-uicell-alt xui-node-tips xui-tips-c /*xui-cls-wordwrap */xui-custom">'+s+"</div>"),this._n.get(0).innerHTML=s,this._ww=xui.frame.width(),this._hh=xui.frame.height(),w=Math.min(html?this._ww:tips.MAXWIDTH,_ruler.get(0).offsetWidth+2);var style=node.get(0).style,t1=this.n.get(0),styleI=t1.style;style.visibility="hidden",t1.innerHTML=s,xui.browser.ie?(style.width=styleI.width=(this._w=Math.round(w+w%2))+"px",h=t1.offsetHeight,style.height=(this._h=Math.round(h-h%2))+"px"):(styleI.width=(this._w=Math.round(w))+"px",this._h=this.n.height()),node.removeClass("xui-ui-hidden"),!0===pos?style.visibility="visible":node.popToTop(pos instanceof window.Event||pos["xui.UI"]||pos["xui.UIProfile"]||pos["xui.Dom"]||1==pos.nodeType||"string"==typeof pos?pos:{left:pos.left,top:pos.top,region:{left:pos.left,top:pos.top-12,width:24,height:32}},1),style=styleI=t1=null}else node.css("zIndex",0).hide();else s+="",xui.Tips._curTips=xui.adjustRes(s),s=s.replace(/<[^>]*>/g,""),(t=xui.Tips._activePrf)&&(t.box["xui.svg"]?t.boxing().setAttr("KEY",{title:s},!1):xui.Tips._activeNode.attr("title",s))}},this.hide=function(){if(xui.Tips.HTMLTips)this.node.css("zIndex",0).hide();else{var t=xui.Tips._activePrf;t&&(t.box["xui.svg"]?t.boxing().setAttr("KEY",{title:null},!1):xui.Tips._activeNode.attr("title",null))}}}}}},Static:{_reg:/-([\w]+):/,TIPSKEY:"tips",MAXWIDTH:600,HTMLTips:!0,MOVABLE:!0,DELAYTIME:400,AUTOHIDETIME:5e3,_showF:function(){if(!xui.ini.disableTips){var o,t,_from=this._from,node=xui.Dom.byId(this._enode),pos=this._pos,b=!0;this._from=this._enode=null,node&&_from&&pos&&(o=_from.box)&&(!1!=(b=!1!==((t=_from.CF)&&(t=t.showTips)&&t(_from,node,pos)))&&(b=!1!==(_from._showTips&&_from._showTips(_from,node,pos))),!1!==b&&(b=!1!==(o._showTips&&o._showTips(_from,node,pos))),!1!==b&&((t=_from)&&t.tips||t&&(t=t.properties)&&t.tips?(this.show(pos,t),b=!1):(t=_from)&&(t=t.properties)&&t.autoTips&&"caption"in t&&""===t.tips&&(t.caption||t.labelCaption)&&(this.show(pos,{tips:t.caption||t.labelCaption}),b=!1)),!1!==b?this.hide():this.HTMLTips&&!this.MOVABLE&&xui.resetRun("$Tips2",this.hide,this.AUTOHIDETIME,null,this),node=pos=_from=null)}},getTips:function(){return this._curTips},setTips:function(s){this._curTips&&this._tpl&&this._tpl.show(s,!0)},setPos:function(left,top){var n=this;n.HTMLTips&&(n=n._Node)&&(n=n.style)&&((left||0===left)&&(n.left=Math.round(parseFloat(left))+"px"),(top||0===top)&&(n.top=Math.round(parseFloat(top))+"px"))},show:function(pos,item,key){var t;this._pos=pos,this._item!==item&&("string"==typeof item||item&&item[key||xui.Tips.TIPSKEY]?((t=this._tpl=this._Types[item.tipsTemplate]||this._Types.default).show(item,pos,key),this._Node=t.node&&t.node.get(0),this._item=item,this._showed=!0):this._cancel())},hide:function(){this._showed&&(this._tpl&&this._tpl.hide(),this._clear())},_cancel:function(){this._markId&&(this._showed?this.hide():(xui.resetRun("$Tips"),xui.resetRun("$Tips3"),this._clear()))},_clear:function(){this._Node=this._curTips=this._markId=this._activeNode=this._activePrf=this._from=this._tpl=this._item=this._showed=null}}}),xui.Class("xui.History",null,{Static:{activate:function(){if(!this._activited)switch(this._activited=1,this._lastFI=decodeURIComponent(location.hash),this._type){case"event":xui.Event._addEventListener(window,"hashchange",this._checker);break;case"iframe":document.body.appendChild(document.createElement('<iframe id="'+this._fid+'" src="about:blank" style="display: none;"></iframe>'));var doc=document.getElementById(this._fid).contentWindow.document;doc.open("javascript:'<html></html>'"),doc.write('<html><head><script type="text/javascript">parent.xui.History._checker(\''+location.hash+"');<\/script></head><body></body></html>"),doc.close();case"timer":this._itimer&&clearInterval(this._itimer),this._itimer=setInterval(this._checker,200)}},_fid:"xui:history",_type:xui.browser.ie&&xui.browser.ver<8?"iframe":"onhashchange"in window?"event":"timer",_callbackTag:null,_callbackArr:null,_inner_callback:null,_callback:function(fragment,init,newAdd){var arr,f,ns=this;if(xui.arr.each(xui.Module._cache,(function(m){m._evsClsBuildIn&&"onFragmentChanged"in m._evsClsBuildIn?(xui.isFun(f=m._evsClsBuildIn.onFragmentChanged)||xui.isArr(f)&&f[0].type)&&m.fireEvent("onFragmentChanged",[m,fragment,init,newAdd]):m._evsPClsBuildIn&&"onFragmentChanged"in m._evsPClsBuildIn&&(xui.isFun(f=m._evsPClsBuildIn.onFragmentChanged)||xui.isArr(f)&&f[0].type)&&m.fireEvent("onFragmentChanged",[m,fragment,init,newAdd])})),!xui.isFun(ns._callbackTag)||!1!==ns._callbackTag(fragment,init,newAdd)){if((arr=ns._callbackArr)&&xui.isArr(arr))for(var i=0,l=arr.length;i<l;i++)if(xui.isFun(arr[i])&&!1===arr[i](fragment,init,newAdd))return;xui.isFun(ns._inner_callback)&&ns._inner_callback(fragment,init,newAdd)}},setCallback:function(callback){var hash=location.hash;return hash=hash?"#"+encodeURIComponent((""+decodeURIComponent(hash)).replace(/^#!?/,"")):"#",this._inner_callback=callback,this._lastFI=decodeURIComponent(hash),this._callback(decodeURIComponent(this._lastFI.replace(/^#!?/,"")),!0,callback),this},_checker:function(hash){var self=xui.History;switch(self._type){case"iframe":xui.isSet(hash)&&(location.hash=hash);case"event":case"timer":decodeURIComponent(location.hash)!=decodeURIComponent(self._lastFI)&&(self._lastFI=decodeURIComponent(location.hash),self._callback(decodeURIComponent(location.hash.replace(/^#(!)?/,""))))}},getFI:function(){return this._lastFI},setFI:function(fi,triggerCallback,mergeParams,replace){var params,path=xui.getUrlPath(this.getFI());if(this.activate(),fi?(xui.isHash(fi)?params=fi:(fi=("#"!=fi[0]?"#":"")+fi,path=xui.getUrlPath(fi),params=xui.getUrlParams(fi)),mergeParams&&(params=xui.merge(params||{},xui.getUrlParams(),"without")),fi="#"+path+(xui.isEmpty(params)?"":"?"+xui.urlEncode(params))):fi="#",this._lastFI==decodeURIComponent(fi))return!1;switch(this._type){case"iframe":var doc=document.getElementById(this._fid).contentWindow.document;doc.open("javascript:'<html></html>'"),doc.write('<html><head><script type="text/javascript">parent.xui.History._checker(\''+fi+"');<\/script></head><body></body></html>"),doc.close();break;case"event":case"timer":replace?location.replace(location.href.split("#")[0]+(this._lastFI=decodeURIComponent(fi))):location.hash=this._lastFI=decodeURIComponent(fi),!1!==triggerCallback&&this._callback(decodeURIComponent(fi.replace(/^#!?/,"")))}},getParams:function(key){var hash=xui.getUrlParams(this.getFI());return key?hash[key]:hash},setParams:function(key,value,triggerCallback,mergeParams){var params;xui.isHash(key)?params=key:(params={})[key]=xui.isHash(value)||xui.isArr(value)?xui.stringify(value):value,this.setFI(params,triggerCallback,!1!==mergeParams)},getRouter:function(returnArr){var path=xui.getUrlPath(this.getFI());return returnArr?path.replace(/^\//,"").split("/"):path},getRouterArray:function(){return this.getRouter(!0)},setRouter:function(path,force,replace,triggerCallback,mergeParams){path=xui.isArr(path)?path.join("/"):path.replace(/^\//,"").replace(/\/$/,"");var arr=this.getRouterArray();!force&&xui.str.startWith(arr.join("/")+"/",path+"/")||this.setFI("#/"+path,triggerCallback,mergeParams,!!replace)}}}),xui.Class("xui.ModuleFactory",null,{Initialize:function(){var ns=this;xui.getModule=function(cls,onEnd,threadid,cached,properties,events,options){return ns.getModule.apply(ns,arguments)},xui.newModule=function(cls,onEnd,threadid,properties,events,options){return ns.newModule.apply(ns,arguments)},xui.showModule=function(cls,beforeShow,onEnd,threadid,cached,properties,events,parent,subId,left,top,options){return ns.getModule(cls,(function(err,module,threadid){err||!1===xui.tryF(beforeShow,[module,threadid],module)?xui.tryF(onEnd,[err,module,threadid],module):this.show.apply(module,[onEnd,parent,subId,threadid,left,top])}),threadid,cached,properties,events,options)},xui.showAlienModule=function(cls,beforeShow,onEnd,threadid,cached,properties,events,parent,subId,left,top){return xui.showModule.apply(this,[cls,beforeShow,onEnd,threadid,cached,properties,events,parent,subId,left,top,{alien:!0}])},xui.getCom=xui.getModule,xui.newCom=xui.newModule,xui.showCom=xui.showModule,ns.setCom=ns.setModule,ns.getComFromCache=ns.getModuleFromCache,ns.getCom=ns.getModule,ns.newCom=ns.newModule,ns.storeCom=ns.storeModule,ns.prepareComs=ns.prepareModules,xui.ComFactory=ns},Static:{_pro:{},_cache:{},_domId:"xui:ModuleFactory:",getProfile:function(key){return key?this._pro[key]:this._pro},setProfile:function(key,value){return"string"==typeof key?this._pro[key]=value:xui.isHash(key)&&(this._pro=key),this},destroyAll:function(){xui.each(this._cache,(function(o){xui.tryF(o.destroy,[],o)})),this._cache={}},setModule:function(id,obj){return this._cache[id]=obj,obj&&(obj.moduleRefId=id),this},getModuleFromCache:function(id){return this._cache[id]||null},getModule:function(id,onEnd,threadid,cached,properties,events,options){if(!id){var e=new Error("No id");throw xui.tryF(onEnd,[e,null,threadid]),xui.Thread.abort(threadid),e}cached=!1!==cached;var config,cls,c=this._cache,p=this._pro;if(cached&&c[id]&&!c[id].destroyed)return xui.tryF(onEnd,[null,c[id],threadid],c[id]),c[id];(config=p[id])?cls=config.cls||config:(config={cls:id,cached:cached,properties:properties,events:events},cls=id);var task=function(cls,config,threadid){if(!xui.isFun(cls))throw new Error("'"+cls+"' is not a constructor");var o=new cls;config.properties&&xui.merge(o.properties,config.properties,"all"),config.events&&xui.merge(o.events,config.events,"all"),!1!==config.cached&&xui.ModuleFactory.setModule(id,o);var args=[function(err,module,threadid){!function(arr,subcfg,firstlayer){var self1=arguments.callee;xui.arr.each(arr,(function(v,i){if(v.children){var a=[];xui.arr.each(v.children,(function(o){a[a.length]=o[0]})),self1(a,subcfg)}}))}(module.getUIComponents().get(),config.children,1)}];args.push(threadid||null),onEnd&&xui.Thread.insert(threadid,{task:onEnd,args:[null,o,threadid],scope:o}),xui.tryF(o[config.iniMethod||"create"],args,o)};xui.Thread.observableRun((function(threadid){var f=function(threadid){var clsObj=this||xui.SC.get(cls);if(!clsObj||!clsObj.$xui$){var e=new Error("Cant find Class '"+cls+"' in the corresponding file (maybe SyntaxError)");throw xui.tryF(onEnd,[e,null,threadid]),xui.Thread.abort(threadid),e}xui.Thread.insert(threadid,{task:task,args:[clsObj,config,threadid]})},createModule=function(path,clsName){if(config.cls=clsName,!path){var e=new Error("No class name");throw xui.tryF(onEnd,[e,null,threadid]),xui.Thread.abort(threadid),e}f.call(this,threadid)};/\//.test(cls+="")&&!/\.js$/i.test(cls)&&(cls+=".js"),/\.js$/i.test(cls)?xui.fetchClass(cls,createModule,(function(e){xui.tryF(onEnd,[e,null,threadid])}),null,null,threadid,options):xui.SC(cls,createModule,!0,threadid,{retry:0,onFail:function(e){xui.tryF(onEnd,[e,null,threadid])}})}),null,threadid)},newModule:function(cls,onEnd,threadid,properties,events,options){return this.getModule(cls,onEnd,threadid,!1,properties,events,options)},storeModule:function(id){var m,t,c=this._cache,domId=this._domId;(t=c[id])&&((m=xui.Dom.byId(domId))||xui("body").prepend(xui.create('<div id="'+domId+'" style="display:none;"></div>')),m=xui(domId),(t=t.getUIComponents()).isEmpty()||(t.get(0).unlinkParent(),m.append(t)))},prepareModules:function(arr){var self=this,funs=[];return xui.arr.each(arr,(function(i){funs.push((function(){self.getModule(i)}))})),xui.Thread(null,funs,500).start(),this}}}),xui.Class("xui.Debugger",null,{Static:{$time:xui.stamp(),_id1:"xui:dbg::_frm",_id4:"xui:dbg::_head",_id2:"xui:dbg::_con",_id3:"xui:dbg::_inp",err:function(sMsg,sUrl,sLine){return xui.browser.gek&&"Error loading script"==sMsg||xui.Debugger.log(">>"+sMsg+" at File: "+sUrl+" ( line "+sLine+" )."),!0},trace:function(obj){var args=xui.toArr(arguments),fun=args[1]||arguments.callee.caller,arr=args[2]||[];if(fun&&(arr.push('function "'+(fun.$name$||"")+'" in Class "'+(fun.$original$||"")+'"'),fun.caller))try{arguments.callee(null,fun.caller,arr,1)}catch(e){}if(!args[3]){var a=[];if(a.push(" >> Object Info:"),"object"==typeof obj)for(var i in obj)a.push(" -- "+i+" : "+obj[i]);else a.push(obj);a.push(" >> Function Trace: "+arr.join(" <= ")),xui.Debugger.log.apply(xui.Debugger,a)}fun=null},log:function(){var t1,t2,time,self=this,arr=xui.toArr(arguments),str;if(arr.length){t1=document.createElement("div"),t2=document.createElement("div"),t2.className="xui-uibase xui-dbg-con1",time=xui.stamp(),t2.appendChild(document.createTextNode("Time stamp : "+time+"("+(time-self.$time)+")")),self.$time=time,t1.appendChild(t2);for(var i=0,l=arr.length;i<l;i++)str=arr[i],t2=document.createElement("div"),t2.className="xui-uibase xui-dbg-con2",t2.appendChild(document.createTextNode(" "+xui.stringify(xui.isArguments(str)?xui.toArr(str):str))),t1.appendChild(t2);if(!xui.Dom.byId(self._id2)){var ns=xui.create("<div id="+self._id1+' style="left:5px;top:'+(xui.win.scrollTop()+5)+'px;" class="xui-ui-reset xui-node xui-node-div xui-wrapper xui-dbg-frm xui-custom"><div class="xui-node xui-node-div xui-dbg-box xui-custom"><div id='+self._id4+' class="xui-node xui-node-div xui-uibar xui-dbg-header xui-custom">&nbsp;&nbsp;:&nbsp;)&nbsp;&nbsp;CrossUI Monitor window <span class="xui-node xui-node-span xui-dbg-cmds xui-custom"><a class="xui-node xui-node-a xui-custom" href="javascript:;" onclick="xui(\''+self._id2+'\').empty();">Clear</a><a class="xui-node xui-node-a xui-custom" href="javascript:;" onclick="xui(\''+self._id1+"').remove();\">✖</a></span></div><div id="+self._id2+' class="xui-node xui-node-div xui-uibase xui-dbg-content xui-custom"></div><div class="xui-node xui-node-div xui-uibase xui-dbg-tail xui-custom"><table class="xui-node xui-node-table xui-custom"><tr><td style="font-family:serif;">&nbsp;>>>&nbsp;</td><td style="width:100%"><input class="xui-node xui-node-input xui-custom" id='+self._id3+" /></td></tr></table></div></div></div>");xui("body").append(ns),self.$con=xui(self._id2),xui(self._id4).draggable(!0,null,null,null,xui(self._id4).parent(2)),xui.Dom.css3Support("boxShadow")&&ns.css("boxShadow","2px 2px 5px #ababab"),xui.browser.ie6&&(ns.height(ns.offsetHeight()),ns.width(299),xui.asyRun((function(){ns.width(300)})));var bak="",temp;xui(self._id3).onKeydown((function(p,e,s){var k=xui.Event.getKey(e).key;if(s=xui.use(s).get(0),"enter"==k){switch(s.value){case"?":case"help":self.$con.append(xui.create("<div class='xui-node xui-node-div xui-uibase xui-dbg-con3 xui-custom'><p class='xui-node xui-node-p xui-custom'><strong  class='xui-node xui-node-strong xui-custom'>vailable commands:</strong></p><ul  class='xui-node xui-node-ul xui-custom'><li  class='xui-node xui-node-li xui-custom'> -- <strong  class='xui-node xui-node-strong xui-custom'>[clr]</strong> or <strong>[clear]</strong> : clears the message</li><li  class='xui-node xui-node-li xui-custom'> -- <strong  class='xui-node xui-node-strong xui-custom'>[?]</strong> or <strong  class='xui-node xui-node-strong xui-custom'>[help]</strong> : shows this message</li><li  class='xui-node xui-node-li xui-custom'> -- <strong class='xui-node xui-node-strong xui-custom'>any other</strong>: shows its string representation</li></ul></div>"));break;case"clr":case"clear":xui(self._id2).empty();break;default:try{temp=s.value,/^\s*\x7b/.test(temp)&&(temp="("+temp+")"),self.log(eval(temp))}catch(e){return void self.$con.append(xui.create("<div  class='xui-node xui-node-div xui-uibase xui-dbg-con4 xui-custom'>"+String(e)+"</div>"))}}bak=s.value,s.value=""}else if("up"==k||"down"==k){var a=s.value;s.value=bak||"",bak=a}k=s=temp=bak=null}))}self.$con.append(t1).scrollTop(self.$con.scrollHeight()),t1=t2=null}}},Initialize:function(){xui.CSS.addStyleSheet(".xui-dbg-frm{position:absolute;width:25em;z-index:2000;}.xui-dbg-header{cursor:move;height:1.5em;padding-top:.25em;position:relative;border-bottom:solid 1px #CCC;background-color:#FFAB3F;font-weight:bold;}.xui-dbg-cmds{position:absolute;right:.25em;top:.25em;}.xui-dbg-cmds a{margin:.25em;}.xui-dbg-box{position:relative;overflow:hidden;border:solid 1px #AAA;}.xui-dbg-content{position:relative;width:100%;overflow:auto;height:25em;overflow-x:hidden;}.xui-dbg-con1{background-color:#CCC;width:24.5empx;}.xui-dbg-con2{padding-left:.5em;border-bottom:dashed 1px #CCC;width:24.5em;}.xui-dbg-con3{padding-left:.5em;border-bottom:dashed 1px #CCC;background:#EEE;color:#0000ff;width:24.5em;}.xui-dbg-con4{padding-left:.5em;border-bottom:dashed 1px #CCC;background:#EEE;color:#ff0000;width:24.5em;}.xui-dbg-tail{overflow:hidden;position:relative;border-top:solid 1px #CCC;height:1.3333333333333333em;background:#fff;color:#0000ff;}.xui-dbg-tail input{width:100%;border:0;background:transparent;}",this.KEY),xui.echo=function(){if(!xui.debugMode)return!1;xui.Debugger.log.apply(xui.Debugger,xui.toArr(arguments))},xui.message=function(body,head,width,duration){width=width||300,xui.browser.ie&&(width+=width%2);var div,h,me=arguments.callee,stack=me.stack||(me.stack=[]),allmsg=me.allmsg||(me.allmsg=[]),t=xui.win,left=t.scrollLeft()+t.width()/2-width/2,height=t.height(),st=t.scrollTop();for(div=stack.pop();div&&!div.get(0);)div=stack.pop();if(div||(div='<div class="xui-ui-reset xui-node xui-node-div xui-wrapper xui-uibar xui-uiborder-outset xui-custom" style="border:solid 1px #cdcdcd;position:absolute;overflow:visible;top:-50px;"><div class="xui-node xui-node-div xui-custom" style="font-size:1em;overflow:hidden;font-weight:bold;padding:.25em;"></div><div class="xui-node xui-node-div xui-custom" style="padding:.5em;overflow:hidden;"></div></div>',(div=xui.create(div)).addBorder&&div.addBorder(),allmsg.push(div),xui.Dom.css3Support("boxShadow")&&div.css("boxShadow","2px 2px 5px #ababab")),document.body.lastChild!=div.get(0)&&xui("body").append(div,!1,!0),div.topZindex(!0),div.__hide=0,div.removeClass("xui-ui-hidden"),div.css({left:left+"px",width:width+"px",visibility:"visible"}).first().html(head||"").css("display",head?"":"none").next().html(body||""),xui.browser.ie&&xui.browser.ver<=8&&div.ieRemedy(),me.last&&me.last.get(0)&&div!=me.last){var last=me.last,l=last.left();last._thread&&last._thread.id&&last._thread.isAlive()&&last._thread.abort(),last._thread=last.animate({left:[l,l+(last.width+width)/2+20]},(function(){last.left(l)}),(function(){last.left(l+(last.width+width)/2+20)})).start();var lh=last.offsetHeight();xui.filter(allmsg,(function(ind){if(ind.isEmpty())return!1;ind.__hide||ind==div||ind==last||(ind._thread.id&&ind._thread.isAlive()&&ind._thread.abort(),ind.topBy(lh))}))}me.last=div,me.last.width=width,h=div.height(),xui.browser.ie6&&div.cssSize({height:h,width:width+2}),div._thread&&div._thread.id&&div._thread.isAlive()&&div._thread.abort(),div._thread=div.animate({top:[st-h-20,st+20]},(function(){div.top(st-h-20)}),(function(){div.top(st+20)}),300,0,"expoOut").start(),xui.asyRun((function(){div._thread&&div._thread.id&&div._thread.isAlive()&&div._thread.abort(),div._thread=div.animate({top:[div.top(),height+20]},null,(function(){stack.push(div),div.hide(),div.__hide=1}),300,0).start()}),duration||5e3),me=null},xui.isDefined(window.console)&&"function"==typeof window.console.log?xui.log=function(){window.console.log.apply(window.console,xui.toArr(arguments))}:xui.debugMode&&(xui.log=xui.echo,window.onerror=this.err)}}),new function(){xui.builtinFontIcon={"xui-icon-xui":"&#xe6a7;","xui-icon-placeholder":"&#xe668;","xui-icon-empty":"&#xe668;","xui-icon-loading":"&#xe678;","xui-icon-star":"&#xe69c;","xui-icon-smill":"&#xe69a;","xui-icon-trash":"&#xe6a1;","xui-icon-error":"&#xe666;","xui-icon-back":"&#xe64e;","xui-icon-bold":"&#xe650;","xui-icon-bgcolor":"&#xe64f;","xui-icon-breaklink":"&#xe652;","xui-icon-clock":"&#xe657;","xui-icon-circle":"&#xe651;","xui-icon-bigup":"&#xe658;","xui-icon-code":"&#xe659;","xui-icon-dialog":"&#xe65a;","xui-icon-bullet":"&#xe65b;","xui-icon-date":"&#xe65c;","xui-icon-dragadd":"&#xe661;","xui-icon-dragmove":"&#xe662;","xui-icon-dragcopy":"&#xe663;","xui-icon-dropdown":"&#xe664;","xui-icon-dragstop":"&#xe665;","xui-icon-file":"&#xe667;","xui-icon-file-expand":"&#xe669;","xui-icon-file-fold":"&#xe66a;","xui-icon-filter":"&#xe66b;","xui-icon-font":"&#xe66c;","xui-icon-forecolor":"&#xe66e;","xui-icon-formatbrush":"&#xe66f;","xui-icon-formatclear":"&#xe670;","xui-icon-indent":"&#xe671;","xui-icon-html":"&#xe672;","xui-icon-italic":"&#xe673;","xui-icon-link":"&#xe675;","xui-icon-inserthr":"&#xe676;","xui-icon-menu":"&#xe677;","xui-icon-minus":"&#xe679;","xui-icon-menu-checked":"&#xe67a;","xui-icon-mobile":"&#xe67b;","xui-icon-mouse":"&#xe67c;","xui-icon-outdent":"&#xe689;","xui-icon-picture":"&#xe68a;","xui-icon-print":"&#xe68c;","xui-icon-numbers":"&#xe68d;","xui-icon-right":"&#xe68e;","xui-icon-search":"&#xe68f;","xui-icon-question":"&#xe690;","xui-icon-remove":"&#xe693;","xui-icon-sort":"&#xe699;","xui-icon-sort-checked":"&#xe69b;","xui-icon-strikethrough":"&#xe69d;","xui-icon-sub":"&#xe69e;","xui-icon-super":"&#xe69f;","xui-icon-transparent":"&#xe6a0;","xui-icon-triangle-down":"&#xe6a2;","xui-icon-triangle-left":"&#xe6a3;","xui-icon-triangle-right":"&#xe6a4;","xui-icon-triangle-up":"&#xe6a5;","xui-icon-undo":"&#xe6a6;","xui-icon-redo":"&#xe691;","xui-icon-upload":"&#xe6a8;","xui-icon-zoomin":"&#xe6a9;","xui-icon-zoomout":"&#xe6ac;","xui-icon-underline":"&#xe6aa;","xui-load-error":"&#xe6ab;","xui-refresh":"&#xe6ae;","xui-uicmd-arrowdrop":"&#xe6af;","xui-uicmd-check":"&#xe6b0;","xui-uicmd-check-checked":"&#xe6b1;","xui-uicmd-add":"&#xe6ad;","xui-uicmd-close":"&#xe6b2;","xui-uicmd-cmdbox":"&#xe6b3;","xui-uicmd-date":"&#xe6b4;","xui-uicmd-color":"&#xe6b5;","xui-uicmd-delete":"&#xe6b6;","xui-uicmd-dotted":"&#xe6b7;","xui-uicmd-datetime":"&#xe6b8;","xui-uicmd-helpinput":"&#xe6b9;","xui-uicmd-getter":"&#xe6ba;","xui-uicmd-file":"&#xe6bb;","xui-uicmd-info":"&#xe6bc;","xui-uicmd-land":"&#xe6bd;","xui-uicmd-max":"&#xe6be;","xui-uicmd-min":"&#xe6bf;","xui-uicmd-location":"&#xe6c0;","xui-uicmd-opt":"&#xe6c1;","xui-uicmd-pop":"&#xe6c2;","xui-uicmd-pin":"&#xe6c3;","xui-uicmd-radio":"&#xe6c4;","xui-uicmd-radio-checked":"&#xe6c5;","xui-uicmd-popbox":"&#xe6c6;","xui-uicmd-refresh":"&#xe6c7;","xui-uicmd-restore":"&#xe6c8;","xui-uicmd-remove":"&#xe6c9;","xui-uicmd-time":"&#xe6ca;","xui-uicmd-select":"&#xe6cb;","xui-uicmd-save":"&#xe6cc;","xui-uicmd-toggle":"&#xe6cd;","xui-uicmd-toggle-checked":"&#xe6ce;","xui-icon-alignleft":"&#xe6d2;","xui-icon-aligncenter":"&#xe6d0;","xui-icon-alignjustify":"&#xe6d1;","xui-icon-alignright":"&#xe6cf;","xui-icon-singleleft":"&#xe694;","xui-icon-singleright":"&#xe695;","xui-icon-singleup":"&#xe696;","xui-icon-singledown":"&#xe692;","xui-icon-smalldown":"&#xe697;","xui-icon-smallup":"&#xe698;","xui-icon-arrowleft":"&#xe64c;","xui-icon-arrowright":"&#xe64b;","xui-icon-arrowtop":"&#xe64d;","xui-icon-arrowbottom":"&#xe6d3;","xui-icon-circleleft":"&#xe654;","xui-icon-circleright":"&#xe655;","xui-icon-circleup":"&#xe656;","xui-icon-circledown":"&#xe653;","xui-icon-doubleleft":"&#xe65e;","xui-icon-doubleright":"&#xe660;","xui-icon-doubleup":"&#xe65f;","xui-icon-doubledown":"&#xe65d;","xui-icon-first":"&#xe66d;","xui-icon-prev":"&#xe68b;","xui-icon-next":"&#xe67d;","xui-icon-last":"&#xe674;","xui-icon-number":"&#xe67e;","xui-icon-number0":"&#xe680;","xui-icon-number1":"&#xe67f;","xui-icon-number2":"&#xe681;","xui-icon-number3":"&#xe682;","xui-icon-number4":"&#xe683;","xui-icon-number5":"&#xe686;","xui-icon-number6":"&#xe687;","xui-icon-number7":"&#xe684;","xui-icon-number8":"&#xe685;","xui-icon-number9":"&#xe688;"},xui.browser.ie678&&(xui.__iefix2=xui.builtinFontIcon)},xui.Class("xui.UIProfile","xui.Profile",{Instance:{renderId:null,_render:function(){if(!this.$ignoreRender){var t,ns=this,ins=ns.boxing(),map=xui.$cache.profileMap;if(!ns.beforeRender||!1!==ins.beforeRender(ns)){if(!ns.renderId){var ele=xui.Dom.byId(ns.$domId);if(!ele)return;if(ns.domId!=ns.$domId&&(ele.id=ns.domId),map[ns.domId]=map[ns.$domId]=ns,ele.$xid||xui.UI.$addEventsHandler(ns,ele,!0),ns._elset)for(var i=1,l=ns._elset.length;i<l;i++)xui.UI.$addEventsHandler(ns,ns._elset[i].node,!0);xui.browser.ie&&xui.browser.ver<10&&"selectable"in ns.properties&&xui.setNodeData(ele,"_onxuisel",ns.properties.selectable?"true":"false"),ns.rendered=ns.renderId=ele.$xid,ele=null}if(ns.CA&&!xui.isEmpty(ns.CA)&&ins.setCustomAttr(ns.CA),ns.CS&&!xui.isEmpty(ns.CS)&&ins.setCustomStyle(ns.CS),xui.browser.isTouch&&(t=ns.box.$Behaviors.DroppableKeys)&&t.length&&xui.arr.each(t,(function(o){ins.getSubNode(o,!0).each((function(node){var key=ns.box.getDropKeys(ns,node.$xid);if(key)for(var c=xui.$cache.droppable,a=key.split(/[^\w-]+/),i=0,l=a.length;i<l;i++)c[a[i]]=c[a[i]]||[],c[a[i]].push(node.$xid)}))})),xui.browser.fakeTouch||xui.browser.isTouch&&(xui.browser.isAndroid||xui.browser.isBB)){var dir,check={auto:1,scroll:1};xui.each(ns.box.$Appearances,(function(o,i){dir="",check[o.overflow]?dir="xy":(check[o["overflow-x"]]&&(dir+="x"),check[o["overflow-y"]]&&(dir+="y")),dir&&ns.getSubNode(i,!0).$touchscroll(dir)})),"overflow"in ns.properties&&(xui.browser.fakeTouch?xui.asyRun((function(){var dir="",root=ns.getRoot();root&&!root.isEmpty()&&(root.isScrollBarShowed("x")&&(dir+="x"),root.isScrollBarShowed("y")&&(dir+="y"),dir&&root.$touchscroll(dir))})):check[ns.properties.overflow]&&ins.setOverflow(ns.properties.overflow,!0))}if(t=ns.RenderTrigger){for(i=0,l=t.length;i<l;i++)t[i].call(ns);delete ns.RenderTrigger}if(ns.onRender&&ins.onRender(ns),xui.tryF(ns.$onrender,[],ns),!0===arguments[0]&&(t=ns.LayoutTrigger)){for(i=0,l=t.length;i<l;i++)t[i].call(ns);ns.onLayout&&ins.onLayout(ns)}if(!ns.properties.lazyAppend){if(ns.children)for(i=0;v=ns.children[i++];)v[0]._render&&v[0]._render(!0);if(ns.$attached){for(i=0;v=ns.$attached[i++];)v._render&&v._render(!0),(t=v._render_holder||v._inline_holder)&&t.$afterAttached?xui.tryF(t.$afterAttached,[v],t):xui.tryF(ns.$afterAttached,[v],ns);delete ns.$attached}if(ns.exchildren){for(i=0;v=ns.exchildren[i++];)ins.append(v[0],v[1]);delete ns.exchildren}if(ns.exmodules){var v;for(i=0;v=ns.exmodules[i++];)v[0].show(null,ins,v[1],!1);delete ns.exmodules}}ns.renderCompleted=1}}},__gc:function(ignoreEffects,purgeNow){var t,ns=this,args=xui.toArr(arguments);if(!ns.destroyed&&(ns.$beforeDestroy&&(xui.each(ns.$beforeDestroy,(function(f){xui.tryF(f,args,ns)})),xui.breakO(ns.$beforeDestroy,2)),xui.tryF(ns.$ondestory,args,ns),ns.onDestroy&&ns.boxing().onDestroy(),ns.destroyTrigger&&ns.destroyTrigger(),ns.serialId)){var o;if((t=ns._$composed)&&xui.each(t,(function(v){v.__gc(ignoreEffects,purgeNow)})),ns.clearCache(),ns.$noReclaim?delete ns.$noReclaim:((t=xui.$cache.reclaimId)[ns.key]||(t[ns.key]=[])).push(ns.serialId),delete xui.$cache.profileMap[ns.domId],delete xui.$cache.profileMap[ns.$domId],ns.alias&&ns.host&&(o=ns.host[ns.alias])&&(o=o._nodes)&&(0===o.length||1===o.length&&o[0]==ns)&&(ns.host[ns.alias]=null,ns.host===window&&xui.browser.ie&&xui.browser.ver<=8||delete ns.host[ns.alias]),ns.unLinkAll(),ns.LayoutTrigger&&(ns.LayoutTrigger.length=0),ns.RenderTrigger&&(ns.RenderTrigger.length=0),(t=ns.children).length){t=xui.copy(t);for(var i=0;i<t.length;i++)t[i][0].__gc(ignoreEffects,purgeNow),t[i].length=0;t.length=0}ns.destroyed=!0,ns.$afterDestroy&&(xui.each(ns.$afterDestroy,(function(f){xui.tryF(f,args,ns)})),xui.breakO(ns.$afterDestroy,2)),ns.afterDestroy&&ns.boxing().afterDestroy(ns),xui.breakO([ns.properties,ns.events,ns.CF,ns.CB,ns.CC,ns.CA,ns.CS,ns],2),ns.destroyed=!0}},linkParent:function(parentProfile,linkId,index){return this.unlinkParent(),this.destroyed||(this.parent=parentProfile,this.childrenId=linkId,this.link(parentProfile.children,"$parent",[this,linkId],index)),this},unlinkParent:function(){return delete this.parent,delete this.childrenId,this.unLink("$parent"),this},getRootNode:function(){return xui.getNodeData(this.renderId,"element")},getRoot:function(){return this.renderId?this["*"]||(this["*"]=xui([this.renderId],!1)):xui([],!1)},getAllNodes:function(){return this.getRoot().query().merge(this.getRoot())},getContainer:function(subId){return!0!==subId&&(subId="string"==typeof subId?subId:null)&&(subId=this.getSubIdByItemId(subId)),this.box._CONTAINERKEY?this.getSubNodes(this.box._CONTAINERKEY,subId):this.keys.PANEL?this.getSubNodes(this.keys.PANEL,subId):this.getRoot()},getEmSize:function(force){var root=this.getRoot(),node=root.get(0);return!force&&this._nodeEmSize||node&&(this._nodeEmSize=root._getEmSize())||xui.CSS._getDftEmSize()},adjustSize:function(useProp,asy,flag){var prf=this,t=prf.getRootNode();if(t&&(useProp||(t=t.style))){var f=function(){xui.UI.$tryResize(prf,useProp?prf.properties.width:t.width,useProp?prf.properties.height:t.height,!0,flag)};asy&&xui.asyRun(f),f()}},$px:function(value,node,roundPx){var ns=this;return xui.CSS.$px(value,node||function(){return ns.getEmSize()},roundPx)},$em:function(value,node,roundPx){var ns=this;return xui.CSS.$em(value,node||function(){return ns.getEmSize()},roundPx)},$px2em:function(value,node,roundPx){var ns=this;return xui.CSS.$px2em(value,node||function(){return ns.getEmSize()},roundPx)},$em2px:function(value,node,roundPx){var ns=this;return xui.CSS.$em2px(value,node||function(){return ns.getEmSize()},roundPx)},$forceu:function(value,u,node,roundPx){var ns=this;return xui.CSS.$forceu(value,u,node||function(){return ns.getEmSize()},roundPx)},$addpx:function(a,b,node){var ns=this;return xui.CSS.$addpx(a,b,node||function(){return ns.getEmSize()})},$isEm:function(value){return xui.CSS.$isEm(value)},$isPx:function(value){return xui.CSS.$isPx(value)},$picku:function(value){return xui.CSS.$picku(value)},$addu:function(value){return xui.CSS.$addu(value)},_cacheR1:/^\w[\w_-]*$/,setDomId:function(id){var t=this,c=xui.$cache.profileMap;return"string"!=typeof id||!t._cacheR1.test(id)&&id!=t.$domId||xui.Dom.byId(id)||(t.domId!=t.$domId&&delete c[t.domId],t.domId=id,t.renderId&&(t.getRootNode().id=id),c[t.$domId]&&(c[id]=t)),t},getDomId:function(){return this.domId},clearCache:function(eventOnly){var t=this.$_egetter;for(var i in t)t[i].length=0,delete t[i];if(!eventOnly){for(var i in t=this.$_domid)t[i].__gc(!0,!0),delete t[i];delete this["*"]}return this},_getEV:function(funs,id,name){var cache,$k=id+"+"+name,g=this.$_egetter||(this.$_egetter={});if(g[$k])Array.prototype.push.apply(funs,g[$k]);else{var t,key;if(cache=g[$k]=[],(t=xui.$cache.profileMap[id])&&(t=t.events)&&(t=t[name]))for(var i=0,l=t.length;i<l;i++)"function"==typeof t[t[i]]&&cache.push(funs[funs.length]=t[t[i]]);key=id.split(":")[0].split("-")[1],("function"==typeof((t=this._CB)&&(key?t=t[key]:1)&&(t=t[name]))||"function"==typeof((t=this.CB)&&(key?t=t[key]:1)&&(t=t[name]))||"function"==typeof((t=this.behavior)&&(key?t=t[key]:1)&&(t=t[name])))&&cache.push(funs[funs.length]=t)}},_cacheR2:/<!--\x03([^>^\s]*)\x04-->/g,toHtml:function(force){var str,id,i,l,o,m,a,data,prop=this.properties,c=this.box,h={};if(this.destroyed)return"";if(c["xui.svg"])return c._RenderSVG(this),"";if(data=c._prepareData(this),c._dynamicTemplate&&c._dynamicTemplate(this),str=c._build(this,data),(!prop.lazyAppend||force)&&(m=this.children))for(i=0,l=m.length;i<l;i++)if((o=m[i])&&o[0]){if(o[0]["xui.Module"]){var mh=new xui.UI.MoudluePlaceHolder({host:o[0].host,alias:o[0].alias});mh.get(0)._module=o[0],o[0]=mh.get(0)}o[0]["xui.UIProfile"]&&(id=o[1]||"",(a=h[id]||(h[id]=[]))[a.length]=o[0].toHtml(force))}return str.replace(this._cacheR2,(function(a,b){return h[b]?h[b].join(""):""}))},_buildItems:function(key,items,addEventHandler){var ns=this,box=ns.box,str=box._rpt(ns,xui.UI.$doTemplate(ns,xui.get(xui.$cache.template,[box.KEY,ns._hash]),items,key)),nodes=xui.UI.$toDom(ns,str.replace(ns._cacheR2,""),addEventHandler);return ns.CA&&!xui.isEmpty(ns.CA)&&ns.boxing().setCustomAttr(ns.CA,undefined,nodes),ns.CS&&!xui.isEmpty(ns.CS)&&ns.boxing().setCustomStyle(ns.CS,undefined,nodes),nodes},serialize:function(rtnString,keepHost,children){var t,m,moduleHash={},o=(t=this.box._beforeSerialized)?t(this):this,r={alias:o.alias,key:o.key,host:o.host},zz=o.moduleClass+"["+o.moduleXid+"]";r.host===this?delete r.host:o.host&&!keepHost&&(!1!==rtnString?r.host="@this":delete r.host),"string"==typeof o.theme&&(r.theme=o.theme),o.$domId!=o.domId&&(r.domId=o.domId);var c={},p=o.box.$DataStruct,df1=xui.UI[o.$inDesign?"__resetDftProp_in_Desinger":"__resetDftProp"],df2=o.box[o.$inDesign?"__resetDftProp_in_Desinger":"__resetDftProp"],map=xui.absObj.$specialChars;xui.merge(c,o.properties,(function(o,i){return(df2&&i in df2?df2:df1&&i in df1?df1:p)[i]!==o&&!map[i.charAt(0)]})),xui.isEmpty(c)||(r.properties=c),xui.isEmpty(t=this.getEvents())||(r.events=t);var eh=o.box.$EventHandlers;return xui.filter(r.events,(function(o,i){return o!=eh[i]})),xui.isEmpty(r.events)&&delete r.events,xui.isEmpty(o.CB)||(r.CB=xui.copy(o.CB)),xui.isEmpty(o.CC)||(r.CC=xui.copy(o.CC)),xui.isEmpty(o.CF)||(r.CF=xui.copy(o.CF)),xui.isEmpty(o.CS)||(r.CS=xui.clone(o.CS,(function(o,i){return!("$"==(i+"").charAt(0)&&!o)}))),xui.isEmpty(o.CA)||(r.CA=xui.copy(o.CA)),"string"==typeof o.theme&&(r.theme=o.theme),!1!==children&&o.children&&o.children.length&&("xui.UI.SVGPaper"!=o.box.KEY&&xui.arr.stableSort(o.children,(function(x,y){return(x=x[0].properties.tabindex||0)>(y=y[0].properties.tabindex||0)?1:x==y?0:-1})),t=r.children=[],xui.arr.each(o.children,(function(v,w,y,z){if((w=v[0]).moduleClass&&w.moduleXid&&(y=xui.SC.get(w.moduleClass))&&(y=y.getInstance(w.moduleXid))&&y["xui.Module"]&&(z=w.moduleClass+"["+w.moduleXid+"]")!==zz){if(moduleHash[z])return;moduleHash[z]=1,w=y}m=[w.serialize(!1,keepHost)],v[1]&&(m[1]=v[1]),t[t.length]=m}))),!1!==children&&o.exchildren&&o.exchildren.length&&(r.exchildren=o.exchildren),moduleHash=null,!1===rtnString?r:xui.serialize(r)},_applySetAction:function(fun,value,ovalue,force,tag,tag2){if(this.renderId)return fun.call(this,value,ovalue,force,tag,tag2)},getKey:function(id,tagOnly){var t;return"!"==id.charAt(0)&&(id=xui.use(id).id()),-1==id.indexOf(":")&&(id=(t=xui.$cache.profileMap[id])&&t.$domId),id&&(id=id.split(":")[0],tagOnly&&(id=id.split("-")[1]||"KEY")),id||""},getSubId:function(id){var t;return"!"==id.charAt(0)&&(id=xui.use(id).id()),id&&-1==id.indexOf(":")&&(id=(t=xui.$cache.profileMap[id])&&t.$domId),id?id.split(":")[2]:""},pickSubId:function(key){var o=this.cache_subid||(this.cache_subid={});return(o[key]||(o[key]=[]))[0]?o[key].shift():((o=this.subId||(this.subId={}))[key]||(o[key]=new xui.id)).next()},reclaimSubId:function(id,key){var o=this.cache_subid||(this.cache_subid={});(o[key]||(o[key]=[])).push(id)},_cacheR3:/\./g,_cacheH1:{},getClass:function(key,tag){var hash=(key=this.keys[key]||key)+":"+(tag||"");return this._cacheH1[hash]||(this._cacheH1[hash]=key.replace(this._cacheR3,"-").toLowerCase().replace("xui-ui","xui")+(tag||""))},_getSubNodeId:function(key,subId,tag){var t,arr=this.$domId.split(":");return arr[0]=key,arr[2]=xui.isSet(subId)?subId+"":"",tag&&(arr[2]+="_"+tag),(key=arr.join(":"))==this.$domId?(t=xui.$cache.profileMap[key])&&t.domId:key},getSubNode:function(key,subId,tag){var ns=this;if(!ns.renderId)return xui();key=ns.keys[key]||key;var r,h=ns.$_domid||(ns.$_domid={});if(!0===subId)key==ns.keys.KEY&&(r=xui([ns.renderId])),r&&r.get(0)||(r=xui([ns.renderId]).query("*","id",new RegExp("^"+key+":"+ns.serialId+(tag?"_"+tag:""))));else{if(!xui.isSet(subId)&&h[key]&&1==h[key]._nodes.length)return h[key];1!=(r=xui(ns._getSubNodeId(key,subId,tag)))._nodes.length||xui.isSet(subId)||(h[key]=r)}return r},getSubNodes:function(arr,subId,tag){var o,v,ns=this,a=[],s1=!xui.isArr(arr),s2=!xui.isArr(subId),push=Array.prototype.push;if(!0===subId||xui.isNull(subId)){if(!s1){a=[];for(var i=0;o=arr[i++];)a.push(ns.keys[o]||o);arr="("+a.join("|")+")"}push.apply(a,ns.getSubNode(arr,!0,tag).get())}else if(s1)if(s2)push.apply(a,ns.getSubNode(arr,subId,tag).get());else for(var j=0;v=subId[j++];)push.apply(a,ns.getSubNode(arr,v,tag).get());else for(i=0;o=arr[i++];)if(s2)push.apply(a,ns.getSubNode(o,subId,tag).get());else for(j=0;v=subId[j++];)push.apply(a,ns.getSubNode(o,v,tag).get());return xui(a)},getSubNodeByItemId:function(key,itemId,tag){return(itemId=this.getSubIdByItemId(itemId))?this.getSubNode(key,itemId,tag):xui()},getItemByItemId:function(itemId){var t;return xui.isNumb(itemId)&&(itemId=xui.get(this.properties.items,[itemId,"id"])),(t=this.ItemIdMapSubSerialId)&&(t=t[itemId])?this.SubSerialIdMapItem[t]:(t=this.queryItems(this.properties.items,(function(v,k){return v.id===itemId}),1,1))&&t[0]},getSubIdByItemId:function(itemId){var t;return xui.isNumb(itemId)&&(itemId=xui.get(this.properties.items,[itemId,"id"])),(t=this.ItemIdMapSubSerialId)&&xui.isSet(itemId)?t[itemId]:null},getItemByDom:function(src){return this.SubSerialIdMapItem&&this.SubSerialIdMapItem[this.getSubId("string"==typeof src?"!"==src.charAt(0)?(src=xui.use(src).get(0))&&src.id:src:src.id)]},getItemIdByDom:function(src){var t;return(t=this.getItemByDom(src))&&t.id},queryItems:function(items,fun,deep,single,flag){var r=[],me=arguments.callee,f=me.f||(me.f=function(items,fun,deep,single,flag,r){xui.arr.each(items,(function(o,i){if((!0===fun||fun.call(null,o,i,items))&&(r.push(flag?[o,i,items]:o),single))return!1;deep&&o.sub&&o.sub.length&&f(o.sub,fun,deep,single,flag,r)}))});return f(items,fun,deep,single,flag,r),r}},Static:{getFromDom:function(id){if((id=id&&"xui.Dom"==id.KEY?id.get(0).id:"string"==typeof id?"!"==id.charAt(0)?(id=xui.use(id).get(0))&&id.id:id:id&&id.id)&&(id=xui.Event._getProfile(id))&&id["xui.UIProfile"])return id}}}),xui.Class("xui.UI","xui.absObj",{Before:function(key,parent_key,o){return xui.absBox.$type[key.replace("xui.UI.","").replace("xui.","")]=xui.absBox.$type[key]=key,!0},After:function(){var t,k,u,i,e,v,b,self=this;if(xui.absObj.After.apply(this,arguments),self.Behaviors&&self.Behaviors.PanelKeys&&self.$DataModel&&self.$DataModel.dataField&&(delete self.$DataModel.dataField,delete self.$DataStruct.dataField,delete self.prototype.setDataField,delete self.prototype.getDataField),self._ctrlId=new xui.id,self._idCache=[],self.$cssKeys={},(t=self.$Keys).KEY=t.$key=self.KEY,self.addTemplateKeys(xui.toArr(t,!0)),v="$Behaviors",k={},(t=self.$parent)&&(e=t.length))for(;e--;)for(i in b=t[e][v])"object"==typeof b[i]?xui.isArr(b[i])?(u=k[i]||(k[i]=[])).push.apply(u,b[i]):(u=k[i]||(k[i]={}),xui.merge(u,b[i])):k[i]=b[i];if(self[v]=k,v="$Templates",k={},(t=self.$parent)&&(e=t[0]))for(i in e[v])"$"!=i.charAt(0)&&(k[i]=e[v][i]);if(self[v]=xui.clone(k),v="$Appearances",k={},(t=self.$parent)&&(e=t.length))for(;e--;)for(i in(b=t[e])[v])t=b[v][i],u=k[i]||(k[i]={}),xui.merge(u,t);self[v]=k,self.setTemplate(self.Templates),delete self.Templates,self.setBehavior(self.Behaviors||{}),delete self.Behaviors,self.setAppearance(self.Appearances),delete self.Appearances,(t=self.PublicAppearance)&&(xui.UI.$cache_css_before+=self.buildCSSText(t),delete self.PublicAppearance)},Instance:{animate:function(key,callback){var t,prf=this.get(0),node=prf.getRootNode(),tid=xui.getNodeData(node,"_inthread"),reset=xui.getNodeData(node,"_animationreset");if(tid&&xui.Thread.isAlive(tid)&&(xui.Thread.abort(tid,"force"),xui.setNodeData(node,"_inthread",null)),"function"==typeof reset&&(reset(),xui.setNodeData(node,"_animationreset",null)),key&&(t=xui.AnimBinder.getFromName(!0===key?"blinkAlert":key)))return t.apply(node,callback);key||(key="blinkAlert");var onEnd,item=xui.isHash(key)&&key.endpoints?key:xui.Dom.$preDefinedAnims[key];return item&&item.endpoints?(xui.isFun(callback)?onEnd=xui.isFun(item.onEnd)?function(){item.onEnd.apply(this,arguments),callback.apply(this,arguments)}:callback:xui.isFun(item.onEnd)&&(onEnd=item.onEnd),prf.getRoot().animate(item.endpoints,item.onStart,onEnd,item.duration||200,null,item.type||"linear",null,item.unit,item.restore,item.times).start()):void 0},hoverPop:function(node,type,beforePop,beforeHide,parent,groupid){var popmenu,prf=this.get(0),source=prf.boxing();if(!prf.box.$EventHandlers.beforeHoverEffect)return source.getRoot().hoverPop(node,type,beforePop,beforeHide,parent,groupid),this;node=xui(node),popmenu=(popmenu=xui.UIProfile.getFromDom(node.id()))&&"xui.UI.PopMenu"===popmenu.key?popmenu.boxing():null,xui.isDefined(type)||(type="outer");var aysid=groupid||source.getRoot().xid()+":"+node.xid();return source.each((function(o){o.$onHover=null===type?null:function(prf,item,e,src,mtype){e.$force||("mouseover"==mtype?(xui.resetRun(aysid,null),xui.getData([aysid,"$ui.hover.pop"])&&xui.getNodeData(node.get(0)||"empty","$ui.hover.parent")==src||(xui.setData([aysid,"$ui.hover.pop"],{item:item}),xui.setNodeData(node.get(0)||"empty","$ui.hover.parent",src),beforePop&&!1===beforePop(prf,node,e,src,item)||(popmenu?popmenu.popUp(src,type,parent):node.popToTop(src,type,parent),node.onMouseover((function(){xui(src).onMouseover(!0)}),"hoverPop"),node.onMouseout((function(){xui(src).onMouseout(!0)}),"hoverPop")))):xui.resetRun(aysid,(function(){xui.setData([aysid,"$ui.hover.pop"]),xui.setNodeData(node.get(0)||"empty","$ui.hover.parent",0),beforeHide&&!1===beforeHide(prf,node,e,src,item)||(popmenu?popmenu.hide():node.hide(),node.onMouseover(null,"hoverPop").onMouseout(null,"hoverPop"))})))}})),node&&(node.onMouseover(null===type?null:function(e){e.$force||xui.getData([aysid,"$ui.hover.pop"])&&xui.resetRun(aysid,null)},"hoverPop"),node.onMouseout(null===type?null:function(prf,e,src){e.$force||xui.getData([aysid,"$ui.hover.pop"])&&xui.resetRun(aysid,(function(){xui.setData([aysid,"$ui.hover.pop"]),xui.setNodeData(node.get(0)||"empty","$ui.hover.parent",0);var item=xui.getData([aysid,"$ui.hover.pop"]);beforeHide&&!1===beforeHide(prf,node,e,src,"pop",item&&item.item)||(popmenu?popmenu.hide():node.hide(),node.onMouseover(null,"hoverPop").onMouseout(null,"hoverPop"))}))},"hoverPop"),node.css("display","none")),this},setTheme:function(key){"string"==typeof key&&key||(key=null);var arr=[];return this.each((function(o){key!=o.theme&&(null===key?delete o.theme:o.theme=key,arr.push(o))})),xui.UI.pack(arr,!1).refresh(),this},getTheme:function(){return this.get(0)&&this.get(0).theme},getModule:function(top){var prf=this.get(0);if(prf)return prf.getModule(top)},destroy:function(ignoreEffects,purgeNow){var ns=this;this.each((function(o,i){if(!o.destroyed){var fun=function(){o.beforeDestroy&&!1===o.boxing().beforeDestroy(ignoreEffects,purgeNow)||(o.$beforeDestroy&&(xui.each(o.$beforeDestroy,(function(f){xui.tryF(f,[ignoreEffects,purgeNow],o)})),xui.breakO(o.$beforeDestroy,2)),o.renderId?o.getRoot().remove(!0,purgeNow):o.__gc(ignoreEffects,purgeNow),xui.arr.removeFrom(ns._nodes,i),o.$afterDestroy&&(xui.each(o.$afterDestroy,(function(f){xui.tryF(f,[ignoreEffects,purgeNow],o)})),xui.breakO(o.$afterDestroy,2)))},p=o.properties;!ignoreEffects&&xui.Dom._getEffects(p.hideEffects,0)?xui.Dom._vAnimate(o.getRoot(),!1,fun):fun()}}),null,!0)},isDestroyed:function(){return!(this.get(0)&&!this.get(0).destroyed)},_toDomElems:function(){var arr=[];return xui.arr.each(this._nodes,(function(o){o.renderId||arr.push(o)})),arr.length&&xui.UI.pack(arr,!1).render(),arr.length=0,xui.arr.each(this._nodes,(function(o){arr.push(o.renderId)})),arr},_ini:function(properties,events,host,theme,CS,CC,CB,CF,CA){var profile,options,alias,temp,c=this.constructor,df3=c.$adjustProp,ds=c.$DataStruct;properties&&properties["xui.Profile"]?(alias=(profile=properties).alias||c.pickAlias(),xui.UIProfile.apply(profile,[host,this.$key,alias,c,null,events])):(properties&&properties.key&&xui.absBox.$type[properties.key]?(options=properties,properties=null,alias=options.alias||c.pickAlias()):alias=c.pickAlias(),profile=new xui.UIProfile(host,this.$key,alias,c,properties,events,options));var v,df1=xui.UI[profile.$inDesign?"__resetDftProp_in_Desinger":"__resetDftProp"],df2=c[profile.$inDesign?"__resetDftProp_in_Desinger":"__resetDftProp"];for(var i in ds)i in profile.properties||(temp=df2&&i in df2?df2[i]:df1&&i in df1?df1[i]:ds[i],profile.properties[i]=profile._dftProps[i]="object"==typeof temp?xui.clone(temp,!0):temp);if("function"==typeof df3&&df3(profile),profile.keys=c.$Keys,profile.CS=CS?xui.copy(CS):profile.CS||{},profile.CB=CB?xui.copy(CB):profile.CB||{},profile.CC=CC?xui.copy(CC):profile.CC||{},profile.CF=CF?xui.copy(CF):profile.CF||{},profile.CA=CA?xui.copy(CA):profile.CA||{},"string"==typeof theme&&(profile.theme=theme),profile.template=c.getTemplate(),profile.behavior=c.$Behaviors,profile.serialId||(profile.serialId=c._pickSerialId()),profile.$domId=profile.key+":"+profile.serialId+":",profile.domId=profile.domId||profile.$domId,profile.RenderTrigger=xui.copy(c.$RenderTrigger),profile.LayoutTrigger=xui.copy(c.$LayoutTrigger),profile.link(xui.UI._cache,"UI").link(c._cache,"self").link(xui._pool,"xui"),temp=profile.children,profile.children=[],temp&&temp.length)for(i=0;v=temp[i++];)v[0]["xui.UIProfile"]||(v[0]=xui.create(v[0]).get(0)),v[0]["xui.UIProfile"]?v[0].linkParent(profile,v[1]):v[0]["xui.Module"]&&v[0].getUIComponents().each((function(p){p.linkParent(profile,v[1])}));return this._nodes.push(profile),profile.Instace=this,this.n0=profile,c.$onInited&&xui.tryF(c.$onInited,[],profile),this},busy:function(coverAll,html,key,subId,bgStyle){return html="string"==typeof html?html:"Loading...",!0===coverAll&&xui.Dom.busy(),this.each((function(profile){xui.resetRun(profile.$xid+":busy",(function(profile,key,subId){if(profile.box){var node,keys=profile.keys;key=keys[key]||keys.BORDER||keys.PANEL||keys.KEY;var parentNode=profile.getSubNode(key,subId);if(!parentNode.isEmpty()){if(profile.$busy&&!profile.$busy.isEmpty()||(node=profile.$busy=xui.create('<button class="xui-node xui-node-div xuicon xui-icon-loading xui-cover xui-custom" style="position:absolute;text-align:center;left:0;top:0;z-index:10;border:0;padding:0;margin:0;width:100%;height:100%;"><div class="xui-node xui-node-div xui-coverlabel xui-custom"></div></button>')),(node=profile.$busy).first().html(html,!1),parentNode.append(node),node.removeClass(/^xui-rand-css-/),node.query("style").remove(!1),bgStyle){var clsName="xui-rand-css-"+xui.rand();node.addClass(clsName),xui.CSS._appendSS(node.get(0),"."+clsName+":before{"+bgStyle+"}",clsName,!0)}var pn=parentNode.get(0);node._parentOST=pn.scrollTop||0,node._parentOSL=pn.scrollLeft||0,node._parentOverflow=pn.style.overflow||"",node._busyP=parentNode.xid(),pn.scrollTop=pn.scrollLeft=0,pn.style.overflow="hidden"}}}),50,[profile,key,subId])}))},free:function(){return xui.Dom.free(),this.each((function(profile){var node;if(xui.resetRun(profile.$xid+":busy"),node=profile.$busy){var pn=xui(node._busyP).get(0);pn&&(pn.scrollTop=node._parentOST||0,pn.scrollLeft=node._parentOSL||0,pn.style.overflow=node._parentOverflow||""),node._parentOST=node._parentOSL=node._parentOverflow=node._busyP=null,node.remove(),delete profile.$busy}}))},adjustSize:function(useProp,asy,flag){return this.each((function(prf){prf.adjustSize(useProp,asy,flag)}))},reLayout:function(force){return this.each((function(o){if(o.renderId){delete o._nodeEmSize;var t,p=o.properties;if(!o.$noB&&p.border&&o.boxing()._border&&o.boxing()._border(null,!1),o.$forceRelayout=1,"absolute"==p.position&&p.dock&&"none"!=p.dock?o.boxing().adjustDock(force):(force&&(o._resize_h=o._resize_w=-1),xui.UI.$tryResize(o,p.width,p.height,force)),delete o.$forceRelayout,t=o.LayoutTrigger){for(var i=0,l=t.length;i<l;i++)t[i].call(o);o.onLayout&&o.boxing().onLayout(o)}}}))},toHtml:function(force){var a=[];return xui.arr.each(this._nodes,(function(o){a[a.length]=o.toHtml(force)})),a.join("")},render:function(triggerLayOut){var i,l,o,arr=[],n=this._nodes,a=[];for(xui.Dom.byId,xui.UI.$trytoApplyCSS(),i=0;o=n[i++];)o.renderId||xui.Dom.byId(o.domId)||xui.Dom.byId(o.$domId)||(arr[arr.length]=o);if(l=arr.length){for(i=0;i<l;i++)(o=arr[i].toHtml())&&(a[a.length]=o);a.length&&xui.UI.$toDom(this.get(0),a.join(""))}for(i=0;o=n[i++];)o._render(triggerLayOut);return a.length=arr.length=0,this},renderOnto:function(node,host,alias){if((node=xui(node)).isEmpty())return this;var self=this,prf=self.get(0),me=arguments.callee,paras=me.paras||(me.paras=function(node){var r=node.cssRegion();return r.tabindex=node.attr("tabIndex"),r.tabindex<=0&&delete r.tabindex,r.zIndex=node.css("zIndex"),r.position=node.css("position"),r}),CS=node.attr("style").replace(/\s*(left|top|width|height|right|bottom|position|z-index)\s*\:\s*[\w-.]+\s*/g,""),CC=node.attr("class"),id=node.id();return xui.merge(prf.properties,paras(node),"all"),prf.properties.dock="none",CS&&self.setCustomStyle("KEY",CS),CC&&self.setCustomClass("KEY",CC),id&&self.setDomId(id),(alias||id)&&self.setHost(host||window,alias||id),self.render(!0),node.replace(self.getRoot()),self},setDomId:function(id){return this.get(0).setDomId(id),this},hide:function(ignoreEffects){return this.each((function(o){if(o.renderId){var t=o.properties,a=ignoreEffects?null:xui.Dom._getEffects(t.hideEffects,0);o.getRoot().hide((function(){t.top=t.left=Math.round(parseFloat(xui.Dom.HIDE_VALUE)||0)+"px",o._dockIgnore=!0}),a)}}))},popUp:function(pos,type,parent,trigger,group){var prf=this.get(0),t=prf.getRoot();(t=t.get(0))&&(prf._dockIgnore=!1,xui(t).popUp(pos,type,parent,trigger,group))},show:function(parent,subId,left,top,ignoreEffects,callback){return this.each((function(o){var b,t=o.properties,ins=o.boxing(),root=o.getRoot();top=top||0===top?top||0:null,null!==(left=left||0===left?left||0:null)&&(t.left=left),null!==top&&(t.top=top),xui.getNodeData(o.renderId,"_xuihide")?(b=1,o._dockIgnore=!1,root.show(left&&o.$forceu(left),top&&o.$forceu(top),null,ignoreEffects),"absolute"==t.position&&t.dock&&"none"!=t.dock&&xui.UI.$dock(o,!1,!0)):(parent=parent||o.parent)||o.renderId&&0!==(o.getRootNode().id||"").indexOf(xui.Dom._emptyDivId)||(parent=xui("body"));var n,p=parent;p&&(p["xui.UIProfile"]?(n=p.renderId,p=p.boxing()):n=p["xui.UI"]?(n=p.get(0))&&n.renderId:(p=xui(p))&&p._nodes[0],n&&(p.append(ins,subId),b?xui.tryF(callback):root.show(left&&o.$forceu(left),top&&o.$forceu(top),callback)))}))},clone:function(){return arguments.callee.upper.apply(this,["domId"])},refresh:function(remedy){var paras,node,b,p,s,$xid,$inDesign,locked,serialId,renderConf,renderHolder,inlineConf,inlineHolder,mcls,mxid,ar,fun,box,children,uiv,save,special,ns=this;return ns.each((function(o,i){if(o.renderId){box=o.box;var host=o.host,alias=o.alias;o.host&&o.host["xui.Module"]&&(o.host.$ignoreAutoDestroy=!0),$xid=o.$xid,$inDesign=o.$inDesign,locked=o.locked,serialId=o.serialId,mcls=o.moduleClass,mxid=o.moduleXid,renderConf=o._render_conf,renderHolder=o._render_holder,inlineConf=o._inline_conf,inlineHolder=o._inline_holder,ar=o.$afterRefresh,(special=o.$handleCustomVars)&&(save=special()),"function"==typeof o.boxing().getUIValue&&(uiv=o.boxing().getUIValue(),o.boxing().getValue()+" "==uiv+" "&&(uiv=null)),(b=!!o.parent)?(p=o.parent.boxing(),paras=o.childrenId):p=o.getRoot().parent(),node=remedy?xui.Dom.getEmptyDiv(o.$inDesign).get(0):xui.$getGhostDiv(),o.boxing().getChildren().reBoxing().each((function(v){node.appendChild(v)})),node=null,children=xui.copy(o.children),o.boxing().removeChildren(),s=o.serialize(!1,!0),fun=o.$refreshTrigger;var replace=xui.create("span");o.getRoot().replace(replace),o.$noReclaim=1;var _c=o.Instace;o.boxing().destroy(!0,!0),xui.merge(o,s,"all"),delete o.destroyed,o.$xid=$xid,o.$inDesign=$inDesign,o.locked=locked,o.$handleCustomVars=special,o.serialId=serialId,o.moduleClass=mcls,o.moduleXid=mxid,renderConf&&(o._render_conf=renderConf),renderHolder&&(o._render_holder=renderHolder),inlineConf&&(o._inline_conf=inlineConf),inlineHolder&&(o._inline_holder=inlineHolder),children&&(o.children=children);var n=new box(o).render();_c&&(xui.merge(_c,n,"all"),n.get(0).Instace=_c,n=_c),ns[i]=n.get(0),fun&&fun.call(fun.target,n.get(0)),b?p.append(n,paras):p.append(n),host&&n.setHost(host,alias),xui.arr.each(children,(function(v){delete v[0].$dockParent,n.append.apply(n,v)})),replace.replace(n.get(0).getRoot()),replace.remove(),replace=null,uiv&&n.setUIValue(uiv,!0,null,"refresh"),ar&&(n.get(0).$afterRefresh=ar,ar(n.get(0))),special&&save&&o.$handleCustomVars(save),n.host&&n.host["xui.Module"]&&delete n.host.$ignoreAutoDestroy}}))},append:function(target,subId,pre,base){var index,baseN,prf=this.get(0),prop=prf.properties,inParent=arguments[4],parentNode=arguments[5];if(pre=!!pre,base?(base["xui.UI"]&&(base=base.get(0)),xui.arr.each(prf.children,(function(o,i){if(o[0]===base)return index=i,!1})),xui.isNumb(index)&&(index=pre?index:index+1,(baseN=base.getRoot()).isEmpty()&&(baseN=null))):index=pre?0:-1,(xui.isHash(target)||xui.isStr(target))&&(target=xui.create(target)),target["xui.UIProfile"]&&(target=target.boxing()),prf.box._IllegalDetect&&prf.box._IllegalDetect(prf,target,!0),!(prf.box.$beforeAppend&&!1===prf.box.$beforeAppend(prf,target,subId,pre,base)||prf.beforeAppend&&!1===this.beforeAppend(prf,target,subId,pre,base))){if(target["xui.Module"]){if(!1!==subId){var i=index;target.getUIComponents().each((function(profile){profile.linkParent(prf,subId,base?i++:i)}))}prf.$ignoreRender||(prf.renderId?!(parentNode=inParent?parentNode:prf.getContainer(subId))||parentNode.isEmpty()||prop.lazyAppend&&"none"==parentNode.css("display")||(base?baseN&&baseN[pre?"addPrev":"addNext"](target):parentNode[pre?"prepend":"append"](target)):xui.arr.insertAny(prf.exmodules||(prf.exmodules=[]),[target,subId],index,!0))}else{var oldp;!1!==subId&&target["xui.UI"]&&(i=index,target.each((function(profile){profile.linkParent&&profile.linkParent(prf,subId,base?i++:i)}))),prf.$ignoreRender||(prf.renderId?!(parentNode=inParent?parentNode:prf.getContainer(subId))||parentNode.isEmpty()||prop.lazyAppend&&"none"==parentNode.css("display")||(!prf.parent||"none"==xui.get(prf,["properties","dock"])||"absolute"!=xui.get(prf,["properties","position"])||xui.get(prf,["properties","dockIgnore"])||prf._dockIgnore||xui.get(prf,["properties","dockFloat"])||target["xui.absBox"]&&(oldp=target.reBoxing().parent()),base?baseN&&baseN[pre?"addPrev":"addNext"](target):parentNode[pre?"prepend":"append"](target),oldp&&oldp.get(0)&&oldp.onSize()):target["xui.UI"]||xui.arr.insertAny(prf.exchildren||(prf.exchildren=[]),[target,subId],index,!0))}return prf.box.$afterAppend&&prf.box.$afterAppend(prf,target,subId,pre,base),prf.afterAppend&&this.afterAppend(prf,target,subId,pre,base),this}},getParent:function(){var prf=this.get(0);if(prf)return prf.parent&&prf.parent.boxing()},getChildrenId:function(){var prf=this.get(0);if(prf)return prf.childrenId},getChildren:function(subId,type){if(!1===type||"include"==type){var z,prf=this.get(0),moduleHash={},a=[],moduleClass=prf.moduleClass,moduleXid=prf.moduleXid,getModlue=function(p){if(p.moduleClass&&p.moduleXid&&p.moduleClass!==moduleClass&&p.moduleXid!==moduleXid){if(moduleHash[z=p.moduleClass+"'"+p.moduleXid+"]"])return null;moduleHash[z]=1;var q=p.getModule();if(q&&q.moduleClass&&q.moduleXid&&q.moduleClass!==moduleClass&&q.moduleXid!==moduleXid)return getModlue(q);if(q)return q}return p},f=function(p){xui.arr.each(p.children,(function(v,t){(t=getModlue(v[0]))&&(a.push(t),t["xui.UIProfile"]&&t.children&&t.children.length&&f(t))}))};return xui.arr.each(prf.children,(function(v,t){subId&&"string"==typeof subId&&v[1]!==subId||(t=getModlue(v[0]))&&(a.push(t),t["xui.UIProfile"]&&t.children&&t.children.length&&f(t))})),a}return a=[],f=function(prf){xui.arr.each(prf.children,(function(v){a.push(v[0]),v[0].children&&v[0].children.length&&f(v[0])}))},xui.arr.each(this.get(0).children,(function(v){subId&&"string"==typeof subId&&v[1]!==subId||(a.push(v[0]),(!0===type||"penetrate"==type)&&v[0].children&&v[0].children.length&&f(v[0]))})),xui.UI.pack(a)},removeChildren:function(subId,bDestroy,purgeNow){return this.each((function(o){var b,arr,c=xui.copy(o.children),s=o.box.$DataModel.valueSeparator||";";xui.arr.each(c,(function(v){if(b=0,subId&&!0!==subId?xui.isStr(subId)||xui.isArr(subId)?(arr=xui.isArr(subId)?subId:(subId+"").split(s),b=-1!=xui.arr.indexOf(arr,v[1])||-1!=xui.arr.indexOf(arr,v[0])||-1!=xui.arr.indexOf(arr,v[0].boxing())):b=v[0]==subId["xui.UI"]?subId.get(0):subId:b=1,b){if(o.beforeRemove&&!1===o.boxing().beforeRemove(o,v[0],v[1],bDestroy))return;v[0].unlinkParent(),o.afterRemove&&o.boxing().afterRemove(o,v[0],v[1],bDestroy),bDestroy&&!v[0].destroyed&&v[0].boxing().destroy(!0,purgeNow)}}))}))},draggable:function(dragKey,dragData,key,options,target){return this.each((function(o){o.getSubNode(o.keys[key]||"KEY",!0).removeClass("xui-ui-selectable").addClass("xui-ui-unselectable").beforeMousedown(dragKey?function(prf,e,src){"left"==xui.Event.getBtn(e)&&(prf.properties.disabled||((target=target?"function"==typeof target?xui.tryF(target,[],o):xui(target):null)&&target.get(0)||(target=xui(src)),(options=options||{}).dragKey=dragKey,options.dragData="function"==typeof dragData?dragData():dragData,xui.merge(options,{dragCursor:"pointer",dragType:"icon",dragDefer:2}),target.startDrag(e,options)))}:null,"_d",-1).beforeDragbegin(dragKey?function(profile,e,src){xui.use(src).onMouseout(!0,{$force:!0}).onMouseup(!0)}:null,"_d",-1),dragKey||o.clearCache()}))},setCustomFunction:function(key,value){return this.each((function(o){"string"==typeof key?value?o.CF[key]=value:delete o.CF[key]:o.CF=key||{}}))},setCustomClass:function(key,value){var me=arguments.callee,fun=me.fun||(me.fun=function(prf,i,h,flag){if(h[i]){var node=prf.getSubNode(i,!0);node.isEmpty()||xui.arr.each(h[i].split(/\s+/),(function(o){node[flag?"removeClass":"addClass"](o)}))}});return this.each((function(o){var t,bak=xui.copy(o.CC);if("string"==typeof key&&(t=key,(key=xui.copy(o.CC))[t]=value),xui.filter(key,(function(o,i){return/^[A-Z][A-Z0-9]*$/.test(i)?!!o&&void 0:(i in(t=key.KEY=key.KEY||{})||(t[i]=o),!1)})),key&&"object"==typeof key){if(o.renderId){for(var i in bak)fun(o,i,bak,!0);for(var i in key)fun(o,i,key)}o.CC=key}else{if(o.renderId)for(var i in bak)fun(o,i,bak,!0);o.CC={}}delete o._nodeEmSize}))},setCustomAttr:function(key,value,nodes){var me=arguments.callee,fun=me.fun||(me.fun=function(prf,key,CAObj,clear,nodes){if(CAObj[key]){var tnodes,hkey=prf.keys[key]||key;(tnodes=nodes?nodes.query("*","id",hkey==prf.keys.KEY?prf.domId:new RegExp("^"+hkey+":"+prf.serialId)):prf.getSubNode(key,!0)).isEmpty()||xui.isHash(CAObj[key])&&xui.each(CAObj[key],(function(o,i){tnodes.attr(i,clear?"":o&&"string"==typeof o?xui.adjustRes(o,0,1):o)}))}});return this.each((function(o){var t,bak=xui.copy(o.CA);if("string"==typeof key&&(t=key,(key=xui.copy(o.CA))[t]=value),xui.filter(key,(function(o,i){return/^[A-Z][A-Z0-9]*$/.test(i)?!!o&&void 0:(i in(t=key.KEY=key.KEY||{})||(t[i]=o),!1)})),key&&"object"==typeof key){if(key&&xui.filter(key,(function(o,i){return"id"!=i&&"class"!=i&&"style"!=i&&"$xid"!=i})),o.renderId){for(var i in key)fun(o,i,bak,!0,nodes);for(var i in key)fun(o,i,key,!1,nodes)}o.CA=key}else{if(o.renderId)for(var i in bak)fun(o,i,bak,!0,nodes);o.CA={}}}))},setCustomStyle:function(key,value,nodes){var me=arguments.callee,fun=me.fun||(me.fun=function(prf,key,CSObj,clear,nodes){if(CSObj[key]){var tnodes,b,hkey=prf.keys[key]||key;(tnodes=nodes?nodes.query("*","id",hkey==prf.keys.KEY?prf.domId:new RegExp("^"+hkey+":"+prf.serialId)):prf.getSubNode(key,!0)).isEmpty()||(xui.isStr(CSObj[key])?xui.arr.each(CSObj[key].split(";"),(function(o,i){(b=o.split(":")).length>=2&&(i=b.shift(),o=b.join(":"),i=i.replace(/\-(\w)/g,(function(a,b){return b.toUpperCase()})),tnodes.css(i,(clear?"":o&&"string"==typeof o?xui.adjustRes(o,0,1):o)||""))})):xui.isHash(CSObj[key])&&xui.each(CSObj[key],(function(v,i){xui.isStr(v)?0===i.indexOf("background")||-1==v.indexOf(";")?tnodes.css(i,(clear?"":v&&"string"==typeof v?xui.adjustRes(v,0,1):v)||""):xui.arr.each(v.split(";"),(function(o){(b=o.split(":")).length>=2&&(i=b.shift(),o=b.join(":"),i=i.replace(/\-(\w)/g,(function(a,b){return b.toUpperCase()})),tnodes.css(i,(clear?"":o&&"string"==typeof o?xui.adjustRes(o,0,1):o)||""))})):(i=i.replace(/\-(\w)/g,(function(a,b){return b.toUpperCase()})),tnodes.css(i,(clear?"":v&&"string"==typeof v?xui.adjustRes(v,0,1):v)||""))})))}});return this.each((function(o){var t,bak=xui.copy(o.CS);if("string"==typeof key&&(t=key,(key=xui.copy(o.CS))[t]=value),xui.filter(key,(function(o,i){return/^[A-Z][A-Z0-9]*$/.test(i)?!!o&&void 0:(i in(t=key.KEY=key.KEY||{})||(t[i]=o),!1)})),key&&"object"==typeof key){if(o.renderId){for(var i in bak)fun(o,i,bak,!0,nodes);for(var i in key)fun(o,i,key,!1,nodes)}o.CS=key}else{if(o.renderId)for(var i in bak)fun(o,i,bak,!0,nodes);o.CS={}}delete o._nodeEmSize}))},setCustomBehavior:function(key,value){return this.each((function(o){"string"==typeof key?o.keys[key]&&(o.CB[key]=value||{}):o.CB=key||{},o.CB.KEY&&(xui.merge(o.CB,o.CB.KEY,"all"),delete o.CB.KEY),o.clearCache()}))},adjustDock:function(force){return this.each((function(o){if(o.renderId){var n,prop=o.properties;if((prop.conDockRelative||prop.conLayoutColumns)&&o.boxing().adjustSize(),"absolute"==prop.position){if("dock"in prop&&prop.dock&&"none"!=prop.dock&&o.renderId&&(n=o.getRootNode())&&n.clientHeight){if(force){var style=n.style;style.width=(parseFloat(o.$px(style.width))||0)+1+"px",style.height=(parseFloat(o.$px(style.height))||0)+1+"px",o._resize_h=o._resize_w=-1}xui.UI.$dock(o,!0,!0)}}else(xui.get(o,["parent","properties","conDockRelative"])||xui.get(o,["parent","properties","conLayoutColumns"]))&&xui.UI._adjustConW(o.parent,o.getRoot().parent(),o);o.$onDock&&(n=o.boxing().getContainer(!0))&&n.onSize&&n.get(0)&&n.onSize()}}))}},Initialize:function(){var ns=this.prototype;xui.arr.each("getSubNode,getSubNodes,getDomId,getRootNode,getRoot,getContainer".split(","),(function(o){ns[o]||(ns[o]=function(){var p=this.get(0);return p?p[o].apply(p,arguments):null},ns[o].$original$="xui.UI",ns[o].$type$="instance",ns[o].$name$=o)}));var hash={};xui.each(xui.UI.$ps,(function(i,o){hash[o]={$spaceunit:1,ini:"auto",action:function(value){var args,p=this.properties;if(this.getRoot()[o]?this.getRoot()[o](value):xui.Dom._setUnitStyle(this.getRootNode(),o,value),"width"==o||"height"==o?!this.box._onresize&&this.onResize&&this.boxing().onResize(this,"width"==o?value:null,"height"==o?value:null):this.onMove&&this.boxing().onMove(this,"left"==o?value:null,"top"==o?value:null,"right"==o?value:null,"bottom"==o?value:null),"absolute"==p.position&&"none"!=p.dock){switch(args={$type:p.dock,$dockid:-1!=xui.arr.indexOf(["width","height","fill","cover"],p.dock)?this.$xid:null},p.dock){case"middle":if("height"!=o&&"top"!=o)return;args.top=args.height=1;break;case"center":if("width"!=o&&"left"!=o)return;args.left=args.width=1;break;case"top":if("height"!=o&&"top"!=o)return;args.width=args.height=1;break;case"bottom":if("height"!=o&&"bottom"!=o)return;args.width=args.height=1;break;case"left":if("width"!=o&&"left"!=o)return;args.width=args.height=1;break;case"right":if("width"!=o&&"right"!=o)return;args.width=args.height=1;break;case"width":if("width"==o)return;args.width=1;break;case"height":if("height"==o)return;args.height=1;break;case"fill":case"cover":if("width"==o&&"height"==o)return;args.width=args.height=1}var pp=xui.UIProfile.getFromDom(this.$dockParent);pp&&pp.boxing().adjustDock(!0)}}}})),xui.merge(hash,{renderer:{ini:null,action:function(){this.boxing().refresh()}},zIndex:{ini:1,action:function(value){this.getRoot().css("zIndex",value)}},tabindex:{ini:1,action:function(value){var reg=new RegExp("^"+this.key+"[-\\w]*:"+this.serialId+":");this.getRoot().query("*",(function(n){return n.id&&reg.test(n.id)&&n.getAttribute("tabIndex")})).attr("tabIndex",value)}},position:{ini:"absolute",listbox:["","static","relative","absolute"],action:function(value){var prop=this.properties;this.getRoot().css("position",value),!("dock"in this.box.$DataModel)||"none"==prop.dock||prop.dockIgnore||this._dockIgnore||(value=prop.dock,prop.dock="none",this.boxing().adjustDock(!0),prop.dock=value)}},visibility:{listbox:["","visible","hidden"],action:function(value){this.box["xui.svg"]?this.boxing().getAllNodes().css("visibility",value):this.getRoot().css("visibility",value),this.$resizer&&("hidden"==value?this.$resizer.hide():this.$resizer.show()),xui.setNodeData(this.getRootNode(),"_setVisibility",1)}},display:{listbox:["","none","block","inline","inline-block"],action:function(value){var n=this.box["xui.svg"]?this.boxing().getAllNodes():this.getRoot();"inline-block"==value?n.setInlineBlock():n.css("display",value)}},selectable:{ini:!1,action:function(value){this.getRoot().setSelectable(!!value)}}}),this.setDataModel(hash),xui.UI.$cache_css_before+=xui.UI.buildCSSText({".xui-css-viewport":{"-webkit-text-size-adjust":"100%","-ms-text-size-adjust":"100%","-ms-overflow-style":"scrollbar","-webkit-tap-highlight-color":"transparent","font-size":"15px"},".xui-css-viewport, .xui-css-viewport body":{height:"100%",border:"0 none",margin:"0",padding:"0"},".xui-css-viewport body":{"font-size":"1rem"},"@-ms-viewport":{width:"device-width"},".xui-ui-draggable":{},".xui-inline-block":{display:xui.$inlineBlock,zoom:xui.browser.ie?1:null},".xui-ui-input":{background:"#fff"},".xui-ui-shadow-input":{"-moz-box-shadow":"inset 2px 2px 2px #EEEEEE","-webkit-box-shadow":"inset 2px 2px 2px #EEEEEE","box-shadow":"inset 2px 2px 2px #EEEEEE"},".xui-ui-shadow":{"-moz-box-shadow":"2px 2px 4px #CCC","-webkit-box-shadow":"2px 2px 4px #CCC","box-shadow":"2px 2px 4px #CCC","-ms-filter":xui.browser.ie&&8==xui.browser.ver?"progid:DXImageTransform.Microsoft.Shadow(Strength=4, Direction=135, Color='#9f9f9f')":null,filter:xui.browser.ie&&xui.browser.ver<=8?"progid:DXImageTransform.Microsoft.Shadow(Strength=4, Direction=135, Color='#9f9f9f')":null},".xui-ui-shadow-r":{"-moz-box-shadow":"1px 0  1px #CCC","-webkit-box-shadow":"1px 0  1px #CCC","box-shadow":"1px 0  1px #CCC","z-index":10},".xui-ui-shadow-b":{"-moz-box-shadow":"0 1px 1px #CCC","-webkit-box-shadow":"0 1px 1px #CCC","box-shadow":"0 1px 1px #CCC","z-index":10},".xui-ui-image":{"vertical-align":"middle",width:"1.3333333333333333em",height:"1.3333333333333333em","background-repeat":"no-repeat"},".xui-uicmd-none, .xui-display-none":{display:"none"},".xui-uitembg":{padding:".25em .5em","background-color":"transparent",border:"solid 1px transparent"},".xui-uitembg-hover":{$order:1,"background-color":"#E0E0E0","border-color":"#CDCDCD"},".xui-uitembg-active":{$order:2,"background-color":"#CDCDCD","border-color":"#B6B6B6"},".xui-uitembg-checked":{$order:3,"background-color":"#CDCDCD","border-color":"#B6B6B6"},".xui-uicell":{"background-color":"#F9F9FB"},".xui-uicell-hover":{$order:1,"background-color":"#d9e8fb"},".xui-uicell-alt":{$order:2,"background-color":"#FDF8D2"},".xui-uicell-checked":{$order:3,"background-color":"#ABABAB",color:"#fff"},".xui-special-icon":{color:"#3393D2","text-shadow":"1px 1px 4px #ccc"},".xui-uibar-top, .xui-uibar-bottom, .xui-uibar-top-s, .xui-uibar-bottom-s":{position:"relative","vertical-align":"baseline"},".xui-uibar-top td, .xui-uibar-top-s td, .xui-uibar-bottom td, .xui-uibar-bottom-s td":{},".xui-uibar-top":{},".xui-uibar-top .xui-uibar-tdl":{$order:1,position:"absolute",width:"12px",left:0,top:0,height:"100%"},".xui-uibar-top .xui-uibar-tdm":{$order:1,position:"absolute",top:0,left:"12px",right:"12px",height:"100%",width:xui.browser.ie&&xui.browser.ver<=7?"expression((this.parentNode.offsetWidth - 24)+'px')":null},".xui-uibar-top .xui-uibar-tdr":{$order:1,position:"absolute",width:"12px",top:0,right:0,height:"100%"},".xui-uibar-top .xui-uibar-tdlt":{$order:1,position:"absolute",width:"12px",left:0,top:0,height:"1.5em"},".xui-uibar-top .xui-uibar-tdmt":{$order:1,position:"absolute",top:0,left:0,right:0,height:"1.5em",width:xui.browser.ie&&xui.browser.ver<=7?"expression((this.parentNode.offsetWidth)+'px')":null},".xui-uibar-top .xui-uibar-tdrt":{$order:1,position:"absolute",width:"12px",right:0,top:0,height:"1.5em"},".xui-uibar-focus, .xui-uibar-top-focus .xui-uibar-tdl, .xui-uibar-top-focus .xui-uibar-tdm, .xui-uibar-top-focus .xui-uibar-tdr":{"background-color":"#B6B6B6"},".xui-uibar-top-focus .xuifont, .xui-uibar-top-focus .xuicon, .xui-uibar-top-focus .xui-uicaption":{},".xui-uibar-top .xui-uibar-cmdl":{overflow:"hidden",position:"relative",padding:".75em 0 .5em .5em","white-space":"nowrap"},".xui-uibar-top2 .xui-uibar-cmdr":{position:"absolute",top:"-.334em",right:"0","text-align":"right"},".xui-uibar-top .xui-uibar-cmdr":{position:"absolute",top:".75em",right:".5em","text-align":"right"},".xui-uibar-top .xui-uibar-tdb":{position:"relative",display:"none",margin:".16667em .16667em 0 .16667em"},".xui-uicon-main":{position:"relative","padding-left":".3333em","z-index":1,overflow:"visible"},".xui-uicon-maini":{"padding-right":".3333em"},".xui-uibar-bottom":{padding:"3px 0"},".xui-uibar-bottom .xui-uibar-tdl":{$order:1,position:"absolute",width:"12px",left:0,bottom:0,height:"100%"},".xui-uibar-bottom .xui-uibar-tdm":{$order:1,position:"absolute",bottom:0,left:"12px",right:"12px",height:"100%",width:xui.browser.ie&&xui.browser.ver<=7?"expression((this.parentNode.offsetWidth - 24)+'px')":null},".xui-uibar-bottom .xui-uibar-tdr":{$order:1,position:"absolute",width:"12px",right:0,bottom:0,height:"100%"},".xui-uibar-top-s, .xui-uibar-bottom-s, .xui-uibar-top-s .xui-uibar-t":{$order:3,height:"5px"},".xui-uibar-top-s .xui-uibar-tdl":{$order:3,position:"absolute",width:"12px",left:0,top:0,height:"100%"},".xui-uibar-top-s .xui-uibar-tdm":{$order:3,position:"absolute",top:0,left:"12px",right:"12px",height:"100%",width:xui.browser.ie&&xui.browser.ver<=7?"expression((this.parentNode.offsetWidth - 24)+'px')":null},".xui-uibar-top-s .xui-uibar-tdr":{$order:3,position:"absolute",width:"12px",top:0,right:0,height:"100%"},".xui-uibar-top-s .xui-uibar-cmdl":{$order:3,display:"none"},".xui-uibar-top-s .xui-uibar-cmdr":{$order:3,display:"none"},".xui-uibar-bottom-s .xui-uibar-tdl":{$order:3,position:"absolute",width:"12px",left:0,bottom:0,height:"100%"},".xui-uibar-bottom-s .xui-uibar-tdm":{$order:3,position:"absolute",bottom:0,left:"12px",right:"12px",height:"100%",width:xui.browser.ie&&xui.browser.ver<=7?"expression((this.parentNode.offsetWidth - 24)+'px')":null},".xui-uibar-bottom-s .xui-uibar-tdr":{$order:3,position:"absolute",width:"12px",right:0,bottom:0,height:"100%"}})+xui.UI.buildCSSText({".xui-ui-unselectable":{$order:0,"-moz-user-select":xui.browser.gek?"-moz-none":null,"-khtml-user-select":xui.browser.kde?"none":null,"-webkit-user-select":xui.browser.kde?"none":null,"-o-user-select":xui.browser.opr?"none":null,"-ms-user-select":xui.browser.ie||xui.browser.newie?"none":null,"user-select":"none","touch-action":"none"},".xui-ui-selectable":{$order:1,"-moz-user-select":xui.browser.gek?"text":null,"-khtml-user-select":xui.browser.kde?"text":null,"-webkit-user-select":xui.browser.kde?"text":null,"-o-user-select":xui.browser.opr?"text":null,"-ms-user-select":xui.browser.ie||xui.browser.newie?"text":null,"user-select":"text","touch-action":"auto"},".xui-uiw-shell":{display:xui.$inlineBlock,zoom:xui.browser.ie&&xui.browser.ver<=7?1:null,border:0,padding:0,margin:0},".xui-uiw-frame":{$order:1,display:"block",position:"relative",border:0,padding:0,margin:0,width:"100%",height:"100%","-moz-box-flex":"1"},".xui-uiw-border":{$order:2,display:"block",position:"relative",border:0,padding:0,margin:0,left:0,top:0,width:"100%",height:"100%"}})+xui.UI.buildCSSText({".xui-uibase":{"background-color":"#FFFFFF"},".xui-uicontainer":{},".xui-uibar":{"background-color":"#E0E0E0"},".xui-uibar-hover":{$order:1,"background-color":"#CDCDCD"},".xui-uibar-active, .xui-uibar-checked, .xui-uibar-expand, .xui-uimenu-hover, .xui-uimenu-active":{$order:2,"background-color":"#ABABAB"},".xui-ui-ctrl-highlight, .xui-node-highlight, .xui-uibar-checked,  .xui-uibar-expand, .xui-uimenu-hover, .xui-uimenu-active":{$order:3,color:"#FFF"},".xui-ui-btn::-moz-focus-inner":{$order:3,padding:"0 !important",border:"0 none !important"},".xui-uigradient":{$order:4,border:"solid 1px #B6B6B6",color:"#333","text-shadow":"0px 1px 1px rgba(255,255,255,1)","text-decoration":"none","white-space":"nowrap","background-image_1":"linear-gradient(top,  #FFF 5%,  #CDCDCD 100%)","background-image_2":"-webkit-gradient(linear, 0% 0%, 0% 100%, from(0.05, #FFF), to(1, #CDCDCD))","background-image_3":"-webkit-linear-gradient(top,  #FFF 5%,  #CDCDCD 100%)","background-image_4":"-moz-linear-gradient(top,  #FFF 5%,  #CDCDCD 100%)","background-image_5":"-o-linear-gradient(top,  #FFF 5%,  #CDCDCD 100%)","background-image_6":"-ms-linear-gradient(top,  #FFF 5%,  #CDCDCD 100%)","-ms-filter":xui.browser.ie&&8==xui.browser.ver?"progid:DXImageTransform.Microsoft.gradient(startColorstr='#FFFFFF', endColorstr='#CDCDCD', GradientType=0)":null,filter:xui.browser.ie&&xui.browser.ver<=9?"progid:DXImageTransform.Microsoft.gradient(startColorstr='#FFFFFF', endColorstr='#CDCDCD', GradientType=0)":null},".xui-uigradient-hover, .xui-uigradient:hover":{$order:5,"background-image_1":"linear-gradient(top,  #FFF 5%,  #EEE 100%)","background-image_2":"-webkit-gradient(linear, 0% 0%, 0% 100%, from(0.05, #FFF), to(1, #EEE))","background-image_3":"-webkit-linear-gradient(top,  #FFF 5%,  #EEE 100%)","background-image_4":"-moz-linear-gradient(top,  #FFF 5%,  #EEE 100%)","background-image_5":"-o-linear-gradient(top,  #FFF 5%,  #EEE 100%)","background-image_6":"-ms-linear-gradient(top,  #FFF 5%,  #EEE 100%)","-ms-filter":xui.browser.ie&&8==xui.browser.ver?"progid:DXImageTransform.Microsoft.gradient(startColorstr='#FFFFFF', endColorstr='#CDCDCD', GradientType=0)":null,filter:xui.browser.ie&&xui.browser.ver<=9?"progid:DXImageTransform.Microsoft.gradient(startColorstr='#FFFFFF', endColorstr='#CDCDCD', GradientType=0)":null},".xui-uigradient-active, .xui-uigradient-checked, .xui-uigradient-expand, .xui-uigradient:active, .xui-uigradient-active:hover, .xui-uigradient-checked:hover, .xui-uigradient-expand:hover":{$order:6,"background-image_1":"linear-gradient(top,  #CDCDCD 5%,  #FFF)","background-image_2":"-webkit-gradient(linear, 0% 0%, 0% 100%, from(0.05, #CDCDCD), to(1, #FFF))","background-image_3":"-webkit-linear-gradient(top,  #CDCDCD 5%,  #FFF 100%)","background-image_4":"-moz-linear-gradient(top,  #CDCDCD 5%,  #FFF 100%)","background-image_5":"-o-linear-gradient(top,  #CDCDCD 5%,  #FFF 100%)","background-image_6":"-ms-linear-gradient(top,  #CDCDCD 5%,  #FFF 100%)","-ms-filter":xui.browser.ie&&8==xui.browser.ver?"progid:DXImageTransform.Microsoft.gradient(startColorstr='#CDCDCD', endColorstr='#FFFFFF', GradientType=0)":null,filter:xui.browser.ie&&xui.browser.ver<=9?"progid:DXImageTransform.Microsoft.gradient(startColorstr='#CDCDCD', endColorstr='#FFFFFF', GradientType=0)":null},".xui-ui-btn":{$order:7,padding:".334em","white-space":"normal",cursor:"pointer",border:"solid 1px #B6B6B6",display:xui.$inlineBlock,"text-align":"center","line-height":"1",zoom:xui.browser.ie?1:null,width_1:xui.browser.ie&&xui.browser.ver<=7?"auto":null,overflow:xui.browser.ie&&xui.browser.ver<=7?"visible":null},".xui-ui-btn:hover, .xui-ui-btn-hover":{$order:8,"border-color":"#B5B5B5"},".xui-uiborder-l":{"border-left-style":"solid","border-left-width":"1px","border-left-color":"#F6F6F6"},".xui-uiborder-r":{"border-right-style":"solid","border-right-width":"1px","border-right-color":"#B6B6B6"},".xui-uiborder-t":{"border-top-style":"solid","border-top-width":"1px","border-top-color":"#F6F6F6"},".xui-uiborder-b, .xui-uitem-split":{"border-bottom-style":"solid","border-bottom-width":"1px","border-bottom-color":"#B6B6B6"},".xui-uiborder-nob":{$order:1,"border-bottom-width":0,"border-bottom-style":"none"},".xui-uiborder-hidden":{border:"solid 1px transparent",background:"none"},".xui-uiborder-hidden-active, .xui-uiborder-hidden-checked":{background:"#efefef"},".xui-uiborder-flat":{border:"solid 1px #B6B6B6"},".xui-uiborder-outset":{$order:8,border:"solid 1px","border-color":"#F6F6F6 #B6B6B6 #B6B6B6 #F6F6F6"},".xui-uiborder-inset, .xui-uiborder-hidden-active, .xui-uiborder-hidden-checked":{$order:10,border:"solid 1px","border-color":"#B6B6B6 #F6F6F6 #F6F6F6 #B6B6B6"},".xui-uiborder-dark, .xui-uiborder-flat-hover":{"border-color":"#B6B6B6"},".xui-uiborder-light, .xui-uiborder-hidden-hover":{"border-color":"#efefef"},".xui-uiborder-radius":{$order:11,"border-radius":"3px","-moz-border-radius":"3px","-webkit-border-radius":"3px","-o-border-radius":"3px","-ms-border-radius":"3px","-khtml-border-radius":"3px"},".xui-uiborder-radius-big":{$order:11,"border-radius":"6px","-moz-border-radius":"6px","-webkit-border-radius":"6px","-o-border-radius":"6px","-ms-border-radius":"6px","-khtml-border-radius":"6px"},".xui-uiborder-radius-tl":{$order:12,"border-top-left-radius":"3px","-moz-border-top-left-radius":"3px","-webkit-border-top-left-radius":"3px","-o-border-top-left-radius":"3px","-ms-border-top-left-radius":"3px","-khtml-border-top-left-radius":"3px"},".xui-uiborder-radius-tr":{$order:12,"border-top-right-radius":"3px","-moz-border-top-right-radius":"3px","-webkit-border-top-right-radius":"3px","-o-border-top-right-radius":"3px","-ms-border-top-right-radius":"3px","-khtml-border-top-right-radius":"3px"},".xui-uiborder-radius-br":{$order:12,"border-bottom-right-radius":"3px","-moz-border-bottom-right--radius":"3px","-webkit-border-bottom-right--radius":"3px","-o-border-bottom-right--radius":"3px","-ms-border-bottom-right--radius":"3px","-khtml-border-bottom-right--radius":"3px"},".xui-uiborder-radius-bl":{$order:12,"border-bottom-left-radius":"3px","-moz-border-bottom-left-radius":"3px","-webkit-border-bottom-left-radius":"3px","-o-border-bottom-left-radius":"3px","-ms-border-bottom-left-radius":"3px","-khtml-border-bottom-left-radius":"3px"},".xui-uiborder-radius-big-tl":{$order:13,"border-top-left-radius":"6px","-moz-border-top-left-radius":"6px","-webkit-border-top-left-radius":"6px","-o-border-top-left-radius":"6px","-ms-border-top-left-radius":"6px","-khtml-border-top-left-radius":"6px"},".xui-uiborder-radius-big-tr":{$order:13,"border-top-right-radius":"6px","-moz-border-top-right-radius":"6px","-webkit-border-top-right-radius":"6px","-o-border-top-right-radius":"6px","-ms-border-top-right-radius":"6px","-khtml-border-top-right-radius":"6px"},".xui-uiborder-radius-big-br":{$order:13,"border-bottom-right-radius":"6px","-moz-border-bottom-right--radius":"6px","-webkit-border-bottom-right--radius":"6px","-o-border-bottom-right--radius":"6px","-ms-border-bottom-right--radius":"6px","-khtml-border-bottom-right--radius":"6px"},".xui-uiborder-radius-big-bl":{$order:13,"border-bottom-left-radius":"6px","-moz-border-bottom-left-radius":"6px","-webkit-border-bottom-left-radius":"6px","-o-border-bottom-left-radius":"6px","-ms-border-bottom-left-radius":"6px","-khtml-border-bottom-left-radius":"6px"},".xui-uiborder-noradius":{$order:15,"border-radius":"0 !important","-moz-border-radius":"0 !important","-webkit-border-radius":"0 !important","-o-border-radius":"0 !important","-ms-border-radius":"0 !important","-khtml-border-radius":"0 !important"},".xui-uiborder-noradius-l":{$order:15,"border-top-left-radius":"0 !important","-moz-border-top-left-radius":"0 !important","-webkit-border-top-left-radius":"0 !important","-o-border-top-left-radius":"0 !important","-ms-border-top-left-radius":"0 !important","-khtml-border-top-left-radius":"0 !important","border-bottom-left-radius":"0 !important","-moz-border-bottom-left-radius":"0 !important","-webkit-border-bottom-left-radius":"0 !important","-o-border-bottom-left-radius":"0 !important","-ms-border-bottom-left-radius":"0 !important","-khtml-border-bottom-left-radius":"0 !important"},".xui-uiborder-noradius-r":{$order:15,"border-top-right-radius":"0 !important","-moz-border-top-right-radius":"0 !important","-webkit-border-top-right-radius":"0 !important","-o-border-top-right-radius":"0 !important","-ms-border-top-right-radius":"0 !important","-khtml-border-top-right-radius":"0 !important","border-bottom-right-radius":"0 !important","-moz-border-bottom-right-radius":"0 !important","-webkit-border-bottom-right-radius":"0 !important","-o-border-bottom-right-radius":"0 !important","-ms-border-bottom-right-radius":"0 !important","-khtml-border-bottom-right-radius":"0 !important"},".xui-uiborder-noradius-t":{$order:15,"border-top-left-radius":"0 !important","-moz-border-top-left-radius":"0 !important","-webkit-border-top-left-radius":"0 !important","-o-border-top-left-radius":"0 !important","-ms-border-top-left-radius":"0 !important","-khtml-border-top-left-radius":"0 !important","border-top-right-radius":"0 !important","-moz-border-top-right-radius":"0 !important","-webkit-border-top-right-radius":"0 !important","-o-border-top-right-radius":"0 !important","-ms-border-top-right-radius":"0 !important","-khtml-border-top-right-radius":"0 !important"},".xui-uiborder-noradius-b":{$order:15,"border-bottom-left-radius":"0 !important","-moz-border-bottom-left-radius":"0 !important","-webkit-border-bottom-left-radius":"0 !important","-o-border-bottom-left-radius":"0 !important","-ms-border-bottom-left-radius":"0 !important","-khtml-border-bottom-left-radius":"0 !important","border-bottom-right-radius":"0 !important","-moz-border-bottom-right-radius":"0 !important","-webkit-border-bottom-right-radius":"0 !important","-o-border-bottom-right-radius":"0 !important","-ms-border-bottom-right-radius":"0 !important","-khtml-border-bottom-right-radius":"0 !important"},".xui-ui-noshadow, .xui-ui-noshadow .xui-ui-shadow-input, .xui-ui-noshadow .xui-ui-shadow, .xui-ui-noshadow .xui-ui-shadow-b, .xui-ui-noshadow .xui-ui-shadow-r,  .xui-ui-disabled .xui-ui-shadow-input,  .xui-ui-readonly .xui-ui-shadow-input,  .xui-ui-inputreadonly .xui-ui-shadow-input":{$order:15,"-moz-box-shadow":"none !important","-webkit-box-shadow":"none !important","box-shadow":"none !important"},".xui-uiborder-circle":{$order:16,"border-radius":"50%","-moz-border-radius":"50%","-webkit-border-radius":"50%","-o-border-radius":"50%","-ms-border-radius":"50%","-khtml-border-radius":"50%"},".xui-uiflag":{$order:16,"border-radius":"50%","-moz-border-radius":"50%","-webkit-border-radius":"50%","-o-border-radius":"50%","-ms-border-radius":"50%","-khtml-border-radius":"50%",top:"-.5em",right:"-.5em",width:xui.browser.contentBox?"1em":"1.625em",height:xui.browser.contentBox?"1em":"1.625em","line-height":xui.browser.contentBox?"1em":"1.625em",padding:".1667em","background-color":"#eb6e1a",color:"#fff !important",overflow:"hidden","text-align":"center"},".xui-uiflag-1":{},".xui-uiflag-2":{$order:17,top:"-1.5em",right:"-1.5em",width:xui.browser.contentBox?"2em":"2.625em",height:xui.browser.contentBox?"2em":"2.625em","line-height":xui.browser.contentBox?"2em":"2.625em",padding:".5em"},".xui-uiflag-3":{$order:18,top:"-2em",right:"-2em",width:xui.browser.contentBox?"3em":"3.625em",height:xui.browser.contentBox?"3em":"3.625em","line-height":xui.browser.contentBox?"3em":"3.625em",padding:".5em"},".xui-uiflag-4":{$order:18,top:"-2.5em",right:"-2.5em",width:xui.browser.contentBox?"4em":"4.625em",height:xui.browser.contentBox?"4em":"4.625em","line-height":xui.browser.contentBox?"4em":"4.625em",padding:".5em"},".xui-uiborder-none":{$order:20,border:"none"},".xui-uisb":{position:"absolute"},".xui-uisb-none":{display:"none"},".xui-uisb-left":{left:0,top:0,width:"3em",height:"100%"},".xui-uisb-right":{top:0,right:0,width:"3em",height:"100%"},".xui-uisb-top":{left:0,top:0,width:"100%",height:"3em"},".xui-uisb-bottom":{left:0,bottom:0,width:"100%",height:"3em"},".xui-uisbbtn":{position:"absolute",cursor:"pointer","z-index":1,width:"1em",height:"1em"},".xui-uisb-left .xui-uisbbtn":{left:0,top:0},".xui-uisb-right .xui-uisbbtn":{right:0,top:0},".xui-uisb-top .xui-uisbbtn":{right:0,bottom:0},".xui-uisb-bottom .xui-uisbbtn":{right:0,top:0},".xui-uisbcap":{position:"relative","text-align":"center",width:"100%",height:"100%"},".xui-uisb-left .xui-uisbcap, .xui-uisb-right .xui-uisbcap":{"writing-mode":"tb-rl",filter:"flipv fliph"},".xui-ltag-cmds":{margin:0,padding:0,"vertical-align":"middle"},".xui-rtag-cmds":{margin:0,padding:0,"vertical-align":"middle"},".xui-tag-cmd":{margin:"0 .125em",padding:".1667em","vertical-align":"middle"},".xui-inline-object":{"vertical-align":"middle",margin:"0 .16666667em"}}),xui.UI.$cache_css_after+=xui.UI.buildCSSText({".xui-css-innerimage":{"vertical-align":"middle"},".xui-uitem-split":{display:"block",position:"relative",overflow:"visible","white-space":"nowrap",margin:"2px 0",padding:0},".xui-css-noscroll, .xui-css-noscroll body":{overflow:"hidden","overflow-x":"hidden","overflow-y":"hidden"},".xui-css-noscrollx, .xui-css-noscroll body":{"overflow-x":"hidden"},".xui-css-noscrolly, .xui-css-noscroll body":{"overflow-y":"hidden"},".xui-css-dockparent":{overflow:"hidden"},".xui-ui-dirty":{$order:1,"background-image":"url(data:image/gif;base64,R0lGODlhBwAHAPcAAAAAADDSEwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACH5BAEAAP8ALAAAAAAHAAcAAAgYAAMIHPhvoMB/BQkiVLgwAMKHDh9KnBgQADs=)","background-repeat":"no-repeat","background-position":"left top"},".xui-float-clear":{clear:"both"},".xui-float-left":{float:"left"},".xui-float-right":{float:"right"},".xui-ui-ellipsis":{"max-width":"100%","text-overflow":"ellipsis","white-space":"nowrap",overflow:"hidden"},".xui-ui-ruler":{width:0,height:"1.22em","vertical-align":"middle"},".xui-nodatauri .xui-ui-dirty":{$order:2,"background-image":xui.UI.$oldBg("dirtymark.gif","no-repeat left top")},".xui-ui-ctrl-readonly, .xui-node-readonly, input[readonly], textarea[readonly], input:read-only, textarea:read-only, .xui-ui-readonly, .xui-ui-itemreadonly, .xui-ui-readonly .xui-node, .xui-ui-itemreadonly .xui-node, xui-ui-inputreadonly input, xui-ui-inputreadonly textarea":{$order:2,color:"#666666 !important"},"button::-moz-focus-inner, input::-moz-focus-inner":{padding:0,border:0},".xui-ui-ctrl-disabled, .xui-node-disabled, button:disabled, a:disabled, input:disabled, textarea:disabled,  .xui-ui-disabled,  .xui-ui-itemdisabled,  .xui-ui-disabled .xui-node, .xui-ui-itemdisabled .xui-node, .xui-uicell-disabled, .xui-uicell-disabled .xui-node":{$order:2,cursor:"not-allowed",color:"#808080 !important"},".xui-ui-ctrl-disabled, .xui-node-disabled, button:disabled, a:disabled, input:disabled, textarea:disabled,  .xui-ui-disabled input,.xui-ui-disabled textarea, .xui-ui-itemdisabled input, .xui-ui-itemdisabled textarea, .xui-uicell-disabled":{$order:3,"background-color":"#eee !important"},".xui-ui-invalid, .xui-ui-invalid .xui-node":{$order:1,"background-color":"#FFEBCD !important"},".xui-item-row":{display:"block","white-space":"nowrap"},".xui-item-cell":{display:xui.$inlineBlock,zoom:xui.browser.ie?1:null,"white-space":"normal"},".xui-required":{color:"#ff0000 !important"},".xui-alert":{"background-color":"#ff6600 !important"},".xui-uisyle-mobile":{"background-clip":"padding-box",border:"10px solid #333333","border-radius":"12px","box-shadow":"0 0 15px rgba(0, 0, 0, 0.28), 0 1px 1px rgba(255, 255, 255, 0.45) inset, 0 0 2px rgba(255, 255, 255, 0.2) inset"},".xui-uisyle-mobile, .xui-uisyle-mobile *, .xui-cursor-touch, .xui-cursor-touch *":{cursor:"url("+xui.ini.img_touchcur+") 8 8,auto!important"},".xui-icon-loading":{$order:7,width:xui.browser.ie&&xui.browser.ver<=8?"1em":null,height:xui.browser.ie&&xui.browser.ver<=8?"1em":null,"background-image":xui.browser.ie&&xui.browser.ver<10?"url("+xui.ini.img_busy+")":null,"background-repeat":xui.browser.ie&&xui.browser.ver<10?"no-repeat":null,"background-position":xui.browser.ie&&xui.browser.ver<10?"center center":null},".xui-icon-loading:before":{$order:7,visibility:xui.browser.ie&&xui.browser.ver<10?"hidden":null},".xui-load-error":{width:xui.browser.ie&&xui.browser.ver<=8?"1em":null,height:xui.browser.ie&&xui.browser.ver<=8?"1em":null,"background-image":xui.browser.ie&&xui.browser.ver<=8?"url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAQAAAC1+jfqAAAAAmJLR0QA/4ePzL8AAAAJcEhZcwAAAEgAAABIAEbJaz4AAAAJdnBBZwAAABAAAAAQAFzGrcMAAADdSURBVCjPfdGxTsJQGIbhpw20GgN1IZQBDQnGxvu/FEU3IjEBB5SKUsGkdTiCYeGb/pw803uixum1iMJ1KZdp40dpYQWNqBERuXItRY1YrPJspmm0wNAYlZkvdPR1jTVmtJAZgUhliaWFQs9IqYwxkKhUUnf64NuTD6kBMTK8mKgkigNZaGQBJGqfVh6PyFotCWC/NxMbiUL+/xhjJ9Y5kEriVk9HbBdAKZI7A+8ebLQVhigDmNvqKg7k3kZbamceOpSmbvSkXq1xIfSfKh2lPlf/pWa7Tx3A6c86vV+v4FNOkQDWwAAAACV0RVh0ZGF0ZTpjcmVhdGUAMjAxMC0wMi0xMVQxMTo1MDowOC0wNjowMNYQZfsAAAAldEVYdGRhdGU6bW9kaWZ5ADIwMDYtMDUtMDVUMTM6MjI6NDAtMDU6MDC/5P4aAAAAAElFTkSuQmCC)":null,"background-repeat":xui.browser.ie&&xui.browser.ver<=8?"no-repeat":null,"background-position":xui.browser.ie&&xui.browser.ver<=8?"center center":null},".xui-load-error:before":{$order:7,visibility:xui.browser.ie&&xui.browser.ver<=8?"hidden":null},".xui-ui-clear-bg":{$order:10,border:"none",background:"none"},".xui-ui-clear-size":{$order:11,border:"0",padding:"0",margin:"0"},".xui-ui-hidden, .xui-ui-hidden *":{$order:12,visibility:"hidden"}})},$End:function(){var hash={},keys=this.$Keys;xui.filter(this.getAppearance(),(function(o,i){for(var arr2,arr1=i.split(/\s*,\s*/),l=arr1.length-1;l>=0;l--)if((arr2=arr1[l].match(/[A-Z][A-Z0-9]*/g))&&arr2.length)for(var j=0,m=arr2.length;j<m;j++)if(!keys[arr2[j]]){arr1.splice(l,1);break}arr1.length&&(hash[arr1.join(", ")]=o)})),this.setAppearance(hash),xui.UI.$cache_css_before+=this.buildCSSText(this.$Appearances)},Static:{$cache_css_before:"",$cache_css_after:"",$css_tag_dirty:"xui-ui-dirty",$css_tag_invalid:"xui-ui-invalid",$tag_left:"{",$tag_right:"}",$tag_subId:"_serialId",$tag_subId_c:"_serialId_c",$x01:/\x01/gim,$x01r:/ \x01 /gim,$tag_special:"",$ID:"id",$DOMID:"domid",$CLS:"cls",$MODULECLS:"modulecls",$TAGCLASS:"tagcls",$childTag:"\x3c!--{id}--\x3e",$ps:{left:1,top:1,width:1,height:1,right:1,bottom:1},objectProp:{},$toDom:function(profile,str,addEventHandler){if(!1===addEventHandler)return xui.str.toDom(str);var matrix=xui.Dom.getEmptyDiv(profile.$inDesign).get(0),r=[],style=matrix.style;style.position="relative",style.display="none",matrix.innerHTML=str,this.$addEventsHandler(profile,matrix);for(var i=0,t=matrix.childNodes,l=t.length;i<l;i++)xui.$registerNode(t[i]),r[r.length]=t[i].$xid;return style.display="",matrix=null,xui(r,!1)},$evtsindesign:{onload:1,onerror:1,onscroll:1,onunload:1,onsize:1,onmousedown:1,onmouseup:1},_handleEventConf:function(conf,args){},$addEventsHandler:function(profile,node,includeSelf){var i,l,j,k,id,t,v,ch=xui.$cache.UIKeyMapEvents,event=xui.Event,eh=event._eventHandler,hash=this.$evtsindesign,handler=event.$eventhandler,children=xui.toArr(node.getElementsByTagName("*"));if(includeSelf&&children.push(node),l=children.length)for(i=0;i<l;i++)if(1==(node=children[i]).nodeType&&(id=node.id)&&(t=ch[id]||ch[id.substr(0,id.indexOf(":"))]))for(j in v=(v=xui.$registerNode(node)).eHandlers||(v.eHandlers={}),t)profile.$inDesign&&!hash[j]||(v[j]=t[j],(k=eh[j])&&(v[k]=t[j],event._addEventListener(node,k,t[j]),xui.browser.isTouch&&"onmousedown"==k&&(v.onxuitouchdown=handler,event._addEventListener(node,"xuitouchdown",handler))));children.length=0,node=t=null},setDftProp:function(prop){return this.__resetDftProp=prop,this},getFromDom:function(id){if(id=xui.UIProfile.getFromDom(id))return id.boxing()},_ensureValues:function(arr){var o,a=[],i=0,k=0,key=this.KEY,cache=xui.$cache.profileMap,getData=xui.getNodeData;for(arr["xui.absBox"]&&(arr=arr._nodes);o=arr[i++];)(o.box&&o.box[key]||(o=cache[getData(o.renderId?o.renderId:o,["element","id"])])&&o.box&&o.box[key])&&(a[k++]=o);return a.length<=1?a:this._unique(a)},__gc:function(){var k=this.$key,cache=xui.$cache;xui.breakO([cache.template[k],cache.reclaimId[k],this._cache,this._idCache,this.$DataModel,this.$Templates,this.$Behaviors,this],2),delete xui.absBox.$type[k.replace("xui.UI.","")],delete xui.absBox.$type[k],xui.filter(xui.$cache.UIKeyMapEvents,(function(o,i){return!(i==k||0==i.indexOf(k+"-"))})),xui.Class.__gc(k)},_pickSerialId:function(){var arr=xui.$cache.reclaimId[this.$key];return arr&&arr[0]?arr.pop():this._ctrlId.next()},$oldBg:function(path,paras,forceKey,root){return function(key){return"url("+xui.ini.path+"appearance/_oldbrowser/"+path+") "+(paras||"")}},$ieOldBg:function(path){return function(key){return'progid:DXImageTransform.Microsoft.AlphaImageLoader(src="'+xui.ini.path+"appearance/_oldbrowser/"+path+'",sizingMethod="crop")'}},$doTemplate:function(profile,template,properties,tplTag,result,index,realTag){var s,t,n,self=xui.UI.$doTemplate,x01=xui.UI.$x01,isA=xui.isArr(properties),temp=template[tplTag||""],r=!result;if(result=result||[],tplTag=realTag||tplTag,isA){"function"!=typeof temp&&(temp=self);for(var i=0;(t=properties[i++])&&!1!==temp(profile,template,t,tplTag,result,i););}else if(t=properties.object)result[result.length]=t.toHtml();else if("function"==typeof temp)(t=temp(profile,template,properties,tplTag,result))&&(tplTag=t);else{tplTag=tplTag?tplTag+".":"";for(var a0=temp[0],a1=temp[1],l=(i=0,a0.length);i<l;i++)(n=a1[i])?n in properties&&(t=properties[n],"_fi_"==n.substr(0,4)&&(!xui.__iefix2||"_the_next_is_fonticon_"!=a0[i-1]&&"_fi_"!=n?"_fi_"==n&&(t=""):t=(t=xui.str.trim(t).split(/\s+/).pop())in xui.__iefix2?xui.__iefix2[t]:""),template[s=tplTag+n]&&t?self(profile,template,t,s,result):result[result.length]=t===undefined||null===t||NaN===t?"":"string"==typeof t?t.replace(x01,"  "):t):result[result.length]=a0[i]===undefined||null===a0[i]||NaN===a0[i]?"":a0[i]}if(r)return result.join("")},$buildTemplate:function(profile,template,key,obj,arr){if(template&&"text"==(template.tagName+"").toLowerCase())arr[arr.length]=template.text;else{var t,o,bak,tagN,cls1,lkey,self=arguments.callee,prop=(profile.behavior&&(key?profile.behavior[key]:profile.behavior),profile.properties),map1=self.map1||(self.map1={tagName:1,text:1}),map2=self.map2||(self.map2={image:1,input:1,br:1,meta:1,hr:1,abbr:1,embed:1}),r2=(self.map3||(self.map3={input:1,textarea:1,pre:1,code:1}),self.r2||(self.r2=/[a-z]/)),r7=(self.r3||(self.r3=/^(on|before|after)/),self.r7||(self.r7=/([^{}]*)\{([\w]+)\}([^{}]*)/g)),first=!1,u=xui.UI,ts=u.$tag_special;template||(template=profile.template),lkey=key?profile.keys[key]:profile.key,template.tagName||(template.tagName="span"),null!==template.id?template.id=key?lkey+":"+u.$ID+":"+u.$tag_left+(template.$customId?u.$tag_subId_c:u.$tag_subId)+u.$tag_right:u.$DOMID:delete template.id,null!==template.className&&(bak=template.className||"",template._NativeElement?template.class=bak+" "+(lkey==profile.key?xui.browser.ie&&xui.browser.ver<10?"":"{_selectable} ":""):(t=u.$CLS+(key?"-"+key.toLowerCase():""),cls1="button"==(tagN="{"!=template.tagName.charAt(0)?template.tagName.toLowerCase():template.tagName)||"input"==tagN||"textarea"==tagN||"select"==tagN||"keygen"==tagN?"xui-ui-reset":"",template.class="xui-node"+(cls1?" "+cls1:"")+" xui-node-"+tagN+(t?" "+t:"")+(bak?" "+bak:"")+(template.$fonticon?" "+template.$fonticon:"")+(lkey==profile.key?" xui-ui-ctrl "+(xui.browser.ie&&xui.browser.ver<10?"":"{_selectable} "):"")),template.class+=" "+ts+(key||"KEY")+"_CT"+ts+" "+ts+(key||"KEY")+"_CC"+ts+" "+u.$MODULECLS+" "+u.$TAGCLASS+(prop._tagClass?" "+prop._tagClass:"")+" xui-custom"),delete template.className,template.style=(template.style?template.style+";":"")+ts+(key||"KEY")+"_CS"+ts;var a=[],b={},tagName="{"!=template.tagName.charAt(0)?template.tagName.toLowerCase():template.tagName,text=template.text,sc=xui.absObj.$specialChars;for(var i in template)template[i]&&(sc[i.charAt(0)]||map1[i]||(o=template[i],r2.test(i)?b[i]=o:"object"==typeof o&&(o.$order||(o.$order=0),o.$key=i,a[a.length]=o)));for(var i in xui.arr.stableSort(a,(function(x,y){return(x=x.$order||0)>(y=y.$order||0)?1:x==y?0:-1})),arr||(first=!0,arr=[]),arr[arr.length]="<"+tagName+" ",b)b[i]&&(arr[arr.length]=i+'="'+b[i]+'" ');null!==template.className&&(template.className=bak),delete template.class,arr[arr.length]=ts+(key||"KEY")+"_CA"+ts,arr[arr.length]=">",!map2[tagName]&&text&&(arr[arr.length]=text),template.$fonticon&&xui.__iefix2&&(template.$fonticon=xui.str.trim(template.$fonticon),xui.__iefix2[template.$fonticon]?arr[arr.length]=xui.__iefix2[template.$fonticon]:/^\s*\{\s*_fi_[\w\s]+\}\s*$/.test(template.$fonticon)&&(arr[arr.length]="{_the_next_is_fonticon_}"+template.$fonticon)),delete template.$fonticon,i=0;for(var l=a.length;i<l;)self(profile,o=a[i++],o.$key,obj,arr);if(map2[tagName]||(arr[arr.length]="</"+tagName+">"),first){var a0=obj[0],a1=obj[1],str=arr.join(""),has=!1;str.replace(r7,(function(a,b,c,d){return b&&(a0[a0.length]=b),a1[a0.length]=a0[a0.length]=c,d&&(a0[a0.length]=d),has=!0,""})),has||(a0[0]=str)}}},_rpt:function(profile,temp){var me=arguments.callee,host=profile.host,moduleCls=host&&host["xui.Module"]&&host.customStyle&&!xui.isEmpty(host.customStyle)?" xui-module-"+host.$xid:null,ui=xui.UI,tag=ui.$tag_special,ca=function(h,s,i){for(i in s="",h)s+=i+'="'+h[i]+'" ';return s},r=me._r||(me._r=new RegExp(tag+"([0-9A-Z_]+)_C([CTA])"+tag+"|"+tag+"([\\w_\\-\\.]*)"+tag,"img")),h1={id:profile.serialId,cls:profile.getClass("KEY"),domid:profile.$domId,modulecls:moduleCls,tagcls:profile.tagcls||""},h2={A:profile.CA,C:profile.CC,T:profile._CT};return temp.replace(r,(function(a,b,c,d){return h1[d]||(h2[c]?"A"==c?ca(h2[c][b]):h2[c][b]||"":"")})).replace(ui.$x01r,"")},_build:function(profile,data){var template,t,m,u=xui.UI,temp=[[],[]],key=this.KEY,cache=xui.$cache.template,hash=profile._hash="b:"+(profile.template._subid||"")+";!"+(profile._exhash||"");if("string"==typeof profile.theme){var h=profile._CT={},pre=profile.key.replace(/\./g,"-").toLowerCase().replace("xui-ui","xui")+"-";xui.each(profile.keys,(function(o,i){"$"!=i.charAt(0)&&(h[i]=pre+profile.theme+"-"+i.toLowerCase())}))}if(!(template=xui.get(cache,[key,hash]))){if(u.$buildTemplate(profile,null,null,temp),xui.set(cache,[key,hash,""],temp),t=profile.template.$submap)for(var i in t){if("function"!=typeof(m=t[i])){for(var j in temp=[[],[]],m)"object"==typeof m[j]&&u.$buildTemplate(profile,m[j],j,temp);m=temp}xui.set(cache,[key,hash,i],m)}template=xui.get(cache,[key,hash])}return template?this._rpt(profile,u.$doTemplate(profile,template,data)):""},_setDefaultBehavior:function(hash){var t,self=this,me=arguments.callee,map=me._m||(me._m={"":1,KEY:1,$key:1}),f=me._f1||(me._f1=function(arr,type,mode){return function(profile,e,src){var item,nodes,funs,box,id=xui.use(src).id(),cid=profile.getSubId(id),prop=profile.properties;if(!prop.disabled&&!prop.readonly&&!((item=cid&&(profile.SubSerialIdMapItem&&profile.SubSerialIdMapItem[cid]||profile.rowMap&&profile.rowMap[cid]))&&item.disabled||item&&item.readonly)){switch(typeof arr){case"string":nodes=profile.getSubNode(arr,cid)._get();break;case"function":funs=[arr];break;case"object":nodes=[],funs=[];for(var o,i=0,l=arr.length;i<l;i++)"string"==typeof(o=arr[i])?nodes.push.apply(nodes,profile.getSubNode(o,cid)._get()):funs.push(o)}if(nodes&&nodes.length){nodes=xui(nodes),box=profile.boxing();var showId="beforeHoverEffect:"+profile.getUid(),hideId=showId+"_";if(1==mode){if("touchOnly"!=xui.browser.deviceType&&"mouseover"==type){if(!0===prop.disableHoverEffect||item&&item.disableHoverEffect)return;if(prop.disableHoverEffect&&new RegExp("\\b"+profile.getKey(src,!0)+"\\b").test(prop.disableHoverEffect||""))return;if(profile.beforeHoverEffect&&!1===box.beforeHoverEffect(profile,item,e,src,"mouseover"))return;var target=item||profile,hoverItem=profile._hoverItem;profile._willHover=hoverItem?null:target,xui.resetRun.cancel(hideId),xui.resetRun(showId,(function(){delete profile._willHover,profile.renderId&&target&&hoverItem!==target&&(profile._hoverItem=target,profile.$onHover&&profile.$onHover(profile,item,e,src,"mouseover"))}),100)}if("mousedown"==type){if(prop.disableClickEffect||item&&item.disableClickEffect)return;if(profile.$onClick&&0==profile.$onClick(profile,item,e,src,"mousedown"))return;if(profile.beforeClickEffect&&!1===box.beforeClickEffect(profile,item,e,src,"mousedown"))return}nodes.tagClass("-"+("touchOnly"!=xui.browser.deviceType&&"mouseover"==type?"hover":"mousedown"==type?"active":type))}else if("mouseup"==type){if(prop.disableClickEffect||item&&item.disableClickEffect)return;if(profile.beforeClickEffect&&!1===box.beforeClickEffect(profile,item,e,src,"mouseup"))return;if(profile.$onClick&&0==profile.$onClick(profile,item,e,src,"mouseup"))return;nodes.tagClass("-active",!1)}else{if(!0===prop.disableHoverEffect||item&&item.disableHoverEffect)return;if(prop.disableHoverEffect&&new RegExp("\\b"+profile.getKey(src,!0)+"\\b").test(prop.disableHoverEffect||""))return;if(profile.beforeHoverEffect&&!1===box.beforeHoverEffect(profile,item,e,src,"mouseout"))return;target=item||profile,profile._willHover==target?(delete profile._willHover,xui.resetRun.cancel(showId)):xui.resetRun(hideId,(function(){xui.resetRun.cancel(showId),delete profile._willHover,delete profile._hoverItem,profile.renderId&&target&&profile.$onHover&&profile.$onHover(profile,item,e,src,"mouseout")}),200),nodes.tagClass("(-hover|-active)",!1)}}funs&&funs.length&&(xui.arr.each(funs,(function(o){xui.tryF(o,[profile],profile)})),funs.length=0)}}}),hls={};xui.SC.get("xui.absContainer")||xui.Class("xui.absContainer","xui.absObj",{Instance:{addPanel:function(paras,children,item){var struct=xui.clone(xui.UI.Panel.$DataStruct,!0);xui.merge(struct,paras,"with"),xui.merge(struct,{dock:"fill",tag:paras.tag||paras.id},"all");var pb=new xui.UI.Panel(struct),arr=[];return this.append(pb,item&&item.id),xui.arr.each(children,(function(o){arr.push(o[0])})),pb.append(xui.UI.pack(arr,!1)),this},removePanel:function(){this.destroy(!0)},getPanelPara:function(){return xui.clone(this.get(0).properties,!0)},dumpContainer:function(subId,purgeNow){return this.each((function(profile){var b,id,arr,con,s=profile.box.$DataModel.valueSeparator||";",p=profile.properties;"items"in p?xui.arr.each(p.items,(function(item){id=item.id,subId&&!0!==subId?(arr=xui.isArr(subId)?subId:(subId+"").split(s),b=-1!=xui.arr.indexOf(arr,id)):b=1,b&&((con=profile.boxing().getContainer(id))&&con.html("",!0,!1,purgeNow),"html"in item&&(item.html=""))})):((con=profile.boxing().getContainer())&&con.html("",!0,!1,purgeNow),"html"in p&&(p.html=""))}))},getPanelChildren:function(){return this.get(0).children},getFormValues:function(dirtiedOnly,subId,penetrate,withCaption,withCaptionField){var hash={};return this.getFormElements(!1,subId,penetrate).each((function(prf){var keys,key=prf.properties.name||prf.alias,ins=prf.boxing(),uv=ins.getUIValue();dirtiedOnly&&uv+" "==ins.getValue()+" "||(ins.getCaption&&(withCaption||withCaptionField)?(withCaptionField&&-1!=key.indexOf(":")&&(keys=key.split(":")),keys&&keys[0]&&keys[1]?(hash[keys[0]]=uv,hash[keys[1]]=ins.getCaption()):hash[key]=withCaption?{value:uv,caption:ins.getCaption()}:uv):hash[key.split(":")[0]]=uv)})),hash},setFormValues:function(values,subId,penetrate){return xui.isEmpty(values)||this.getFormElements(!1,subId,penetrate).each((function(prf){var keys,cap,prop=prf.properties,ins=prf.boxing(),key=prop.name||prf.alias;"function"==typeof ins.setCaption&&-1!=key.indexOf(":")&&(keys=key.split(":"))&&keys[0]&&keys[1]&&(key=keys[0],cap=keys[1]);var v=values[key],b=xui.isHash(v);"value"in prop&&key in values&&ins.setValue(b&&"value"in v?v.value:v,!0,"form"),"function"==typeof ins.setCaption&&(cap in values?ins.setCaption(values[cap],null,!0,"form"):b&&"caption"in v&&ins.setCaption(v.caption,null,!0,"form"))})),this},getFormElements:function(dirtiedOnly,subId,penetrate){var a=this.getChildren(subId,!1!==penetrate),elems=xui.absValue.pack(a);if(xui.filter(elems._nodes,(function(prf){return prf.box._isFormField?prf.box._isFormField(prf):!!xui.get(prf,["properties","isFormField"])})),dirtiedOnly){var ins,arr=[];return elems.each((function(p,z){(ins=p.boxing()).getUIValue()+" "!=ins.getValue()+" "&&arr.push(p)})),xui.absValue.pack(arr)}return elems},isDirtied:function(subId,penetrate){for(var elems=this.getFormElements(!1,subId,penetrate).get(),i=0,l=elems.length;i<l;i++){var ins,profile=elems[i];if(profile.box["xui.absValue"]&&(ins=profile.boxing()).getUIValue()+" "!=ins.getValue()+" ")return!0}return!1},checkValid:function(ignoreAlert,subId,penetrate){var profile=this.get(0),result=!0;return!!this.checkRequired(ignoreAlert,subId,penetrate)&&(this.getFormElements(!1,subId,penetrate).each((function(prf){var prop=prf.properties,ins=prf.boxing();if(!ins.checkValid(ignoreAlert,subId,penetrate)){if(!ignoreAlert)return profile.beforeInputAlert&&!1===profile.boxing().beforeInputAlert(profile,prf,"invalid")?xui.asyRun((function(){ins.activate()})):xui.alert("$inline.invalid",xui.getRes("$inline.invalid2")+(prop.labelCaption?" : "+prop.labelCaption:""),(function(){prf&&prf.renderId&&ins.activate()})),result=!1;result=!1}})),result)},checkRequired:function(ignoreAlert,subId,penetrate){var profile=this.get(0),result=!0;return this.getFormElements(!1,subId,penetrate).each((function(prf,i){var prop=prf.properties,ins=prf.boxing();if(prop.required&&!(i=ins.getUIValue())&&0!==i){if(!ignoreAlert)return profile.beforeInputAlert&&!1===profile.boxing().beforeInputAlert(profile,prf,"required")?xui.asyRun((function(){ins.activate()})):xui.alert("$inline.required",xui.getRes("$inline.required2")+(prop.labelCaption?" : "+prop.labelCaption:""),(function(){prf&&prf.renderId&&ins.activate()})),result=!1;result=!1}})),result},formClear:function(subId,penetrate){return this.each((function(prf){prf.boxing().getFormElements(!1,subId,penetrate).resetValue(null)}))},formReset:function(subId,penetrate){return this.each((function(prf){prf.properties;var elems=prf.boxing().getFormElements(!1,subId,penetrate);prf.beforeFormReset&&!1===prf.boxing().beforeFormReset(prf,elems,subId,penetrate)||(elems.each((function(p,i){(i=p.properties.value)!==p.properties.$UIvalue&&p.boxing().resetValue(i)})),prf.afterFormReset&&prf.boxing().afterFormReset(prf,elems,subId,penetrate))}))},updateFormValues:function(subId,penetrate){this.getFormElements(!1,subId,penetrate).updateValue()},formSubmit:function(ignoreAlert,subId,penetrate,withCaption,withCaptionField){if(ignoreAlert||this.checkValid(!1,subId,penetrate)){var f,apicaller,prf=this.get(0),p=prf.properties,data=this.getFormValues(!1,subId,penetrate,withCaption,withCaptionField);prf.beforeFormSubmit&&!1===prf.boxing().beforeFormSubmit(prf,data,subId,penetrate,withCaption,withCaptionField)||("Alert"==p.formTarget?(data=xui.stringify(data),xui.Coder&&xui.Coder.formatText&&(data=xui.Coder.formatText(data)),alert(data)):/^\s*\{[^}]+\}\s*$/.test(p.formTarget)?(f=xui.adjustVar(p.formTarget))(data):/^((\s*function\s*([\w$]+\s*)?\(\s*([\w$\s,]*)\s*\)\s*)(\{([^\{\}]*)\}))\s*$/.test(p.formTarget)?(f=xui.unserialize(p.formTarget))&&f(data):(xui.APICaller&&-1==xui.arr.indexOf(["_blank","_self","_parent","_top"],p.formTarget)&&(apicaller=xui.APICaller.getFromName(p.formTarget)),apicaller?(apicaller.setQueryData(data,p.formDataPath),apicaller.invoke()):xui.Dom.submit(p.formAction,data,p.formMethod,p.formTarget,p.formEnctype)),this.getFormElements(!1,subId,penetrate).updateValue(),prf.afterFormSubmit&&prf.boxing().afterFormSubmit(prf,data,subId,penetrate,withCaption,withCaptionField))}},_e1:function(profile,item,e,src,type){},_e2:function(profile,keyboard,e,src){},_e3:function(profile,e,shiftKey,src){},_e4:function(profile,e,src,dragKey,dragData,item){},_e5:function(profile,e,src){},_e6:function(profile,ctrlPrf,type){},_e7:function(profile,elems,subId){},_e8:function(profile,data,subId){}},Static:{$abstract:!0,DataModel:{dragKey:"",dropKeys:"",overflow:{ini:"touchOnly"==xui.browser.deviceType?"auto":undefined,combobox:["","visible","hidden","scroll","auto","overflow-x:hidden;overflow-y:auto","overflow-x:auto;overflow-y:hidden"],action:function(v){var prf=this;xui.arr.each(prf.box.$Behaviors.PanelKeys,(function(k){var node=prf.getSubNode(k,!0);v&&-1!=v.indexOf(":")?xui.arr.each(v.split(/\s*;\s*/g),(function(s){var a=s.split(/\s*:\s*/g);a.length>1&&node.css(xui.str.trim(a[0]),xui.str.trim(a[1]||""))})):node.css("overflow",v||"")}))}},panelBgClr:{type:"color",ini:"",action:function(v){var prf=this;xui.arr.each(prf.box.$Behaviors.PanelKeys,(function(k){prf.getSubNode(k,!0).css("background-color",v)}))}},panelBgImg:{format:"image",ini:"",action:function(v){var prf=this;xui.arr.each(prf.box.$Behaviors.PanelKeys,(function(k){prf.getSubNode(k,!0).css("background-image",v?"url("+xui.adjustRes(v||"")+")":"")}))}},panelBgImgPos:{ini:"",combobox:["","top left","top center","top right","center left","center center","center right","bottom left","bottom center","bottom right","0% 0%","-0px -0px"],action:function(v){var prf=this;xui.arr.each(prf.box.$Behaviors.PanelKeys,(function(k){prf.getSubNode(k,!0).css("background-position",v)}))}},panelBgImgRepeat:{ini:"",combobox:["","repeat","repeat-x","repeat-y","no-repeat"],action:function(v){var prf=this;xui.arr.each(prf.box.$Behaviors.PanelKeys,(function(k){prf.getSubNode(k,!0).css("background-repeat",v)}))}},panelBgImgAttachment:{ini:"",combobox:["","scroll","fixed"],action:function(v){var prf=this;xui.arr.each(prf.box.$Behaviors.PanelKeys,(function(k){prf.getSubNode(k,!0).css("background-attachment",v)}))}},conLayoutColumns:{ini:0,action:function(){this.adjustSize()}},conDockRelative:{hidden:!0,ini:!1,get:function(){return this.boxing().getConLayoutColumns()},set:function(value){return this.boxing().setConLayoutColumns(value?1:0)}},conDockPadding:{ini:{left:0,top:0,right:0,bottom:0},action:function(){this.boxing().adjustDock(!0)}},conDockSpacing:{ini:{width:0,height:0},action:function(){this.boxing().adjustDock(!0)}},conDockFlexFill:{ini:"",combobox:["none","width","height","both"],action:function(){this.boxing().adjustDock(!0)}},conDockStretch:{ini:"",combobox:["fixed","forward","rearward","stretch","0.25","0.33","0.5","0.25,0.5,0.25"],action:function(){this.boxing().adjustDock(!0)}},sandboxTheme:{ini:"",action:function(v,ov,force,tag1,tag2){xui.UI._refreshSBTheme(this,v,tag1,tag2)}},formMethod:{ini:"get",listbox:["get","post"]},formTarget:{ini:"Alert",combobox:["Alert","_blank","_self","_parent","_top","[framename]","[APICaller]","function(d){xui.log(d)}"]},formDataPath:"",formAction:"",formEnctype:{ini:"application/x-www-form-urlencoded",listbox:["application/x-www-form-urlencoded","multipart/form-data","text/plain"]},readonly:{ini:!1,action:function(v){this.boxing().getChildren().each((function(prf){var ins=prf.boxing();"function"==typeof ins.setReadonly?ins.setReadonly(v||!1):"function"==typeof ins.setDisabled&&ins.setDisabled(v||!1)}))}}}}});var src=xui.absContainer.prototype;hash.HoverEffected&&(xui.each(hash.HoverEffected,(function(o,i){t=map[i]?hash:hash[i]||(hash[i]={}),o?(t.afterMouseover=f(o,"mouseover",1),t.afterMouseout=f(o,"mouseout",2)):t.afterMouseover=t.afterMouseout=null})),hls.beforeHoverEffect=src._e1),hash.ClickEffected&&(xui.each(hash.ClickEffected,(function(o,i){t=map[i]?hash:hash[i]||(hash[i]={}),o?(t.afterMousedown=f(o,"mousedown",1),t.afterMouseup=f(o,"mouseup",2)):t.afterMousedown=t.afterMouseup=null})),hls.beforeClickEffect=src._e1),hash.HotKeyAllowed&&(xui.merge(hash,{beforeKeydown:function(profile,e,src){if(profile.onHotKeydown)return!1!==profile.boxing().onHotKeydown(profile,xui.Event.getKey(e),e,src)},beforeKeypress:function(profile,e,src){if(profile.onHotKeypress)return!1!==profile.boxing().onHotKeypress(profile,xui.Event.getKey(e),e,src)},beforeKeyup:function(profile,e,src){if(profile.onHotKeyup)return!1!==profile.boxing().onHotKeyup(profile,xui.Event.getKey(e),e,src)}}),hls.onHotKeydown=hls.onHotKeypress=hls.onHotKeyup=src._e2),hash.NavKeys&&(xui.each(hash.NavKeys,(function(o,i){var map=arguments.callee,m1=map.m1||(map.m1={KEY:1,$key:1});if(!m1[i]){var m2=map.m2||(map.m2={input:1,textarea:1}),m3=map.m3||(map.m3={tab:1,enter:1,up:1,down:1,left:1,right:1}),m4=map.m4||(map.m4={tab:1,up:1,down:1,left:1,right:1}),t=hash[i]||(hash[i]={});t.afterKeydown=null===o?null:function(profile,e,src){var k=xui.Event.getKey(e),key=k.key,ctrl=k.ctrlKey,shift=k.shiftKey,alt=k.altKey,b=!1,smartnav=profile._smartnav;if(smartnav){var node=xui.use(src).get(0);if(m2[k=node.tagName.toLowerCase()]){if(key&&"input"==k&&"text"!=node.type.toLowerCase()&&"password"!=node.type.toLowerCase())b=!0;else if(m3[key]){var reg=xui.use(src).caret(),txt=xui.use(src).get(0).value;switch(key){case"up":/[\n\r]/.test(txt.substr(0,reg[0]))||(b=!0);break;case"left":shift||!ctrl&&(0!==reg[0]||reg[1]===txt.length&&0!==reg[1])||(b=!0);break;case"down":/[\n\r]/.test(txt.substr(reg[1],txt.length))||(b=!0);break;case"right":shift||!ctrl&&(reg[1]!==txt.length||0===reg[0]&&0!==reg[1])||(b=!0);break;case"enter":("input"==k||alt)&&(b=!0);break;case"tab":b=!0}}}else m4[key]&&(b=!0);node=null}else b="tab"===key;if(b){if(profile.beforeNextFocus&&!1===profile.boxing().beforeNextFocus(profile,e,k.shiftKey,src)){switch(k.key){case"tab":case"enter":profile.onHotKeydown&&profile.boxing().onHotKeydown(profile,xui.Event.getKey(e),e,src);case"esc":profile.onHotKeyup&&profile.boxing().onHotKeyup(profile,xui.Event.getKey(e),e,src)}return!1}smartnav&&"tab"!=key&&xui.use(src).nextFocus("up"!=key&&"left"!=key)}}}})),hls.beforeNextFocus=src._e3),(t=hash.DroppableKeys)&&t.length&&(xui.arr.each(t,(function(o){self._droppable(o)})),t=self.prototype,xui.arr.each("getDropKeys,setDropKeys".split(","),(function(o){t[o]||(t[o]=src[o])})),hash.PanelKeys&&xui.arr.each("addPanel,removePanel,dumpContainer,getPanelPara,getPanelChildren,getFormValues,setFormValues,getFormElements,isDirtied,checkValid,checkRequired,formClear,formReset,updateFormValues,formSubmit".split(","),(function(o){t[o]||(t[o]=src[o])})),self.$DataModel.dropKeys=self.$DataStruct.dropKeys="",hls.onDragEnter=hls.onDragLeave=hls.beforeDrop=hls.onDrop=hls.afterDrop=hls.onDropTest=hls.onDropMarkShow=hls.onDropMarkClear=src._e4),(t=hash.DraggableKeys)&&t.length&&(xui.arr.each(t,(function(o){self._draggable(o)})),t=self.prototype,xui.arr.each("getDragKey,setDragKey".split(","),(function(o){t[o]||(t[o]=src[o])})),self.$DataModel.dragKey=self.$DataStruct.dragKey="",hls.onGetDragData=hls.onStartDrag=hls.onDragStop=src._e5),(t=hash.NoDraggableKeys)&&t.length&&(self.NoDraggableKeys=t),(t=hash.NoDroppableKeys)&&t.length&&(self.NoDroppableKeys=t),(t=hash.PanelKeys)&&t.length&&(xui.each(hash.PanelKeys,(function(i){(t=map[i]?hash:hash[i]||(hash[i]={})).onMousewheel=function(profile,e,src){var id=xui.use(src).id();if(id){var cid=profile.getSubId(id),item=profile.SubSerialIdMapItem&&profile.SubSerialIdMapItem[cid];if(profile.onMousewheel)return profile.boxing().onMousewheel(profile,xui.Event.getWheelDelta(e),item,e,src)}}})),t=self.prototype,xui.arr.each("overflow,panelBgClr,panelBgImg,panelBgImgPos,panelBgImgRepeat,panelBgImgAttachment,conDockRelative,conLayoutColumns,conDockPadding,conDockSpacing,conDockFlexFill,conDockStretch,sandboxTheme,formMethod,formTarget,formDataPath,formAction,formEnctype,readonly".split(","),(function(o){var dm,f="get"+xui.str.initial(o);t[f]||(t[f]=src[f]),f="set"+xui.str.initial(o),t[f]||(t[f]=src[f]),dm=xui.absContainer.$DataModel[o],self._NoProp&&self._NoProp[o]||(self.$DataStruct[o]=xui.isSet(dm.ini)?xui.copy(dm.ini):"",self.$DataModel[o]=xui.copy(dm))})),xui.merge(hls,xui.absContainer.$EventHandlers),hls.beforeInputAlert=src._e6,hls.beforeFormReset=hls.afterFormReset=src._e7,hls.beforeFormSubmit=hls.afterFormSubmit=src._e8,hls.onMousewheel=function(profile,delta,item,e,src){},self["xui.absContainer"]=!0),self.setEventHandlers(hls),self.$RenderTrigger=self.$RenderTrigger||[],self.$RenderTrigger.push((function(){this.properties.readonly&&this.boxing().setReadonly(!0,!0)}))},addTemplateKeys:function(arr){var self=this,key=self.KEY,me=arguments.callee,reg=me._reg||(me._reg=/\./g);return xui.arr.each(arr,(function(i){self.$cssKeys[i]=(self.$Keys[i]="KEY"==i?key:key+"-"+i).replace(reg,"-").toLowerCase().replace("xui-ui","xui")})),self},_refreshSBTheme:function(profile,cssSetting,tag,callback,relayout){var id=profile.getDomId()+"sandboxtheme",prevId=this._getThemePrevId(profile),old=xui(id).get(0),applyCss=function(css){profile.destroyed||(xui.CSS._appendSS(profile.getRootNode(),xui.UI._adjustCSS(css,prevId,tag),id,!0),(relayout||profile.$inDesign)&&profile.boxing().reLayout(!0).getChildren(!0,"penetrate").reLayout(!0))};if(old&&(old.disabled=!0,xui(id).remove(!1)),cssSetting)if(/^[a-zA-Z-]+$/.test(cssSetting+"")&&cssSetting+""!="default"){var path=xui.getPath("xui.appearance."+cssSetting,"");xui.getFileAsync(path+"theme.css",(function(rsp){applyCss(rsp.replace(/\.setting-uikey\{[^}]+\}/,"").replace(/url\(([^)]+)\)/g,"url("+path+"$1)")),xui.tryF(callback,[profile,cssSetting])}))}else applyCss(cssSetting+"")},_getThemePrevId:function(profile){return profile?"#"+(profile["xui.UIProfile"]?profile.getDomId():profile).replace(/([.:])/g,"\\$1"):""},_adjustCSS:function(css,prevId,tag){return prevId=prevId||"",tag&&(css=xui.replace(css,[[/(\/\*[^*]*\*+([^\/][^*]*\*+)*\/)/,"$0"],[/\{[^}]*\}/,"$0"],[/([^\/{},]+)/,function(a){return a[0].replace(/([^\s>]+)/,"$1"+tag)}]])),css.replace(/(\/\*[^*]*\*+([^\/][^*]*\*+)*\/)/g,"").replace(/^\s*(\.)/,(function(a,b){return prevId+" "+b})).replace(/([},])\s*(\.)/g,(function(a,b,c){return b+"\n"+prevId+" "+c})).replace(/([{;])\s*(.)/g,(function(a,b,c){return b+"\n"+("}"==c?"":"    ")+c})).replace(/url\(([^)]+)\)/g,(function(a,b){return"url("+xui.adjustRes(b,0,1)+")"}))},setAppearance:function(hash){return xui.merge(this.$Appearances,hash,"all"),this},getAppearance:function(){return this.$Appearances},setTemplate:function(hash,cacheId){if(hash){var t,self=this,tagNames=self.$tagName||(self.$tagName={}),me=arguments.callee,r2=me.r2||(me.r2=/[a-z]/),sc=xui.absObj.$specialChars,_ks=["KEY"],fun=me._fun||(me._fun=function(hash,arr,tagNames){var o,i;for(i in hash)sc[i.charAt(0)]||r2.test(i)||(arr[arr.length]=i,(o=hash[i])&&"object"==typeof o&&(tagNames[i]=o.tagName||"",arguments.callee(o,arr,tagNames)))});if(tagNames.KEY=hash.tagName||"",fun(hash,_ks,tagNames),self.addTemplateKeys(_ks),t=self.$Templates,"string"==typeof cacheId?(hash._subid=cacheId,t[cacheId]=hash):t._=hash,t=hash.$submap)for(var i in t)for(var j in t[i])me.call(self,t[i],j);t=self.$tplWordMap||(self.$tplWordMap={}),(xui.serialize(self.$Templates)||"").replace(/\{(\w+)\}/g,(function(a,b){t[b]=1}))}return this},getTemplate:function(cacheId){return this.$Templates[cacheId||"_"]},setBehavior:function(hash){if(hash){var m,i,j,k,o,v,self=this,ch=xui.$cache.UIKeyMapEvents,skey=self.$key,check=xui.absObj.$specialChars,event=xui.Event,handler=event.$eventhandler,eventType=event._eventMap,me=arguments.callee,r1=me.r1||(me.r1=/[a-z]/),r2=me.r2||(me.r2=/^(on|before|after)/),t=self.$Behaviors;for(i in xui.filter(ch,(function(o,i){return!(i==skey||0==i.indexOf(skey+"-"))})),self._setDefaultBehavior(hash),hash.KEY&&(xui.merge(hash,hash.KEY,"all"),delete hash.KEY),hash)if(o=hash[i],!check[i.charAt(0)])if(r1.test(i))r2.test(i)?o?t[i]=o:delete t[i]:t[i]=o;else for(j in m=t[i]||(t[i]={}),o)v=o[j],check[j.charAt(0)]||(v?m[j]=v:delete m[j]);for(i in t)if(o=t[i],!check[i.charAt(0)])if(r1.test(i))r2.test(i)&&o&&(ch[k=skey]=ch[k]||{},ch[k]["on"+eventType[i]]=ch[k]["on"+eventType[i]]||handler);else for(j in o)!check[j.charAt(0)]&&o[j]&&(ch[k=skey+"-"+i]=ch[k]||{},ch[k]["on"+eventType[j]]=ch[k]["on"+eventType[j]]||handler)}return self},getBehavior:function(){return this.$Behaviors},$trytoApplyCSS:function(){var self=xui.UI,css=xui.CSS,id="xui.UI-CSS",cache1=self.$cache_css_before,cache2=self.$cache_css_after;if(!self.$cssNo){self.$cssNo=1;var b=xui.browser;xui("body").addClass((b.ie?"xui-css-ie xui-css-ie"+b.ver+" ":b.gek?"xui-css-gek xui-css-gek"+b.ver+" ":b.kde?"xui-css-kde xui-css-kde"+b.ver+" ":b.opr?"xui-css-opr xui-css-opr"+b.ver+" ":"")+(b.isSafari?"xui-css-safari ":b.isChrome?"xui-css-chrome ":"")+(b.isMac?"xui-css-mac":b.isLinux?"xui-css-linux ":"")),xui("html").addClass("xui-css-base xui-css-viewport xui-uicontainer"+(b.isStrict?" xui-css-strict":"")),css.includeLink(xui.ini.path+"iconfont/iconfont.css","xui-font-icon",!0)}cache1&&(css.addStyleSheet(cache1,id+self.$cssNo++),self.$cache_css_before=""),cache2&&(css.addStyleSheet(cache2,id+self.$cssNo++,!0),self.$cache_css_after="")},buildCSSText:function(hash){var t,v,o,r1=/(^|\s|,)([0-9A-Z_]+)/g,h=[],r=[],browser=xui.browser,ks=(browser.ie6,browser.ie,browser.gek,this.$cssKeys);for(var i in hash)(o=hash[i])&&(t=i.replace(r1,(function(a,b,c){return b+"."+(ks[c]||c)})).toLowerCase(),o.$order=parseInt(o.$order,10)||0,o.$=t,h[h.length]=o);xui.arr.stableSort(h,(function(x,y){return(x=x.$order||0)>(y=y.$order||0)?1:x==y?0:-1})),i=0;for(var l=h.length;i<l;){for(var j in o=h[i++],r[r.length]=o.$+"{",(t=o.$before)&&(r[r.length]=t),(t=o.$text)&&(r[r.length]=t),o)if("$"!=j.charAt(0)&&((v=o[j])||0===o[j]))switch(j=j.replace(/_[0-9]+$/,""),typeof v){case"string":case"number":r[r.length]=j+":"+v+";";break;case"function":r[r.length]=j+":"+v(this.KEY)+";";break;default:xui.arr.each(v,(function(k){k&&(r[r.length]=j+":"+k+";")}))}(v=o.$after)&&(r[r.length]=v),r[r.length]="}"}return r.join("")},_prepareCmds:function(profile,item,filter){var p=profile.properties,cmds=item.tagCmds||xui.clone(p.tagCmds,!0);if(cmds&&cmds.length){for(var c,sid=xui.UI.$tag_subId,a=[],b=[],i=0,t=cmds,l=t.length;i<l;i++){if(c="string"==typeof t[i]?{id:t[i]}:xui.clone(t[i]),filter&&xui.isFun(filter)){if(!filter(c,item))continue}else if(item.tag&&item.tag.match(new RegExp("\\bno~"+c.id+"\\b")))continue;if(c&&c.tag)if(item.sub){if(!c.tag.match(/\bbranch\b/)&&c.tag.match(/\bleaf\b/))continue;if(item.group){if(!c.tag.match(/\bgroup\b/))continue}else if(c.tag.match(/\bgroup\b/))continue}else if(!c.tag.match(/\bleaf\b/)&&c.tag.match(/\bbranch\b/))continue;"id"in c?c.id+="":c.id="cmds"+profile.$xid+i,c.object?(c.object=this._prepareInlineObj(profile,c,p.tabindex),c.type="profile"):("tips"in c||(c.tips=c.caption||c.id),c.id=c.id.replace(/[^0-9a-zA-Z]/g,""),c.type||(c.type="text"),c.caption&&(c.caption=xui.adjustRes(c.caption)),c.tips&&(c.tips=xui.adjustRes(c.tips)),c.image&&(c.image=xui.adjustRes(c.image)||xui.ini.img_bg),c._style="","width"in c&&(c._style+=c.width+(xui.isFinite(c.width)&&"px")+";"),"height"in c&&(c._style+=c.height+(xui.isFinite(c.height)&&"px")+";"),c[sid]=(item[sid]?item[sid]:"")+"_"+c.id),"left"==c.location?b.push(c):(a.push(c),"right-float"==c.location&&(c._exstyle="float:right;"))}item.ltagCmds=b,item.rtagCmds=a}item._ltagDisplay=item.ltagCmds?"":"display:none",item._rtagDisplay=item.rtagCmds?"":"display:none"},$getTagCmdsTpl:function(key){var tpl={ltagCmds:function(profile,template,v,tag,result){var me=arguments.callee,map=me._m||(me._m={text:".text",button:".button",image:".image"});xui.UI.$doTemplate(profile,template,v,"tagCmds"+(map[v.type]||".button"),result)},rtagCmds:function(profile,template,v,tag,result){var me=arguments.callee,map=me._m||(me._m={text:".text",button:".button",image:".image"});xui.UI.$doTemplate(profile,template,v,"tagCmds"+(map[v.type]||".button"),result)},"tagCmds.text":{CMD:{tagName:"span",title:"{tips}",style:"{_style};{itemStyle};{_exstyle};",className:"xui-node xui-tag-cmd",tabindex:"{_tabindex}",CMDICON:{className:"{itemClass}"},CMDTXT:{text:"{caption}"}}},"tagCmds.button":{CMD:{tagName:"button",title:"{tips}",style:"{_style};{itemStyle};{_exstyle};",className:"xui-node xui-ui-btn xui-uibar xui-uigradient xui-uiborder-radius xui-list-cmd xui-tag-cmd",tabindex:"{_tabindex}",CMDICON:{className:"{itemClass}"},CMDTXT:{text:"{caption}"}}},"tagCmds.image":{CMD:{tagName:"image",title:"{tips}",src:"{image}",border:"0",style:"{_style};{itemStyle};{_exstyle};",className:"xui-node xui-tag-cmd {itemClass}",tabindex:"{_tabindex}",alt:"{caption}"}}};return key?tpl["tagCmds."+key]:tpl},_droppable:function(key){var h2=xui.Event.$eventhandler,o=this.$Behaviors,v="KEY"==key?o:o[key]||(o[key]={}),handler=xui.$cache.UIKeyMapEvents,k2="KEY"==key?this.KEY:this.KEY+"-"+key,ch=handler[k2]||(handler[k2]={});return xui.merge(v,{beforeMouseover:function(profile,e,src){var prop=profile.properties;if(!prop.disabled&&!prop.readonly){if(profile.behavior.NoDroppableKeys){var sk=profile.getKey(xui.Event.getSrc(e).id||"").split("-")[1];if(sk&&-1!=xui.arr.indexOf(profile.behavior.NoDroppableKeys,sk))return}var t,item,box,args,ns=src,dd=xui.DragDrop,pp=dd.getProfile(),key=pp.dragKey,data=pp.dragData,isPanelN=(t=profile.box.$Behaviors.PanelKeys)&&-1!==xui.arr.indexOf(t,profile.getKey(src,!0));if(data&&(prop.dragSortable&&profile.$xid==xui.get(data,["profile","$xid"])&&!isPanelN||key&&new RegExp("\\b"+key+"\\b").test(profile.box.getDropKeys(profile,ns)))){if((box=profile.boxing()).getItemByDom&&(item=box.getItemByDom(src)),args=[profile,e,ns,key,data,item],(t=profile.onDropTest)&&!1===box.onDropTest.apply(box,args))return;if((t=profile.box._onDropTest)&&!1===t.apply(profile.host||profile,args))return;dd.setDropElement(src),profile.onDropMarkShow&&!1===box.onDropMarkShow.apply(box,args)||(t=profile.box._onDropMarkShow)&&!1===t.apply(profile.host||profile,args)||xui.resetRun("setDropFace",dd.setDropFace,0,[ns],dd),(t=profile.box._onDragEnter)&&t.apply(profile.host||profile,args),profile.onDragEnter&&box.onDragEnter.apply(box,args)}}},beforeMouseout:function(profile,e,src){if(!profile.properties.disabled&&!profile.properties.readonly){var t,item,box,args,dd=xui.DragDrop,pp=dd.getProfile(),key=pp.dragKey,data=pp.dragData;pp.dropElement==src&&((box=profile.boxing()).getItemByDom&&(item=box.getItemByDom(src)),args=[profile,e,src,key,data,item],profile.onDropMarkClear&&!1===box.onDropMarkClear.apply(box,args)||(t=profile.box._onDropMarkClear)&&!1===t.apply(profile.host||profile,args)||xui.resetRun("setDropFace",dd.setDropFace,0,[null],xui.DragDrop),(t=profile.box._onDragLeave)&&t.apply(profile.host||profile,args),profile.onDragLeave&&box.onDragLeave.apply(box,args),dd.setDropElement(null))}},beforeDrop:function(profile,e,src){var item,t,args,pp=xui.DragDrop.getProfile(),key=pp.dragKey,data=pp.dragData,box=profile.boxing();box.getItemByDom&&(item=box.getItemByDom(src)),args=[profile,e,src,key,data,item],profile.onDropMarkClear&&!1===box.onDropMarkClear.apply(box,args)||(t=profile.box._onDropMarkClear)&&t.apply(profile.host||profile,args),profile.beforeDrop&&!1===box.beforeDrop.apply(box,args)||((!profile.onDrop||profile.onDrop&&!1===box.onDrop.apply(box,args))&&profile.box._onDrop&&profile.box._onDrop.apply(profile.host||profile,args),profile.afterDrop&&box.afterDrop.apply(box,args))}},"all"),xui.merge(ch,{onmouseover:h2,onmouseout:h2,ondrop:h2,afterDrop:h2,beforeDrop:h2}),this},_draggable:function(key){var h2=xui.Event.$eventhandler,o=this.$Behaviors,v="KEY"==key?o:o[key]||(o[key]={}),handler=xui.$cache.UIKeyMapEvents,k2="KEY"==key?this.KEY:this.KEY+"-"+key,ch=handler[k2]||(handler[k2]={});return xui.merge(v,{beforeMousedown:function(profile,e,src){if("left"==xui.Event.getBtn(e)){var prop=profile.properties;if(!prop.disabled&&(prop.dragSortable||prop.dragKey)){if(profile.behavior.NoDraggableKeys){var sk=profile.getKey(xui.Event.getSrc(e).id||"").split("-")[1];if(sk&&-1!=xui.arr.indexOf(profile.behavior.NoDraggableKeys,sk))return}var t,pos=xui.Event.getPos(e),box=profile.boxing(),args=[profile,e,src];if(profile.onStartDrag&&!1===box.onStartDrag.apply(box,args));else if((t=profile.box._onStartDrag)&&!1===t.apply(profile.host||profile,args));else{var con=profile.box;xui.use(src).startDrag(e,{dragType:"icon",targetLeft:pos.left+12,targetTop:pos.top+12,dragCursor:"pointer",dragDefer:2,dragKey:con.getDragKey(profile,src),dragData:con.getDragData(profile,e,src)})}}}},beforeDragbegin:function(profile,e,src){xui.use(src).onMouseout(!0,{$force:!0}).onMouseup(!0)},beforeDragstop:function(profile,e,src){var t;profile.onDragStop&&profile.boxing().onDragStop(profile.e,src),(t=profile.box._onDragStop)&&t.apply(profile.host||profile,arguments)}},"all"),xui.merge(ch,{onmousedown:h2,ondragbegin:h2}),this},_adjustConW:function(profile,container,trigger,_adjust){var cols,containerWidth,prop=profile.properties;if((cols=prop.conLayoutColumns)||(cols=prop.conDockRelative?1:0),cols&&(containerWidth=profile._containerWidth=container.offsetWidth(),!_adjust||_adjust!=containerWidth)){var off,pw,w,pad=prop.conDockPadding,spc=prop.conDockSpacing,c=container.children(),l=c.size(),rowtotal=0,allCtrls=[],redoLastRow=function(pw,row,allCtrls){for(var rw,ww,prf,node,min,max,rowLen=row.length,colW=Math.floor(pw/rowLen),rowtotal=0,i=0;i<rowLen;i++)node=row[i][0],prf=row[i][1],min=row[i][2],max=row[i][3],i==rowLen-1?ww=prf.$forceu(Math.min(max,Math.max(min,pw-rowtotal))):(ww=prf.$forceu(rw=Math.min(max,Math.max(min,colW))),rowtotal+=rw),allCtrls.push([node,prf,ww,rw])};if(l){c.each((function(n,i,prf,p){n.id&&(prf=xui.$cache.profileMap[n.id])&&prf.Class&&prf.Class["xui.UIProfile"]&&("relative"!=(p=xui(n).css("position"))&&"static"!=p||xui(n).setInlineBlock())})),off=pad.left+pad.right+(cols-1)*spc.width,pw=containerWidth-off,w=Math.floor(pw/cols);var curCtrl,min,max,lastRow=[];c.each((function(n,i,prf,p,rw){n.id&&(prf=xui.$cache.profileMap[n.id])&&prf.Class&&prf.Class["xui.UIProfile"]&&("relative"!=(p=(curCtrl=xui(n)).css("position"))&&"static"!=p||prf&&(curCtrl.css({position:"relative",left:"auto",top:"auto",right:"auto",bottom:"auto","margin-left":(0===i?pad.left:spc.width)+"px","margin-top":(0===i?pad.top:spc.height)+"px"}),min=xui.CSS.$px(prf.properties.dockMinW)||0,max=xui.CSS.$px(prf.properties.dockMaxW)||pw+off,prf.$forceu(rw=Math.min(max,Math.max(min,w))),(rowtotal+=rw)>pw&&(redoLastRow(pw+(cols-lastRow.length)*spc.width,lastRow,allCtrls),lastRow=[],rowtotal=rw),lastRow.push([curCtrl,prf,min,max])))})),lastRow.length&&redoLastRow(pw+(cols-lastRow.length)*spc.width,lastRow,allCtrls);var i=0;for(l=allCtrls.length;i<l;i++)allCtrls[i][0].width(allCtrls[i][1].properties.width=allCtrls[i][2]),allCtrls[i][1]._conLayout=1;var checkScroll=function(profile,container){profile.destroyed||!profile._containerWidth||container.isEmpty()||profile._containerWidth!=container.scrollWidth()&&xui.UI._adjustConW(profile,container,profile,profile._containerWidth)};checkScroll(profile,container),xui.asyRun(checkScroll,0,[profile,container])}}},adjustData:function(profile,hashIn,hashOut,type){hashOut||(hashOut={});var i,o,box=profile.box,map=box.$tplWordMap||{},dm=box.$DataModel;for(i in hashIn)"$"!=i.charAt(0)&&"renderer"!=i&&hashIn.hasOwnProperty(i)&&!hashOut.hasOwnProperty(i)&&(hashOut[i]="string"==typeof(o=hashIn[i])&&map[i]?"html"==i?xui.adjustRes(o,0,1,!1,null,null,"sub"==type&&hashIn):xui.adjustRes(o,!0,!1,null,null,"sub"==type&&hashIn):o);"hidden"in hashIn&&(hashOut.hidden=hashIn.hidden);var ifc,itemFilter=hashIn.itemFilter||profile.$itemFilter;if(itemFilter&&(hashOut.hidden=!!itemFilter(hashIn,"adjustData",profile)),hashOut._itemDisplay=hashIn.hidden?"display:none;":"","disabled"in dm&&(hashOut.disabled=xui.isSet(hashOut.disabled)&&hashOut.disabled?"xui-ui-itemdisabled":""),"readonly"in dm&&(hashOut.readonly=xui.isSet(hashOut.readonly)&&hashOut.readonly?"xui-ui-itemreadonly":""),hashOut.imageDisplay=hashOut.imageClass||hashOut.image||hashOut.iconFontCode?"":"display:none",hashOut.iconFontCode){if(hashOut.imageClass){var arr=hashOut.imageClass.split(/\s+/);xui.filter(arr,(function(s){return!xui.builtinFontIcon[s]})),hashOut.imageClass=arr.join(" ")}}else hashOut.imageClass&&(arr=hashOut.imageClass.split(/\s+/),xui.arr.each(arr,(function(s){xui.builtinFontIcon[s]&&(ifc=xui.builtinFontIcon[s])}),null,!0),ifc&&xui.__iefix2&&(hashOut.iconFontCode=ifc,xui.filter(arr,(function(s){return!xui.builtinFontIcon[s]}))),hashOut.imageClass=arr.join(" ")),ifc||(hashOut.picClass="xui-css-innerimage",hashOut.image&&(hashOut.imageClass="xui-icon-placeholder",hashOut.backgroundImage="background-image:url("+hashOut.image+");"),hashOut.imagePos?hashOut.backgroundPosition="background-position:"+hashOut.imagePos+";":hashOut.image&&(hashOut.backgroundPosition="background-position:center;"),hashOut.imageBgSize?hashOut.backgroundSize="background-size:"+hashOut.imageBgSize+";":hashOut.image&&(hashOut.backgroundSize="background-size:initial;"),hashOut.imageRepeat?hashOut.backgroundRepeat="background-repeat:"+hashOut.imageRepeat+";":hashOut.image&&(hashOut.backgroundRepeat="background-repeat:no-repeat;"));return hashOut.iconFontSize&&(hashOut.iconFontSize="font-size:"+hashOut.iconFontSize+";"),!hashOut.image&&box.IMGNODE&&(hashOut.image=xui.ini.img_blank),(o=hashOut.renderer||hashIn.renderer)&&(hashOut.caption=xui.UI._applyRenderer(profile,o,hashIn,hashOut)),hashOut},_applyRenderer:function(profile,renderer,hashIn,hashOut){if(xui.isFun(renderer))return xui.adjustRes(renderer.call(profile,hashIn,hashOut));if(xui.isStr(renderer)){var obj,prf,alias,t,prop={},events={},adjustRenderer=function(hash,prop,events){if(hash){var mapReg=/^\s*([^>\s]+)?\s*>\s*([^>\s]+)\s*$/;xui.each(hash,(function(o,i){mapReg.test(i)&&(prop[i.replace(/^\s*>\s*/,"")]=o)})),xui.isHash(hash.ModuleProp)&&(prop=xui.merge(prop,hash.ModuleProp,"all")),xui.isHash(hash.ModuleEvents)&&(events=xui.merge(events,hash.ModuleEvents,"all")),prop.parentProp=hash}};if(/^\s*[\w]+\.[\w.]+\s*$/.test(renderer)&&(obj=xui.SC.get(renderer))&&(obj["xui.UI"]||obj["xui.Module"])){if(prf=(obj=new obj).get(0),alias=xui.get(hashOut,["tagVar","alias"])||prf.alias,hashIn&&(hashIn._render_xid=prf.$xid,hashIn._render_obj=prf,prf._render_conf=hashIn),prf._render_holder=profile,obj["xui.Module"]){var mp=new xui.UI.MoudluePlaceHolder;(prf=mp.get(0))._module=obj,obj=mp}else obj.setPosition&&obj.setPosition("relative"),obj.setDisplay&&obj.setDisplay("inline-block");return obj.setHost(profile.host,alias),hashIn!==profile.properties&&((t=profile.box._applyRendererEx)&&t.call(profile.box,profile,prop,events,hashOut,adjustRenderer),adjustRenderer(hashOut,prop,events)),adjustRenderer(hashOut.tagVar,prop,events),delete prop.renderer,xui.isEmpty(prop)||obj.setProperties(prop),xui.isEmpty(events)||obj.setEvents(events),(profile.$attached||(profile.$attached=[])).push(prf),obj.toHtml()}return xui.adjustVar(renderer,hashOut)}},$iconAction:function(profile,key,oldImageClass){var ifc,p=profile.properties,icon=profile.getSubNode(key||"ICON"),dispaly=p.imageClass||p.image||p.iconFontCode?"":"display:none";if(icon.css("backgroundImage","none"),icon.removeClass("xui-icon-placeholder"),p.imageClass&&icon.removeClass(p.imageClass),oldImageClass&&icon.removeClass(oldImageClass),icon.html(""),p.iconFontCode){if(icon.html(p.iconFontCode),p.imageClass){var arr=p.imageClass.split(/\s+/);xui.filter(arr,(function(s){return!xui.builtinFontIcon[s]})),icon.addClass(arr.join(" "))}}else p.imageClass&&(arr=p.imageClass.split(/\s+/),xui.arr.each(arr,(function(s){xui.builtinFontIcon[s]&&(ifc=xui.builtinFontIcon[s])}),null,!0),ifc&&xui.__iefix2&&(p.iconFontCode=ifc,xui.filter(arr,(function(s){return!xui.builtinFontIcon[s]}))),icon.addClass(arr.join(" "))),p.iconFontCode&&icon.html(p.iconFontCode),ifc||p.image&&(icon.addClass("xui-icon-placeholder"),icon.css("backgroundImage","url("+xui.adjustRes(p.image)+")"));icon.css("display",dispaly)},cacheData:function(key,obj){return xui.set(xui.$cache,["UIDATA",key],obj),this},getCachedData:function(key){var r=xui.get(xui.$cache,["UIDATA",key]);return"function"==typeof r&&(r=r()),r},Behaviors:{onSize:function(profile,e){var root=profile.getRootNode(),style=root&&root.style;style&&(e.width||e.height)&&xui.UI.$tryResize(profile,style.width,style.height)},HotKeyAllowed:!0,onContextmenu:function(profile,e,src){if(profile.onContextmenu)return!1!==profile.boxing().onContextmenu(profile,e,src)}},DataModel:{autoTips:!0,className:{ini:"",action:function(v,ov){ov&&this.getRoot().removeClass(ov),this.getRoot().addClass(v),delete this._nodeEmSize}},disableClickEffect:!1,disableHoverEffect:!1,disableTips:!1,disabled:{ini:!1,action:function(v){var i=this.getRoot();v?i.addClass("xui-ui-disabled"):i.removeClass("xui-ui-disabled")}},spaceUnit:{listbox:["","px","em"],action:function(){this.boxing().reLayout(!0).getChildren(!0,"penetrate").reLayout(!0)}},defaultFocus:!1,hoverPop:{ini:"",action:function(v,ov){var t,ns=this,b=ns.boxing(),p=ns.properties;!ns.destroyed&&ns.host&&(ov&&(t=ns.host[ov])&&(t=t.get(0))&&t.renderId&&!t.destroyed&&b.hoverPop(t,null),v&&(t=ns.host[v])&&(t=t.get(0))&&t.renderId&&!t.destroyed&&b.hoverPop(t,p.hoverPopType,(function(prf,node,e,src,item){if(t.properties.tagVar.hoverFrom=arguments,ns.beforeHoverPop)return ns.boxing().beforeHoverPop(prf,item,node,e,src)}),(function(prf,node,e,src,item){if(delete t.properties.tagVar.hoverFrom,ns.beforeHoverHide)return ns.boxing().beforeHoverHide(prf,item,node,e,src)}),t.getRoot().parent(),v))}},hoverPopType:{ini:"outer",dftWidth:180,listbox:["outer","outer_tb","outer_lr","inner","outerleft-outertop","left-outertop","center-outertop","right-outertop","outerright-outertop","outerleft-top","left-top","center-top","right-top","outerright-top","outerleft-middle","left-middle","center-middle","right-middle","outerright-middle","outerleft-bottom","left-bottom","center-bottom","right-bottom","outerright-bottom","outerleft-outerbottom","left-outerbottom","center-outerbottom","right-outerbottom","outerright-outerbottom"]},locked:{ini:!1,action:function(){this.$inDesign&&this.boxing().refresh(!0)}},dock:{ini:"none",listbox:["none","top","bottom","left","right","center","middle","origin","width","height","fill","cover"],action:function(v){xui.UI.$dock(this,!0,!0)}},dockIgnore:{ini:!1,action:function(v){"none"!=this.properties.dock&&xui.UI.$dock(this,!0,!0)}},dockFloat:{ini:!1,action:function(v){"none"!=this.properties.dock&&xui.UI.$dock(this,!0,!0)}},dockOrder:{hidden:!0},showEffects:"",hideEffects:"",dockMargin:{ini:{left:0,top:0,right:0,bottom:0},action:function(v){(v=v||{}).left=v.left||0,v.top=v.top||0,v.right=v.right||0,v.bottom=v.bottom||0,"none"!=this.properties.dock&&xui.UI.$dock(this,!0,!0)}},dockMinW:{$spaceunit:1,ini:0},dockMinH:{$spaceunit:1,ini:0},dockMaxW:{$spaceunit:1,ini:0},dockMaxH:{$spaceunit:1,ini:0},dockIgnoreFlexFill:{ini:!1,action:function(v){"none"!=this.properties.dock&&xui.UI.$dock(this,!0,!0)}},dockStretch:{ini:"",combobox:["fixed","forward","rearward","stretch","0.25","0.33","0.5"],set:function(value){var o=this,t=o.properties;t.dockStretch=value,"fill"!=t.dock&&"cover"!=t.dock&&"width"!=t.dock&&"height"!=t.dock||"forward"!=value&&"rearward"!=value&&"stretch"!=value&&(t.dockStretch="stretch"),o.rendered&&"none"!=t.dock&&xui.UI.$dock(o,!0,!0)}},tips:{ini:"",action:function(v){var t=xui.Tips;t&&t._showed&&xui.UIProfile.getFromDom(t._markId)==this&&t.setTips(v,!0)}},rotate:{ini:0,action:function(v){var root=this.getRoot(),ins=this.boxing();v=parseFloat(v)||0,(v%=360)<0&&(v+=360),this.box["xui.svg"]?ins.setAttr("KEY",{transform:"r"+v},!1):root.rotate(v)}},activeAnim:{ini:"",action:function(key){var okey,t;(okey=this._activeAnim)&&(xui.Thread.abort(okey),delete this._activeAnim),key&&(this._activeAnim=(t=this.boxing().animate(key))&&t.id)}}},EventHandlers:{beforeRender:function(profile){},onRender:function(profile){},onLayout:function(profile){},onResize:function(profile,width,height){},onMove:function(profile,left,top,right,bottom){},onDock:function(profile,region){},beforePropertyChanged:function(profile,name,value,ovalue){},afterPropertyChanged:function(profile,name,value,ovalue){},beforeAppend:function(profile,child){},afterAppend:function(profile,child){},beforeRemove:function(profile,child,subId,bdestroy){},afterRemove:function(profile,child,subId,bdestroy){},onDestroy:function(profile){},beforeDestroy:function(profile){},afterDestroy:function(profile){},onShowTips:function(profile,node,pos){},onContextmenu:function(profile,e,src,item){},beforeHoverPop:function(prf,item,node,e,src){},beforeHoverHide:function(prf,item,node,e,src){}},RenderTrigger:function(){var t,prf=this,b=prf.boxing(),p=prf.properties,style=prf.getRootNode().style;p.sandboxTheme&&xui.UI._refreshSBTheme(prf,p.sandboxTheme),prf.box._onresize&&(prf._syncResize||prf.box._syncResize||("hidden"!=(t=(style=prf.getRootNode().style).visibility)&&(prf._$visibility=t,style.visibility="hidden"),style=null),xui.UI.$tryResize(prf,p.width,p.height)),p.disabled&&b.setDisabled(!0,!0),p.rotate&&b.setRotate(p.rotate,!0),!prf.$inDesign&&p.hoverPop&&xui.asyRun((function(){b.setHoverPop(p.hoverPop,!0)})),prf.behavior.PanelKeys&&(t=p.dataBinder)&&b.setDataBinder(t,!0),p.activeAnim&&xui.asyRun((function(){prf&&!prf.destroyed&&prf.boxing().setActiveAnim(p.activeAnim,!0)})),(prf.$beforeDestroy=prf.$beforeDestroy||{}).activeAnim=function(t){(t=prf._activeAnim)&&xui.Thread.abort(t)},prf._inValid=1},$doResize:function(profile,w,h,force,key){if(force||(w||h)&&(profile._resize_w!=w||profile._resize_h!=h)){var con;if(!profile.getRootNode())return!1;if(profile._resize_w=w,profile._resize_h=h,xui.tryF(profile.box._onresize,[profile,w,h,force,key],profile.box),(force||w)&&profile.box&&profile.box["xui.absContainer"]&&(con=profile.getContainer(!0))){var ignore={};ignore[profile.$xid]=1,con.children().each((function(o,i,p){!((i=xui.UIProfile.getFromDom(o.id))&&i!==profile&&!ignore[i.$xid]&&i.children.length&&i.box&&i.box._onresize&&i.box.$Behaviors.PanelKeys&&i.box.$Behaviors.PanelKeys.length&&(p=i.properties)&&"position"in p&&"width"in p)||"static"!=p.position&&"relative"!=p.position||""!==p.width&&"auto"!=p.width||(ignore[i.$xid]=1,xui.UI.$doResize(i,xui(o).width(),null,force,key))}))}profile.onResize&&profile.boxing().onResize(profile,w,h)}if("_$visibility"in profile){var node=profile.getRootNode(),style=node.style;"visible"==style.visibility||xui.getNodeData(node,"_setVisibility")||(style.visibility=profile._$visibility),node=style=null,xui.clearTimeout(profile._$rs_timer),delete profile._$rs_timer,delete profile._$rs_args,delete profile._$visibility}},$tryResize:function(profile,w,h,force,key){var s=profile.box;if(s&&s._onresize&&(force||w||h))if(w=(""===w||"auto"==w?"auto":xui.isFinite(w)||profile.$isPx(w)?parseFloat(w)||0:w)||null,h=(""===h||"auto"==h?"auto":xui.isFinite(h)||profile.$isPx(h)?parseFloat(h)||0:h)||null,"_$visibility"in profile){var args=profile._$rs_args;args||(args=profile._$rs_args=[profile,null,null],profile._$rs_timer=xui.asyRun((function(){profile.box&&profile&&profile._$rs_args&&xui.UI.$doResize.apply(null,profile._$rs_args)}))),args[1]=w,args[2]=h,args[3]=force,args[4]=key}else xui.UI.$doResize(profile,w,h,force,key)},LayoutTrigger:function(){var self=this,p=(self.boxing(),self.properties);if(delete self._nodeEmSize,"absolute"==p.position){if(p.dock&&"none"!=p.dock){if(!self.$laidout){self.$laidout=1;var stl=self.getRootNode().style;switch(self.$picku(stl.width),self.$picku(stl.height),p.dock){case"top":case"bottom":case"width":stl.width=0;break;case"left":case"right":case"height":stl.height=0;break;default:stl.width=0,stl.height=0}}xui.UI.$dock(this,!1,!0)}}else(xui.get(self,["parent","properties","conDockRelative"])||xui.get(self,["parent","properties","conLayoutColumns"]))&&(self._conLayout||xui.resetRun("conLayoutColumns:"+self.parent.$xid,(function(){self._conLayout||self.destroyed||self.parent.destroyed||xui.UI._adjustConW(self.parent,self.getRoot().parent(),self)})))},$dock_args:["top","bottom","left","right","center","middle","width","height"],$dock_map:{middle:1,center:1},$dock:function(profile,force,trigger){var node=profile.getRoot(),isSVG=profile.box["xui.svg"],ins=profile.boxing(),i1=-1,i2=-1,i3=-1,i4=-1,p=xui(node.get(0)&&node.get(0).parentNode||profile.$dockParent),_adjust=function(v){return xui.browser.ie&&xui.browser.ver<=6?v-v%2:v},adjustOverflow=function(p,isWin){var f,t,c,x,y;if(isWin){if(xui.ini.$frame&&xui.ini.$frame.zoom&&!xui.isNumb(xui.ini.$frame.zoom))return;f=xui.win.$getEvent("onSize","dock")}else p&&p.get(0)&&(f=p.$getEvent("onSize","dock"));if(f&&f.dockall&&f.dockall.length)for(var i=0,l=f.dockall.length;i<l;i++)switch(f.dockall[i].$dockType){case"fill":case"cover":x=y=1;break;case"top":case"bottom":case"width":x=1;break;case"left":case"right":case"height":y=1}x&&y?c="xui-css-noscroll":x?c="xui-css-noscrollx":y&&(c="xui-css-noscrolly"),isWin?(xui("html").removeClass(/^xui-css-noscroll(x|y)?$/),(t=xui("body").get(0))&&(t.scroll=""),c&&(x&&xui.win.scrollLeft(0),y&&xui.win.scrollTop(0),xui("html").addClass(c),x&&y&&t&&(t.scroll="no"))):(p.removeClass(/^xui-css-noscroll(x|y)?$/),c&&(x&&p.scrollLeft(0),y&&p.scrollTop(0),p.addClass(c)))},checkLimits=function(profile,prop,dir,value){var t;return parseFloat(prop["dockMin"+dir])&&(t=profile.$px(prop["dockMin"+dir]))&&(value=_adjust(t<=value?value:t)),parseFloat(prop["dockMax"+dir])&&(t=profile.$px(prop["dockMax"+dir]))&&(value=_adjust(t<=value?t:value)),value},apply2Ctrl=function(profile,isSvg,ins,node,style,region){var us=xui.$us(profile),adjustunit=function(v){return profile.$forceu(v,us>0?"em":"px",null,!0)};"left"in region&&profile.$px(style.left)!==region.left&&(region.left=adjustunit(region.left)),"top"in region&&profile.$px(style.top)!==region.top&&(region.top=adjustunit(region.top)),"right"in region&&profile.$px(style.right)!==region.right&&(region.right=adjustunit(region.right)),"bottom"in region&&profile.$px(style.bottom)!==region.bottom&&(region.bottom=adjustunit(region.bottom)),"width"in region&&profile.$px(style.width)!==region.width&&(region.width=adjustunit(region.width)),"height"in region&&profile.$px(style.height)!==region.height&&(region.height=adjustunit(region.height)),xui.isEmpty(region)||(isSVG?ins._setBBox(region):node.cssRegion(region,!0))},applyPrevLine=function(obj,space,all,p2,p3,p4,p5){if(obj.prevLine.length){var size,t,l,region,nodefz,prop,pct=[],ll=obj.prevLine.length-1,preAll=0,start=obj[p4],css=xui.CSS;if(all-=ll*space,xui.arr.each(obj.prevLine,(function(n){n.pct?pct.push(n):all-=n.region[p2]+n.margin[p4]+n.margin[p5]})),l=pct.length){var pctSum=0;xui.arr.each(pct,(function(n,i){pctSum+=n.pct})),xui.arr.each(pct,(function(n,i){prop=n.prop,region=n.region,nodefz=n.nodefz,n.pct=n.pct/pctSum,size=all*n.pct-n.margin[p4]-n.margin[p5],parseFloat(prop[p3])&&(t=css.$px(prop[p3],nodefz))&&(size=_adjust(t<=size?t:size)),i==l-1?(size=all-preAll,parseFloat(prop[p3])&&(t=css.$px(prop[p3],nodefz))&&(size=_adjust(t<=size?t:size)),region[p2]=size):preAll+=region[p2]=parseInt(size,10)}))}xui.arr.each(obj.prevLine,(function(n,i){(region=n.region)[p4]=parseInt(start+n.margin[p4],10),start+=region[p2]+n.margin[p4]+n.margin[p5]+space,apply2Ctrl(n.profile,n.isSVG,n.ins,n.node,n.style,region)})),obj.prevLine=[]}};if(p.get(0)){var region,f,isWin,prop=profile.properties,us=xui.$us(profile),adjustunit=function(v,emRate){return profile.$forceu(v,us>0?"em":"px",emRate,!0)},margin=prop.dockMargin,auto="auto",value=prop.dock||"none",pid=xui.Event.getId(p.get(0)),order=function(x,y){return(x=parseInt(x.properties._dockOrder||x.properties.dockOrder,10)||0)>(y=parseInt(y.properties._dockOrder||y.properties.dockOrder,10)||0)?1:x==y?0:-1},rootfz=node._getEmSize(),umargin={top:adjustunit(margin.top||0,rootfz),left:adjustunit(margin.left||0,rootfz),right:adjustunit(margin.right||0,rootfz),bottom:adjustunit(margin.bottom||0,rootfz)};if(isSVG){var bbox=ins._getBBox();prop.left=bbox.x,prop.top=bbox.y,prop.width=bbox.width,prop.height=bbox.height}if(p.get(0)!==document.body&&p.get(0)!==document&&p.get(0)!==window||(pid="!document",isWin=!0),!pid||pid!=xui.Dom._ghostDivId&&!xui.str.startWith(pid,xui.Dom._emptyDivId)){if(profile.$dockParent!=pid||profile.$dockType!=value||force){switch(profile.$dockParent=pid,profile.$dockType=value,i1=profile.unLink("$dockall"),i2=profile.unLink("$dock"),i3=profile.unLink("$dock1"),i4=profile.unLink("$dock2"),value){case"middle":region={right:prop.right==auto?auto:prop.right||"",bottom:auto,left:prop.left==auto?auto:prop.left||"",width:prop.width||"",height:prop.height||""};break;case"center":region={right:auto,bottom:prop.bottom==auto?auto:prop.bottom||"",top:prop.top==auto?auto:prop.top||"",width:prop.width||"",height:prop.height||""};break;case"origin":region={right:auto,bottom:auto,width:prop.width||"",height:prop.height||""};break;case"top":region={left:umargin.left,right:umargin.right,bottom:auto,height:prop.height||""};break;case"bottom":region={left:umargin.left,right:umargin.right,top:auto,height:prop.height||""};break;case"left":region={right:auto,width:prop.width||""};break;case"right":region={left:auto,width:prop.width||""};break;case"width":region={bottom:auto,height:prop.height||"",top:prop.top||""};break;case"height":region={right:auto,width:prop.width||"",left:prop.left||""};break;case"fill":case"cover":region={right:auto,bottom:auto};break;case"none":region={left:prop.left,top:prop.top,width:prop.width||"",height:prop.height||""}}node.get(0)&&(isSVG?ins._setBBox(region):node.cssRegion(region,!0)),isWin&&(p=xui.win,xui.$cache._resizeTime||(xui.$cache._resizeTime=1)),"none"!=value&&((f=p.$getEvent("onSize","dock"))||((f=function(arg){var me=arguments.callee,css=xui.CSS,map=xui.UI.$dock_map,arr=xui.UI.$dock_args,rePos=me.rePos,pid=me.pid,isWin="!window"==me.pid||"!document"==me.pid,pprf=isWin?0:xui.UIProfile.getFromDom(pid),pprop=pprf&&pprf.properties,proot=pprf&&pprf.getRoot(),pstyle=proot&&proot.get(0)&&proot.get(0).style,prootfz=pstyle&&proot._getEmSize(),conDockSpacing=pprop&&"conDockSpacing"in pprop?pprop.conDockSpacing:{width:0,height:0},conDockPadding=pprop&&"conDockPadding"in pprop?pprop.conDockPadding:{left:0,top:0,right:0,bottom:0},conDockFlexFill=pprop&&"conDockFlexFill"in pprop?pprop.conDockFlexFill:"",conDockStretch=pprop&&"conDockStretch"in pprop?pprop.conDockStretch.split(/[,;\s]+/):[],perW="width"==conDockFlexFill||"both"==conDockFlexFill,perH="height"==conDockFlexFill||"both"==conDockFlexFill;if((node=isWin?xui.frame:xui(pid)).get(0)){var obj,i,k,o,key,target,hasCover,pn=node.get(0),style=pn.style,us=xui.$us(profile),nodefz=node._getEmSize(),adjustunit=function(v,emRate){return css.$forceu(v,us>0?"em":"px",emRate||nodefz)},ofs=isWin?xui("body").get(0).style:style,old_of=ofs.overflow,old_ofx=ofs.overflowX,old_ofy=ofs.overflowY;for(i in style&&(style.overflow=style.overflowX=style.overflowY="hidden"),me.dockall)if("cover"==me.dockall[i].$dockType){hasCover=1;break}var width=style&&css.$px(style.width,nodefz)||node.width()||0,height=style&&css.$px(style.height,nodefz)||node.height()||0,offsetH=hasCover?node.offsetHeight():height,offsetW=hasCover?node.offsetWidth():width;if("auto"==width&&(width=0),"auto"==height&&(height=0),style&&(style.overflow=old_of,style.overflowX=old_ofx,style.overflowY=old_ofy),conDockSpacing={width:css.$px(conDockSpacing.width||0,prootfz),height:css.$px(conDockSpacing.height||0,prootfz)},conDockPadding={left:css.$px(conDockPadding.left||0,prootfz),top:css.$px(conDockPadding.top||0,prootfz),right:css.$px(conDockPadding.right||0,prootfz),bottom:css.$px(conDockPadding.bottom||0,prootfz)},arg.$dockid||!isWin||xui.stamp()-xui.$cache._resizeTime>50){if((obj={left:conDockPadding.left,top:conDockPadding.top,right:conDockPadding.right,bottom:conDockPadding.bottom,width:width,height:height,offsetW:offsetW||width,offsetH:offsetH||height}).preX=obj.oX=obj.left,obj.preY=obj.oY=obj.top,obj.prevLine=[],obj.ww=obj.width-obj.left-obj.right,obj.hh=obj.height-obj.top-obj.bottom,obj.leftHolder=obj.topHolder=obj.rightHolder=obj.bottomHolder=0,perW||perH){var innerH,innerW,wCount=0,wSum=0,hCount=0,hSum=0,hMax=0,adjustMM=function(prf,direction,numb,prop,t){return prop=prf.properties,parseFloat(t=prop["dockMin"+direction])&&(numb=Math.max(prf.$px(t),numb)),parseFloat(t=prop["dockMax"+direction])&&(numb=Math.min(prf.$px(t),numb)),numb},originalSize=function(prf,dir){return parseFloat(prf.$px(prf.properties[dir]))||0};for(k=0;key=arr[k++];)if((target=me[key]).length)for(i=0;o=target[i++];)if(!("absolute"!=o.properties.position||o.properties.dockIgnore||o._dockIgnore||o.properties.dockIgnoreFlexFill)){var node=o.getRoot();!perW||"left"!=key&&"right"!=key&&"width"!=key||(wCount++,wSum+=adjustMM(o,"W",originalSize(o,"width")),"fill"!=o.properties.dock&&(hMax=Math.max(hMax,adjustMM(o,"H",originalSize(o,"height"))))),!perH||"top"!=key&&"bottom"!=key&&"height"!=key||(hCount++,hSum+=adjustMM(o,"H",originalSize(o,"height")))}if(hSum&&hMax&&(hSum+=hMax),hCount>=1&&hSum&&obj.height)for(innerH=obj.height-conDockPadding.top-conDockPadding.bottom-(hCount-1)*conDockSpacing.height,k=0;key=arr[k++];)if((target=me[key]).length){for(i=0;o=target[i++];)"absolute"!=o.properties.position||o.properties.dockIgnore||o._dockIgnore||!o.properties.dockIgnoreFlexFill||(node=o.getRoot(),"top"!=key&&"bottom"!=key&&"height"!=key||(innerH-=adjustMM(o,"H",originalSize(o,"height")),innerH-=conDockSpacing.height));for(i=0;o=target[i++];)"absolute"!=o.properties.position||o.properties.dockIgnore||o._dockIgnore||o.properties.dockIgnoreFlexFill||(node=o.getRoot(),"top"!=key&&"bottom"!=key&&"height"!=key||node.height(adjustunit(adjustMM(o,"H",Math.min(1,originalSize(o,"height")/hSum)*innerH))))}if(wCount>=1&&wSum&&obj.width)for(innerW=obj.width-conDockPadding.left-conDockPadding.right-(wCount-1)*conDockSpacing.width,k=0;key=arr[k++];)if((target=me[key]).length){for(i=0;o=target[i++];)"absolute"!=o.properties.position||o.properties.dockIgnore||o._dockIgnore||!o.properties.dockIgnoreFlexFill||(node=o.getRoot(),"left"!=key&&"right"!=key&&"width"!=key||(innerW-=adjustMM(o,"W",originalSize(o,"width")),innerH-=conDockSpacing.width));for(i=0;o=target[i++];)"absolute"!=o.properties.position||o.properties.dockIgnore||o._dockIgnore||o.properties.dockIgnoreFlexFill||(node=o.getRoot(),"left"!=key&&"right"!=key&&"width"!=key||node.width(adjustunit(adjustMM(o,"W",Math.min(1,originalSize(o,"width")/wSum)*innerW))))}pprf&&perW&&(pprf._conDockFlexFillW=1),pprf&&perH&&(pprf._conDockFlexFillH=1)}if("both"!=conDockFlexFill)for(k=0;key=arr[k++];)if((target=me[key]).length)for(i=0;o=target[i++];)"absolute"!=o.properties.position||o.properties.dockIgnore||o._dockIgnore||o.properties.dockIgnoreFlexFill||(node=o.getRoot(),!pprf||!pprf._conDockFlexFillW||perW||"left"!=key&&"right"!=key&&"width"!=key||node.width(adjustunit(o.properties.width)),!pprf||!pprf._conDockFlexFillH||perH||"top"!=key&&"bottom"!=key&&"height"!=key||node.height(adjustunit(o.properties.height)));for(pprf&&pprf._conDockFlexFillW&&delete pprf._conDockFlexFillW,pprf&&pprf._conDockFlexFillH&&delete pprf._conDockFlexFillH,k=0;key=arr[k++];){obj.preX=obj.oX,obj.preY=obj.top;var ll,ii=0;if(ll=(target=me[key]).length)for(map[key]||(arg.width=arg.height=1),i=0;o=target[i++];)"absolute"!=o.properties.position||o.properties.dockIgnore||o._dockIgnore||rePos(o,ii++,ll,obj,key,arg.$dockid,isWin||arg.width,isWin||arg.height,conDockSpacing.width,conDockSpacing.height,conDockStretch)}for(obj.later&&xui.each(obj.later,(function(o){var profile;try{o.isSVG?o.ins._setBBox(o):o.node.cssRegion(o,!0),(profile=xui.UIProfile.getFromDom(o.node.get(0)))&&(delete o.node,profile.box._onresize||!profile.onResize||null===o.width&&null===o.height||profile.boxing().onResize(profile,o.width,o.height),profile.onDock&&profile.boxing().onDock(profile,o),profile.$onDock&&profile.$onDock(profile,o))}catch(e){xui.asyRun((function(){if(o.node){var ow=o.width,oh=o.height;o.width=(parseFloat(o.width)||0)+1+xui.CSS.$picku(o.width),o.height=(parseFloat(o.width)||0)+1+xui.CSS.$picku(o.height),o.isSVG?o.ins._setBBox(o):o.node.cssRegion(o),o.width=ow,o.height=oh,o.isSVG?o.ins._setBBox(o):o.node.cssRegion(o,!0),(profile=xui.UIProfile.getFromDom(o.node.get(0)))&&(delete o.node,profile.box._onresize||!profile.onResize||null===o.width&&null===o.height||profile.boxing().onResize(profile,o.width,o.height),profile.onDock&&profile.boxing().onDock(profile,o),profile.$onDock&&profile.$onDock(profile,o))}}))}})),k=0;key=arr[k++];)if((target=me[key]).length)for(i=0;o=target[i++];)"absolute"!=o.properties.position||o.properties.dockIgnore||o._dockIgnore||obj.later&&obj.later[o.$xid]||(o.onDock&&o.boxing().onDock(o),o.$onDock&&o.$onDock(o));isWin&&(xui.$cache._resizeTime=xui.stamp())}me=rePos=node=style=null}}).pid=pid,xui.arr.each(xui.UI.$dock_args,(function(key){f[key]=[]})),f.dockall=[],f.rePos=function(profile,index,ll,obj,value,id,w,h,spaceW,spaceH,conDockStretch){var flag=!1;id&&profile.$xid!=id&&(flag=!0);var sStart,sEnd,noStretch,pct,isCover,left,top,right,bottom,temp,bbox,prop=profile.properties,css=xui.CSS,flt=prop.dockFloat,margin=prop.dockMargin,stretch=prop.dockStretch,node=profile.getRoot(),ins=profile.boxing(),style=node.get(0).style,us=xui.$us(profile),nodefz=node._getEmSize(),adjustunit=function(v){return css.$forceu(v,us>0?"em":"px",nodefz)},x=css.$px(prop._dockBorderWidth,nodefz)||0,y=css.$px(prop._dockBorderHeight,nodefz)||0,isSVG=profile.box["xui.svg"];if(margin.top=css.$px(margin.top,nodefz),margin.left=css.$px(margin.left,nodefz),margin.right=css.$px(margin.right,nodefz),margin.bottom=css.$px(margin.bottom,nodefz),isSVG&&(bbox=ins._getBBox(),prop.left=bbox.x,prop.top=bbox.y,prop.width=bbox.width,prop.height=bbox.height),"none"!=style.display){switch(value){case"middle":case"center":sStart=sEnd=0;break;default:switch(stretch=stretch||("width"==value||"height"==value?"":conDockStretch[index%conDockStretch.length])||"stretch","width"!=value&&"height"!=value||"stretch"!=stretch&&"forward"!=stretch&&"rearward"!=stretch&&(stretch="stretch"),stretch){case"stretch":sStart=1,sEnd=1,noStretch=0;break;case"forward":sStart=1,sEnd=0,noStretch=0;break;case"rearward":sStart=0,sEnd=1,noStretch=0;break;case"fixed":noStretch=1;break;default:noStretch=1,pct=Math.min(1,Math.max(0,parseFloat(stretch)||0))}}switch(isCover="cover"==prop.dock,value){case"middle":isSVG?ins.setTop(Math.max(0,(obj.height-bbox.height)/2)):node.top(adjustunit(Math.max(0,(obj.height-node.height())/2)));break;case"center":isSVG?ins.setLeft(Math.max(0,(obj.width-bbox.width)/2)):node.left(adjustunit(Math.max(0,(obj.width-node.width())/2)));break;case"top":flag||(noStretch?(temp=pct?parseFloat(obj.ww*pct)||0:_adjust(isSVG?bbox.width:css.$px(prop.width,nodefz))+margin.left+margin.right,pct&&(temp=checkLimits(profile,prop,"W",(temp-=spaceW)-margin.left-margin.right)+margin.left+margin.right),obj.preX+temp-obj.oX>obj.ww&&(obj.top+=obj.topHolder,obj.topHolder=0,obj.preX=obj.oX,applyPrevLine(obj,spaceW,obj.ww,"width","dockMaxW","left","right")),obj.prevLine.push({profile:profile,prop:prop,node:node,style:style,isSVG:isSVG,ins:ins,pct:pct,margin:margin,region:{top:obj.top+margin.top,width:temp}}),obj.preX+=temp+spaceW,obj.topHolder=Math.max(obj.topHolder,(isSVG?bbox.height:node.offsetHeight())+margin.top+margin.bottom+spaceH)):(applyPrevLine(obj,spaceW,obj.ww,"width","dockMaxW","left","right"),obj.topHolder&&(obj.top+=obj.topHolder,obj.preX=obj.oX),left=sStart?(flt?0:obj.left)+margin.left:css.$px(prop.left,nodefz),right=sEnd?(flt?0:obj.right)+margin.right:obj.width-css.$px(prop.width,nodefz)-css.$px(prop.left,nodefz),top=(flt?0:obj.top)+margin.top,temp=checkLimits(profile,prop,"W",obj.width-left-right-x),apply2Ctrl(profile,0,ins,node,style,{left:left,top:top,width:_adjust(temp)}),flt||(obj.top+=(isSVG?bbox.height:node.offsetHeight())+margin.top+margin.bottom+spaceH)),ll==index+1&&applyPrevLine(obj,spaceW,obj.ww,"width","dockMaxW","left","right"));break;case"bottom":flag||(noStretch?(temp=pct?parseFloat(obj.ww*pct)||0:_adjust(isSVG?bbox.width:css.$px(prop.width,nodefz))+margin.left+margin.right,pct&&(temp=checkLimits(profile,prop,"W",(temp-=spaceW)-margin.left-margin.right)+margin.left+margin.right),obj.preX+temp-obj.oX>obj.ww&&(obj.bottom+=obj.bottomHolder,obj.bottomHolder=0,obj.preX=obj.oX,applyPrevLine(obj,spaceW,obj.ww,"width","dockMaxW","left","right")),obj.prevLine.push({profile:profile,prop:prop,node:node,style:style,isSVG:isSVG,ins:ins,pct:pct,margin:margin,region:{bottom:obj.bottom+margin.bottom,width:temp}}),obj.preX+=temp+spaceW,obj.bottomHolder=Math.max(obj.bottomHolder,(isSVG?bbox.height:node.offsetHeight())+margin.top+margin.bottom+spaceH)):(applyPrevLine(obj,spaceW,obj.ww,"width","dockMaxW","left","right"),obj.bottomHolder&&(obj.bottom+=obj.bottomHolder,obj.bottomHolder=0,obj.preX=obj.oX),left=sStart?(flt?0:obj.left)+margin.left:css.$px(prop.left,nodefz),right=sEnd?(flt?0:obj.right)+margin.right:obj.width-css.$px(prop.width,nodefz)-css.$px(prop.left,nodefz),bottom=(flt?0:obj.bottom)+margin.bottom,temp=checkLimits(profile,prop,"W",obj.width-left-right),apply2Ctrl(profile,0,ins,node,style,{left:left,bottom:bottom,width:_adjust(temp)}),flt||(obj.bottom+=(isSVG?bbox.height:node.offsetHeight())+margin.top+margin.bottom+spaceH)),ll==index+1&&applyPrevLine(obj,spaceW,obj.ww,"width","dockMaxW","left","right"));break;case"left":if(!flag){if(obj.topHolder&&(obj.top+=obj.topHolder+spaceH,obj.topHolder=0,obj.oY=obj.preY=obj.top),obj.bottomHolder&&(obj.bottom+=obj.bottomHolder+spaceH,obj.bottomHolder=0),obj.hh=obj.height-obj.top-obj.bottom,obj.hh<=0)return;noStretch?(temp=pct?parseFloat(obj.hh*pct)||0:_adjust(isSVG?bbox.height:css.$px(prop.height,nodefz))+margin.top+margin.bottom,pct&&(temp=checkLimits(profile,prop,"H",(temp-=spaceH)-margin.top-margin.bottom)+margin.top+margin.bottom),obj.preY+temp-obj.oY>obj.hh&&(obj.left+=obj.leftHolder,obj.leftHolder=0,obj.preY=obj.oY,applyPrevLine(obj,spaceH,obj.hh,"height","dockMaxH","top","bottom")),obj.prevLine.push({profile:profile,prop:prop,node:node,style:style,isSVG:isSVG,ins:ins,pct:pct,margin:margin,region:{left:obj.left+margin.left,height:temp}}),obj.preY+=temp+spaceH,obj.leftHolder=Math.max(obj.leftHolder,(isSVG?bbox.width:node.offsetWidth())+margin.left+margin.right+spaceW)):(applyPrevLine(obj,spaceW,obj.hh,"height","dockMaxH","top","bottom"),obj.leftHolder&&(obj.left+=obj.leftHolder,obj.leftHolder=0,obj.preY=obj.top),left=(flt?0:obj.left)+margin.left,top=sStart?(flt?0:obj.top)+margin.top:css.$px(prop.top,nodefz),bottom=sEnd?(flt?0:obj.bottom)+margin.bottom:obj.height-css.$px(prop.height,nodefz)-css.$px(prop.top,nodefz),temp=checkLimits(profile,prop,"H",obj.height-top-bottom-y),apply2Ctrl(profile,0,ins,node,style,{left:left,top:top,height:_adjust(temp)}),flt||(obj.left+=(isSVG?bbox.width:node.offsetWidth())+margin.left+margin.right+spaceW)),ll==index+1&&applyPrevLine(obj,spaceW,obj.hh,"height","dockMaxH","top","bottom")}break;case"right":if(!flag){if(obj.topHolder&&(obj.top+=obj.topHolder,obj.topHolder=0,obj.oY=obj.preY=obj.top),obj.bottomHolder&&(obj.bottom+=obj.bottomHolder,obj.bottomHolder=0),obj.hh=obj.height-obj.top-obj.bottom,obj.hh<=0)return;noStretch?(temp=pct?parseFloat(obj.hh*pct)||0:_adjust(isSVG?bbox.height:css.$px(prop.height,nodefz))+margin.top+margin.bottom,pct&&(temp=checkLimits(profile,prop,"H",(temp-=spaceH)-margin.top-margin.bottom)+margin.top+margin.bottom),obj.preY+temp-obj.oY>obj.hh&&(obj.right+=obj.rightHolder,obj.rightHolder=0,obj.preY=obj.oY,applyPrevLine(obj,spaceH,obj.hh,"height","dockMaxH","top","bottom")),obj.prevLine.push({profile:profile,prop:prop,node:node,style:style,isSVG:isSVG,ins:ins,pct:pct,margin:margin,region:{right:obj.right+margin.right,height:temp}}),obj.preY+=temp+spaceH,obj.rightHolder=Math.max(obj.rightHolder,(isSVG?bbox.width:node.offsetWidth())+margin.left+margin.right+spaceW)):(applyPrevLine(obj,spaceW,obj.hh,"height","dockMaxH","top","bottom"),obj.rightHolder&&(obj.right+=obj.rightHolder,obj.rightHolder=0,obj.preY=obj.top),right=(flt?0:obj.right)+margin.right,top=sStart?(flt?0:obj.top)+margin.top:css.$px(prop.top,nodefz),bottom=sEnd?(flt?0:obj.bottom)+margin.bottom:obj.height-css.$px(prop.height,nodefz)-css.$px(prop.top,nodefz),temp=checkLimits(profile,prop,"H",obj.height-top-bottom-y),apply2Ctrl(profile,0,ins,node,style,{right:right,top:top,height:_adjust(temp)}),flt||(obj.right+=(isSVG?bbox.width:node.offsetWidth())+margin.left+margin.right+spaceW)),ll==index+1&&applyPrevLine(obj,spaceW,obj.hh,"height","dockMaxH","top","bottom")}break;case"width":if(!w)return;obj.leftHolder&&(obj.left+=obj.leftHolder,obj.leftHolder=0),obj.rightHolder&&(obj.right+=obj.rightHolder,obj.rightHolder=0),left=sStart?(isCover||flt?0:obj.left)+margin.left:css.$px(prop.left,nodefz),right=sEnd?(isCover||flt?0:obj.right)+margin.right:obj.width-css.$px(prop.width,nodefz)-css.$px(prop.left,nodefz),top="width"==prop.dock?css.$px(prop.top,nodefz)||0:sStart?(isCover||flt?0:obj.top)+margin.top:css.$px(prop.top,nodefz),temp=checkLimits(profile,prop,"W",(isCover?obj.offsetW:obj.width)-left-right-x),obj.later=obj.later||{},obj.later[profile.$xid]=obj.later[profile.$xid]||{},xui.merge(obj.later[profile.$xid],{isSVG:isSVG,ins:ins,node:node,width:adjustunit(temp),left:adjustunit(left),top:adjustunit(top)},"all");break;case"height":if(!h)return;obj.topHolder&&(obj.top+=obj.topHolder,obj.topHolder=0,obj.preX=obj.oX),obj.bottomHolder&&(obj.bottom+=obj.bottomHolder,obj.bottomHolder=0,obj.preX=obj.oX),top=sStart?(isCover||flt?0:obj.top)+margin.top:css.$px(prop.top,nodefz),bottom=sEnd?(isCover||flt?0:obj.bottom)+margin.bottom:obj.height-css.$px(prop.height,nodefz)-css.$px(prop.top,nodefz),left="height"==prop.dock?css.$px(prop.left,nodefz)||0:sStart?(isCover||flt?0:obj.left)+margin.left:css.$px(prop.left,nodefz),temp=checkLimits(profile,prop,"H",(isCover?obj.offsetH:obj.height)-top-bottom-y),obj.later=obj.later||{},obj.later[profile.$xid]=obj.later[profile.$xid]||{},xui.merge(obj.later[profile.$xid],{isSVG:isSVG,ins:ins,node:node,height:adjustunit(temp),left:adjustunit(left),top:adjustunit(top)},"all")}}},p.onSize(f,"dock")),"fill"==value||"cover"==value?(profile.link(f.height,"$dock1",null,i3),profile.link(f.width,"$dock2",null,i4),xui.arr.stableSort(f.height,order),xui.arr.stableSort(f.width,order)):"origin"==value?(profile.link(f.center,"$dock1",null,i3),profile.link(f.middle,"$dock2",null,i4)):(profile.link(f[value],"$dock",null,i2),xui.arr.stableSort(f[value],order)),profile.link(f.dockall,"$dockall",null,i1),xui.$cache._resizeTime=1,profile.$dockFun=f),adjustOverflow(p,isWin),"none"!=value?(profile.$beforeDestroy=profile.$beforeDestroy||{}).releaseDock=function(){profile.unLink("$dockall"),profile.unLink("$dock"),profile.unLink("$dock1"),profile.unLink("$dock2"),adjustOverflow(p,isWin),p&&p.get(0)&&(p=xui.UIProfile.getFromDom(p.id()))&&(p.boxing().adjustDock(),xui.tryF(p.clearCache,[],p)),profile=p=null}:profile.$beforeDestroy&&delete profile.$beforeDestroy.releaseDock}trigger&&p.onSize()}}},_beforeSerialized:function(profile){var t,r,df1,df2,o={};xui.merge(o,profile,"all");var p=o.properties=xui.clone(profile.properties,!0),ds=o.box.$DataStruct,dm=o.box.$DataModel;for(var i in xui.UI.$ps)i in p&&""===p[i]&&(p[i]="auto");for(var i in dm)df1=xui.UI[o.$inDesign?"__resetDftProp_in_Desinger":"__resetDftProp"],((df2=o.box[o.$inDesign?"__resetDftProp_in_Desinger":"__resetDftProp"])&&i in df2?df2[i]:df1&&i in df1?df1[i]:dm[i].ini)===p[i]?delete p[i]:dm[i]&&dm[i].$spaceunit&&(0!==dm[i].ini&&"0"!==dm[i].ini&&"0px"!==dm[i].ini&&"0em"!==dm[i].ini||0!==p[i]&&"0"!==p[i]&&"0px"!==p[i]&&"0em"!==p[i]?dm[i].ini+(xui.isFinite(dm[i].ini)?"px":"")==p[i]+(xui.isFinite(p[i])?"px":"")?delete p[i]:"auto"!=p[i]&&(t=xui.$us(o),p[i]=profile.$forceu(p[i],2==t?"em":-2==t?"px":null)):delete p[i]);if("absolute"==p.position)switch(p.dock){case"top":case"bottom":delete p.top,delete p.bottom,delete p.right;break;case"left":case"right":delete p.left,delete p.right,delete p.bottom}for(var i in xui.UI.$ps)i in p&&xui.isNaN(p[i])&&delete p[i];for(var i in p.items&&p.items.length&&(t=xui.absObj.$specialChars,p.items=xui.clone(p.items,(function(o,i,d){return!t[((1===d?o.id:i)+"").charAt(0)]&&o!=undefined}))),p.tagCmds&&p.tagCmds.length&&(t=xui.absObj.$specialChars,p.tagCmds=xui.clone(p.tagCmds,(function(o,i,d){return!t[((1===d?o.id:i)+"").charAt(0)]&&o!=undefined}))),profile.box._objectProp)i in p&&p[i]&&(xui.isHash(p[i])||xui.isArr(p[i]))&&xui.isEmpty(p[i])&&delete p[i];return(i="tagVar")in p&&p[i]&&xui.isHash(p[i])&&xui.isEmpty(p[i])&&delete p[i],xui.arr.each(["dockMargin","conDockPadding","conDockSpacing","sandboxTheme","propBinder"],(function(key){if(t=p[key]){if(!xui.isHash(t))return;for(var i in r=ds[key],t)if(r[i]!==t[i])return;delete p[key]}})),xui.isEmpty(p.resizerProp)&&delete p.resizerProp,p.items&&(0==p.items.length||p.listKey)&&delete p.items,p.tagCmds&&(0==p.tagCmds.length||p.listKey)&&delete p.tagCmds,o},getDropKeys:function(profile,node){return profile.properties.dropKeys},getDragKey:function(profile,node){return profile.properties.dragKey||profile.properites.dragSortable&&profile.key+":"+profile.$xid},getDragData:function(profile,event,node){return{profile:profile,domId:xui.use(node).id(),data:profile.onGetDragData?profile.boxing().onGetDragData(profile,event,node):null}},_prepareData:function(profile,data){var prop=profile.properties,dm=this.$DataModel,me=arguments.callee,map=me.map||(me.map=xui.toArr("left,top,bottom,right,width,height")),a=[],box=profile.box,ajd=profile.box.adjustData;data=data||{},prop.id&&delete prop.id,"required"in dm&&(prop._required=prop.required?"xui-required":"",prop._requiredfld=prop.required?"xui-required-field":""),"nodeName"in dm&&!prop.nodeName&&(prop.nodeName="xui"),"caption"in dm&&null!==prop.caption&&(prop.caption=prop.caption===undefined?profile.alias:prop.caption),"html"in dm&&prop.html&&(data.html=xui.adjustRes(prop.html,0,1)),"src"in dm&&prop.src&&(data.src=xui.adjustRes(prop.src,0,1)),xui.each(prop,(function(o,i){dm[i]&&dm[i].$spaceunit&&xui.$us(profile)>0&&(0===prop[i]||"0"==prop[i]?prop[i]="0em":0!==prop[i]&&"0"!=prop[i]||(prop[i]="0px"))})),"$hborder"in dm&&dm.$hborder&&(profile.$isEm(prop.width)?data.bWidth=profile.$px2em(profile.$em2px(prop.width)-2*prop.$hborder,null,!0)+"em":data.bWidth=(parseFloat(prop.width)||0)-2*prop.$hborder),"$vborder"in dm&&dm.$vborder&&(profile.$isEm(prop.height)?data.bHeight=profile.$px2em(profile.$em2px(prop.height)-2*prop.$vborder,null,!0)+"em":data.bHeight=(parseFloat(prop.height)||0)-2*prop.$vborder);for(var i,j=0;i=map[j];j++){var t;((t=i in data?data[i]:prop[i])||0===t)&&"auto"!=t&&(a[a.length]=i+":"+profile.$addu(t))}return prop.position&&(a[a.length]="position:"+prop.position),prop.visibility&&(a[a.length]="visibility:"+prop.visibility),"zIndex"in prop&&(a[a.length]="z-index:"+prop.zIndex),prop.display&&(a[a.length]="inline-block"==prop.display?"display:"+xui.$inlineBlock.join("; display:")+";":"display:"+prop.display),data._style=a.join(";")+";",box.$Behaviors.PanelKeys&&!box["xui.absList"]&&(a=[],prop.panelBgClr&&(a[a.length]="background-color:"+prop.panelBgClr),prop.panelBgImg&&(a[a.length]="background-image:url("+xui.adjustRes(prop.panelBgImg)+")"),prop.panelBgImgPos&&(a[a.length]="background-position:"+prop.panelBgImgPos),prop.panelBgImgRepeat&&(a[a.length]="background-repeat:"+prop.panelBgImgRepeat),prop.panelBgImgAttachment&&(a[a.length]="background-attachment:"+prop.panelBgImgAttachment),data._panelstyle=a.join(";")),"className"in dm&&(data._className=prop.className||""),"readonly"in dm&&(data.readonly=prop.readonly?"xui-ui-readonly":""),"href"in dm&&(data.href=prop.href||xui.$DEFAULTHREF),"tabindex"in dm&&(data.tabindex=prop.tabindex||"-1"),"items"in dm&&(profile.ItemIdMapSubSerialId={},profile.SubSerialIdMapItem={},prop.items=profile.box._adjustItems(prop.items),data.items=this._prepareItems(profile,prop.items)),"selectable"in dm&&(data._selectable=xui.browser.ie&&xui.browser.ver<10?"":prop.selectable?"xui-ui-selectable":"xui-ui-unselectable"),data=ajd(profile,prop,data),profile.prepared=!0,data},_prepareInlineObj:function(profile,item,tabindex){var obj=item.object;if((obj=obj["xui.absBox"]?obj.get(0):obj["xui.UIProfile"]?obj:xui.create(obj).get(0)).destroyed)return null;if(obj["xui.UIProfile"]){obj.properties.position="relative","tabindex"in obj.properties&&(obj.properties.tabindex=tabindex);var cck=obj.CC.KEY||(obj.CC.KEY="");-1===cck.indexOf("xui-inline-object")&&(obj.CC.KEY=cck+" xui-inline-object")}return item._inline_xid=obj.$xid,item._inline_obj=obj,obj._inline_conf=item,obj._inline_holder=profile,!obj.alias||obj.host&&obj.host!==obj||obj.boxing().setHost(profile.host,obj.alias),(profile.$attached||(profile.$attached=[])).push(obj),obj},_prepareItems:function(profile,items,pid,mapCache,serialId){var item,dataItem,id,result=[],SubID=xui.UI.$tag_subId,prop=profile.properties,tabindex=prop.tabindex,ajd=profile.box.adjustData,itemFilter=profile.$itemFilter;itemFilter&&itemFilter("begin","prepareItem",profile);for(var i=0,l=items.length;i<l;i++)xui.isHash(items[i])||(xui.isArr(items[i])?(items[i]={id:items[i][0]},items.length>1&&(items[i].caption=items[i][1])):items[i]={id:items[i]}),"?"===items[i].id&&(items[i].id=xui.rand()),item=items[i],profile.beforePrepareItem&&!1===profile.boxing().beforePrepareItem(profile,item,pid,mapCache,serialId)||(item.hasOwnProperty("caption")||(item.caption=item.id),dataItem={id:item.id},xui.isSet(pid)&&(dataItem._pid=pid),dataItem.renderer=item.renderer||prop.renderer,id=dataItem[SubID]="string"==typeof serialId?serialId:profile.pickSubId("items"),!1!==mapCache&&(profile.ItemIdMapSubSerialId[item.id]=id,profile.SubSerialIdMapItem[id]=item),item.object?dataItem.object=this._prepareInlineObj(profile,item,tabindex):(dataItem._tabindex=tabindex,ajd(profile,item,dataItem,"sub"),this._prepareItem&&this._prepareItem(profile,dataItem,item,pid,i,l,mapCache,serialId)),result.push(dataItem));return itemFilter&&itemFilter("end","prepareItem",profile),result},_showTips:function(profile,node,pos){if(!profile.properties.disableTips)return profile.onShowTips?profile.boxing().onShowTips(profile,node,pos):void 0}}}),xui.Class("xui.absList","xui.absObj",{Instance:{activate:function(){var items=this.get(0).getSubNode("ITEM",!0);return items.isEmpty()||items.focus(!0),this},insertItems:function(arr,base,before,all){var node,arr2,items,index,r,t,k,prop,data,box,ns=this,b=ns._afterInsertItems;return this.each((function(profile){if(box=profile.box,arr2=box._adjustItems(arr),prop=profile.properties,!0===base&&((v=prop.$UIvalue||prop.value)&&(v=(v+"").split(prop.valueSeparator)),k=profile.getItemByItemId(v[0]),base=k?k.id:null),items=profile.properties.items,index=xui.arr.subIndexOf(items,"id",base),profile.renderId){if(data=box._prepareItems(profile,arr2),r=profile._buildItems("items",data),profile.$attached){for(var v,i=0;v=profile.$attached[i++];)v._render&&v._render(!0),(t=v._render_holder||v._inline_holder)&&t.$afterAttached?xui.tryF(t.$afterAttached,[v],t):xui.tryF(ns.$afterAttached,[v],ns);delete profile.$attached}-1==index?(node=profile.getSubNode(box._ITEMSKEY||profile.keys.ITEMS||profile.keys.KEY),before?node.prepend(r):node.append(r)):(node=profile.getSubNodeByItemId(box._ITEMKEY||"ITEM",base),before?node.addPrev(r):node.addNext(r))}if(-1==index?xui.arr.insertAny(items,arr2,before?0:-1):xui.arr.insertAny(items,arr2,before?index:index+1),b&&profile.boxing()._afterInsertItems(profile,data,base,before),profile.$itemFilter){var hideItems=[];xui.arr.each(arr,(function(item){if(item.sub&&!item.hidden)if(!0!==profile.$itemFilter(item,"checkSub",profile)){for(var flag,i=0,l=item.sub.length;i<l;i++)if(!item.sub[i].hidden){flag=1;break}flag||hideItems.push(item.id)}else hideItems.push(item.id)})),hideItems.length&&ns.showItems(hideItems,!1)}}))},removeItems:function(arr,key,purgeNow){var obj,v,b=this._afterRemoveItems;return this.each((function(profile){var p=profile.properties,data=[];(arr=xui.isHash(arr)?[arr.id]:xui.isArr(arr)?arr:0===arr?[0]:arr?(arr+"").split(p.valueSeparator):null)||(arr=((p.$UIvalue||p.value)+"").split(p.valueSeparator)),xui.arr.each(arr,(function(o,i){arr[i]=""+(xui.isNumb(o)?p.items&&p.items[o].id:xui.isHash(o)?o.id:o)})),function(profile,arr,target,data,ns,force){var self=arguments.callee;ns||(ns=xui()),xui.filter(arr,(function(o){var serialId,b;if((force||(b=-1!=xui.arr.indexOf(target,o.id)))&&profile.renderId&&(serialId=profile.ItemIdMapSubSerialId[o.id])&&(data.push(xui.copy(profile.SubSerialIdMapItem[serialId])),delete profile.SubSerialIdMapItem[serialId],delete profile.ItemIdMapSubSerialId[o.id],profile.reclaimSubId(serialId,"items"),force||((obj=profile.getSubNode(profile.keys[key]?key:profile.box._ITEMKEY||"ITEM",serialId)).isEmpty()||ns.merge(obj),o.$xid&&ns.get().push(xui.getObject(o.$xid).getRootNode()))),o.sub&&self(profile,o.sub,target,data,ns,force||b),b){for(var i in o)o[i]=null;return!1}})),ns.remove(!0,purgeNow)}(profile,p.items,arr,data),(v=p.$UIvalue)&&((v=(""+v).split(p.valueSeparator)).length>1?(xui.filter(v,(function(o){return-1==xui.arr.indexOf(arr,o)})),p.$UIvalue=v.join(p.valueSeparator)):-1!=xui.arr.indexOf(arr,p.$UIvalue)&&(p.$UIvalue=null)),b&&profile.renderId&&profile.boxing()._afterRemoveItems(profile,data)}))},clearItems:function(purgeNow){return this.each((function(profile){var prop=profile.properties;profile.SubSerialIdMapItem&&(profile.renderId&&profile.getSubNode(profile.keys[profile.box._ITEMKEY||"ITEM"],!0).remove(!0,purgeNow),xui.each(profile.SubSerialIdMapItem,(function(o,serialId){profile.reclaimSubId(serialId,"items")})),profile.SubSerialIdMapItem={},profile.ItemIdMapSubSerialId={}),prop.items.length=0,prop.$UIvalue=null}))},updateItem:function(itemId,options){var self=this,profile=self.get(0),prop=profile.properties;itemId=xui.isHash(itemId)?itemId.id:0===itemId?0:itemId?itemId+"":null,xui.isNumb(itemId)&&(itemId=xui.get(prop.items,[itemId,"id"])),itemId||((v=prop.$UIvalue||prop.value)&&(v=(v+"").split(prop.valueSeparator)),v=profile.getItemByItemId(v[0]),itemId=v?v.id:null);var nid,item,serialId,node,oldsub,t,box=profile.box,items=prop.items,rst=profile.queryItems(items,(function(o){return"object"==typeof o?o.id===itemId:o===itemId}),!0,!0,!0);if(xui.isHash(options)||(options={caption:options+""}),rst&&rst.length){if(item="object"!=typeof(rst=rst[0])[0]?rst[2][rst[1]]={id:rst[0]}:rst[0],xui.isSet(options.id)&&(options.id+=""),options.id&&itemId!==options.id){nid=options.id;var m2=profile.ItemIdMapSubSerialId;m2[nid]||((v=m2[itemId])?(m2[nid]=v,delete m2[itemId],profile.SubSerialIdMapItem[v].id=nid):item.id=nid)}if(delete options.id,xui.isEmpty(options))return self;if((node=profile.getSubNodeByItemId("ITEM",nid||itemId)).isEmpty())xui.merge(item,options,"all");else{if("sub"in options){if(delete item._created,delete item._checked,delete item._inited,item.sub){var sub=[];xui.arr.each(item.sub,(function(o){sub.push(o.id)})),self.removeItems(sub)}}else item.sub&&(oldsub=profile.getSubNodeByItemId("SUB",nid||itemId));if(xui.merge(item,options,"all"),serialId=xui.get(profile,["ItemIdMapSubSerialId",nid||itemId]),arr=box._prepareItems(profile,[item],item._pid,!1,serialId),node.replace(profile._buildItems(arguments[2]||"items",arr),!1),oldsub&&!oldsub.isEmpty()&&((t=profile.getSubNodeByItemId("SUB",nid||itemId)).isEmpty()||t.replace(oldsub)),"function"==typeof self.setUIValue){var arr,uiv=prop.$UIvalue||"";(arr=(""+uiv).split(prop.valueSeparator)).length&&-1!=xui.arr.indexOf(arr,itemId)&&(nid?(xui.arr.removeValue(arr,itemId),arr.push(item.id),self.setUIValue(arr.join(prop.valueSeparator),!0,null,"update")):self._setCtrlValue(uiv))}}if(box.$Behaviors.PanelKeys){var v,hash={};options.hasOwnProperty("panelBgClr")&&(hash["background-color"]=options.panelBgClr),options.hasOwnProperty("panelBgImg")&&(hash["background-image"]=options.panelBgImg?"url("+xui.adjustRes(options.panelBgImg)+")":""),options.hasOwnProperty("panelBgImgPos")&&(hash["position-color"]=options.panelBgImgPos),options.hasOwnProperty("panelBgImgRepeat")&&(hash["background-repeat"]=options.panelBgImgRepeat),options.hasOwnProperty("panelBgImgAttachment")&&(hash["background-attachment"]=options.panelBgImgAttachment),options.hasOwnProperty("overflow")&&((v=options.overflow)&&-1!=v.indexOf(":")&&xui.arr.each(v.split(/\s*;\s*/g),(function(s){var a=s.split(/\s*:\s*/g);a.length>1&&(hash[xui.str.trim(a[0])]=xui.str.trim(a[1]||""))})),hash.overflow=v||""),xui.isEmpty(hash)||xui.arr.each(box.$Behaviors.PanelKeys,(function(k){profile.getSubNode(k,nid||itemId).css(hash)}))}}return self},doFilter:function(itemFilter,helper,reLayout){var ns=this,profile=ns.get(0);if(profile){if(helper=helper||"doFilter",itemFilter)xui.isFun(itemFilter)?profile.$itemFilter=itemFilter:!0===itemFilter&&(itemFilter=profile.$itemFilter);else{if(!profile.$itemFilter)return this;delete profile.$itemFilter,itemFilter=function(){return!1}}xui.resetRun(profile.$xid+":itemFilter",(function(){itemFilter("begin",helper,profile);var prop=profile.properties,items=prop.rows||prop.items,showItems=[],hideItems=[],f1=function(items,showItems,hideItems){var count=0;return xui.arr.each(items,(function(item){item.sub?!0===itemFilter(item,helper,profile)||f1(item.sub,showItems,hideItems)?(count++,item.hidden&&showItems.push(item.id)):item.hidden||hideItems.push(item.id):itemFilter(item,helper,profile)?item.hidden||hideItems.push(item.id):(count++,item.hidden&&showItems.push(item.id))})),count};f1(items,showItems,hideItems),itemFilter("end",helper,profile),showItems.length&&(ns.showRows||ns.showItems).call(ns,showItems),hideItems.length&&(ns.showRows||ns.showItems).call(ns,hideItems,!1),!1!==reLayout&&ns.reLayout(!0)}))}return this},disableItem:function(itemId){return this.updateItem(itemId,{disabled:!0})},enableItem:function(itemId){return this.updateItem(itemId,{disabled:!1})},hideItems:function(itemId){return this.showItems(itemId,!1)},showItems:function(itemId,show){var ns=this,profile=ns.get(0),showNodes=xui(),hideNodes=xui(),prop=profile.properties;return(itemId=xui.isHash(itemId)?itemId.id:xui.isArr(itemId)?itemId:0===itemId?[0]:itemId?(itemId+"").split(prop.valueSeparator):null)||(itemId=((prop.$UIvalue||prop.value)+"").split(prop.valueSeparator)),itemId&&itemId.length&&xui.arr.each(itemId,(function(r,item){(item=ns.getItemByItemId(r))&&(!1===show?item.hidden||hideNodes.merge(ns.getSubNodeByItemId("ITEM",item.id)):item.hidden&&showNodes.merge(ns.getSubNodeByItemId("ITEM",item.id)),item.hidden=!1===show)})),showNodes.isEmpty()||showNodes.css("display",""),hideNodes.isEmpty()||hideNodes.css("display","none"),this},getItems:function(type,v){if(v=v||this.get(0).properties.items,"data"==type)return xui.clone(v,!0);if("min"==type){var a=xui.clone(v,!0);return xui.arr.each(a,(function(o,i){a[i]=o.id})),a}return v},focusItem:function(itemId){return this.getSubNodeByItemId(this.constructor._focusNodeKey,itemId).focus(!0),this},scrollIntoView:function(itemId){return(itemId=(itemId=this.getSubNodeByItemId(this.constructor._focusNodeKey,itemId)).get(0))&&itemId.scrollIntoView(),this},selectItem:function(itemId){return this.fireItemClickEvent(itemId)},fireItemClickEvent:function(itemId){return this.getSubNodeByItemId(this.constructor._focusNodeKey,itemId).onClick(),this},editItem:function(itemId){var item,source,v,profile=this.get(0),prop=profile.properties;if(profile&&profile.renderId&&!profile.destroyed&&(itemId=xui.isHash(itemId)?itemId.id:0===itemId?0:itemId?itemId+"":null,xui.isNumb(itemId)&&(itemId=xui.get(prop.items,[itemId,"id"])),itemId||((v=prop.$UIvalue||prop.value)&&(v=(v+"").split(prop.valueSeparator)),itemId=(v=profile.getItemByItemId(v[0]))?v.id:null),itemId&&(item=profile.getItemByItemId(itemId))&&((source=profile.getSubNodeByItemId("ITEMCAPTION",itemId)).isEmpty()&&(source=profile.getSubNodeByItemId("CAPTION",itemId)),!source.isEmpty()))){var pp=source.parent(),cb=xui.browser.contentBox,pos=source.offset(null,pp.get(0)),pos2=(source.cssSize(),pp.offset()),size2=pp.cssSize();if(pos2.left+=cb?source._paddingW("left"):0,pos2.top+=cb?source._paddingH("top"):0,size2.height+=cb?source._paddingH():0,profile.beforeIniEditor&&!1===(editor=profile.boxing().beforeIniEditor(profile,item,source)))return;if(!editor||!editor["xui.UI"]){var editor;(editor=new xui.UI.ComboInput({type:"input"})).setWidth(Math.max(size2.width-pos.left,40)).setHeight(Math.max(size2.height,20)).setResizer(!0).setValue(item.caption||""),profile.onBeginEdit&&profile.boxing().onBeginEdit(profile,item,editor);var undo=function(){xui.resetRun("absList_editor_reset",(function(){editor&&!editor.isDestroyed()&&(editor.getRoot().setBlurTrigger("absList_editor_blur",null),editor.destroy(),editor=null)}))};editor.beforeUIValueSet((function(prf,ov,nv,force,tag){!1!==(profile.beforeEditApply&&profile.boxing().beforeEditApply(profile,item,nv,editor,tag))&&(profile.boxing().updateItem(item.id,{caption:nv}),profile.onEndEdit&&profile.boxing().onEndEdit(profile,item,editor),undo())})).onCancel((function(){undo()})),xui("body").append(editor);var root=editor.getRoot();root.popToTop({left:pos.left+pos2.left,top:pos2.top}),root.setBlurTrigger("absList_editor_blur",(function(){undo()})),editor.activate()}}return this},getSelectedItem:function(){var item,uiv=this.getUIValue(!0),prf=this.get(0),items=[];if(xui.isArr(uiv)){if(uiv.length)return xui.arr.each(uiv,(function(id){(item=prf.getItemByItemId(id))&&items.push(item)})),items}else if(uiv)return prf.getItemByItemId(uiv)}},Initialize:function(){var o=this.prototype;xui.arr.each(xui.toArr("getItemByItemId,getItemByDom,getSubIdByItemId,getSubNodeByItemId"),(function(s){o[s]=function(){var t=this.get(0);return t[s].apply(t,arguments)},xui.Class._fun(o[s],s,o.KEY,null,"instance")}))},Static:{_focusNodeKey:"ITEM",$abstract:!0,_ensureValues:xui.UI._ensureValues,DataModel:{listKey:{set:function(value){var o=this,t=o.box.getCachedData(value);t?o.boxing().setItems(xui.clone(t)):o.boxing().setItems(o.properties.items),o.properties.listKey=value}},items:{ini:[],set:function(value){var children,bv,o=this,ins=o.boxing(),items=o.properties.items;if("function"==typeof ins.setValue&&(bv=o.properties.value)&&value&&value.length){var i=xui.arr.indexOf(value,bv);-1===i&&(i=xui.arr.subIndexOf(value,"id",o.properties.value))}if(items&&items.length&&(o.children&&o.children.length&&(xui.arr.each(children=o.serialize(!1,!0).children,(function(arr){if(arr[1]){var i=xui.arr.indexOf(items,arr[1]);-1===i&&(i=xui.arr.subIndexOf(items,"id",arr[1])),-1!==i&&(arr[2]=i)}})),ins.removeChildren(!0,!0,!0)),ins.clearItems(!0,!0)),ins.insertItems(value?xui.copy(value):null,null,null,!0),value&&value.length&&children){var hash={},rhash={};value.length,xui.arr.each(value,(function(item,i){hash[item.id||item]=i,rhash[i]=item.id||item})),xui.arr.each(children,(function(arr){var added,t;xui.isSet(arr[1])&&(xui.isSet(hash[arr[1]])?(t=xui.create(arr[0]),o.$panelRestore&&o.$panelRestore(t.get(0)),ins.append(t,arr[1]),added=1):rhash[arr[2]]&&(t=xui.create(arr[0]),o.$panelRestore&&o.$panelRestore(t.get(0)),ins.append(t,rhash[arr[2]]),added=1)),added||(t=xui.create(arr[0]),o.$panelRestore&&o.$panelRestore(t.get(0)),ins.append(t,bv))}))}xui.isSet(bv)&&ins.setValue(bv,!0,"items"),o.renderId&&o.adjustSize()}},dragSortable:!1,valueSeparator:";"},RenderTrigger:function(){this.destroyTrigger=function(){xui.each(this.SubSerialIdMapItem,(function(o){xui.breakO(o)})),this.properties.items.length=0}},EventHandlers:{beforePrepareItem:function(profile,item,pid){},beforeIniEditor:function(profile,item,captionNode){},onBeginEdit:function(profile,item,editor){},beforeEditApply:function(profile,item,caption,editor,tag){},onEndEdit:function(profile,item,editor){}},getDropKeys:function(profile,node){var item=profile.getItemByDom(node);return item&&item.dropKeys||profile.properties.dropKeys},getDragKey:function(profile,node){var item=profile.getItemByDom(node);return item&&item.dragKey||profile.properties.dragKey||profile.properties.dragSortable&&profile.key+":"+profile.$xid},_adjustItems:function(arr){xui.isSet(arr)||(arr=[]),xui.isArr(arr)||(arr=[arr]);var a=xui.copy(arr);return xui.arr.each(a,(function(o,i){xui.isArr(o)&&o.length?(a[i]={id:o[0]},a[i].id=xui.isSet(a[i].id)?a[i].id+"":xui.id(),xui.isSet(o[1])&&(a[i].caption=o[1]+"")):xui.isHash(o)?(a[i]=xui.copy(o),a[i].id=xui.isSet(a[i].id)?a[i].id+"":xui.id()):a[i]={id:o+""}})),a},_showTips:function(profile,node,pos){if(!profile.properties.disableTips){if(profile.onShowTips)return profile.boxing().onShowTips(profile,node,pos);if(xui.Tips){profile.properties;var id=node.id,sid=profile.getSubId(id),map=profile.SubSerialIdMapItem,item=map&&map[sid];return item&&"tips"in item?(item.tips?xui.Tips.show(pos,item):xui.Tips.hide(),!1):!(profile.properties.autoTips&&item&&"caption"in item&&(item.caption||item.comment?xui.Tips.show(pos,{tips:xui.adjustRes((item.caption||"")+(item.caption||item.comment?"<br/>":"")+(item.comment||""),!0,!1,null,null,item)}):xui.Tips.hide(),1))}}}}}),xui.Class("xui.absValue","xui.absObj",{Instance:{_getCtrlValue:function(){return this.get(0).properties.$UIvalue},_setCtrlValue:function(value){return this},_setDirtyMark:function(key){return this.each((function(profile){if(profile.renderId){var properties=profile.properties,flag=properties.value!==properties.$UIvalue,o=profile.getSubNode(key||profile.box.DIRYMARKICON||"KEY"),d=xui.UI.$css_tag_dirty;profile._dirtyFlag!==flag&&(properties.dirtyMark&&properties.showDirtyMark&&(profile.beforeDirtyMark&&!1===profile.boxing().beforeDirtyMark(profile,flag)||(flag?o.addClass(d):o.removeClass(d))),profile._dirtyFlag=flag)}}))},getValue:function(returnArr){var prf=this.get(0),prop=prf.properties,v=prop.value;return"multi"==prf.box.$valuemode&&returnArr&&xui.isStr(v)&&(v=v.split(prop.valueSeparator)),prf.box.$DataModel.selMode&&("multi"==prop.selMode||"multibycheckbox"==prop.selMode)&&returnArr&&(xui.isStr(v)&&(v=v.split(prop.valueSeparator)),v&&xui.isArr(v)&&v.length>1&&v.sort()),v},getUIValue:function(returnArr){var prf=this.get(0),prop=prf.properties;if(!prf.renderId)return prop&&prop.value;var v,cv=this._getCtrlValue();return prf.box._checkValid&&!1===prf.box._checkValid(prf,cv)||(prop.$UIvalue=cv),v=prop.$UIvalue,"multi"==prf.box.$valuemode&&returnArr&&xui.isStr(v)&&(v=v.split(prop.valueSeparator)),prf.box.$DataModel.selMode&&("multi"==prop.selMode||"multibycheckbox"==prop.selMode)&&returnArr&&(xui.isStr(v)&&(v=v.split(prop.valueSeparator)),v&&xui.isArr(v)&&v.length>1&&v.sort()),v},resetValue:function(value){return this.each((function(profile){var r,prop=profile.properties,ins=profile.boxing(),v="function"==typeof(r=profile.box._ensureValue)?r.call(profile.box,profile,value):value;prop.value===v&&prop.$UIvalue===v||(profile.box._beforeResetValue&&profile.box._beforeResetValue(profile),"function"==typeof(r=profile.$onValueSet)&&(r=r.call(profile,prop.value,v),xui.isSet(r)&&(v=r)),prop.value=v,profile.renderId&&profile.boxing()._setCtrlValue(v),prop.$UIvalue=v),profile._inValid=1,ins._setDirtyMark()})),this},setUIValue:function(value,force,triggerEventOnly,tag,tagVar){return this.each((function(profile){var r,prop=profile.properties,ovalue=prop.$UIvalue,box=profile.boxing();if(force||ovalue!==value){if(profile.box._checkValid&&!1===profile.box._checkValid(profile,value)||profile.beforeUIValueSet&&!1===(r=box.beforeUIValueSet(profile,ovalue,value,force,tag,tagVar)))return;var cv;r!==undefined&&"boolean"!=typeof r&&(value=r),profile.box&&"function"==typeof(r=profile.box._ensureValue)&&(value=r.call(profile.box,profile,value)),"function"==typeof(r=profile.$onUIValueSet)&&(r=r.call(profile,value,force,tag),xui.isSet(r)&&(value=r)),profile.renderId&&!triggerEventOnly&&(cv=1,box._setCtrlValue(value)),prop.$UIvalue=value,profile.renderId&&!triggerEventOnly&&box._setDirtyMark(),profile.afterUIValueSet&&box.afterUIValueSet(profile,ovalue,value,force,tag,tagVar),profile._onChange&&box._onChange(profile,ovalue,value,force,tag,tagVar),profile.onChange&&box.onChange(profile,ovalue,value,force,tag,tagVar),prop.dirtyMark||box.setValue(value,!1,"uiv",cv||triggerEventOnly),prop.excelCellId&&box.notifyExcel&&box.notifyExcel(!1)}})),this},updateValue:function(){return this.each((function(profile){var prop=profile.properties;if(prop.value!==prop.$UIvalue){var ins=profile.boxing();ins.checkValid()&&(ins.setValue(ins.getUIValue(),!0,"update"),ins._setDirtyMark())}}))},isDirtied:function(){var dirtied=!1;return this.each((function(profile){var p=profile.properties;if(dirtied=p.value+" "!=p.$UIvalue+" ")return!1})),dirtied},checkValid:function(value){var prop,tr,r=!0,outv=xui.isSet(value);return this.each((function(profile){prop=profile.properties,tr=!0,profile.box._checkValid2&&(r=(tr=profile.box._checkValid2(profile))&&r),tr&&profile.box._checkValid&&(r=profile.box._checkValid(profile,outv?value:prop.$UIvalue)&&r),!outv&&profile.renderId&&profile.boxing()._setDirtyMark()})),r}},Static:{$abstract:!0,DataModel:{readonly:{ini:!1,action:function(v){var i=this.getRoot();v?i.addClass("xui-ui-readonly"):i.removeClass("xui-ui-readonly")}},required:{ini:!1,action:function(v){if(this.keys.LABEL){var node=this.getSubNode("LABEL");v?node.addClass("xui-required"):node.removeClass("xui-required")}v?this.getRoot().addClass("xui-required-field"):this.getRoot().removeClass("xui-required-field")}},value:{ini:null,set:function(value,force,tag,triggerEventOnly){var r,p=this.properties,ovalue=p.value,box=this.boxing();this.box._checkValid&&!1===this.box._checkValid(this,value)||this.beforeValueSet&&!1===(r=box.beforeValueSet(this,ovalue,value,force,tag))||(r!==undefined&&(value=r),"function"==typeof(r=this.box._ensureValue)&&(value=r.call(this.box,this,value)),"function"==typeof(r=this.$onValueSet)&&(r=r.call(this,ovalue,value,force,tag),xui.isSet(r)&&(value=r)),this.renderId&&!triggerEventOnly&&box._setCtrlValue(value),p.value=p.$UIvalue=value,this._inValid||(this._inValid=1),this.renderId&&box._setDirtyMark(),this.afterValueSet&&box.afterValueSet(this,ovalue,value,force,tag),this.onValueChange&&box.onValueChange(this,ovalue,value,force,tag))}},isFormField:!0,dirtyMark:!0,showDirtyMark:!0},_ensureValues:xui.UI._ensureValues,_ensureValue:function(profile,value){var prop=profile.properties;return!profile.box.$DataModel.selMode||"multi"!=prop.selMode&&"multibycheckbox"!=prop.selMode?xui.isArr(value)?value[0]:value:(xui.isArr(value)||(value=(value?""+value:"").split(prop.valueSeparator)),value.sort(),value.join(prop.valueSeparator))},EventHandlers:{beforeValueSet:function(profile,oldValue,newValue,force,tag){},afterValueSet:function(profile,oldValue,newValue,force,tag){},onValueChange:function(profile,oldValue,newValue,force,tag){},beforeUIValueSet:function(profile,oldValue,newValue,force,tag,tagVar){},afterUIValueSet:function(profile,oldValue,newValue,force,tag,tagVar){},onChange:function(profile,oldValue,newValue,force,tag,tagVar){},_onChange:function(profile,oldValue,newValue,force,tag,tagVar){},beforeDirtyMark:function(profile,dirty){}},RenderTrigger:function(){var t,b=this.boxing(),p=this.properties;this.behavior.PanelKeys||((t=p.dataBinder)&&b.setDataBinder(t,!0),(t=p.dataField)&&b.setDataField(t)),p.value!==undefined&&("function"==typeof(t=this.box._ensureValue)&&(p.value=t.call(this.box,this,p.value),p.$UIvalue&&(p.$UIvalue=t.call(this.box,this,p.$UIvalue))),p.$UIvalue||(p.$UIvalue=p.value),b._setCtrlValue(p.$UIvalue,!0))}}}),xui.Class("xui.UI.Widget","xui.UI",{Static:{Appearances:{KEY:{},IE67_SHADOW:xui.browser.ie&&xui.browser.ver<=8?{"z-index":"-1",position:"absolute",left:0,top:0,width:"100%",height:"100%",overflow:"visible"}:null},Templates:{className:"xui-uiw-shell {_className} {_requiredfld}",style:"{_style}",IE67_SHADOW:xui.browser.ie&&xui.browser.ver<=8?{}:null,FRAME:{$order:2,className:"xui-uiw-frame ",BORDER:{$order:1,style:"width:{bWidth};height:{bHeight};",className:"xui-uiw-border"}}},DataModel:{width:{$spaceunit:1,ini:"10em"},height:{$spaceunit:1,ini:"10em"},shadow:{ini:!1,action:function(v){if(xui.browser.ie&&xui.browser.ver<=8){var node=this.getSubNode("IE67_SHADOW");v?node.addClass("xui-ui-shadow xui-uiborder-r xui-uiborder-b xui-uiborder-radius-br"):node.removeClass("xui-ui-shadow xui-uiborder-r xui-uiborder-b xui-uiborder-radius-br")}else node=this.getSubNode("BORDER"),v?node.addClass("xui-ui-shadow"):node.removeClass("xui-ui-shadow")}},$hborder:0,$vborder:0},RenderTrigger:function(){var p=this.properties,o=this.boxing();this.renderId&&!this.$noB&&p.border&&o._border&&o._border(),!this.$noR&&p.resizer&&o.setResizer&&o.setResizer(p.resizer,!0),!this.$noS&&p.shadow&&o.setShadow&&o.setShadow(!0,!0)},_onresize:function(profile,width,height){var region,prop=profile.properties,border=profile.getSubNode("BORDER"),cb=border.contentBox(),shadow=xui.browser.ie&&xui.browser.ver<=8?profile.getSubNode("IE67_SHADOW"):null,us=xui.$us(profile),adjustunit=function(v,emRate){return profile.$forceu(v,us>0?"em":"px",emRate)},ww=profile.$px(width),hh=profile.$px(height),left=cb?Math.max(0,(prop.$b_lw||0)-(prop.$hborder||0)):0,top=cb?Math.max(0,(prop.$b_tw||0)-(prop.$vborder||0)):0;return ww&&"auto"!==ww&&(ww-=cb?Math.max(2*(prop.$hborder||0),(prop.$b_lw||0)+(prop.$b_rw||0)):0,xui.browser.ie&&xui.browser.ver<=6&&(ww=2*profile.$px(ww/2))),hh&&"auto"!==hh&&(hh-=cb?Math.max(2*(prop.$vborder||0),(prop.$b_lw||0)+(prop.$b_rw||0)):0,xui.browser.ie&&xui.browser.ver<=6&&(hh=2*profile.$px(hh/2)),xui.browser.ie&&xui.browser.ver<=6&&null===width&&(border.ieRemedy(),shadow&&shadow.ieRemedy())),region={left:adjustunit(left),top:adjustunit(top),width:adjustunit(ww),height:adjustunit(hh)},border.cssRegion(region),shadow&&shadow.cssRegion(region),profile.$resizer&&xui.browser.ie&&(border.ieRemedy(),shadow&&shadow.ieRemedy()),region}}}),xui.Class("xui.UI.Link","xui.UI",{Instance:{fireClickEvent:function(){return this.getRoot().onClick(),this}},Static:{Appearances:{KEY:{cursor:"pointer"}},Templates:{tagName:"a",className:"{_className}",style:"{_style}",href:"{href}",target:"{target}",tabindex:"{tabindex}",text:"{caption}"},Behaviors:{HoverEffected:{KEY:"KEY"},ClickEffected:{KEY:"KEY"},onClick:function(profile,e,src){var r;!profile.properties.disabled&&profile.onClick&&(r=profile.boxing().onClick(profile,e,src));var href=xui.use(src).attr("href");return"boolean"==typeof r?r:0!==href.indexOf("javascript:")&&0!==href.indexOf("#")}},DataModel:{caption:{ini:undefined,action:function(v){v=(xui.isSet(v)?v:"")+"",this.getRoot().html(xui.adjustRes(v,!0))}},href:{ini:xui.$DEFAULTHREF,action:function(v){this.getRoot().attr("href",v)}},target:{action:function(v){this.getRoot().attr("target",v)}}},EventHandlers:{onClick:function(profile,e){}}}}),xui.Class("xui.UI.Element","xui.UI",{Instance:{fireClickEvent:function(){return this.getRoot().onClick(),this}},Static:{_objectProp:{attributes:1},Templates:{_NativeElement:!0,tagName:"{nodeName}",className:"xui-node xui-wrapper {_className}",style:"{_style};",tabindex:"{tabindex}",text:"{html}"+xui.UI.$childTag},DataModel:{width:{$spaceunit:1,ini:"8em"},height:{$spaceunit:1,ini:"1em"},nodeName:{ini:"xui",action:function(v){this.boxing().refresh()}},selectable:!0,html:{html:1,action:function(v,ov,force){this.getRoot().html(xui.adjustRes(v,0,1),null,null,force)}},attributes:{ini:{},action:function(v,ov){var root=this.getRoot();xui.isEmpty(ov)||xui.each(ov,(function(o,i){root.attr(i,null)})),xui.isEmpty(v)||xui.each(v,(function(o,i){root.attr(i,o)}))}},tabindex:-1},Appearances:{KEY:{"line-height":"normal"}},Behaviors:{HoverEffected:{KEY:"KEY"},onClick:function(profile,e,src){return!profile.properties.disabled&&(profile.onClick?profile.boxing().onClick(profile,e,src):void 0)}},EventHandlers:{onClick:function(profile,e,value){}},RenderTrigger:function(){var v=this.properties.attributes;if(!xui.isEmpty(v)){var root=this.getRoot();xui.each(v,(function(o,i){root.attr(i,o)}))}}}}),xui.Class("xui.UI.Icon","xui.UI",{Instance:{fireClickEvent:function(){return this.getRoot().onClick(),this}},Static:{Templates:{className:"xui-node xui-wrapper {_className}  {picClass}",style:"{_style};",ICON:{className:"xuicon {imageClass}",style:"{backgroundImage}{backgroundPosition}{backgroundSize}{backgroundRepeat}{imageDisplay}{_fontsize}{_fontclr}{iconStyle}",text:"{iconFontCode}"},FLAG:{$order:1,className:"xui-display-none xui-uiflag {flagClass}",style:"{_flagStyle};{flagStyle}",text:"{flagText}"}},DataModel:{selectable:null,html:null,attributes:null,renderer:null,defaultFocus:null,tabindex:-1,image:{format:"image",action:function(v){xui.UI.$iconAction(this)}},imagePos:{action:function(v){this.getSubNode("ICON").css("backgroundPosition",v||"center")}},imageBgSize:{action:function(v){this.getSubNode("ICON").css("backgroundSize",v||"")}},imageClass:{ini:"",action:function(v,ov){xui.UI.$iconAction(this,"ICON",ov)}},iconFontCode:{action:function(v){xui.UI.$iconAction(this)}},iconFontSize:{action:function(v){this.getSubNode("ICON").css("fontSize",v||"")}},iconColor:{type:"color",action:function(v){this.getSubNode("ICON").css("color",v||"")}},flagText:{ini:"",action:function(v){this.getSubNode("FLAG").text(v)}},flagClass:{ini:"",combobox:["","xui-uiflag-2","xui-uiflag-3","xui-uiflag-4"],action:function(v,ov){this.getSubNode("FLAG").removeClass(ov).addClass(v)}}},Appearances:{KEY:{overflow:"visible"},ICON:{position:"relative",display:xui.$inlineBlock,zoom:xui.browser.ie?1:null},FLAG:{position:"absolute","z-index":10}},Behaviors:{HoverEffected:{ICON:"ICON"},ClickEffected:{ICON:"ICON"},onClick:function(profile,e,src){return!profile.properties.disabled&&(profile.onClick?profile.boxing().onClick(profile,e,src):void 0)}},EventHandlers:{onClick:function(profile,e,src){}},_prepareData:function(profile){var data=arguments.callee.upper.call(this,profile);return data.iconFontSize&&(data._fontsize=data.iconFontSize+";"),data.iconColor&&(data._fontclr="color:"+data.iconColor+";"),data._flagStyle="display:"+(data.flagText||data.flagClass?"block":"none"),data.flagClass||(data.flagClass="xui-uiflag-1"),data}}}),xui.Class("xui.UI.HTMLButton","xui.UI.Element",{Instance:{activate:function(){return this.getRoot().focus(!0),this}},Static:{Templates:{tagName:"button",className:"xui-ui-unselectable xui-ui-btn xui-uibar xui-uigradient xui-uiborder-radius {_className}",style:"{_style};",tabindex:"{tabindex}",text:"{caption}"+xui.UI.$childTag},Appearances:{KEY:{cursor:"pointer",padding:".334em"}},DataModel:{nodeName:null,tabindex:1,width:"auto",height:"auto",html:{hidden:1,get:function(){return this.boxing().getCaption()},set:function(v,ov){return this.boxing().setCaption(v,ov)}},caption:{ini:undefined,action:function(v){v=(xui.isSet(v)?v:"")+"",this.getRoot().html(xui.adjustRes(v,0,1))}},disabled:{ini:!1,action:function(v){var i=this.getRoot(),cls="xui-ui-disabled";v?this.getRoot().addClass(cls):this.getRoot().removeClass(cls),i.attr("disabled",v?"1":null)}},shadow:{ini:!1,action:function(v){var node=this.getRoot();v?node.addClass("xui-ui-shadow"):node.removeClass("xui-ui-shadow")}},fontColor:{ini:"",type:"color",action:function(value){this.getRoot().css("color",value)}},fontSize:{combobox:["","14px","18px","22px","30px"],action:function(value){this.getRoot().css("fontSize",value)}},fontWeight:{combobox:["","normal","bolder","bold","lighter","100","200","300","400","500","600","700","800","900"],action:function(value){this.getRoot().css("fontWeight",value)}},fontFamily:{combobox:["","arial","sans-serif","comic","courier new","monospace","serif","times new roman","wingdings"],action:function(value){this.getRoot().css("fontFamily",value)}}},RenderTrigger:function(){var p=this.properties,o=this.boxing();p.disabled&&o.setDisabled(!0),!this.$noS&&p.shadow&&o.setShadow&&o.setShadow(!0,!0)},Behaviors:{HoverEffected:{KEY:"KEY"}},_prepareData:function(profile){var data=arguments.callee.upper.call(this,profile);return data._style=data._style+(data.fontColor?";color:"+data.fontColor:"")+(data.fontSize?";font-size:"+data.fontSize:"")+(data.fontWeight?";font-weight:"+data.fontWeight:"")+(data.fontFamily?";font-family:"+data.fontFamily:""),data}}}),xui.Class("xui.UI.Button",["xui.UI.HTMLButton","xui.absValue"],{Initialize:function(){xui.UI.SButton=xui.UI.Button;var key="xui.UI.SButton";xui.absBox.$type[key.replace("xui.UI.","")]=xui.absBox.$type[key]=key,this.$activeClass$="xui.UI.Button"},Instance:{activate:function(){return this.getRoot().focus(!0),this},_setCtrlValue:function(value){return!xui.isNull(value)&&xui.isDefined(value)||(value=!1),this.each((function(profile){"status"==profile.properties.type&&profile.getRoot().tagClass("-checked",value)}))},resetValue:function(value){this.each((function(p){"drop"==p.properties.type&&p.boxing().setCaption("",!0)}));var upper=arguments.callee.upper,rtn=upper.apply(this,xui.toArr(arguments));return upper=null,rtn},setUIValue:function(value,force){this.each((function(profile){var p=profile.properties;p.$UIvalue!==value&&"drop"==p.type&&profile.boxing().setCaption("",!0)}));var upper=arguments.callee.upper,rtn=upper.apply(this,xui.toArr(arguments));return upper=null,rtn}},Static:{DIRYMARKICON:"BACKGROUND",Templates:{tagName:"button",className:"xui-ui-unselectable xui-ui-btn xui-uibar xui-uigradient xui-uiborder-radius {_className}",style:"{_style};{_align}",tabindex:"{tabindex}",BACKGROUND:{tagName:"div"},ICON:{$order:1,className:"xuicon {imageClass}  {picClass}",style:"{backgroundImage}{backgroundPosition}{backgroundSize}{backgroundRepeat}{iconFontSize}{imageDisplay}{iconStyle}",text:"{iconFontCode}"},CAPTION:{$order:2,className:"",style:"{_capStyle}",text:"{caption}"},DROP:{$order:3,className:"xuifont xui-special-icon",style:"{_showDrop}",$fonticon:"xui-uicmd-arrowdrop"}},Appearances:{BACKGROUND:{"z-index":-1,position:"absolute",left:0,top:0,width:"100%",height:"100%"},DROP:{"vertical-align":"middle","padding-left":".66667em"}},Behaviors:{HoverEffected:{KEY:["KEY","DROP"]},NavKeys:{KEY:1},onClick:function(profile,e,src){var p=profile.properties;if(p.disabled)return!1;var b=profile.boxing();if("status"==p.type){if(p.readonly)return!1;b.setUIValue(!p.$UIvalue,null,null,"click"),profile.onChecked&&b.onChecked(profile,e,p.$UIvalue)}return profile.onClick?b.onClick(profile,e,src,p.$UIvalue):"drop"==p.type&&profile.onClickDrop?b.onClickDrop(profile,e,src,p.$UIvalue):void 0},onKeydown:function(profile,e,src){var key=xui.Event.getKey(e).key;" "!=key&&"enter"!=key||(profile.getSubNode("KEY").afterMousedown(),profile.__fakeclick=1)},onKeyup:function(profile,e,src){var key=xui.Event.getKey(e).key;" "!=key&&"enter"!=key||(profile.getSubNode("KEY").afterMouseup(),profile.__fakeclick&&xui.use(src).onClick()),delete profile.__fakeclick}},DataModel:{html:null,image:{format:"image",action:function(v){xui.UI.$iconAction(this)}},imagePos:{action:function(value){this.getSubNode("ICON").css("backgroundPosition",value||"center")}},imageBgSize:{action:function(value){this.getSubNode("ICON").css("backgroundSize",value||"")}},imageClass:{ini:"",action:function(v,ov){xui.UI.$iconAction(this,"ICON",ov)}},iconFontCode:{action:function(v){xui.UI.$iconAction(this)}},caption:{ini:undefined,action:function(v){v=(xui.isSet(v)?v:"")+"",this.getSubNode("CAPTION").html(xui.adjustRes(v,0,1))}},hAlign:{ini:"center",listbox:["left","center","right"],action:function(v){this.getRoot().css("textAlign",v)}},vAlign:{ini:"middle",listbox:["top","middle","bottom"],action:function(v){}},value:{ini:!1},fontColor:{action:function(value){this.getSubNode("CAPTION").css("color",value)}},fontSize:{combobox:["","14px","18px","22px",".75em","1.5em","2em","3em"],action:function(value){this.getSubNode("CAPTION").css("fontSize",value)}},fontWeight:{action:function(value){this.getSubNode("CAPTION").css("fontWeight",value)}},fontFamily:{action:function(value){this.getSubNode("CAPTION").css("fontFamily",value)}},type:{ini:"normal",listbox:["normal","status","drop"],action:function(value){var drop=this.getSubNode("DROP");"drop"==value?drop.css("display",""):drop.css("display","none")}}},_isFormField:function(profile){return"status"==profile.properties.type&&profile.properties.isFormField},_ensureValue:function(profile,value){return"status"==profile.properties.type?!!value:value},_prepareData:function(profile){var data=arguments.callee.upper.call(this,profile);return data._align="text-align:"+data.hAlign+";",data._showDrop="drop"==data.type?"":"display:none",data._capStyle=(data.fontColor?"color:"+data.fontColor+";":"")+(data.fontSize?"font-size:"+data.fontSize+";":"")+(data.fontWeight?"font-weight:"+data.fontWeight+";":"")+(data.fontFamily?"font-family:"+data.fontFamily+";":""),data},RenderTrigger:function(){var p=this.properties,o=this.boxing();"status"==p.type&&p.value&&o.setValue(!0,!0,"render")},EventHandlers:{onClick:function(profile,e,src,value){},onClickDrop:function(profile,e,src,value){},onChecked:function(profile,e,value){}}}}),xui.Class("xui.UI.Span","xui.UI",{Instance:{fireClickEvent:function(){return this.getRoot().onClick(),this}},Static:{Templates:{className:"{_className}",style:"{_style};{_overflow};",tabindex:"{tabindex}",text:"{html}"+xui.UI.$childTag},DataModel:{width:{$spaceunit:1,ini:"2em"},height:{$spaceunit:1,ini:"1em"},selectable:!0,html:{html:1,action:function(v,ov,force){this.getRoot().html(xui.adjustRes(v,0,1),null,null,force)}},overflow:{ini:"touchOnly"==xui.browser.deviceType?"auto":undefined,combobox:["","visible","hidden","scroll","auto","overflow-x:hidden;overflow-y:auto","overflow-x:auto;overflow-y:hidden"],action:function(v){var node=this.getContainer();v&&-1!=v.indexOf(":")?xui.arr.each(v.split(/\s*;\s*/g),(function(s){var a=s.split(/\s*:\s*/g);a.length>1&&node.css(xui.str.trim(a[0]),xui.str.trim(a[1]||""))})):node.css("overflow",v||"")}},tabindex:-1},Appearances:{KEY:{"line-height":"normal"}},Behaviors:{HoverEffected:{KEY:"KEY",ICON:"ICON"},onClick:function(profile,e,src){return!profile.properties.disabled&&(profile.onClick?profile.boxing().onClick(profile,e,src):void 0)}},EventHandlers:{onClick:function(profile,e,value){}},_prepareData:function(profile,data){return data=arguments.callee.upper.call(this,profile,data),xui.isStr(data.overflow)&&(data._overflow=-1!=data.overflow.indexOf(":")?data.overflow:data.overflow?"overflow:"+data.overflow:""),data}}}),xui.Class("xui.UI.Div","xui.UI",{Initialize:function(){xui.UI.Pane=xui.UI.Div;var key="xui.UI.Pane";xui.absBox.$type[key.replace("xui.UI.","")]=xui.absBox.$type[key]=key,this.$activeClass$="xui.UI.Div"},Instance:{fireClickEvent:function(){return this.getRoot().onClick(),this}},Static:{Appearances:{KEY:{outline:xui.browser.gek?"none":null,zoom:xui.browser.ie&&xui.browser.ver<9?"1":null,background:xui.browser.ie?"url("+xui.ini.img_bg+") no-repeat left top":null,"line-height":"normal"},FLAG:{position:"absolute","z-index":10}},Templates:{tagName:"div",className:"xui-uicontainer {_className}",style:"{_style};{_panelstyle};{_overflow};",tabindex:"{tabindex}",text:"{html}"+xui.UI.$childTag,FLAG:{$order:1,className:"xui-display-none xui-uiflag {flagClass}",style:"{_flagStyle};{flagStyle}",text:"{flagText}"}},DataModel:{iframeAutoLoad:{ini:"",action:function(){this.box._applyAutoLoad(this)}},ajaxAutoLoad:{ini:"",action:function(){this.box._applyAutoLoad(this)}},width:{$spaceunit:1,ini:"10em"},height:{$spaceunit:1,ini:"10em"},selectable:!0,html:{html:1,action:function(v,ov,force){this.getRoot().html(xui.adjustRes(v,0,1),null,null,force)}},overflow:{ini:"touchOnly"==xui.browser.deviceType?"auto":undefined,combobox:["","visible","hidden","scroll","auto","overflow-x:hidden;overflow-y:auto","overflow-x:auto;overflow-y:hidden"],action:function(v){var node=this.getContainer();v&&-1!=v.indexOf(":")?xui.arr.each(v.split(/\s*;\s*/g),(function(s){var a=s.split(/\s*:\s*/g);a.length>1&&node.css(xui.str.trim(a[0]),xui.str.trim(a[1]||""))})):node.css("overflow",v||"")}},tabindex:-1,flagText:{ini:"",action:function(v){this.getSubNode("FLAG").text(v)}},flagClass:{ini:"",combobox:["","xui-uiflag-2","xui-uiflag-3","xui-uiflag-4"],action:function(v,ov){this.getSubNode("FLAG").removeClass(ov).addClass(v)}}},RenderTrigger:function(){"xui.UI.Div"==this.box.KEY&&(this.properties.iframeAutoLoad||this.properties.ajaxAutoLoad)&&this.box._applyAutoLoad(this)},Behaviors:{DroppableKeys:["KEY"],PanelKeys:["KEY"],onClick:function(profile,e,src){return!profile.properties.disabled&&(profile.onClick?profile.boxing().onClick(profile,e,src):void 0)}},EventHandlers:{onClick:function(profile,e,value){}},_prepareData:function(profile,data){return(data=arguments.callee.upper.call(this,profile,data))._flagStyle="display:"+(data.flagText||data.flagClass?"block":"none"),data.flagClass||(data.flagClass="xui-uiflag-1"),xui.isStr(data.overflow)&&(data._overflow=-1!=data.overflow.indexOf(":")?data.overflow:data.overflow?"overflow:"+data.overflow:""),data},_applyAutoLoad:function(prf){var prop=prf.properties,ins=prf.boxing();if(prop.iframeAutoLoad){ins.getContainer().css("overflow","hidden");var _if="string"==typeof prop.iframeAutoLoad?{url:prop.iframeAutoLoad}:xui.clone(prop.iframeAutoLoad,!0),id="biframe_"+xui.stamp(),e=xui.browser.ie&&xui.browser.ver<9,ifr=document.createElement(e?"<iframe name='"+id+"'>":"iframe");_if.url=xui.adjustRes(_if.url,!1,!0),ifr.id=ifr.name=id,xui.isHash(prop.iframeAutoLoad)&&(prop.iframeAutoLoad.frameName=id),prop._frameName=id,_if.query||(_if.query={}),_if.query._rand=xui.rand(),ifr.frameBorder="0",ifr.marginWidth="0",ifr.marginHeight="0",ifr.vspace="0",ifr.hspace="0",ifr.allowTransparency="true",ifr.width="100%",ifr.height="100%",ins.getContainer().html("",!1),ins.append(ifr),"post"==(_if.method||"").toLowerCase()?xui.Dom.submit(_if.url,_if.query,"post",id,_if.enctype):ifr.src=_if.url,prf.$afterAutoLoad&&prf.$afterAutoLoad.call(prf.boxing(),prf)}else if(prop.ajaxAutoLoad){var _ajax="string"==typeof prop.ajaxAutoLoad?{url:prop.ajaxAutoLoad}:xui.clone(prop.ajaxAutoLoad,!0),options={rspType:"text"};_ajax.query||(_ajax.query={}),_ajax.query._rand=xui.rand(),xui.merge(options,_ajax.options),ins.busy();var node=ins.getContainer();xui.Ajax(xui.adjustRes(_ajax.url,!1,!0),_ajax.query,(function(rsp){node.html(rsp,!0,!0),prf.$afterAutoLoad&&prf.$afterAutoLoad.call(prf.boxing(),prf),ins.free()}),(function(err){node.html("<div>"+err+"</div>",!0,!1),prf.$afterAutoLoad&&prf.$afterAutoLoad.call(prf.boxing(),prf),ins.free()}),null,options).start()}},_onresize:function(profile,width){width&&xui.UI._adjustConW(profile,profile.getRoot(),profile)}}}),xui.Class("xui.UI.CSSBox","xui.UI.Span",{Instance:{fireClickEvent:null,adjustDock:null,draggable:null,busy:null,free:null},Static:{$initRootHidden:!0,_objectProp:{normalStatus:1,hoverStatus:1,activeStatus:1,focusStatus:1},Templates:{style:"left:"+xui.Dom.HIDE_VALUE+";top:"+xui.Dom.HIDE_VALUE+";width:12.5em;height:5em;visibility:hidden;display:none;position:absolute;z-index:0;",className:"{_className}",text:"{_html}"},DataModel:{className:{ini:null,action:function(){this.box._refreshCSS(this)}},sandbox:{ini:"",action:function(v){this.box._refreshCSS(this)}},normalStatus:{ini:{},action:function(v){this.box._refreshCSS(this)}},hoverStatus:{ini:{},action:function(v){this.box._refreshCSS(this)}},activeStatus:{ini:{},action:function(v){this.box._refreshCSS(this)}},focusStatus:{ini:{},action:function(v){this.box._refreshCSS(this)}},childSelector:"",spaceUnit:null,showEffects:null,hideEffects:null,position:null,display:null,visibility:null,zIndex:null,left:null,top:null,width:null,height:null,right:null,bottom:null,rotate:null,activeAnim:null,hoverPop:null,hoverPopType:null,dock:null,dockStretch:null,dockIgnoreFlexFill:null,renderer:null,html:null,selectable:null,overflow:null,tabindex:null,autoTips:null,disableClickEffect:null,disableHoverEffect:null,disableTips:null,disabled:null,defaultFocus:null,dockIgnore:null,dockOrder:null,dockMargin:null,dockFloat:null,dockMinW:null,dockMinH:null,dockMaxW:null,dockMaxH:null,tips:null},$adjustProp:function(profile,force){var prop=profile.properties,cls=!force&&prop.className||"xui-css-"+profile.$xid,i=1,hash={};for(profile.box.getAll().each((function(prf){prf!==profile&&(hash[prf.properties.className]=1)}));hash[cls];)cls+=i++;prop.className=cls},RenderTrigger:function(){this.$inDesign||xui("body").append(this.getRoot())},_prepareData:function(profile,data){data=arguments.callee.upper.call(this,profile,data);var css=this._getCon(profile);return data._html="Text"+(css?"<style id='"+profile.getDomId()+"cssnode' type='text/css'>"+css+"</style>":""),data},_getCon:function(prf){var t,css="",prevId="",prop=prf.properties,cls=prop.className,cs=prop.childSelector,hash1=prop.normalStatus,hash2=prop.hoverStatus,hash3=prop.activeStatus,hash4=prop.focusStatus;return cs=(prf.$inDesign?'[class~="xui-designer-inner-control"]':"")+(cs?" "+cs:""),hash1&&!xui.isEmpty(hash1)&&(css+="."+cls+cs+"{"+xui.Dom.$adjustCss(hash1,!0)+"}\n",hash1.color&&(css+="."+cls+" .xui-node{color:"+hash1.color+"}")),hash2&&!xui.isEmpty(hash2)&&(css+="."+cls+":hover"+cs+", ."+cls+"-hover"+cs+"{"+xui.Dom.$adjustCss(hash2,!0)+"}\n",hash2.color&&(css+="."+cls+":hover .xui-node, ."+cls+"-hover .xui-node{color:"+hash2.color+"}")),hash3&&!xui.isEmpty(hash3)&&(css+="."+cls+":active"+cs+", ."+cls+":checked"+cs+", ."+cls+"-active"+cs+", ."+cls+"-checked"+cs+", ."+cls+"-checked:hover"+cs+", ."+cls+"-active:hover"+cs+"{"+xui.Dom.$adjustCss(hash3,!0)+"}",hash3.color&&(css+="."+cls+":active .xui-node, ."+cls+":checked .xui-node, ."+cls+"-active .xui-node, ."+cls+"-checked .xui-node, ."+cls+"-checked:hover .xui-node, ."+cls+"-active:hover .xui-node{color:"+hash3.color+"}")),hash4&&!xui.isEmpty(hash4)&&(css+="."+cls+":focus"+cs+", ."+cls+"-focus"+cs+"{"+xui.Dom.$adjustCss(hash4,!0)+"}",hash4.color&&(css+="."+cls+":focus .xui-node, ."+cls+"-focus .xui-node{color:"+hash4.color+"}")),(t=prop.sandbox)?(t=prf.host&&prf.host[t]&&prf.host[t].get(0)||xui(t).get(0)&&t)&&(prevId=xui.UI._getThemePrevId(t)):prf.$inDesign&&(t=prf.parent)&&(prevId=xui.UI._getThemePrevId(t)),xui.UI._adjustCSS(css,prevId)},_refreshCSS:function(prf){var ns=this;xui.resetRun(prf.key+":"+prf.$xid,(function(){if(!prf.destroyed){var id=prf.getDomId()+"cssnode",prop=prf.properties,root=prf.getRoot(),css=ns._getCon(prf);root.query("style").remove(!1),xui.Dom._setClass(root.get(0),prop.className),css&&xui.CSS._appendSS(root.get(0),css,id,!1)}}))},EventHandlers:{beforeInputAlert:null,onContextmenu:null,onClick:null,onDock:null,onLayout:null,onMove:null,onRender:null,onResize:null,onShowTips:null,beforeHoverEffect:null,beforeAppend:null,afterAppend:null,beforeRender:null,afterRender:null,beforeRemove:null,afterRemove:null,onHotKeydown:null,onHotKeypress:null,onHotKeyup:null}}}),xui.Class("xui.UI.MoudluePlaceHolder","xui.UI.Div",{Instance:{destroy:function(ignoreEffects,purgeNow){var o=this.get(0);if(o)return(o.$afterDestroy=o.$afterDestroy||{}).destroyAttachedModule=function(){!this._replaced&&this._module&&this._module.destroy(ignoreEffects,purgeNow)},arguments.callee.upper.apply(this,[ignoreEffects,purgeNow])},adjustDock:null,draggable:null,busy:null,free:null,setProperties:function(key,value){var self=this.get(0);return self._properties||(self._properties={}),key?"string"==typeof key?self._properties[key]=value:(xui.merge(self._properties,key,"all"),value&&xui.isHash(value)&&xui.merge(self._properties,value,"all")):self._properties={},this},getValue:function(){return xui.get(this.get(0),["_properties","value"])},setValue:function(value){return xui.set(this.get(0),["_properties","value"],value),this},getUIValue:function(){return this.get(0)._$UIvalue},setUIValue:function(value){return this.get(0)._$UIvalue=value,this},getProperties:function(key){var self=this.get(0);return self._properties||(self._properties={}),key?self._properties[key]:self._properties},setEvents:function(key,value){var self=this.get(0);return self._events||(self._events={}),key?"string"==typeof key?self._events[key]=value:xui.merge(self._events,key,"all"):self._events={},this},getEvents:function(key){var self=this.get(0);return self._events||(self._events={}),key?this._events[key]:this._events},replaceWithModule:function(module){var m,t,parent,subId,prf=this.get(0),onEnd=function(t){prf.$afterReplaced&&prf.$afterReplaced.call(module),(t=prf._render_holder||prf._inline_holder)&&t.$afterAttached&&module.getUIComponents().each((function(prf){xui.tryF(t.$afterAttached,[prf],t)})),prf.alias=null,prf._module=null,prf.box&&prf.boxing().destroy()};prf&&!prf.destroyed&&!prf._replaced&&prf.getRootNode()&&(prf._replaced=1,prf.$beforeReplaced&&prf.$beforeReplaced.call(module),(prf.host||prf.alias)&&module.setHost(prf.host,prf.alias),"_$UIvalue"in prf&&(module.$UIvalue=prf._$UIvalue),(t=prf._events)&&module.setEvents(t),(t=prf._properties)&&module.setProperties(t),prf.moduleClass&&prf.moduleXid&&(m=xui.Module.getInstance(prf.moduleClass,prf.moduleXid))&&m.AddComponents(module),(parent=prf.parent)?(subId=prf.childrenId,module.show(onEnd,parent,subId)):prf.rendered&&(parent=prf.getRoot().parent())&&!parent.isEmpty()&&module.show(onEnd,parent),prf.$afterReplaced&&prf.$afterReplaced.call(module),prf.alias=null,prf._module=null,this.destroy())}},Static:{Templates:{tagName:"div",style:"left:0;top:0;width:0;height:0;visibility:hidden;display:none;position:absolute;z-index:0;"},DataModel:{showEffects:null,hideEffects:null,activeAnim:null,hoverPop:null,hoverPopType:null,dock:null,dockStretch:null,renderer:null,html:null,disableClickEffect:null,disableHoverEffect:null,disableTips:null,disabled:null,defaultFocus:null,dockIgnore:null,dockOrder:null,dockMargin:null,dockFloat:null,dockMinW:null,dockMinH:null,dockMaxW:null,dockMaxH:null,tips:null},EventHandlers:{onContextmenu:null,onDock:null,onLayout:null,onMove:null,onRender:null,onResize:null,onShowTips:null,beforeAppend:null,afterAppend:null,beforeRender:null,afterRender:null,beforeRemove:null,afterRemove:null,onHotKeydown:null,onHotKeypress:null,onHotKeyup:null},RenderTrigger:function(){this&&!this._replaced&&this._module&&this.boxing().replaceWithModule(this._module)}}}),xui.Class("xui.AnimBinder","xui.absObj",{Instance:{_ini:xui.Timer.prototype._ini,_after_ini:function(profile,ins,alias){profile.name||profile.Instace.setName(alias)},getParent:xui.Timer.prototype.getParent,getChildrenId:xui.Timer.prototype.getChildrenId,destroy:function(){this.each((function(profile){var box=profile.box,name=profile.properties.name;delete box._pool[name],profile.__gc()}))},setHost:function(value,alias){var self=this;return value&&alias&&self.setName(alias),arguments.callee.upper.apply(self,arguments)},apply:function(node,onEnd){for(var frame,frame1,frame2,endpoints,prf=this.get(0),fs=prf.properties.frames,arr=[],i=0,l=fs.length;i<l-1;i++){for(var j in endpoints={},frame1=fs[i],frame2=fs[i+1],delete(frame=xui.copy(frame2)).status,frame2.status)endpoints[j]=frame2.status[j];frame.endpoints=endpoints,frame.start=frame1,frame.end=frame2,arr.push(frame)}var fun=function(){if(!arr.length)return prf.onEnd&&prf.boxing().onEnd(prf),void(xui.isFun(onEnd)&&xui.tryF(onEnd));var frame=arr.shift();return prf.beforeFrame&&!1===prf.boxing().beforeFrame(prf,frame)?void 0:xui(node).animate(frame.endpoints,null,fun,frame.duration,frame.step,frame.type,null,null,frame.restore,frame.times).start()};return fun()}},Static:{_objectProp:{tagVar:1,propBinder:1,frames:1},_beforeSerialized:xui.Timer._beforeSerialized,$nameTag:"ani_",_pool:{},destroyAll:function(){this.pack(xui.toArr(this._pool,!1),!1).destroy(),this._pool={}},getFromName:function(name){var o=this._pool[name];return o&&o.boxing()},DataModel:{dataBinder:null,dataField:null,name:{set:function(value){var o=this,ovalue=o.properties.name,_p=o.box._pool,_old=_p[ovalue],_new=_p[value];_p[o.properties.name=value]=o,_new&&!_old&&(o._n=_new._n),_old&&delete _p[ovalue]}},frames:{ini:[]}},EventHandlers:{beforeFrame:function(profile,frame){},onEnd:function(profile){}}}}),xui.Class("xui.UI.Image","xui.UI",{Initialize:function(){this._adjustItems=xui.absList._adjustItems,this.prototype._prepareItems=function(a){return a}},Instance:{fireClickEvent:function(){return this.getRoot().onClick(),this},getRate:function(){return parseFloat(this.get(0)._rate)||1}},Static:{IMGNODE:1,Templates:{tagName:"img",style:"cursor:{cursor};{_style}",className:"{_className}",border:"0",src:xui.ini.img_bg,alt:"{alt}"},Behaviors:{HoverEffected:{KEY:"KEY"},ClickEffected:{KEY:"KEY"},DraggableKeys:["KEY"],onError:function(profile,e,src){profile.boxing().onError(profile)},onLoad:function(profile,e,src){var path,img=xui.use(src).get(0);try{path=img.src}catch(e){return}if(path!=xui.ini.img_bg){var i=new Image;i.onload=function(){if(profile&&!profile.destroyed){var prop=profile.properties,size=profile.box._adjust(profile,""===prop.width||"auto"==prop.width?i.width:prop.width,""===prop.height||"auto"==prop.height?i.height:prop.height);profile.$afterLoad&&profile.$afterLoad.apply(profile.host,[profile,path,size[0],size[1]]),profile.boxing().afterLoad(profile,path,size[0],size[1]),"none"!=prop.dock&&profile.boxing().adjustDock(),i.onload=null}},i.src=path,xui.Dom.fixPng(img)}},onClick:function(profile,e,src){return!profile.properties.disabled&&(profile.onClick?profile.boxing().onClick(profile,e,src):void 0)},onDblclick:function(profile,e,src){if(profile.properties.disabled)return!1;profile.onDblclick&&profile.boxing().onDblclick(profile,e,src)}},RenderTrigger:function(){var pro=this.properties,v=pro.src,v2=pro.activeItem;v2&&-1!=xui.arr.subIndexOf(pro.items,"id",v2)?this.boxing().setActiveItem(v2,!0):v&&this.boxing().setSrc(v,v!=xui.ini.img_bg)},EventHandlers:{onClick:function(profile,e,src){},onDblclick:function(profile,e,src){},onError:function(profile){},beforeLoad:function(profile){},afterLoad:function(profile,path,width,height){}},_adjust:function(profile,width,height){var prop=profile.properties,src=profile.getRootNode();if(xui.$us(profile),width=width?profile.$px(width,null,!0):width,height=height?profile.$px(height,null,!0):height,src.style.width=src.style.height="",width>0&&height>0){var r1=prop.maxWidth/width,r2=prop.maxHeight/height,r=r1<r2?r1:r2;return r>=1&&(r=1),profile._rate=r,[src.width=width*r,src.height=height*r]}return[0,0]},DataModel:{maxWidth:{ini:800,action:function(v){var src=this.getRootNode(),prop=this.properties;this.box._adjust(this,""===prop.width||"auto"==prop.width?src.width:prop.width,""===prop.height||"auto"==prop.height?src.height:prop.height)}},maxHeight:{ini:600,action:function(v){var src=this.getRootNode(),prop=this.properties;this.box._adjust(this,""===prop.width||"auto"==prop.width?src.width:prop.width,""===prop.height||"auto"==prop.height?src.height:prop.height)}},width:{ini:"auto",action:function(v){var src=this.getRootNode(),prop=this.properties,i=new Image;i.src=src.src,this.box._adjust(this,""===v||"auto"==v?i.width:v,""===prop.height||"auto"==prop.height?i.height:prop.height)}},height:{ini:"auto",action:function(v){var src=this.getRootNode(),prop=this.properties,i=new Image;i.src=src.src,this.box._adjust(this,""===prop.width||"auto"==prop.width?i.width:prop.width,""===v||"auto"==v?i.height:v)}},src:{format:"image",ini:xui.ini.img_bg,linkage:["activeItem"],action:function(v){var self=this;!1!==self.boxing().beforeLoad(this)&&xui.asyRun((function(){self.properties;var r=self.getRoot(),src=xui.adjustRes(v);r.attr("src")!==src&&r.attr("src",src)})),self.$inner||(self.properties.activeItem="")}},alt:{ini:"",action:function(v){this.getRoot().attr("alt",v)}},items:{ini:[]},activeItem:{ini:"",linkage:["src","alt","tips"],action:function(v){var item,alt,tips,items=this.properties.items,i=xui.arr.subIndexOf(items,"id",""+v),ins=this.boxing(),src=xui.ini.img_bg;-1!=i&&(item=items[i])&&(src=item.image,alt=item.alt||"",tips=item.tips||""),this.$inner=1,ins.setSrc(src,!0),delete this.$inner,ins.setAlt(alt||""),ins.setTips(tips||"")}},cursor:{ini:"auto",combobox:["","default","text","pointer","move","crosshair","wait","help","e-resize","ne-resize","nw-resize","n-resize","se-resize","sw-resize","s-resize","w-resize"],action:function(v){this.getRoot().css("cursor",v)}}}}}),xui.Class("xui.UI.Flash","xui.UI",{Instance:{refreshFlash:function(){var cls=this.constructor;return this.each((function(profile){xui.resetRun(profile.domId,(function(){cls._clearMemory(profile),profile.properties.src&&cls._drawSWF(profile)}))}))},getFlash:function(){return this.constructor._getSWF(this.get(0))}},Static:{Appearances:{KEY:{overflow:"hidden"},BOX:{position:"absolute",left:0,top:0,"z-index":1},COVER:{position:"absolute",left:"-1px",top:"-1px",width:0,height:0,"z-index":4}},Templates:{tagName:"div",className:"{_className}",style:"{_style}",BOX:{tagName:"div"},COVER:{tagName:"div",style:"background-image:url("+xui.ini.img_bg+");"}},DataModel:{selectable:!0,width:{$spaceunit:1,ini:"30em"},height:{$spaceunit:1,ini:"25em"},cover:!1,src:{format:"media",ini:"",action:function(v){this.boxing().refreshFlash()}},parameters:{ini:{},action:function(v){this.boxing().refreshFlash()}},flashvars:{ini:{},action:function(v){this.boxing().refreshFlash()}}},RenderTrigger:function(){(this.$beforeDestroy=this.$beforeDestroy||{}).flashClearMem=function(){this.box&&this.box._clearMemory(this)},this.boxing().refreshFlash()},getFlashVersion:function(){if(xui.browser.ie)try{var axo=new ActiveXObject("ShockwaveFlash.ShockwaveFlash.6");try{axo.AllowScriptAccess="always"}catch(e){return"6,0,0"}}catch(e){}finally{try{return new ActiveXObject("ShockwaveFlash.ShockwaveFlash").GetVariable("$version").replace(/\D+/g,",").match(/^,?(.+),?$/)[1]}catch(e){}}else try{if(navigator.mimeTypes["application/x-shockwave-flash"].enabledPlugin)return(navigator.plugins["Shockwave Flash 2.0"]||navigator.plugins["Shockwave Flash"]).description.replace(/\D+/g,",").match(/^,?(.+),?$/)[1]}catch(e){}return"0,0,0"},_getSWF:function(profile){var id=xui.isStr(profile)?profile:this._idtag+profile.serialId;return(xui.browser.ie?window[id]:document.embeds&&document.embeds[id]||window.document[id])||document.getElementById(id)},_clearMemory:function(profile){var id=this._idtag+profile.serialId,_e=xui.fun(),chart=profile.box._getSWF(profile);if(chart){if(chart.style.display="none",xui.browser.ie){for(var x in chart)"function"==typeof chart[x]&&(chart[x]=_e);window[id]&&(window[id]=undefined)}else document.embeds&&document.embeds[id]&&(document.embeds[id]=undefined),window.document[id]&&(window.document[id]=undefined);chart=_e=null}},_drawSWF:function(profile){var prop=profile.properties,src=(profile.serialId,xui.adjustRes(prop.src)),parameters=prop.parameters,options=xui.copy(prop.flashvars),xml="";options.DOMId=profile.box._idtag+profile.serialId,options.chartWidth=prop.width,options.chartHeight=prop.height,navigator.plugins&&navigator.mimeTypes&&navigator.mimeTypes.length?(xml+='<embed type="application/x-shockwave-flash" src="'+src+"?"+xui.urlEncode(parameters)+'" ',xml+='width="'+prop.width+'" height="'+prop.height+'" ',xml+='id="'+options.DOMId+'" name="'+options.DOMId+'" ',xml+='wmode="opaque" ',xml+='flashvars="'+xui.urlEncode(options)+'" ',xml+="/>"):(xml+='<object id="'+options.DOMId+'" classid="clsid:D27CDB6E-AE6D-11cf-96B8-444553540000" ',xml+='width="'+prop.width+'" height="'+prop.height+'">',xml+='<param name="movie" value="'+src+"?"+xui.urlEncode(parameters)+'" />',xml+='<param name="wmode" value="opaque" />',xml+='<param name="flashvars" value="'+xui.urlEncode(options)+'" />',xml+="</object>"),profile.getSubNode("BOX").html(xml,!1)},_onresize:function(profile,width,height){var prop=profile.properties,us=xui.$us(profile),adjustunit=function(v,emRate){return profile.$forceu(v,us>0?"em":"px",emRate)},size=profile.getSubNode("BOX").cssSize(),ww=width?profile.$px(width):width,hh=height?profile.$px(height):height;(width&&!xui.compareNumber(size.width,ww,6)||height&&!xui.compareNumber(size.height,hh,6))&&(width&&(prop.width=adjustunit(ww)),height&&(prop.height=adjustunit(hh)),size={width:width?prop.width:null,height:height?prop.height:null},profile.getSubNode("BOX").cssSize(size,!0),(profile.$inDesign||prop.cover)&&profile.getSubNode("COVER").cssSize(size,!0),profile.boxing().refreshFlash())}}}),xui.Class("xui.UI.Audio","xui.UI",{Instance:{play:function(){var vn=this.getSubNode("H5").get(0);vn&&this.getSrc()&&vn.play()},pause:function(){var vn=this.getSubNode("H5").get(0);vn&&this.getSrc()&&vn.pause()},load:function(){var vn=this.getSubNode("H5").get(0);vn&&this.getSrc()&&vn.load()},canPlayType:function(type){var vn=this.getSubNode("H5").get(0);if(vn)return vn.canPlayType(type)}},Static:{Appearances:{KEY:{overflow:"hidden"},H5:{position:"absolute",left:0,top:0,"z-index":1},COVER:{position:"absolute",left:"-1px",top:"-1px",width:0,height:0,"z-index":4}},Templates:{tagName:"div",className:"{_className}",style:"{_style}",H5:{tagName:"audio",crossOrigin:"anonymous",autoplay:"{_autoplay}",controls:"{_controls}",loop:"{_loop}",muted:"{_muted}",preload:"{preload}",volume:"{volume}",src:"{src}",text:"Your browser does not support the audio element."},COVER:{tagName:"div",style:"background-image:url("+xui.ini.img_bg+");"}},Behaviors:{HotKeyAllowed:!1},DataModel:{selectable:!0,width:{$spaceunit:1,ini:"18em"},height:{$spaceunit:1,ini:"5em"},src:{format:"media",ini:"",action:function(v){this.getSubNode("H5").attr("src",xui.adjustRes(v))}},cover:!1,controls:{ini:!0,action:function(v){this.getSubNode("H5").attr("controls",v?"controls":null)}},preload:{ini:"none",listbox:["none","metadata","auto"],action:function(v){this.getSubNode("H5").attr("preload",v&&"none"!=v?v:null)}},loop:{ini:!1,action:function(v){this.getSubNode("H5").attr("loop",v?"loop":null)}},muted:{ini:!1,action:function(v){this.getSubNode("H5").attr("muted",v?"muted":null)}},volume:{ini:1,action:function(v){this.getSubNode("H5").attr("volume",v)}},autoplay:{ini:!1,action:function(v){this.getSubNode("H5").attr("autoplay",v?"autoplay":null)}}},RenderTrigger:function(){var prf=this,H5=prf.getSubNode("H5"),prop=prf.properties,ef=function(event){prf.onMediaEvent&&prf.boxing().onMediaEvent(prf,(event||window.event).type,arguments)};xui.arr.each("loadstart progress durationchange seeked seeking timeupdate playing canplay canplaythrough volumechange ratechange loadedmetadata loadeddata play pause ended".split(" "),(function(event,i){(i=H5&&H5.get(0))&&xui.Event._addEventListener(i,event,ef)})),(prf.$beforeDestroy=prf.$beforeDestroy||{}).detachEvents=function(){xui.arr.each("loadstart progress durationchange seeked seeking timeupdate playing canplay canplaythrough volumechange ratechange loadedmetadata loadeddata play pause ended".split(" "),(function(event,i){(i=H5&&H5.get(0))&&xui.Event._removeEventListener(i,event,ef)}))},prop.controls||H5.attr("controls",null),prop.loop||H5.attr("loop",null),prop.muted||H5.attr("muted",null),prop.autoplay?xui.asyRun((function(t){prf.$inDesign||prop.src&&xui.isStr(prop.src)&&(t=H5.get(0))&&t.play()})):H5.attr("autoplay",null)},_prepareData:function(profile){var data=arguments.callee.upper.call(this,profile);return data.autoplay&&(data._autoplay="autoplay"),data.controls&&(data._controls="controls"),data.loop&&(data._loop="loop"),data.muted&&(data._muted="muted"),data},EventHandlers:{onMediaEvent:function(profile,eventType,params){}},_onresize:function(profile,width,height){var H5=profile.getSubNode("H5"),size=H5.cssSize(),prop=profile.properties,us=xui.$us(profile),adjustunit=function(v,emRate){return profile.$forceu(v,us>0?"em":"px",emRate)},ww=width?profile.$px(width):width,hh=height?profile.$px(height):height;(width&&!xui.compareNumber(size.width,ww,6)||height&&!xui.compareNumber(size.height,hh,6))&&(width&&H5.attr("width",ww).width(prop.width=adjustunit(ww)),height&&H5.attr("height",hh).height(prop.height=adjustunit(hh)),(profile.$inDesign||prop.cover)&&profile.getSubNode("COVER").cssSize({width:width?prop.width:null,height:height?prop.height:null},!0))}}}),xui.Class("xui.UI.Video","xui.UI.Audio",{Instance:{},Static:{Templates:{tagName:"div",crossOrigin:"anonymous",className:"{_className}",style:"{_style}",H5:{tagName:"video",autoplay:"{_autoplay}",controls:"{_controls}",loop:"{_loop}",muted:"{_muted}",type:"application/x-mpegURL",preload:"{preload}",volume:"{volume}",src:"{src}",width:"{width}",height:"{height}",text:"Your browser does not support the video element."},COVER:{tagName:"div",style:"background-image:url("+xui.ini.img_bg+");"}},DataModel:{width:{$spaceunit:1,ini:"34em"},height:{$spaceunit:1,ini:"25em"},poster:{format:"image",ini:"",action:function(v){this.getSubNode("H5").attr("poster",v||null)}}},RenderTrigger:function(){var t,H5=this.getSubNode("H5");(t=this.properties.poster)&&H5.attr("poster",t)}}}),xui.Class("xui.UI.Resizer","xui.UI",{Instance:{_attachTo:function(target,parent){var v=this.get(0);return v._target=xui(target),v._parent=parent||xui("body"),v._parent.append(this),v.$resizeId=xui(target).id(),this},show:function(){return this.each((function(o){o.getRoot().css("display","")})),xui.browser.ie&&this.reBoxing().ieRemedy(),this},hide:function(){return this.reBoxing().css("display","none"),this}},Initialize:function(){this.addTemplateKeys(["HANDLER","HIDDEN","MOVE","CONF1","CONF2","ROTATE","L","R","T","B","LT","RT","LB","RB","REGION"]),xui.each({addResizer:function(properties,onUpdate,onChange){var target=xui([this.get(0)]);properties=properties||{},xui.merge(properties,{_attached:!0});var r=new xui.UI.Resizer(properties)._attachTo(target,target);return onUpdate&&r.onUpdate(onUpdate),onChange&&r.onChange(onChange),r},removeResizer:function(){var s=this.id();return xui.arr.each(xui.UI.Resizer._cache,(function(o){o&&o.$resizeId==s&&o.boxing().destroy(!0)})),this},$getResizer:function(){var b,s=this.id();return xui.arr.each(xui.UI.Resizer._cache,(function(o){if(o&&o.$resizeId==s)return b=o,!1})),b&&b.boxing()}},(function(o,i){xui.Dom.plugIn(i,o)})),xui.each({_resizer:function(key,args){return this.each((function(o){var target=o.getSubNode("BORDER"),d=o.properties;if(!target.$getResizer()){args=args||{};var update=function(pro,target,size,cssPos){var profile=arguments.callee.profile,node=profile.getRoot(),instance=profile.boxing(),prop=profile.properties,svg=profile.box["xui.svg"];if(size){var w=null,h=null,l=null,t=null;(t=size.width)&&(node.widthBy(t),prop.width=w=profile.$forceu(svg?instance.getWidth():node.width())),(t=size.height)&&(node.heightBy(t),prop.height=h=profile.$forceu(svg?instance.getHeight():node.height())),xui.UI.$tryResize(profile,w,h,!0),profile.box._onresize||!profile.onResize||null===w&&null===h||instance.onResize(profile,w,h)}return cssPos&&(!(t=cssPos.left)||"auto"==prop.left&&Math.round(parseFloat(prop.right))>=0||(node.leftBy(t),prop.left=l=profile.$forceu(svg?instance.getLeft():node.left())),!(t=cssPos.top)||"auto"==prop.top&&Math.round(parseFloat(prop.bottom))>=0||(node.topBy(t),prop.top=t=profile.$forceu(svg?instance.getTop():node.top())),!profile.onMove||null===l&&null===t||instance.onMove(profile,l,t,null,null)),!1};update.profile=o,o.$resizer=target.addResizer(args,update),o.$resizer.get(0).$parentUIProfile=o,"hidden"==d.visibility&&o.$resizer.hide()}}))},_unResizer:function(){return this.each((function(o){var target=o.getSubNode("BORDER");target.$getResizer()&&(target.removeResizer(),delete o.$resizer)}))}},(function(o,i){xui.UI.Widget.plugIn(i,o)})),xui.UI.Widget.setDataModel({resizer:{ini:!1,action:function(v){var b=this.boxing();if(v){var t=this.properties,arg={};xui.each("minHeight,minWidth,maxHeight,maxWidth".split(","),(function(i){i in t&&(arg[i]=t[i])})),t.resizerProp&&!xui.isEmpty(t.resizerProp)&&xui.merge(arg,t.resizerProp,"all"),t.tagVar.resizerProp&&xui.merge(arg,t.tagVar.resizerProp,"all"),b._resizer(v,arg),this.$inDesign&&(this.$resizer.get(0).$inDesign=1)}else b._unResizer()}},resizerProp:{ini:{}}})},Static:{Templates:{tagName:"div",className:"{_disabled}",style:"{_style};"},Appearances:{KEY:{position:"absolute",margin:"0 -1px -1px 0",visibility:"visible",background:xui.browser.ie&&!xui.browser.newie?"url("+xui.ini.img_bg+")":"","z-index":60,cursor:"move"},"KEY.readonly, KEY.disabled":{"background-image":"url(\"data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='32' height='32' viewBox='0 0 8 8'%3E%3Cg fill='%239C92AC' fill-opacity='0.6'%3E%3Cpath fill-rule='evenodd' d='M0 0h4v4H0V0zm4 4h4v4H4V4z'/%3E%3C/g%3E%3C/svg%3E\")"},"KEY.readonly.active, KEY.disabled.active":{"background-image":"url(\"data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='32' height='32' viewBox='0 0 8 8'%3E%3Cg fill='%239C92AC' fill-opacity='0.4'%3E%3Cpath fill-rule='evenodd' d='M0 0h4v4H0V0zm4 4h4v4H4V4z'/%3E%3C/g%3E%3C/svg%3E\")"},"KEY.readonly div, KEY.disabled div":{display:"none"},"KEY.readonly MOVE":{display:"block",$order:2},"KEY.readonly CONF1, KEY.readonly CONF2":{$order:10,opacity:1,display:"block"},MOVE:{position:"absolute",display:"block","z-index":100,visibility:"visible",cursor:"alias"},"CONF1, CONF2, ROTATE":{position:"absolute",display:"block","z-index":100,visibility:"visible",cursor:"pointer"},ROTATE:{$order:1,cursor:"crosshair"},HANDLER:{$order:0,position:"absolute",display:"block",border:"solid 1px","z-index":100,visibility:"visible"},T:{$order:1,left:"50%",cursor:"n-resize"},RT:{$order:1,cursor:"ne-resize","z-index":110},R:{$order:1,top:"50%",cursor:"e-resize"},RB:{$order:1,cursor:"se-resize","z-index":110},B:{$order:1,left:"50%",cursor:"s-resize"},LB:{$order:1,cursor:"sw-resize","z-index":110},L:{$order:1,top:"50%",cursor:"w-resize"},LT:{$order:1,cursor:"nw-resize","z-index":110},HIDDEN:{$order:10,"background-color":"transparent","border-width":0}},Behaviors:{beforeMousedown:function(profile,e,src){if(profile.properties.readonly||profile.properties.disabled)return!1;profile.box._onMousedown(profile,e,src,"move")},onDragbegin:function(profile,e,src){if(profile.properties.readonly||profile.properties.disabled)return!1;profile.box._onDragbegin(profile,e,src,"move")},onDrag:function(profile,e,src){profile.box._onDrag(profile,e,src,"move")},onDragstop:function(profile,e,src){profile.box._onDragstop(profile,e,src,"move")},onDblclick:function(profile,e,src){profile.onDblclick&&profile.boxing().onDblclick(profile,e,src)},CONF1:{onMouseover:function(profile,e,src){return!profile.properties.disabled&&!!profile.onConfig&&profile.boxing().onConfig(profile,e,src,"left","mouseover")},onMousedown:function(profile,e,src){return!profile.properties.disabled&&!!profile.onConfig&&profile.boxing().onConfig(profile,e,src,"left","mousedown")},onClick:function(profile,e,src){return!profile.properties.disabled&&!!profile.onConfig&&profile.boxing().onConfig(profile,e,src,"left","click")}},CONF2:{onMouseover:function(profile,e,src){return!profile.properties.disabled&&!!profile.onConfig&&profile.boxing().onConfig(profile,e,src,"right","mouseover")},onMousedown:function(profile,e,src){return!profile.properties.disabled&&!!profile.onConfig&&profile.boxing().onConfig(profile,e,src,"right","mousedown")},onClick:function(profile,e,src){return!profile.properties.disabled&&!!profile.onConfig&&profile.boxing().onConfig(profile,e,src,"right","click")}},MOVE:{beforeMousedown:function(profile,e,src){return profile.box._onMousedown(profile,e,src,"exmove"),!1},onDragbegin:function(profile,e,src){profile.box._onDragbegin(profile,e,src,"exmove")},onDrag:function(profile,e,src){profile.box._onDrag(profile,e,src,"exmove")},onDragstop:function(profile,e,src){profile.box._onDragstop(profile,e,src,"exmove")}},ROTATE:{beforeMousedown:function(profile,e,src){return profile.box._onMousedown(profile,e,src,"rotate"),!1},onDragbegin:function(profile,e,src){profile.box._onDragbegin(profile,e,src,"rotate")},onDrag:function(profile,e,src){profile.box._onDrag(profile,e,src,"rotate")},onDragstop:function(profile,e,src){profile.box._onDragstop(profile,e,src,"rotate")}},LT:{beforeMousedown:function(profile,e,src){return profile.box._onMousedown(profile,e,src,"nw"),!1},onDragbegin:function(profile,e,src){profile.box._onDragbegin(profile,e,src,"nw")},onDrag:function(profile,e,src){profile.box._onDrag(profile,e,src,"nw")},onDragstop:function(profile,e,src){profile.box._onDragstop(profile,e,src,"nw")}},RT:{beforeMousedown:function(profile,e,src){return profile.box._onMousedown(profile,e,src,"ne"),!1},onDragbegin:function(profile,e,src){profile.box._onDragbegin(profile,e,src,"ne")},onDrag:function(profile,e,src){profile.box._onDrag(profile,e,src,"ne")},onDragstop:function(profile,e,src){profile.box._onDragstop(profile,e,src,"ne")}},LB:{beforeMousedown:function(profile,e,src){return profile.box._onMousedown(profile,e,src,"sw"),!1},onDragbegin:function(profile,e,src){profile.box._onDragbegin(profile,e,src,"sw")},onDrag:function(profile,e,src){profile.box._onDrag(profile,e,src,"sw")},onDragstop:function(profile,e,src){profile.box._onDragstop(profile,e,src,"sw")}},RB:{beforeMousedown:function(profile,e,src){return profile.box._onMousedown(profile,e,src,"se"),!1},onDragbegin:function(profile,e,src){profile.box._onDragbegin(profile,e,src,"se")},onDrag:function(profile,e,src){profile.box._onDrag(profile,e,src,"se")},onDragstop:function(profile,e,src){profile.box._onDragstop(profile,e,src,"se")}},L:{beforeMousedown:function(profile,e,src){return profile.box._onMousedown(profile,e,src,"w"),!1},onDragbegin:function(profile,e,src){profile.box._onDragbegin(profile,e,src,"w")},onDrag:function(profile,e,src){profile.box._onDrag(profile,e,src,"w")},onDragstop:function(profile,e,src){profile.box._onDragstop(profile,e,src,"w")}},T:{beforeMousedown:function(profile,e,src){return profile.box._onMousedown(profile,e,src,"n"),!1},onDragbegin:function(profile,e,src){profile.box._onDragbegin(profile,e,src,"n")},onDrag:function(profile,e,src){profile.box._onDrag(profile,e,src,"n")},onDragstop:function(profile,e,src){profile.box._onDragstop(profile,e,src,"n")}},R:{beforeMousedown:function(profile,e,src){return profile.box._onMousedown(profile,e,src,"e"),!1},onDragbegin:function(profile,e,src){profile.box._onDragbegin(profile,e,src,"e")},onDrag:function(profile,e,src){profile.box._onDrag(profile,e,src,"e")},onDragstop:function(profile,e,src){profile.box._onDragstop(profile,e,src,"e")}},B:{beforeMousedown:function(profile,e,src){return profile.box._onMousedown(profile,e,src,"s"),!1},onDragbegin:function(profile,e,src){profile.box._onDragbegin(profile,e,src,"s")},onDrag:function(profile,e,src){profile.box._onDrag(profile,e,src,"s")},onDragstop:function(profile,e,src){profile.box._onDragstop(profile,e,src,"s")}}},DataModel:{_attached:!1,forceVisible:!1,forceMovable:"",singleDir:!1,vertical:!0,horizontal:!0,minHeight:12,minWidth:12,maxHeight:5e3,maxWidth:5e3,handlerSize:xui.browser.contentBox?8:12,handlerOffset:xui.browser.contentBox?1:0,readonly:{ini:!1,action:function(v){v?this.getRoot().addClass("readonly"):this.getRoot().removeClass("readonly")}},disabled:{ini:!1,action:function(v){v?this.getRoot().addClass("disabled"):this.getRoot().removeClass("disabled")}},leftConfigBtn:{ini:!1,action:function(v){this.getSubNode("CONF1").css("display",v?"":"none")}},rightConfigBtn:{ini:!1,action:function(v){this.getSubNode("CONF2").css("display",v?"":"none")}},rotatable:{ini:!1,action:function(v){v&&xui.browser.ie&&xui.browser.ver<=8&&(v=!1),this.getSubNode("ROTATE").css("display",v?"":"none")}},left:100,top:100,height:100,width:100,position:"absolute",display:"block",cover:!1},EventHandlers:{onDblclick:function(profile,e,src){},onUpdate:function(profile,target,size,cssPos,rotate){},onChange:function(profile,proxy){},onConfig:function(profile,e,src,pos,type){}},_dynamicTemplate:function(profile){var t,n,pro=profile.properties,hash=profile._exhash="$_attached:"+pro._attached+";forceVisible:"+pro.forceVisible+";singleDir:"+pro.singleDir+";vertical:"+pro.vertical+";horizontal:"+pro.horizontal+";forceMovable:"+pro.forceMovable+";",map=arguments.callee.map||(arguments.callee.map={MOVE:{tagName:"div",className:"xuifont",$fonticon:"xui-icon-dragmove",style:"color:#fff;border-radius:50%;background-color:#079bfa;padding: 0.125em;opacity:0.85;font-size: 1.5em;top:50%;left:50%;margin-left: -.625em;margin-top: -.625em;"},CONF1:{tagName:"div",className:"xuifont",$fonticon:"xui-icon-star",style:"color:#079bfa;font-size: 1.5em;top:-1.125em;left:-1.125em;{_leftCofigBtn};"},CONF2:{tagName:"div",className:"xuifont",$fonticon:"xui-uicmd-opt",style:"color:#079bfa;font-size: 1.5em;top:-1.125em;left:auto;right:-1.125em;{_rightCofigBtn};"},ROTATE:{tagName:"div",className:"xuifont",$fonticon:"xui-icon-circle",style:"color:#079bfa;font-size: 2em;top:-1.25em;left:50%;margin-left:-0.5em;{_rotateBtn};"},T:{tagName:"div",style:"top:-{_extend};margin-left:-{_extend};width:{_handlerSize};height:{_handlerSize};"},RT:{tagName:"div",style:"top:-{_extend};right:-{_extend};width:{_handlerSize};height:{_handlerSize};"},R:{tagName:"div",style:"right:-{_extend};margin-top:-{_extend};width:{_handlerSize};height:{_handlerSize};"},RB:{tagName:"div",style:"bottom:-{_extend};right:-{_extend};width:{_handlerSize};height:{_handlerSize};"},B:{tagName:"div",style:"bottom:-{_extend};margin-left:-{_extend};width:{_handlerSize};height:{_handlerSize};"},LB:{tagName:"div",style:"bottom:-{_extend};left:-{_extend};width:{_handlerSize};height:{_handlerSize};"},L:{tagName:"div",style:"left:-{_extend};margin-top:-{_extend};width:{_handlerSize};height:{_handlerSize};"},LT:{tagName:"div",style:"left:-{_extend};top:-{_extend};width:{_handlerSize};height:{_handlerSize};"},cover:{T:{tagName:"div",style:"width:100%;left:0em;top:-{_extend};height:{_handlerSize};"},RT:{tagName:"div",style:"top:-{_extend};right:-{_extend};width:{_handlerSize};height:{_handlerSize};"},R:{tagName:"div",style:"height:100%;top:0em;right:-{_extend};width:{_handlerSize};"},RB:{tagName:"div",style:"right:-{_extend};bottom:-{_extend};width:{_handlerSize};height:{_handlerSize};"},B:{tagName:"div",style:"width:100%;left:0em;bottom:-{_extend};height:{_handlerSize};"},LB:{tagName:"div",style:"left:-{_extend};bottom:-{_extend};width:{_handlerSize};height:{_handlerSize};"},L:{tagName:"div",style:"height:100%;top:0em;left:-{_extend};width:{_handlerSize};"},LT:{tagName:"div",style:"top:-{_extend};left:-{_extend};width:{_handlerSize};height:{_handlerSize};"}}}),template=profile.box.getTemplate(hash);template||(template=xui.clone(profile.box.getTemplate()),t=pro._cover||pro.cover?map.cover:map,pro._move&&(template.MOVE=map.MOVE),template.CONF1=map.CONF1,template.CONF2=map.CONF2,template.ROTATE=map.ROTATE,pro.vertical&&(pro.singleDir||(template.T=t.T),template.B=t.B),pro.horizontal&&(pro.singleDir||(template.L=t.L),template.R=t.R,pro.vertical&&(pro.singleDir||(template.LB=t.LB,template.RT=t.RT,template.LT=t.LT),template.RB=t.RB)),n=profile.getClass("KEY","-handler")+" ",(t=template.T)&&(t.className=n),(t=template.RT)&&(t.className=n),(t=template.R)&&(t.className=n),(t=template.RB)&&(t.className=n),(t=template.B)&&(t.className=n),(t=template.LB)&&(t.className=n),(t=template.L)&&(t.className=n),(t=template.LT)&&(t.className=n),pro._visible||(n=profile.getClass("KEY","-hidden")+" ",(t=template.T)&&(t.className+=n),(t=template.RT)&&(t.className+=n),(t=template.R)&&(t.className+=n),(t=template.RB)&&(t.className+=n),(t=template.B)&&(t.className+=n),(t=template.LB)&&(t.className+=n),(t=template.L)&&(t.className+=n),(t=template.LT)&&(t.className+=n)),profile.box.setTemplate(template,hash)),profile.template=template},_prepareData:function(profile){var t=profile.properties;t._visible=!0,t._cover=!1,t._move=!0,t._attached?(t._visible=!1,t._cover=!0,t._move=!1,t.position="static",xui.browser.ie67&&(t.display="inline"),t.left=t.top=t.width=t.height=0):t.cover&&(t._visible=!1),t.forceVisible&&(t._visible=!0,t._cover=!1),"boolean"==typeof t.forceMovable&&(t._move=t.forceMovable),t.extend=(parseFloat(t.handlerSize)||0)/2+(parseFloat(t.handlerOffset)||0),t._handlerSize=profile.$em(t.handlerSize)+"em",t._extend=profile.$em(t.extend)+"em",t._leftCofigBtn=t.leftConfigBtn?"":"display:none",t._rightCofigBtn=t.rightConfigBtn?"":"display:none";var r=t.rotatable;return r&&xui.browser.ie&&xui.browser.ver<=8&&(r=!1),t._rotateBtn=r?"":"display:none",t._disabled=t.disabled?"disabled":"",arguments.callee.upper.call(this,profile)},RenderTrigger:function(){xui.setNodeData(this.renderId,"zIndexIgnore",1),this.box._tryCursors(this)},_onUpdate:function(profile,target,size,cssPos,rotate){if(target){if(size&&target.widthBy(size.width,!0).heightBy(size.height,!0),cssPos){var t=target.get(0).style;"auto"==t.left&&Math.round(parseFloat(t.right))>=0||target.leftBy(cssPos.left),"auto"==t.top&&Math.round(parseFloat(t.bottom))>=0||target.topBy(cssPos.top)}xui.isDefined(rotate)&&target.rotate(rotate)}},_switchAxis:function(axis,angle,dir4){var a=(angle+360)%360,axisArray=["n","ne","e","se","s","sw","w","nw"],octant=Math.round(a/45),index=xui.arr.indexOf(axisArray,axis)+octant,naxis=axisArray[index%8];return dir4&&index%2==1&&(naxis=a<45*octant?axisArray[(index-1)%8]:axisArray[(index+1)%8]),naxis},_tryCursors:function(profile){var n,a=(profile.getRoot().rotate()+360)%360,f=this._switchAxis;xui.each({T:"n",RT:"ne",R:"e",RB:"se",B:"s",LB:"sw",L:"w",LT:"nw"},(function(k,i){(n=profile.getSubNode(i)).get(0)&&n.css("cursor",f(k,a)+"-resize")}))},_getDDParas:function(angle,axis,switched){switch(axis){case"move":return{move:!0};case"exmove":return{exmove:!0};case"rotate":return{rotate:!0};case"nw":return{left:!0,top:!0};case"ne":return{right:!0,top:!0};case"sw":return{left:!0,bottom:!0};case"se":return{right:!0,bottom:!0};case"w":return{left:!0};case"n":return{top:!0};case"e":return{right:!0};case"s":return{bottom:!0}}},_onMousedown:function(profile,e,src,axis){if(!profile.$inDesign){if(profile.properties.disabled)return!1;var ddparas=this._getDDParas(0,axis);if("left"==xui.Event.getBtn(e)){var puip=profile.$parentUIProfile;if(!(puip&&puip["xui.UIProfile"]&&puip.beforeResizerDrag&&!1===xui.tryF(puip.beforeResizerDrag,[puip,profile,ddparas],puip.boxing()))){var pos=xui.Event.getPos(e);xui.use(src).startDrag(e,{dragDefer:2,targetReposition:!1,dragType:"blank",dragCursor:!0,targetLeft:pos.left,targetTop:pos.top})}}}},_onDragbegin:function(profile,e,src,axis){var rotate,rotatable=profile.properties.rotatable,o=profile.properties._attached?profile._target:xui([profile.renderId]),w=o.width(),h=o.height(),pos=o.offset();if(rotatable)if(rotate=o.rotate(),o.get(0).getBoundingClientRect){var rect=o.get(0).getBoundingClientRect();profile.o_center={x:(rect.right+rect.left)/2,y:(rect.bottom+rect.top)/2}}else profile.o_center={x:pos.left+w/2,y:pos.top+w/2};profile.properties._attached?(profile.proxy=xui.Dom.getEmptyDiv(),profile.proxy.html(" ",!1).css({border:"1px dashed",visibility:"visible",position:"absolute"}).offset(pos).width(w).height(h).css("zIndex",xui.Dom.TOP_ZINDEX+20).removeClass("xui-ui-hidden"),rotate&&profile.proxy.rotate(rotate)):profile.proxy=o,profile.o_w2=profile.o_w=w,profile.o_h2=profile.o_h=h,profile.o_pos=profile.proxy.cssPos(),profile.o_size={width:w,height:h},profile.o_rotate=rotate,profile.regions&&(profile.o_regions=[],profile.regions.each((function(n){profile.o_regions.push(xui(n).cssSize())}))),profile.$onDrag=!0,xui.Tips.hide()},_onDrag:function(profile,e,src,axis){var args=this._getDDParas(profile.o_rotate,axis);profile.oos=profile.oos||{};var x,y,w,h,rotate,dd=xui.DragDrop.getProfile(),t=profile.properties,xOff=t.xOff||0,yOff=t.yOff||0,elemAngle=profile.o_rotate,cs=profile.o_size,sp=profile.o_pos,os=dd.offset,dx=os.x,dy=os.y,data={};if(0!==dx||0!==dy){if(elemAngle&&!args.move&&!args.rotate){var adjustAngle=function(a){return(a+360)%360},distance=Math.pow(Math.pow(dx,2)+Math.pow(dy,2),.5),mouseAngle=adjustAngle(180*Math.atan2(dx,-dy)/Math.PI),offAngle=elemAngle+90-mouseAngle,flagX=adjustAngle(mouseAngle-elemAngle)<180?1:-1,flagY=adjustAngle(mouseAngle-elemAngle)<90||adjustAngle(mouseAngle-elemAngle)>270?-1:1;dx=distance*Math.abs(Math.cos(offAngle*Math.PI/180))*flagX,dy=distance*Math.abs(Math.sin(offAngle*Math.PI/180))*flagY}if(dx!=profile.oos.width||dy!=profile.oos.height){if(profile.oos={width:dx,height:dy},args.left?(w=profile.o_w-dx,x=sp.left+dx,w<t.minWidth?(w=t.minWidth,x=profile.o_w+sp.left-w):w>t.maxWidth&&(w=t.maxWidth,x=profile.o_w+sp.left-w),xui.merge(data,{width:w,left:x})):args.right&&((w=profile.o_w+dx)<t.minWidth?w=t.minWidth:w>t.maxWidth&&(w=t.maxWidth),xui.merge(data,{width:w})),args.top?(h=profile.o_h-dy,y=sp.top+dy,h<t.minHeight?(h=t.minHeight,y=profile.o_h+sp.top-h):h>t.maxHeight&&(h=t.maxHeight,y=profile.o_h+sp.top-h),xui.merge(data,{height:h,top:y})):args.bottom&&((h=profile.o_h+dy)<t.minHeight?h=t.minHeight:h>t.maxHeight&&(h=t.maxHeight),xui.merge(data,{height:h})),elemAngle&&!args.move&&!args.rotate){delete data.left,delete data.top;var xRate=Math.abs(Math.cos(elemAngle*Math.PI/180)),yRate=Math.abs(Math.sin(elemAngle*Math.PI/180)),oldBBoxCX=sp.left+cs.width/2,oldBBoxCY=sp.top+cs.height/2,oldBboxW=cs.width*xRate+cs.height*yRate,oldBboxH=cs.width*yRate+cs.height*xRate,newBboxCX=(data.left||sp.left)+(data.width||cs.width)/2,newBboxCY=(data.top||sp.top)+(data.height||cs.height)/2,newBboxW=(data.width||cs.width)*xRate+(data.height||cs.height)*yRate,newBboxH=(data.width||cs.width)*yRate+(data.height||cs.height)*xRate,offW=(newBboxW-oldBboxW)/2,offH=(newBboxH-oldBboxH)/2,offCX=newBboxCX-oldBBoxCX,offCY=newBboxCY-oldBBoxCY;switch(data.left=sp.left-offCX,data.top=sp.top-offCY,this._switchAxis(axis,elemAngle,!0)){case"e":elemAngle<90?data.top-=(data.height||cs.height)*xRate-newBboxH/2-(cs.height*xRate-oldBboxH/2):elemAngle>90&&elemAngle<180?data.top-=(data.width||cs.width)*yRate-newBboxH/2-(cs.width*yRate-oldBboxH/2):data.top+=elemAngle>180&&elemAngle<270?(data.width||cs.width)*yRate-newBboxH/2-(cs.width*yRate-oldBboxH/2):(data.height||cs.height)*xRate-newBboxH/2-(cs.height*xRate-oldBboxH/2),data.left+=offW;break;case"s":elemAngle<90?data.left-=(data.height||cs.height)*yRate-newBboxW/2-(cs.height*yRate-oldBboxW/2):elemAngle>90&&elemAngle<180?data.left-=(data.width||cs.width)*xRate-newBboxW/2-(cs.width*xRate-oldBboxW/2):data.left+=elemAngle>180&&elemAngle<270?(data.width||cs.width)*xRate-newBboxW/2-(cs.width*xRate-oldBboxW/2):(data.height||cs.height)*yRate-newBboxW/2-(cs.height*yRate-oldBboxW/2),data.top+=offH;break;case"w":elemAngle<90?data.top+=(data.height||cs.height)*xRate-newBboxH/2-(cs.height*xRate-oldBboxH/2):elemAngle>90&&elemAngle<180?data.top+=(data.width||cs.width)*yRate-newBboxH/2-(cs.width*yRate-oldBboxH/2):data.top-=elemAngle>180&&elemAngle<270?(data.width||cs.width)*yRate-newBboxH/2-(cs.width*yRate-oldBboxH/2):(data.height||cs.height)*xRate-newBboxH/2-(cs.height*xRate-oldBboxH/2),data.left-=offW;break;case"n":elemAngle<90?data.left+=(data.height||cs.height)*yRate-newBboxW/2-(cs.height*yRate-oldBboxW/2):elemAngle>90&&elemAngle<180?data.left+=(data.width||cs.width)*xRate-newBboxW/2-(cs.width*xRate-oldBboxW/2):data.left-=elemAngle>180&&elemAngle<270?(data.width||cs.width)*xRate-newBboxW/2-(cs.width*xRate-oldBboxW/2):(data.height||cs.height)*yRate-newBboxW/2-(cs.height*yRate-oldBboxW/2),data.top-=offH}}if((args.left||args.right)&&profile.regions&&"width"in data&&data.width!==cs.width){var offw=data.width-cs.width;profile.regions.each((function(n,i){xui(n).width(profile.o_regions[i].width+offw)}))}if((args.top||args.bottom)&&profile.regions&&"height"in data&&data.height!==cs.height){var offh=data.height-cs.height;profile.regions.each((function(n,i){xui(n).height(profile.o_regions[i].height+offh)}))}if(args.move&&(x=sp.left+dx,y=sp.top+dy,xui.merge(data,{top:y,left:x})),data.transform="",!xui.isEmpty(data)){var t1=0;"left"in data&&(t1=Math.floor(parseFloat(data.left)),data.left!==t1&&(data.transform+=" translateX("+(data.left-t1)+"px)",data.left=t1)),"top"in data&&(t1=Math.floor(parseFloat(data.top)),data.top!==t1&&(data.transform+=" translateY("+(data.top-t1)+"px)",data.top=t1)),xui.each(data,(function(o,i){"transform"!==i&&(data[i]=Math.floor(parseFloat(o))+"px")}))}if(args.rotate?((rotate=180-180*Math.atan2(dd.x-profile.o_center.x,dd.y-profile.o_center.y)/Math.PI)<0&&(rotate+=360),rotate=parseInt(rotate,10),data.transform+=" rotate("+rotate+"deg)"):elemAngle&&(data.transform+=" rotate("+elemAngle+"deg)"),data.transform||delete data.transform,!xui.isEmpty(data)){profile.proxy.css(data),profile.onChange&&profile.boxing().onChange(profile,profile.proxy);var s=args.rotate?parseInt(rotate,10)+"°":args.move?parseInt(data.left,10)-xOff+" : "+(parseInt(data.top,10)-yOff):parseInt(data.width||cs.width,10)+" X "+parseInt(data.height||cs.height,10);xui.Tips.show(e,{tips:s})}}}},_onDragstop:function(profile,e,src,axis){var cssSize,cssPos,offsize,offpos,rotate,cs=profile.o_size,sp=profile.o_pos,o=profile.proxy,args=this._getDDParas(profile.o_rotate,axis);"exmove"!=axis&&(args.move||args.rotate||0===(offsize={width:(cssSize=o.cssSize()).width-cs.width,height:cssSize.height-cs.height}).width&&0===offsize.height&&(offsize=null),0===(offpos={left:(cssPos=o.cssPos()).left-sp.left,top:cssPos.top-sp.top}).left&&0===offpos.top&&(offpos=null),args.rotate&&(rotate=o.rotate()),profile.onUpdate&&!1===profile.boxing().onUpdate(profile,profile._target,offsize,offpos,rotate)||profile.box._onUpdate(profile,profile._target,offsize,offpos,rotate),profile.properties._attached&&(xui.browser.ie6&&profile._target.ieRemedy(),profile.proxy.html("",!1).css({visibility:"hidden",border:"none",zIndex:"0",width:"0",height:"0",rotate:0}))),profile.$onDrag=!1,delete profile.o_rotate,profile.box._tryCursors(profile),xui.Tips.hide()}}}),xui.Class("xui.UI.Block","xui.UI.Widget",{Initialize:function(){var t=this.getTemplate();t.className+=" {_sidebarStatus}",xui.merge(t.FRAME.BORDER,{className:"xui-uiw-border {clsBorderType1}",SIDEBAR:{tagName:"div",className:"xui-uisb xui-uibar {_sidebar}",SBCAP:{className:"xui-uisbcap xui-title-node",text:"{sideBarCaption}"},SBBTN:{$order:1,className:"xui-uisbbtn xuifont",$fonticon:"{_fi_btn}"}},PANEL:{tagName:"div",className:"xui-uibar xui-uicontainer {clsBorderType2}",style:"{_panelstyle};{background};{_overflow};",text:"{html}"+xui.UI.$childTag}},"all"),this.setTemplate(t),t=this.getAppearance(),xui.merge(t,{PANEL:{position:"relative",overflow:"auto"},SBCAP:{"text-overflow":"ellipsis","white-space":"nowrap",overflow:"hidden"},SBBTN:{"z-index":2,margin:"0.33333em"}}),this.setAppearance(t)},Instance:{hide:function(ignoreEffects){return this.each((function(profile){profile.$inModal&&profile.box._unModal(profile)})),arguments.callee.upper.apply(this)},getFiles:function(){return this.get(0).$files||[]},removeFiles:function(files){var prf=this.get(0);return files&&prf.$files?xui.isArr(files)?xui.filter(prf.$files,(function(item){return-1==files.indexOf(item)})):xui.arr.removeValue(prf.$files,files):prf.$files=null,prf.onFiles&&prf.boxing().onFiles(prf,prf.$files||[]),prf.$files}},Static:{Behaviors:{HoverEffected:{SBBTN:"SBBTN",SBCAP:null},ClickEffected:{SBBTN:"SBBTN"},DroppableKeys:["PANEL"],PanelKeys:["PANEL"],PANEL:{onClick:function(profile,e,src){return!profile.properties.disabled&&(profile.onClickPanel?profile.boxing().onClickPanel(profile,e,src):void 0)}},SBBTN:{onClick:function(profile,e,src){var p=profile.properties;if(p.disabled)return!1;profile.boxing().setSideBarStatus("fold"==p.sideBarStatus?"expand":"fold")}},SIDEBAR:{onClick:function(profile,e,src){var p=profile.properties,btn=profile.getSubNode("SBBTN");if(p.disabled)return!1;xui.Event.getSrc(e).$xid!=btn.xid()&&"fold"==p.sideBarStatus&&btn.onClick(!0)}}},EventHandlers:{onClickPanel:function(profile,e,src){},onClickBackdrop:function(profile,e,src){},onFiles:function(profile,files){},onFileError:function(profile,message,file){}},DataModel:{disabled:null,tips:null,rotate:null,iframeAutoLoad:{ini:"",action:function(){xui.UI.Div._applyAutoLoad(this)}},ajaxAutoLoad:{ini:"",action:function(){xui.UI.Div._applyAutoLoad(this)}},selectable:!0,backdrop:{ini:"",combobox:["","transparent","#FFFFFF","background:#000;opacity:0.7;"],action:function(v){this.box&&(this.box._unModal(this),v&&this.box._modal(this))}},backdropClick:{ini:"",listbox:["","none","hide","destroy"]},dropFileTypes:{ini:"",combobox:["","*","image/*","image/jpeg,image/png,image/gif",".doc,.docx"]},maxFileSize:0,html:{html:1,action:function(v,ov,force){this.getSubNode("PANEL").html(xui.adjustRes(v,0,1),null,null,force)}},borderType:{ini:"outset",listbox:["none","flat","inset","outset","groove","ridge"],action:function(v){var p=this.properties;this.box._borderType(this,v,p.sideBarStatus,p.sideBarType.split("-"),!0)}},sideBarCaption:{ini:"",action:function(v){this.getSubNode("SBCAP").html(v)}},sideBarType:{ini:"none",listbox:["none","left","right","top","bottom","left-top","left-bottom","right-top","right-bottom","top-left","top-right","bottom-left","bottom-right"],action:function(v){var ns=this,prop=ns.properties;ns.box._adjustSideBar(ns,prop.sideBarStatus,v),"none"!=prop.dock?ns.boxing().adjustDock(!0):ns.adjustSize()}},sideBarStatus:{ini:"expand",listbox:["expand","fold"],action:function(v){var ns=this,prop=ns.properties;ns.getRoot().tagClass("-fold","expand"!=v),ns.box._adjustSideBar(ns,v,prop.sideBarType),xui.UI.$doResize(ns,prop.width,prop.height,!0),ns.boxing().adjustDock(!0)}},sideBarSize:{ini:"2em",action:function(v){"none"==this.properties.dock?this.adjustSize():this.boxing().adjustDock(!0)}},background:{format:"color",ini:"",action:function(v){this.getSubNode("PANEL").css("background",v)}},width:{$spaceunit:1,ini:"10em"},height:{$spaceunit:1,ini:"10em"}},Appearances:{KEY:{"line-height":"normal"},"KEY-fold PANEL":{display:"none"},"KEY-fold SIDEBAR":{cursor:"pointer","background-color":"#B6B6B6"}},RenderTrigger:function(){var ns=this;"xui.UI.Block"==ns.box.KEY&&(ns.properties.iframeAutoLoad||ns.properties.ajaxAutoLoad)&&xui.UI.Div._applyAutoLoad(this),ns.destroyTrigger=function(){var s=this,panel=this.getSubNode("PANEL").get(0);s.$inModal&&s.box._unModal(s),s.$input&&s.$inputchange&&s.$input.removeEventListener("change",s.$inputchange,!1),s.$dragover&&panel.removeEventListener("dragover",s.$dragover,!1),s.$dragleave&&panel.removeEventListener("dragleave",s.$dragleave,!1),s.$drop&&panel.removeEventListener("drop",s.$drop,!1),s.$click&&panel.removeEventListener("click",s.$click,!1),s.$files=null};var dropFileTypes=ns.properties.dropFileTypes,maxFileSize=ns.properties.maxFileSize;if(!ns.$inDesign&&xui.Dom.supportDropzone()&&dropFileTypes){var panel=ns.getSubNode("PANEL").get(0),input=ns.$input=document.createElement("input"),prevent=function(e){e.preventDefault(),e.stopPropagation()},validFiles=function(files){for(var fs=[],arr=dropFileTypes.split(/,\s*/),i=0,len=files.length;i<len;i++){var pass;if(maxFileSize&&files[i].size>maxFileSize)ns.onFileError&&ns.boxing().onFileError(ns,"File too large",files[i]);else{if(!files[i].type)try{(new FileReader).readAsBinaryString(files[i].slice(0,5))}catch(e){ns.onFileError&&ns.boxing().onFileError(ns,"It's a dir",files[i]);continue}if(-1!=arr.indexOf(files[i].type))fs.push(files[i]),pass=1;else for(var j=0,k=arr.length;j<k;j++)if(-1!=arr[j].indexOf("*")&&("*"==arr[j]||new RegExp("^"+arr[j].replace("*","")+"[.-\\w]+$").test(files[i].type))){fs.push(files[i]),pass=1;break}!pass&&ns.onFileError&&ns.boxing().onFileError(ns,"Type is not allowed: "+files[i].type,files[i])}}return fs},triggerCallback=function(e){var files;if(e.dataTransfer){if(!(files=e.dataTransfer.files)||!files.length){var html=e.dataTransfer.getData("text/html"),match=html&&/\bsrc="?([^"\s]+)"?\s*/.exec(html),url=match&&match[1];if(url){var img=new Image,c=document.createElement("canvas"),ctx=c.getContext("2d");img.onload=function(){c.width=this.naturalWidth,c.height=this.naturalHeight,ctx.drawImage(this,0,0),c.toBlob((function(blob){ns.onFiles&&ns.boxing().onFiles(ns,ns.$files=validFiles([blob]))}),"image/png"),img.onload=img.onerror=null},img.onerror=function(e){ns.onFileError&&ns.boxing().onFileError(ns,"Error at: "+url,null),img.onload=img.onerror=null},img.crossOrigin="",img.src=url}return}if(xui.Dom.supportPromise()&&e.dataTransfer.items&&e.dataTransfer.items[0]&&e.dataTransfer.items[0].webkitGetAsEntry){var getFilesFromDataTransferItems=async function(dataTransferItems){for(var readFile=function(entry,path){return new Promise((function(resolve,reject){entry.file((function(file){file.filepath=(path||"")+file.name,resolve(file)}),(function(err){reject(err)}))}))},dirReadEntries=function(dirReader,path){return new Promise((function(resolve,reject){dirReader.readEntries((async function(entries){var files=[];for(var entry of entries){const itemFiles=await getFilesFromEntry(entry,path);files=files.concat(itemFiles)}resolve(files)}),(function(err){reject(err)}))}))},getFilesFromEntry=async function(entry,path){return entry.isDirectory?await async function(entry,path){var newFiles,dirReader=entry.createReader(),newPath=path+entry.name+"/",files=[];do{newFiles=await dirReadEntries(dirReader,newPath),files=files.concat(newFiles)}while(newFiles.length>0);return files}(entry,path||""):[await readFile(entry,path||"")]},files=[],entries=[],i=0,l=dataTransferItems.length;i<l;i++)entries.push(dataTransferItems[i].webkitGetAsEntry());for(var entry of entries)files=files.concat(await getFilesFromEntry(entry));return files};return void async function(){try{var files=await getFilesFromDataTransferItems(e.dataTransfer.items);ns.onFiles&&ns.boxing().onFiles(ns,ns.$files=validFiles(files))}catch(e){ns.onFileError&&ns.boxing().onFileError(ns,"Error at: "+xui.getErrMsg(e),e)}}()}}else e.target&&(files=e.target.files);ns.$files=files,ns.onFiles&&ns.boxing().onFiles(ns,ns.$files=validFiles(files))};input.type="file",input.accept=ns.properties.dropFileTypes,input.multiple=!0,input.style.display="none",input.addEventListener("change",ns.$inputchange=function(e){triggerCallback(e)},!1),this.getRootNode().appendChild(input),panel.addEventListener("dragover",ns.$dragover=function(e){prevent(e),xui.DragDrop.setDropFace(panel)},!1),panel.addEventListener("dragleave",ns.$dragleave=function(e){prevent(e),xui.DragDrop.setDropFace()},!1),panel.addEventListener("drop",ns.$drop=function(e){prevent(e),xui.DragDrop.setDropFace(),triggerCallback(e)},!1),panel.addEventListener("click",ns.$click=function(){input.value=null,input.click()},!1)}},_sbicon:function(profile,sideBarStatus,type,ui){var target="fold"==sideBarStatus?"left"==type?"left":"right"==type?"right":"top"==type?"up":"down":"left"==type?"right":"right"==type?"left":"top"==type?"down":"up";return ui?profile.getSubNode("SBBTN").replaceClass(/(xui-icon-double)[\w]+/g,"$1"+target):"xui-icon-double"+target},_borderType:function(profile,borderType,sideBarStatus,type,adjust){type="expand"==sideBarStatus?type[0]:type[1]||type[0];var ns=profile,v=borderType,n1=ns.getSubNode("BORDER"),n2=ns.getSubNode("PANEL"),reg=/^xui-uiborder-/,b="xui-uiborder-",r=b+"radius",i=b+"inset",o=b+"outset",ibr="left"==type?r+"-tr "+r+"-br":"top"==type?r+"-bl "+r+"-br":"right"==type?r+"-tl "+r+"-bl":"bottom"==type?r+"-tl "+r+"-tr":r,ins=i+" "+r,outs=o+" "+r,ins2=i+" "+ibr,outs2=o+" "+ibr;switch(ns.getRoot(),n1.removeClass(reg),n2.removeClass(reg),v){case"flat":n1.addClass("xui-uiborder-flat xui-uiborder-radius"),n2.addClass(ibr);break;case"inset":n1.addClass(ins),n2.addClass(ibr);break;case"outset":n1.addClass(outs),n2.addClass(ibr);break;case"groove":n1.addClass(ins),n2.addClass(outs2);break;case"ridge":n1.addClass(outs),n2.addClass(ins2)}ns.box._setB(ns),adjust&&ns.adjustSize()},_adjustSideBar:function(prf,sideBarStatus,sideBarType){var ns=prf,prop=ns.properties,arr=sideBarType.split("-");ns.getSubNode("SIDEBAR").removeClass(/^xui-uisb-/).addClass("xui-uisb-"+("expand"==sideBarStatus?arr[0]:arr[1]||arr[0])),ns.box._sbicon(ns,sideBarStatus,arr[1]||arr[0],!0),ns.box._borderType(ns,prop.borderType,sideBarStatus,arr,!1)},_setB:function(profile){var p=profile.properties,type=p.borderType,w=profile.getSubNode("BORDER")._borderW("left");p.$hborder=p.$vborder=p.$iborder=0,"flat"==type||"inset"==type||"outset"==type?(p.$hborder=p.$vborder=w,p.$iborder=0):"groove"!=type&&"ridge"!=type||(p.$hborder=p.$vborder=p.$iborder=w)},LayoutTrigger:function(){var prop=this.properties,m=prop.sideBarStatus,v=prop.borderType;if("none"!=v&&this.boxing().setBorderType(v,!0),"fold"==m&&this.boxing().setSideBarStatus("fold",!0),prop.backdrop){var p=this.$modalDiv&&this.$modalDiv.parent(),b=this.box;p&&p.get(0)&&p.get(0)!==this.getRootNode()&&b._unModal(this),b._modal(this)}},_modal:function(profile){var cover,s=profile.getRoot(),p=s.parent(),props=profile.properties,bdc=props.backdropClick,bd=props.backdrop;if(!p.isEmpty()&&!profile.$inModal){if(profile.$modalDiv&&profile.$modalDiv.remove(),(cover=profile.$modalDiv=xui.create("<div class='xui-cover xui-custom xui-cover-modal' style='cursor:default;left:0;top:0;position:absolute;overflow:hidden;display:block;z-index:0;'></div>")).css({display:"block",width:Math.max(p.width(),p.scrollWidth())+"px",height:Math.max(p.height(),p.scrollHeight())+"px"}),/:/.test(bd)){var ex={};xui.arr.each(bd.split(/;\s*/),(function(s){var a=s.split(/:\s*/);a[0]&&"display"!==a[0]&&"visibility"!==a[0]&&(ex[a[0]]=a[1])})),xui.isEmpty(ex)||cover.css(ex)}else cover.css("background-color",bd);cover.onClick((function(p,e,src){if(bdc)"hide"==bdc?profile.boxing().hide():"destroy"==bdc&&profile.boxing().destroy();else if(profile.onClickBackdrop)return profile.boxing().onClickBackdrop(profile,e,src);return!!profile.$inDesign&&null})).topZindex(!0).setSelectable(!1),p.append(cover),p.get(0)!==document.body&&p.get(0)!==document&&p.get(0)!==window||(p=xui.win),profile.$inDesign&&cover.onClick((function(){s.onClick(!0)})),p.onSize((function(node){var w=(node=xui(node)).width()+"px",h=node.height()+"px";cover.css({width:w,height:h}),xui.asyRun((function(){var w=Math.max(node.width(),node.scrollWidth())+"px",h=Math.max(node.height(),node.scrollHeight())+"px";cover.css({width:w,height:h})}))}),"dialog:"+profile.serialId);var i=(parseInt(cover.css("zIndex"),10)||0)+1;s.css("zIndex",i),i>=xui.Dom.TOP_ZINDEX&&(xui.Dom.TOP_ZINDEX=i+1),profile.$inModal=!0,p.setBlurTrigger(profile.$xid+"_anti",!0,xui([cover.get(0),profile.getRootNode()]))}},_unModal:function(profile){if(profile.$inModal){var p=profile.$modalDiv.parent();p.get(0)!==document.body&&p.get(0)!==document&&p.get(0)!==window||(p=xui.win),p.onSize(null,"block:"+profile.serialId),profile.getRoot().css("zIndex",0),profile.$modalDiv.css("display","none");var node=profile.getSubNode("BORDER");node.isEmpty()||node.append(profile.$modalDiv),profile.$inModal=!1,p.setBlurTrigger(profile.$xid+"_anti")}},_prepareData:function(profile){var data=arguments.callee.upper.call(this,profile),a=data.sideBarType.split("-"),b=data.sideBarStatus;return data.background=data.background?"background:"+data.background:"",xui.isStr(data.overflow)&&(data._overflow=-1!=data.overflow.indexOf(":")?data.overflow:data.overflow?"overflow:"+data.overflow:""),data._sidebar="xui-uisb-"+("expand"==b?a[0]:a[1]||a[0]),data._sidebarStatus="fold"==b?profile.getClass("KEY","-fold"):"",data._fi_btn=profile.box._sbicon(profile,b,a[1]||a[0]),data},_onresize:function(profile,width,height){var size=arguments.callee.upper.apply(this,arguments),root=profile.getRoot(),border=profile.getSubNode("BORDER"),panel=profile.getSubNode("PANEL"),sidebar=profile.getSubNode("SIDEBAR"),sbcap=profile.getSubNode("SBCAP"),prop=profile.properties,sbs=prop.sideBarStatus,sbtype=prop.sideBarType.split("-"),cb1=border.contentBox(),bv=2*(prop.$vborder||0),bh=2*(prop.$hborder||0),cb2=panel.contentBox(),b2=2*(prop.$iborder||0),us=xui.$us(profile),adjustunit=function(v,emRate){return profile.$forceu(v,us>0?"em":"px",emRate)},fzrate=profile.getEmSize()/root._getEmSize(),panelfz=panel._getEmSize(fzrate),ww=width?profile.$px(size.width):size.width,hh=height?profile.$px(size.height):size.height,sbsize=profile.$px(prop.sideBarSize),sbsize2=adjustunit(sbsize);if(sbtype="expand"==sbs?sbtype[0]:sbtype[1]||sbtype[0],size.left=size.top=0,sbtype&&"none"!=sbtype){if(sbcap.css("line-height",adjustunit(sbsize-(cb1?bh:0))),"left"==sbtype||"right"==sbtype?(sidebar.width(sbsize2),height&&"auto"!==height&&sidebar.height(adjustunit(hh-(cb1?0:bv)))):(sidebar.height(sbsize2),sidebar.width(adjustunit(ww-(cb1?0:bh)))),"fold"==sbs)return void("left"==sbtype||"right"==sbtype?(root.width(adjustunit(sbsize+bh)),border.width(adjustunit(sbsize+(cb1?0:bh)))):(root.height(adjustunit(sbsize+bv)),border.height(adjustunit(sbsize+(cb1?0:bv)))));switch("left"==sbtype||"right"==sbtype?(root.width(adjustunit(width)),border.width(adjustunit(ww))):(root.height(adjustunit(height)),border.height(adjustunit(hh))),sbtype){case"left":ww-=sbsize,size.left=sbsize;break;case"right":ww-=sbsize;break;case"top":hh-=sbsize,size.top=sbsize;break;case"bottom":hh-=sbsize}}size.width&&(size.width=adjustunit(ww-(cb1?0:bh)-(cb2?b2:0),panelfz)),size.height&&"auto"!==size.height&&(size.height=adjustunit(hh-(cb1?0:bv)-(cb2?b2:0),panelfz)),panel.cssRegion(size,!0),size.width&&xui.UI._adjustConW(profile,panel,size.width)},_showTips:function(profile,node,pos){var p=profile.properties;if(!p.disableTips){if(profile.onShowTips)return profile.boxing().onShowTips(profile,node,pos);if(xui.Tips&&"none"!=p.sideBarType){var id=node.id,ks=profile.keys;return"fold"!=p.sideBarStatus||0!==id.indexOf(ks.SBCAP)&&0!==id.indexOf(ks.SBBTN)?"expand"==p.sideBarStatus&&0===id.indexOf(ks.SBBTN)?(xui.Tips.show(pos,{tips:xui.wrapRes("$inline.Fold")}),!1):void 0:(xui.Tips.show(pos,{tips:xui.wrapRes("$inline.Expand")}),!1)}}}}}),xui.Class("xui.UI.Label","xui.UI",{Initialize:function(){xui.UI.SLabel=xui.UI.Label;var key="xui.UI.SLabel";xui.absBox.$type[key.replace("xui.UI.","")]=xui.absBox.$type[key]=key},Instance:{fireClickEvent:function(){return this.getRoot().onClick(),this},_applyExcelFormula:function(cellsMap){var f,value,profile=this.get(0),prop=profile.properties;(f=prop.excelCellFormula)&&(value=xui.ExcelFormula.calculate(f,cellsMap),xui.isSet(value)&&(profile.beforeApplyExcelFormula&&!1===profile.beforeApplyExcelFormula(profile,prop.excelCellFormula,value)||(this.setCaption(value,!0),profile.afterApplyExcelFormula&&profile.afterApplyExcelFormula(profile,prop.excelCellFormula,value))))}},Static:{Templates:{tagName:"label",className:"{_className}",style:"{_hAlign};{_vAlign};{_style}",VALIGN:{$order:0,style:"{_vAlign2}"},ICON:{$order:1,className:"xuicon {imageClass}  {picClass}",style:"{backgroundImage}{backgroundPosition}{backgroundSize}{backgroundRepeat}{iconFontSize}{imageDisplay}{iconStyle}",text:"{iconFontCode}"},CAPTION:{$order:2,text:"{caption}",style:"{_fc}{_fw}{_fs}{_ff}","font-size":"1em"}},Appearances:{VALIGN:{"font-size":0,width:0,display:"inline-block",height:"100%"}},DataModel:{selectable:!0,caption:{ini:undefined,action:function(v){this.properties.clock||(v=(xui.isSet(v)?v:"")+"",this.getSubNode("CAPTION").html(xui.adjustRes(v,!0)))}},clock:{ini:"",combobox:["hh : nn : ss","hh - nn : ss"],action:function(v){var prf=this;v&&!prf._timer?((prf._timer=new xui.Timer).get(0).$onTime=function(){prf.destroyed||prf.getSubNode("CAPTION").html(xui.Date.format(new Date,prf.properties.clock))})():!v&&prf._timer&&(prf._timer.destroy(),prf._timer=null,prf.boxing().setCaption(prf.properties.caption,!0))}},image:{format:"image",action:function(v){xui.UI.$iconAction(this)}},imagePos:{action:function(value){this.getSubNode("ICON").css("backgroundPosition",value||"center")}},imageBgSize:{action:function(value){this.getSubNode("ICON").css("backgroundSize",value||"")}},imageClass:{ini:"",action:function(v,ov){xui.UI.$iconAction(this,"ICON",ov)}},iconFontCode:{action:function(v){xui.UI.$iconAction(this)}},hAlign:{ini:"right",listbox:["left","center","right"],action:function(v){xui.Dom.css3Support("flex")?this.getRoot().css({"justify-content":"left"==v?"flex-start":"right"==v?"flex-end":"center"}):this.getRoot().css("textAlign",v||"")}},vAlign:{ini:"top",listbox:["top","middle","bottom"],action:function(v){xui.Dom.css3Support("flex")?this.getRoot().css({"align-items":"top"==v?"flex-start":"bottom"==v?"flex-end":"center"}):this.getSubNode("VALIGN").css("verticalAlign",v||"")}},fontColor:xui.UI.Button.$DataModel.fontColor,fontSize:xui.UI.Button.$DataModel.fontSize,fontWeight:xui.UI.Button.$DataModel.fontWeight,fontFamily:xui.UI.Button.$DataModel.fontFamily,excelCellFormula:{ini:"",action:function(v){var m;this.properties,v&&xui.ExcelFormula.validate(v)&&this.host&&(m=this.host["xui.Module"])&&m.applyExcelFormula(this)}}},Behaviors:{HoverEffected:{KEY:"KEY",ICON:"ICON"},onClick:function(profile,e,src){return!profile.properties.disabled&&(profile.onClick?profile.boxing().onClick(profile,e,src):void 0)}},EventHandlers:{onClick:function(profile,e,src){},beforeApplyExcelFormula:function(profile,excelCellFormula,value){},afterApplyExcelFormula:function(profile,excelCellFormula,value){}},RenderTrigger:function(){var t,prf=this;(prf.$beforeDestroy=prf.$beforeDestroy||{}).timerClear=function(){prf._timer&&(prf._timer.destroy(),delete prf._timer)},(t=prf.properties.clock)&&prf.boxing().setClock(t,!0)},_prepareData:function(profile,data){var v;return(data=arguments.callee.upper.call(this,profile,data)).clock&&(data.caption=""),(v=data.fontSize)&&(data._fs="font-size:"+v+";"),(v=data.fontWeight)&&(data._fw="font-weight:"+v+";"),(v=data.fontColor)&&(data._fc="color:"+v+";"),(v=data.fontFamily)&&(data._ff="font-family:"+v+";"),xui.Dom.css3Support("flex")?(data._hAlign="display:inline-flex;justify-content:"+("left"==data.hAlign?"flex-start":"right"==data.hAlign?"flex-end":"center"),data._vAlign="align-items:"+("top"==data.vAlign?"flex-start":"bottom"==data.vAlign?"flex-end":"center")):(data._hAlign="text-align:"+(data.hAlign||""),data._vAlign2="vertical-align:"+(data.vAlign||"")),data}}}),xui.Class("xui.UI.ProgressBar",["xui.UI.Widget","xui.absValue"],{Instance:{_setCtrlValue:function(value){return this.each((function(profile){var type=profile.properties.type,inn=profile.getSubNode("FILL");"horizontal"==type?inn.width(value+"%"):inn.top(100-value+"%").height(value+"%"),profile.getSubNode("CAP").text(profile.properties.captionTpl.replace(/\{value\}|\*/g,value))}))}},Initialize:function(){var t=this.getTemplate();xui.merge(t.FRAME.BORDER,{className:"xui-uiborder-flat xui-uiborder-radius xui-uibase",FILL:{tagName:"div",style:"{fillBG}",className:"xui-uibar",text:"{html}"+xui.UI.$childTag},INN:{$order:2,tagName:"div",CAP:{tagName:"div"}}},"all"),this.setTemplate(t),t=this.getAppearance(),xui.merge(t,{BORDER:{overflow:"hidden"},INN:{display:"table",position:"absolute",left:0,top:0,width:"100%",height:"100%"},CAP:{"text-align":"center"},FILL:{border:"none",position:"relative",width:0,height:0,left:0,top:0}}),this.setAppearance(t)},Static:{DataModel:{value:0,width:{$spaceunit:1,ini:"25em"},height:{$spaceunit:1,ini:"1.5em"},captionTpl:{ini:"* %",action:function(){this.boxing()._setCtrlValue(this.properties.$UIvalue)}},type:{listbox:["vertical","horizontal"],ini:"horizontal",action:function(v){var w=this.properties.width,h=this.properties.height;this.properties.height=w,this.properties.width=h,this.boxing().refresh()}},fillBG:{ini:"",format:"color",action:function(v){this.getSubNode("FILL").css("background",v)}},$hborder:1,$vborder:1},LayoutTrigger:function(){var v=this.properties,nd=this.getSubNode("BORDER");v.$hborder=v.$vborder=nd._borderW("left")},_prepareData:function(profile){var data=arguments.callee.upper.call(this,profile);return data.fillBG=data.fillBG?"background:"+data.fillBG:"",data},_ensureValue:function(profile,value){return Math.max(0,Math.min(100,(/^\s*\=/.test(value||"")?xui.ExcelFormula.calculate(value||""):parseInt(value,10))||0))},_onresize:function(profile,width,height){var v,size=arguments.callee.upper.apply(this,arguments),p=profile.properties,us=xui.$us(profile),adjustunit=function(v,emRate){return profile.$forceu(v,us>0?"em":"px",emRate)},root=profile.getRoot(),inn=profile.getSubNode("INN"),cap=profile.getSubNode("CAP"),fill=profile.getSubNode("FILL"),fzrate=profile.getEmSize()/root._getEmSize(),innfz=inn._getEmSize(fzrate),capfz=cap._getEmSize(fzrate),fillfz=fill._getEmSize(fzrate);size.width&&"auto"!=size.width&&(size.width=profile.$px(size.width)),size.height&&"auto"!=size.height&&(size.height=profile.$px(size.height)),"horizontal"==p.type?size.height&&(v=adjustunit(size.height,innfz),inn.css({"line-height":v}),v=adjustunit(size.height,fillfz),fill.css({height:v,"line-height":v}),v=adjustunit(size.height,capfz),cap.css({height:v,"line-height":v})):(size.width&&(fill.css({width:adjustunit(size.width,fillfz)}),cap.css({width:adjustunit(size.width,capfz)})),size.height&&(inn.css({"line-height":adjustunit(size.height,innfz)}),fill.css({"line-height":adjustunit(size.height,fillfz)}),cap.css({"line-height":adjustunit(size.height,capfz)})))}}}),xui.Class("xui.UI.Slider",["xui.UI","xui.absValue"],{Instance:{_setCtrlValue:function(value){return this.each((function(profile){var label,p=profile.properties,fun=(p.steps,function(k){return profile.getSubNode(k)}),a=fun("IND1"),b=fun("IND2"),c=fun("BG"),v="vertical"==p.type,arr=profile.box._v2a(profile,value),ori=v?"top":"left",orj=v?"height":"width",cap=xui.adjustRes(p.labelCaption,!0)||"";p.isRange?(a[ori](arr[0]+"%"),b[ori](arr[1]+"%"),c[ori](arr[0]+"%")[orj](arr[1]-arr[0]+"%"),label=(p.numberTpl+"").replace(/[*12]/g,(function(a){return"1"==a?xui.formatNumeric(arr[0],p.precision||0,null,null,!0):"2"==a?xui.formatNumeric(arr[1],p.precision||0,null,null,!0):cap}))):(a[ori](arr[0]+"%"),c[orj](arr[0]+"%"),-1!=(label=(p.numberTpl+"").replace(/1[^2]*2/,"1").replace("1",xui.formatNumeric(arr[0],p.precision||0,null,null,!0))).indexOf("*")?label=label.replace("*",cap):label+=cap),"none"!=p.labelPos&&parseFloat(p.labelSize)&&profile.getSubNode("LABEL").html(label)}))},_setDirtyMark:function(){return arguments.callee.upper.apply(this,["BOX"])}},Static:{Templates:{style:"{_style}",className:"{_className} xui-ui-ellipsis {_cls}",LABEL:{className:"{_required}",style:"{labelShow};width:{_labelSize};{labelHAlign}",text:"{labelCaption}"},BOX:{tagName:"div",RULER:{$order:1,tagName:"div",className:"xui-uiborder-flat xui-uibase xui-uiborder-radius",BG:{tagName:"div",className:"xui-uibar xui-uiborder-radius"}},IND:{$order:2,IND1:{tagName:"span",className:"xui-uibar xui-uigradient xui-ui-btn xui-uiborder-circle xuicon xui-icon-placeholder",style:"{_showD}",tabindex:"{tabindex}"},IND2:{tagName:"span",className:"xui-uibar xui-uigradient xui-ui-btn xui-uiborder-circle xuicon xui-icon-placeholder",style:"{_showD2}",tabindex:"{tabindex}"}},DECREASE:{style:"{_showDes}",className:"xuifont",$fonticon:"{_fi_decls}",tabindex:"{tabindex}"},INCREASE:{style:"{_showIns}",className:"xuifont",$fonticon:"{_fi_incls}",tabindex:"{tabindex}"}}},Appearances:{"IND, BT, RULER, IND1, IND2, DECREASE, INCREASE":{position:"absolute"},LABEL:{"z-index":1,top:0,left:0,display:xui.browser.isWebKit?"-webkit-flex":"flex",position:"absolute","padding-top":".5em"},BOX:{position:"absolute",left:0,top:0,width:"100%",height:"100%"},"KEY-h BOX":{$order:1,height:"2em"},"KEY-v BOX":{$order:2,width:"2em"},"KEY-v LABEL":{"writing-mode":"tb-rl",filter:"flipv fliph"},"KEY-h DECREASE, KEY-h INCREASE":{top:"50%","margin-top":"-.5em"},"KEY-h IND1,KEY-h IND2, KEY-v IND1,KEY-v IND2":{padding:0,margin:0},"KEY-h DECREASE":{$order:1,left:0},"KEY-h INCREASE":{$order:1,right:0},BG:{position:"absolute",left:0,top:0,height:"100%",width:"100%"},"KEY-h IND":{"z-index":1,top:"50%",height:xui.browser.contentBox?"2px":"4px","margin-top":"-1px"},"KEY-h RULER":{$order:2,top:"50%",height:xui.browser.contentBox?"2px":"4px","margin-top":"-2px"},"KEY-v DECREASE, KEY-v INCREASE":{$order:10,left:"50%","margin-left":"-.5em"},"KEY-v DECREASE":{$order:10,top:0},"KEY-v INCREASE":{$order:10,bottom:0},"KEY-v IND":{$order:10,"z-index":1,left:"50%",width:xui.browser.contentBox?"2px":"4px","margin-left":"-1px"},"KEY-v RULER":{$order:10,"z-index":1,left:"50%",width:xui.browser.contentBox?"2px":"4px","margin-left":"-2px"},"KEY-h IND1,KEY-h IND2":{$order:1,"z-index":2,left:0,top:0,cursor:"e-resize","margin-top":"-.5em","margin-left":"-.5em"},"KEY-v IND1,KEY-v IND2":{$order:10,"z-index":2,left:0,top:0,cursor:"n-resize","margin-top":"-.5em","margin-left":"-.5em"}},Behaviors:{HoverEffected:{IND1:"IND1",IND2:"IND2",DECREASE:"DECREASE",INCREASE:"INCREASE"},ClickEffected:{IND1:"IND1",IND2:"IND2",DECREASE:"DECREASE",INCREASE:"INCREASE"},IND:{onClick:function(profile,e,src){var p=profile.properties;if(p.disabled||p.readonly)return!1;var i1,i2,p1=xui.use(src).offset(),p2=xui.Event.getPos(e),arr=profile.box._v2a(profile,profile.properties.$UIvalue),type="vertical"==p.type,k1=type?"top":"left",k2=type?"top":"left",k3=type?"height":"width",cur=p2[k1]-p1[k1],v=cur/xui.use(src)[k3]()*100;p.isRange?(i1=profile.getSubNode("IND1")[k2](),i2=profile.getSubNode("IND2")[k2](),Math.abs(i1-cur)<Math.abs(i2-cur)?arr[0]=v:arr[1]=v):arr[0]=v,profile.boxing().setUIValue(profile.box._adjustValue(profile,arr),null,null,"click")}},IND1:{onKeydown:function(profile,e,src){var p=profile.properties;if(!p.disabled&&!p.readonly){var type="vertical"==p.type,key=xui.Event.getKey(e).key;key==(type?"up":"left")&&profile.box._auto(profile,!1),key==(type?"down":"right")&&profile.box._auto(profile,!0)}},onKeyout:function(profile){xui.Thread.abort(profile.$xid+":auto")},onKeyup:function(profile){xui.Thread.abort(profile.$xid+":auto")},beforeMousedown:function(profile,e,src){if("left"==xui.Event.getBtn(e)){var p=profile.properties;if(!p.disabled&&!p.readonly){var type="vertical"==p.type,k2=type?"top":"left",k3=type?"height":"width";profile.box,xui.use(src).startDrag(e,{widthIncrement:p.steps?profile._size/p.steps:null,dragType:"none",targetReposition:!0,horizontalOnly:!!type||null,verticalOnly:!type||null,maxLeftOffset:xui.use(src)[k2](),maxRightOffset:xui.use(src).parent()[k3]()-xui.use(src)[k2](),dragCursor:"default"}),xui.use(src).css("zIndex",10).focus(!0),profile.getSubNode("IND2").css("zIndex",5)}}},beforeDragbegin:function(profile,e,src){var type="vertical"==profile.properties.type;xui(src)[type?"top":"left"](profile.__x=profile.$px(xui.use(src)[type?"top":"left"]()))},onDrag:function(profile,e,src){var offset=xui.DragDrop.getProfile().offset,type="vertical"==profile.properties.type,arr=profile.box._v2a(profile,profile.properties.$UIvalue);arr[0]=(profile.__x+offset[type?"y":"x"])/xui.use(src).parent()[type?"height":"width"]()*100,profile.boxing().setUIValue(profile.box._adjustValue(profile,arr),null,null,"drag")},onDragstop:function(profile,e,src){xui(src).onMouseout(!0,{$force:!0}).onMouseup(!0)},onClick:function(){return!1}},IND2:{onKeydown:function(profile,e,src){var p=profile.properties;if(!p.disabled&&!p.readonly){var type="vertical"==p.type,key=xui.Event.getKey(e).key;key==(type?"up":"left")&&profile.box._auto(profile,!1),key==(type?"down":"right")&&profile.box._auto(profile,!0)}},onKeyout:function(profile){xui.Thread.abort(profile.$xid+":auto")},onKeyup:function(profile){xui.Thread.abort(profile.$xid+":auto")},beforeMousedown:function(profile,e,src){if("left"==xui.Event.getBtn(e)){var p=profile.properties;if(!p.disabled&&!p.readonly){var type="vertical"==p.type,k2=type?"top":"left",k3=type?"height":"width";profile.box,xui.use(src).startDrag(e,{widthIncrement:p.steps?profile._size/p.steps:null,dragType:"none",targetReposition:!0,horizontalOnly:!!type||null,verticalOnly:!type||null,maxLeftOffset:xui.use(src)[k2](),maxRightOffset:xui.use(src).parent()[k3]()-xui.use(src)[k2](),dragCursor:"default"}),xui.use(src).css("zIndex",10).focus(!0),profile.getSubNode("IND1").css("zIndex",5)}}},beforeDragbegin:function(profile,e,src){var type="vertical"==profile.properties.type;xui(src)[type?"top":"left"](profile.__x=profile.$px(xui.use(src)[type?"top":"left"]()))},onDrag:function(profile,e,src){var offset=xui.DragDrop.getProfile().offset,type="vertical"==profile.properties.type,arr=profile.box._v2a(profile,profile.properties.$UIvalue);arr[1]=(profile.__x+offset[type?"y":"x"])/xui.use(src).parent()[type?"height":"width"]()*100,profile.boxing().setUIValue(profile.box._adjustValue(profile,arr),null,null,"drag2")},onDragstop:function(profile,e,src){xui(src).onMouseout(!0,{$force:!0}).onMouseup(!0)},onClick:function(){return!1}},DECREASE:{onMousedown:function(profile){profile.properties.disabled||profile.properties.readonly||profile.box._auto(profile,!1)},onMouseout:function(profile){profile.properties.disabled||profile.properties.readonly||xui.Thread.abort(profile.$xid+":auto")},onMouseup:function(profile){profile.properties.disabled||profile.properties.readonly||xui.Thread.abort(profile.$xid+":auto")}},INCREASE:{onMousedown:function(profile){profile.properties.disabled||profile.properties.readonly||profile.box._auto(profile,!0)},onMouseout:function(profile){profile.properties.disabled||profile.properties.readonly||xui.Thread.abort(profile.$xid+":auto")},onMouseup:function(profile){profile.properties.disabled||profile.properties.readonly||xui.Thread.abort(profile.$xid+":auto")}},LABEL:{onClick:function(profile,e,src){if(profile.properties.disabled)return!1;profile.onLabelClick&&profile.boxing().onLabelClick(profile,e,src)},onDblClick:function(profile,e,src){if(profile.properties.disabled)return!1;profile.onLabelDblClick&&profile.boxing().onLabelDblClick(profile,e,src)},onMousedown:function(profile,e,src){if("left"==xui.Event.getBtn(e))return!profile.properties.disabled&&void(profile.onLabelActive&&profile.boxing().onLabelActive(profile,e,src))}}},DataModel:{position:"absolute",width:{$spaceunit:1,ini:"15em"},height:{$spaceunit:1,ini:"4em"},precision:0,numberTpl:"* - 1% ~ 2%",steps:0,value:"0:0",type:{listbox:["vertical","horizontal"],ini:"horizontal",action:function(v){this.boxing().refresh()}},isRange:{ini:!0,action:function(v){this.boxing().refresh()}},showIncreaseHandle:{ini:!0,action:function(v){this.adjustSize()}},showDecreaseHandle:{ini:!0,action:function(v){this.adjustSize()}},labelSize:{$spaceunit:2,ini:0,action:function(v){this.getSubNode("LABEL").css({display:v?"":"none"}),xui.UI.$doResize(this,this.properties.width,this.properties.height,!0)}},labelPos:{ini:"left",listbox:["none","left","top","right","bottom"],action:function(v){xui.UI.$doResize(this,this.properties.width,this.properties.height,!0)}},labelGap:{$spaceunit:2,ini:4,action:function(v){xui.UI.$doResize(this,this.properties.width,this.properties.height,!0)}},labelCaption:{ini:"",action:function(v){var p=this.properties;"none"!=p.labelPos&&parseFloat(p.labelSize)&&this.getSubNode("LABEL").html(xui.adjustRes((xui.isSet(v)?v:"")+"",!0))}},labelHAlign:{ini:"right",listbox:["","left","center","right"],action:function(v){this.getSubNode("LABEL").css({textAlign:v||"",justifyContent:"right"==v?"flex-end":"center"==v?"center":"left"==v?"flex-start":""})}},labelVAlign:{ini:"top",listbox:["","top","middle","bottom"],action:function(v){this.getSubNode("LABEL").css("align-items","bottom"==v?"flex-end":"middle"==v?"center":"top"==v?"flex-start":"")}}},EventHandlers:{onLabelClick:function(profile,e,src){},onLabelDblClick:function(profile,e,src){},onLabelActive:function(profile,e,src){}},_prepareData:function(profile){var v,d=arguments.callee.upper.call(this,profile),N="display:none";return d._showDes=d.showDecreaseHandle?"":N,d._showIns=d.showIncreaseHandle?"":N,d._showD2=d.isRange?"":N,d._cls=profile.getClass("KEY","vertical"==d.type?"-v":"-h"),d._labelHAlign="text-align:"+(v=d.labelHAlign||"")+";justify-content:"+("right"==v?"flex-end":"center"==v?"center":"left"==v?"flex-start":""),d._labelVAlign="align-items:"+("bottom"==(v=d.labelVAlign)?"flex-end":"middle"==v?"center":"top"==v?"flex-start":""),d.labelShow="none"!=d.labelPos&&d.labelSize&&"auto"!=d.labelSize?"":"display:none",d._labelSize=d.labelSize?"":0+profile.$picku(),"none"!=d.labelPos&&d.labelSize&&d.labelCaption&&(d.labelCaption=xui.adjustRes(d.labelCaption,!0)),d._fi_decls="xui-icon-single"+("vertical"==d.type?"up":"left"),d._fi_incls="xui-icon-single"+("vertical"==d.type?"down":"right"),d},_adjustValue:function(profile,value){var p=profile.properties,b=[];return b[0]=parseFloat(value[0])||0,b[1]=parseFloat(value[1])||0,p.steps&&(value=100/p.steps,b[0]=Math.ceil(b[0]/value),p.isRange&&(b[1]=Math.ceil(b[1]/value))),p.isRange?b.join(":"):b[0]+""},_ensureValue:function(profile,value){var p=profile.properties,a=String(value).split(":"),max=p.steps?p.steps:100,b=[],f1=function(a){return parseFloat(a)||0},f2=function(a){return Math.min(max,Math.max(0,a))};return b[0]=f1(a[0]),p.isRange&&(b[1]=f1(a[1]),b[0]>b[1]&&(a=b[1],b[1]=b[0],b[0]=a)),b[0]=f2(b[0]),p.isRange&&(b[1]=f2(b[1])),p.isRange?b.join(":"):b[0]+""},_v2a:function(profile,v){var t,steps=profile.properties.steps;return(v="string"==typeof v?v.split(":"):v)[0]=parseFloat(v[0])||0,v[1]=parseFloat(v[1])||0,steps&&(v[0]=100*v[0]/steps),steps&&(v[1]=100*v[1]/steps),v[0]>v[1]&&(t=v[0],v[1]=v[0],v[0]=t),v},_auto:function(profile,flag){var id=profile.$xid+":auto";if(!xui.Thread.isAlive(id)){var p=profile.properties,off=(p.steps?100/p.steps:1)*(flag?1:-1),task={delay:300},arr=profile.box._v2a(profile,p.$UIvalue),fun=function(){arr[0]+=off,p.isRange&&(arr[1]+=off),profile.boxing().setUIValue(profile.box._adjustValue(profile,arr),null,null,"auto"),task.delay*=.8};task.task=fun,xui.Thread(id,[task],500,null,fun,null,!0).start()}},_onresize:function(profile,width,height){var ww,hh,prop=profile.properties,type=prop.type,f=function(k){return profile.getSubNode(k)},root=f("KEY"),ruler=f("RULER"),ind=f("IND"),indb=f("IND1"),offset=profile.$px(".75em"),box=f("BOX"),label=f("LABEL"),cmd1=f("INCREASE"),cmd2=f("DECREASE"),cb=xui.browser.contentBox,us=xui.$us(profile),adjustunit=function(v,emRate){return profile.$forceu(v,us>0?"em":"px",emRate)},fzrate=profile.getEmSize()/root._getEmSize(),labelfz=label._getEmSize(fzrate),rulerfz=ruler._getEmSize(fzrate),indfz=ind._getEmSize(fzrate),labelPos=(label=profile.getSubNode("LABEL"),prop.labelPos),labelSize="none"!=labelPos&&labelPos&&profile.$px(prop.labelSize,labelfz)||0,labelGap="none"!=labelPos&&labelPos&&profile.$px(prop.labelGap)||0;if(width&&"auto"!=width&&(width=profile.$px(width)),height&&"auto"!=height&&(height=profile.$px(height)),box.cssPos({left:adjustunit("left"==labelPos?labelSize:0),top:adjustunit("top"==labelPos?labelSize:0)}),cmd2.css("display",prop.showDecreaseHandle?"":"none"),cmd1.css("display",prop.showIncreaseHandle?"":"none"),"vertical"==type){box.cssSize({width:"",height:adjustunit(hh=null===height?null:Math.max(0,height-("top"==labelPos||"bottom"==labelPos?labelSize:0)))});var w=profile.$px("1em"),w1=prop.showIncreaseHandle?w:0,w2=prop.showDecreaseHandle?w:0,w3=xui.browser.contentBox?indb._borderH("top"):0;hh&&(ruler.top(adjustunit(w1+offset,rulerfz)).height(adjustunit(hh-w1-w2-2*offset,rulerfz)),ind.top(adjustunit(w1+offset-w3,indfz)).height(adjustunit(hh-w1-w2-2*offset,indfz))),labelSize&&label.cssRegion({left:adjustunit(null===width?null:Math.max(0,"right"==labelPos?box.width()+labelGap:0),labelfz),top:adjustunit(null===height?null:Math.max(0,"bottom"==labelPos?height-labelSize+labelGap:0),labelfz),width:"",height:adjustunit(null===height?null:Math.max(0,"top"==labelPos||"bottom"==labelPos?labelSize-labelGap:height),labelfz)})}else box.cssSize({width:adjustunit(ww=null===width?null:Math.max(0,width-("left"==labelPos||"right"==labelPos?labelSize:0))),height:""}),w=profile.$px("1em"),w1=prop.showDecreaseHandle?w:0,w2=prop.showIncreaseHandle?w:0,w3=cb?indb._borderW("left"):0,ww&&(ruler.left(adjustunit(w1+offset,rulerfz)).width(adjustunit(ww-w1-w2-2*offset,rulerfz)),ind.left(adjustunit(w1+offset-w3,indfz)).width(adjustunit(ww-w1-w2-2*offset,indfz))),labelSize&&label.cssRegion({left:adjustunit(null===width?null:Math.max(0,"right"==labelPos?width-labelSize+labelGap:0),labelfz),top:adjustunit(null===height?null:Math.max(0,"bottom"==labelPos?box.height()+labelGap:0),labelfz),width:adjustunit(null===width?null:Math.max(0,"left"==labelPos||"right"==labelPos?labelSize-labelGap:width),labelfz),height:adjustunit(null===height?null:Math.max(0,"top"==labelPos||"bottom"==labelPos?labelSize-labelGap:height),labelfz)})}}}),xui.Class("xui.UI.Input",["xui.UI.Widget","xui.absValue"],{Instance:{_setTB:function(type){var o,t,profile=this.get(0),p=profile.properties;if(profile.host&&p.tipsBinder){var ot=profile.tips;t=profile.tips=profile.tips||p.tips||"",!(o=xui.getObject(p.tipsBinder)||(o=profile.host[p.tipsBinder])&&o.get(0))||"xui.UI.Span"!=o.key&&"xui.UI.Div"!=o.key&&"xui.UI.Label"!=o.key||o.renderId&&(o.getRootNode().innerHTML="$"==t.charAt(0)?xui.wrapRes(t):t,o.getRoot().css("color",1==type?"gray":2==type?"red":"#000")),ot!==profile.tips&&xui.Tips&&xui.Tips.getTips()&&xui.Tips.setTips(profile.tips)}},activate:function(select){var profile=this.get(0);if(profile&&profile.renderId){var node=profile.getSubNode("INPUT").get(0);if(node){try{if(node.focus(),select||!xui.browser.fakeTouch&&"touchOnly"!=xui.browser.deviceType)try{"input"!=node.tagName.toLowerCase()&&/[\n\r]/.test(node.value)?xui(node).caret(0,0):node.select()}catch(e){}}catch(e){}delete profile._justFocus}}return this},getAutoexpandHeight:function(){var prf=this.get(0),prop=prf.properties;return prop.multiLines&&parseFloat(prf._autoexpand||prop.autoexpand)?prf.$autoExpandH||prf.$px(prf._autoexpand||prop.autoexpand):null},_setCtrlValue:function(value){return!xui.isNull(value)&&xui.isDefined(value)||(value=""),this.each((function(profile){profile.$Mask&&!value&&(value=profile.$Mask),profile.$_inner=1,profile.getSubNode("INPUT").attr("value",value+""),profile.box._checkAutoexpand(profile),delete profile.$_inner}))},_getCtrlValue:function(){var node=this.getSubNode("INPUT"),v=node&&!node.isEmpty()?this.getSubNode("INPUT").attr("value"):"";return-1!=v.indexOf("\r")&&(v=v.replace(/(\r\n|\r)/g,"\n")),this.get(0).$Mask&&this.get(0).$Mask==v&&(v=""),v},_setDirtyMark:function(){return this.each((function(profile){var properties=profile.properties,o=profile.getSubNode("INPUT"),box=(profile.box,profile.boxing()),d=xui.UI.$css_tag_dirty,v=xui.UI.$css_tag_invalid,flag=properties.value!==properties.$UIvalue,ot=profile.tips;if(2==profile._inValid?profile.tips=properties.tipsErr||properties.tips:1==profile._inValid?profile.tips=properties.tips:profile.tips=properties.tipsOK||properties.tips,ot!==profile.tips&&xui.Tips&&xui.Tips.getTips()&&xui.Tips.setTips(profile.tips),profile._dirtyFlag!==flag&&(properties.dirtyMark&&properties.showDirtyMark&&(profile.beforeDirtyMark&&!1===box.beforeDirtyMark(profile,flag)||((profile._dirtyFlag=flag)?o.addClass(d):o.removeClass(d))),profile._dirtyFlag=flag),profile.beforeFormatMark&&!1===box.beforeFormatMark(profile,2==profile._inValid));else{var err=profile.getSubNode("ERROR");2==profile._inValid?(o.addClass(v),err.css("display","block")):(o.removeClass(v),err.css("display","none"))}box._setTB(profile._inValid)}))},notifyExcel:function(refreshAll){return this.each((function(prf){var ID="triggerExcelFormulas:";prf.properties.excelCellId&&prf.host&&prf.host["xui.Module"]&&(ID+=prf.host.xid,!1===refreshAll?xui.resetRun.exists(ID)||prf&&prf.host&&prf.host.triggerExcelFormulas(prf):xui.resetRun(ID,(function(){prf&&prf.host&&prf.host.triggerExcelFormulas(null)})))}))},getExcelCellValue:function(){var value,v2,profile=this.get(0),prop=profile.properties;return prop.excelCellId&&(value=this.getUIValue(),xui.isSet(v2=profile.onGetExcelCellValue&&profile.onGetExcelCellValue(profile,prop.excelCellId,value))&&(value=v2)),value},_applyExcelFormula:function(cellsMap){var f,value,profile=this.get(0),prop=profile.properties;(f=prop.excelCellFormula)&&(value=xui.ExcelFormula.calculate(f,cellsMap),xui.isSet(value)&&(profile.beforeApplyExcelFormula&&!1===profile.beforeApplyExcelFormula(profile,prop.excelCellFormula,value)||(this.setUIValue(value,!0,null,"formula"),profile.afterApplyExcelFormula&&profile.afterApplyExcelFormula(profile,prop.excelCellFormula,value))))}},Initialize:function(){var t=this.getTemplate();xui.merge(t.FRAME.BORDER,{style:"",LABEL:{className:"{_required} xui-ui-ellipsis",style:"{labelShow};width:{_labelSize};{_labelHAlign};{_labelVAlign};",text:"{labelCaption}"},BOX:{className:"xui-ui-input xui-ui-shadow-input xui-uiborder-flat xui-uiborder-radius xui-uibase",WRAP:{tagName:"div",INPUT:{$order:10,className:"xui-ui-ellipsis {_inputcls}",tagName:"input",autocorrect:"off",autocomplete:"{autocomplete}",type:"{_inputtype}",name:"{_name}",maxlength:"{maxlength}",tabindex:"{tabindex}",placeholder:"{placeholder}",style:"{_css};{hAlign};"}}}},"all"),t.FRAME.ERROR={className:"xuifont",$fonticon:"xui-icon-error"},this.setTemplate(t)},Static:{_syncResize:!0,_maskMap:{"~":"[+-]",1:"[0-9]",a:"[A-Za-z]",u:"[A-Z]",l:"[a-z]","*":"[A-Za-z0-9]"},_maskSpace:"_",Appearances:{KEY:{position:"relative"},BORDER:{},WRAP:{left:0,position:"absolute",overflow:xui.browser.gek&&xui.browser.ver<3?"auto":"visible"},BOX:{left:0,top:0,position:"absolute",overflow:"hidden","z-index":10},".xui-required-field BOX":{"border-color":"#ff0000"},LABEL:{$order:100,"z-index":1,top:0,left:0,display:xui.browser.isWebKit?"-webkit-flex":"flex",position:"absolute","padding-top":"4px","padding-bottom":"4px"},INPUT:{$order:100,"padding-top":"4px","padding-left":"4px","padding-right":"4px","padding-bottom":"4px","background-color":"transparent",border:0,margin:0,"text-align":"left","margin-top":xui.browser.ie67?"-1px":null,position:"relative","z-index":10,width:"8.5em",overflow:xui.browser.ie678?"hidden":"auto","overflow-y":xui.browser.ie678?"hidden":"auto","overflow-x":(xui.browser.ie678,"hidden"),resize:"none"},"KEY textarea.autoexpand":{overflow:"hidden",$order:2},"KEY textarea":{"white-space":"pre","overflow-x":"hidden","overflow-y":"auto"},ERROR:{position:"absolute",right:".25em",top:".25em",display:"none","z-index":20}},Behaviors:{HoverEffected:{BOX:["BOX"]},NavKeys:{INPUT:1},LABEL:{onClick:function(profile,e,src){if(profile.properties.disabled)return!1;profile.onLabelClick&&profile.boxing().onLabelClick(profile,e,src)},onDblClick:function(profile,e,src){if(profile.properties.disabled)return!1;profile.onLabelDblClick&&profile.boxing().onLabelDblClick(profile,e,src)},onMousedown:function(profile,e,src){if("left"==xui.Event.getBtn(e))return!profile.properties.disabled&&void(profile.onLabelActive&&profile.boxing().onLabelActive(profile,e,src))}},INPUT:{onChange:function(profile,e,src){if(!(profile.$_onedit||profile.$_inner||profile.destroyed)&&profile.box){var p=profile.properties,b=profile.box,o=profile._inValid,instance=profile.boxing(),value=xui.use(src).get(0).value;profile.$Mask&&profile.$Mask==value&&(value=""),instance.setUIValue(value,null,null,"onchange"),p.$UIvalue!==value&&instance._setCtrlValue(p.$UIvalue),o!==profile._inValid&&profile.renderId&&instance._setDirtyMark(),b._asyCheck(profile)}},onKeydown:function(profile,e,src){var p=profile.properties,b=profile.box,m=p.multiLines,k=xui.Event.getKey(e);if(!p.disabled&&!p.readonly&&(parseInt(p.autoexpand)&&b._checkAutoexpand(profile),"enter"!=k.key||m&&!k.altKey||xui.use(src).onChange(),b._asyCheck(profile),p.mask))switch(k.key.length>1?profile.$ignore=!0:delete profile.$ignore,k.key){case"backspace":return b._changeMask(profile,xui.use(src).get(0),"",!1),!1;case"delete":return b._changeMask(profile,xui.use(src).get(0),""),!1}},onKeypress:function(profile,e,src){var t,p=profile.properties,b=profile.box,cls=profile.box,k=(cls._maskMap,xui.Event.getKey(e)),caret=xui.use(src).caret();return(!profile.beforeKeypress||!1!==profile.boxing().beforeKeypress(profile,caret,k,e,src))&&(!(t=profile.CF.beforeKeypress||profile.$beforeKeypress)||!1!==t(profile,caret,k,e,src))&&(b._asyCheck(profile),p.mask?profile.$ignore?(delete profile.$ignore,!0):!(!k.ctrlKey&&!k.altKey&&(cls._changeMask(profile,xui.use(src).get(0),k.key,!0),1)):void 0)},onKeyup:function(profile,e,src){var p=profile.properties,b=profile.box;if("esc"==xui.Event.getKey(e).key&&(profile.boxing()._setCtrlValue(p.$UIvalue),profile.onCancel&&profile.boxing().onCancel(profile)),p.dynCheck){var value=xui.use(src).get(0).value;profile.box._checkValid(profile,value),profile.boxing()._setDirtyMark()}b._asyCheck(profile)},onMousedown:function(profile,e,src){profile._mousedownmark=1,xui.asyRun((function(){profile&&delete profile._mousedownmark}))},onMouseup:function(profile,e,src){var node;profile.properties.selectOnFocus&&profile._justFocus&&(!(node=xui.use(src).get(0)).readOnly&&node.select&&(profile.$mouseupDelayFun=xui.asyRun((function(){delete profile.$mouseupDelayFun,xui.browser.fakeTouch||"touchOnly"==xui.browser.deviceType||"input"!=node.tagName.toLowerCase()&&/[\n\r]/.test(node.value)||node.select()}))),delete profile._justFocus),profile._activedonmousedown&&(delete profile._activedonmousedown,"input"!=(node=xui.use(src).get(0)).tagName.toLowerCase()&&/[\n\r]/.test(node.value)||node.select())},onFocus:function(profile,e,src){if(profile.$ignoreFocus)return!1;if(profile.beforeFocus&&!1===profile.boxing().beforeFocus(profile))return profile.$ignoreBlur=1,xui(src).blur(),delete profile.$ignoreBlur,!1;var p=profile.properties,b=profile.box;if(p.disabled||p.readonly)return!1;profile.onFocus&&profile.boxing().onFocus(profile),profile.getSubNode("BOX").tagClass("-focus");var node=xui.use(src).get(0);p.mask&&(node.value||(profile.$focusDelayFun=xui.asyRun((function(){profile.box&&(delete profile.$focusDelayFun,profile.$_inner=!0,node.value=profile.$Mask,delete profile.$_inner,b._setCaret(profile,node))})))),p.selectOnFocus&&!node.readOnly&&node.select&&(xui.browser.kde?profile.$focusDelayFun2=xui.asyRun((function(){delete profile.$focusDelayFun2,xui.browser.fakeTouch||"touchOnly"==xui.browser.deviceType||"input"!=node.tagName.toLowerCase()&&/[\n\r]/.test(node.value)||node.select()})):xui.browser.fakeTouch||"touchOnly"==xui.browser.deviceType||"input"!=node.tagName.toLowerCase()&&/[\n\r]/.test(node.value)||node.select(),profile._mousedownmark&&(profile._justFocus=1)),profile.boxing()._setTB(3),b._asyCheck(profile)},onBlur:function(profile,e,src){if(profile.$ignoreBlur)return!1;xui.resetRun(profile.$xid+":asycheck"),profile.$focusDelayFun&&xui.clearTimeout(profile.$focusDelayFun),profile.$focusDelayFun2&&xui.clearTimeout(profile.$focusDelayFun2),profile.$focusDelayFun2&&xui.clearTimeout(profile.$mouseupDelayFun);var p=profile.properties,b=profile.box;if(p.disabled||p.readonly)return!1;if(profile.onBlur&&profile.boxing().onBlur(profile),profile.destroyed)return!1;profile.getSubNode("BOX").tagClass("-focus",!1);var value=xui.use(src).get(0).value;profile.$Mask&&profile.$Mask==value&&(value=""),p.$UIvalue==value&&profile.box._checkValid(profile,value),profile.boxing()._setDirtyMark(),b._asyCheck(profile,!1)},onClick:function(profile,e,src){profile.onInputClick&&profile.boxing().onInputClick(profile,e,src)}}},DataModel:{selectable:!0,tipsErr:"",tipsOK:"",dynCheck:!1,selectOnFocus:!0,autocomplete:{ini:"off",listbox:["on","off"],action:function(value){this.getSubNode("INPUT").attr("autocomplete",value)}},placeholder:{ini:"",action:function(value){this.getSubNode("INPUT").attr("placeholder",value)}},labelSize:{$spaceunit:2,ini:"0",action:function(v){this.getSubNode("LABEL").css({display:v?"":"none"}),xui.UI.$doResize(this,this.properties.width,this.properties.height,!0)}},labelPos:{ini:"left",listbox:["none","left","top","right","bottom"],action:function(v){xui.UI.$doResize(this,this.properties.width,this.properties.height,!0)}},labelGap:{$spaceunit:2,ini:"4",action:function(v){xui.UI.$doResize(this,this.properties.width,this.properties.height,!0)}},labelCaption:{ini:"",action:function(v){v=(xui.isSet(v)?v:"")+"",this.getSubNode("LABEL").html(xui.adjustRes(v,!0))}},labelHAlign:{ini:"right",listbox:["","left","center","right"],action:function(v){this.getSubNode("LABEL").css({textAlign:v||"",justifyContent:"right"==v?"flex-end":"center"==v?"center":"left"==v?"flex-start":""})}},labelVAlign:{ini:"top",listbox:["","top","middle","bottom"],action:function(v){this.getSubNode("LABEL").css("align-items","bottom"==v?"flex-end":"middle"==v?"center":"top"==v?"flex-start":"")}},valueFormat:{helpinput:[{caption:"required",id:"[^.*]"},{caption:"email",id:"^[\\w\\.=-]+@[\\w\\.-]+\\.[\\w\\.-]{2,4}$"},{caption:"charOnly",id:"^[a-zA-Z]*$"},{caption:"words",id:"^[\\w ]*$"},{captoin:"size",id:"^(([1-9]d*.d+)|([1-9]d*)|(.dd*))s*(px|em)?$"},{caption:"integer",id:"^-?\\d\\d*$"},{caption:"positiveInteger",id:"^\\d\\d*$"},{caption:"number",id:"^-?(\\d\\d*\\.\\d*$)|(^-?\\d\\d*$)|(^-?\\.\\d\\d*$)"},{caption:"filepath",id:"([\\/]?[\\w_]+)+\\.\\w{1,9}$"},{caption:"URL",id:"^(http|https|ftp)\\:\\/\\/[\\w\\-\\_\\.]+[\\w\\-\\_](:[\\w]*)?\\/?([\\w\\-\\._\\?\\,\\'\\/\\\\\\+&amp;%\\$#\\=~])*$"},{caption:"color",id:"^\\#[0-9A-Fa-f]{6}$"},{caption:"HH:MM",id:"^(([0-1][0-9])|([2][0-3])):([0-5][0-9])$"},{caption:"HH:MM:SS",id:"^(([0-1][0-9])|([2][0-3])):([0-5][0-9])\\:([0-5][0-9])$"},{caption:"YYYY-MM-DD",id:"^([0-9]{4})\\-(([0][0-9])|([1][0-2]))\\-([0-3][0-9])$"},{caption:"DD/MM/YYYY",id:"^(([0-2][0-9])|([3][0-1]))/(([0][0-9])|([1][0-2]))/([0-9]{4})$"}]},mask:{action:function(value){var ns=this,b=ns.box;if(value){ns.$MaskFormat=function(ns,v){var m=ns._maskMap,a=[],r=/[A-Za-z0-9]/;return xui.arr.each(v.split(""),(function(o,i){a.push(m[o]||(r.test(o)?"":"\\")+o)})),"^"+a.join("")+"$"}(b,value),ns.$Mask=function(ns,v){var m=ns._maskMap,a=[],s=ns._maskSpace;return xui.arr.each(v.split(""),(function(o,i){a.push(m[o]?s:o)})),a.join("")}(b,value);var uiv=ns.properties.$UIvalue;uiv=xui.isSet(uiv)?uiv+"":"",ns.boxing()._setCtrlValue(uiv+ns.$Mask.slice(uiv.length))}else delete ns.$MaskFormat,delete ns.$Mask}},value:"",width:{$spaceunit:1,ini:"10em"},height:{$spaceunit:1,ini:"auto"},hAlign:{ini:"",listbox:["","left","center","right"],action:function(v){this.getSubNode("INPUT").css("textAlign",v)}},disabled:{ini:!1,action:function(v){this.box._handleInput(this,"xui-ui-disabled",v)}},readonly:{ini:!1,action:function(v){this.box._handleInput(this,"xui-ui-readonly",v)}},type:{ini:"text",listbox:["text","password"],set:function(value){this.properties.type=value,this.renderId&&this.boxing().refresh(!0)}},maxlength:{ini:-1,action:function(value){this.getSubNode("INPUT").attr("maxlength",value)}},multiLines:{ini:!1,action:function(value){this.boxing().refresh()}},autoexpand:{$spaceunit:1,ini:"",action:function(v){this.boxing().refresh()}},tipsBinder:{ini:"",set:function(value){value["xui.UIProfile"]&&(value=value.$xid),value["xui.UI"]&&(value=value.get(0))&&(value=value.$xid),this.properties.tipsBinder=value+""}},excelCellId:{ini:"",action:function(){this.boxing().notifyExcel(!1)}},excelCellFormula:{ini:"",action:function(v){var m;this.properties,v&&xui.ExcelFormula.validate(v)&&this.host&&(m=this.host["xui.Module"])&&m.applyExcelFormula(this)}}},EventHandlers:{beforeFocus:function(profile){},onFocus:function(profile){},onBlur:function(profile){},onCancel:function(profile){},onInputClick:function(profile,e,src){},beforeFormatCheck:function(profile,value){},beforeFormatMark:function(profile,formatErr){},beforeKeypress:function(profile,caret,keyboard,e,src){},onLabelClick:function(profile,e,src){},onLabelDblClick:function(profile,e,src){},onLabelActive:function(profile,e,src){},onGetExcelCellValue:function(profile,excelCellId,dftValue){},beforeApplyExcelFormula:function(profile,excelCellFormula,value){},afterApplyExcelFormula:function(profile,excelCellFormula,value){},onAutoexpand:function(profile,height,offset){}},_checkAutoexpand:function(profile){var prop=profile.properties,autoe=profile._autoexpand||prop.autoexpand;profile.renderId&&parseFloat(autoe)&&xui.resetRun(profile.key+":"+profile.$xid+":autoexpand",(function(){if(profile.renderId&&!profile.destroyed){var th1,ph,oth,offset,root=profile.getRoot(),min=profile.$px(autoe),t=profile.getSubNode("INPUT"),rh=root.height();if(t.css("overflow","hidden"),oth=t.get(0).style.height,th1=t.height(),ph=t._paddingH(),t.scrollHeight(),min-=rh-th1,t.height(min+"px"),min=Math.max(min,t.scrollHeight()-ph),offset=parseInt(min-th1,10),t.get(0).style.height=oth,offset){var toH=profile.$autoExpandH=rh+offset;profile.$beforeAutoexpand&&!1===profile.$beforeAutoexpand(profile,toH,offset)||(profile.boxing().setHeight(toH),profile.$onAutoexpand&&(toH=profile.$onAutoexpand(profile,toH,offset)),profile.onAutoexpand&&profile.boxing().onAutoexpand(profile,toH,offset))}t.css("overflow","")}}))},_handleInput:function(prf,cls,v){var i=prf.getSubNode("INPUT");v||!prf.properties.disabled&&!prf.properties.readonly||(v=!0),prf.getRoot()[v?"addClass":"removeClass"](cls),"button"!=(""+i.get(0).type).toLowerCase()&&i.attr("readonly",v)},_prepareData:function(profile){var v,data={},prop=profile.properties;"auto"==prop.height&&(data.height="1.83em"),data._inputcls=parseFloat(profile._autoexpand||prop.autoexpand)?"autoexpand":"",data._name=prop.name||profile.alias;var d=arguments.callee.upper.call(this,profile,data);return d._inputtype=d.type||"",d.maxlength<0&&(d.maxlength=""),xui.browser.kde&&(d._css="resize:none;"),d.hAlign=(v=d.hAlign)?"text-align:"+v:"",data._labelHAlign="text-align:"+(v=data.labelHAlign||"")+";justify-content:"+("right"==v?"flex-end":"center"==v?"center":"left"==v?"flex-start":""),data._labelVAlign="align-items:"+("bottom"==(v=data.labelVAlign)?"flex-end":"middle"==v?"center":"top"==v?"flex-start":""),d.labelShow="none"!=d.labelPos&&d.labelSize&&"auto"!=d.labelSize?"":"display:none",d._labelSize=d.labelSize?"":0+profile.$picku(),(v=d.labelCaption)&&(d.labelCaption=xui.adjustRes(v,!0)),d},_dynamicTemplate:function(profile){var t,prop=profile.properties,hash=profile._exhash="$multiLines:"+prop.multiLines,template=profile.box.getTemplate(hash);prop.$UIvalue=prop.value,template||(template=xui.clone(profile.box.getTemplate()),prop.multiLines&&((t=template.FRAME.BORDER.BOX.WRAP.INPUT).tagName="textarea",delete t.type),profile.box.setTemplate(template,hash)),profile.template=template},_ensureValue:function(profile,value){return""+(xui.isSet(value)?value:"")},RenderTrigger:function(){var ns=this,p=ns.properties;xui.asyRun((function(){ns.box&&ns.boxing()._setTB(1)})),ns.getSubNode("WRAP").$firfox2(),p.readonly&&ns.boxing().setReadonly(!0,!0),p.tipsBinder&&ns.boxing().setTipsBinder(p.tipsBinder,!0),p.excelCellId&&ns.boxing().notifyExcel();var ie=xui.browser.ie,src=ns.getSubNode("INPUT").get(0),b=ns.box,f=function(o){ie&&"propertyName"in o&&"value"!=o.propertyName||b._asyCheck(ns,!1)};ie&&src.attachEvent?(src.attachEvent("onpropertychange",f),src.attachEvent("ondrop",f),ns.$ondestory=function(){var src=this.getSubNode("INPUT").get(0);src&&(src.detachEvent("onpropertychange",f),src.detachEvent("ondrop",f)),src=f=null}):(src.addEventListener("input",f,!1),src.addEventListener("drop",f,!1),xui.browser.gek&&src.addEventListener("dragdrop",f,!1),ns.$ondestory=function(){var src=this.getSubNode("INPUT").get(0);src&&(src.removeEventListener("input",f,!1),src.removeEventListener("drop",f,!1),xui.browser.gek&&src.removeEventListener("dragdrop",f,!1)),src=f=null}),src=null},LayoutTrigger:function(){var p=this.properties;p.mask&&this.boxing().setMask(p.mask,!0)},_changeMask:function(profile,src,v,dir,resetCaret){if(!1!==resetCaret){var ns=this,p=profile.properties,map=ns._maskMap,ms=ns._maskSpace,maskTxt=p.mask,maskStr=profile.$Mask,input=xui(src),caret=input.caret();if(!1===dir&&caret[0]==caret[1]&&caret[0]>0&&input.caret(caret[0]-1,caret[0]),dir===undefined&&caret[0]==caret[1]&&input.caret(caret[0],caret[0]+1),!0===dir&&maskStr.charAt(caret[0])!=ms){var from=caret[0]+maskStr.substr(caret[0],maskStr.length).indexOf(ms);input.caret(from,Math.max(caret[1],from))}caret=input.caret();var i,value=src.value,cc=p.mask.charAt(caret[0]),reg=ns._maskMap[cc];if(reg&&v&&1==v.length&&("l"==cc?v=v.toLowerCase():"u"==cc&&(v=v.toUpperCase())),reg&&new RegExp("^"+reg+"$").test(v)||""==v){t=value,caret[0]!=caret[1]&&(t=t.substr(0,caret[0])+maskStr.substr(caret[0],caret[1]-caret[0])+t.substr(caret[1],t.length-caret[1])),v&&(t=t.substr(0,caret[0])+v+t.substr(caret[0]+1,t.length-caret[0]-1));var a=[];xui.arr.each(maskTxt.split(""),(function(o,i){a.push(map[o]&&new RegExp("^"+map[o]+"$").test(t.charAt(i))?t.charAt(i):maskStr.charAt(i))})),!0===dir?(i=(v=maskStr.substr(caret[0]+1,value.length-caret[0]-1)).indexOf(ms),i=caret[0]+(-1==i?0:i)+1):i=caret[0],xui.browser.opr&&(dir===undefined&&xui.arr.insertAny(a,ms,i),!1===dir&&xui.arr.insertAny(a,ms,i++)),value=a.join(""),src.value=value,profile.boxing().setUIValue(value==maskStr?"":value,null,null,"mask"),ns._setCaret(profile,src,i)}}else{ns=this,p=profile.properties,map=ns._maskMap,maskTxt=p.mask,maskStr=profile.$Mask;var t=src.value;a=[],xui.arr.each(maskTxt.split(""),(function(o,i){a.push(new RegExp("^"+(map[o]?map[o]:"\\"+o)+"$").test(t.charAt(i))?t.charAt(i):maskStr.charAt(i))})),value=a.join(""),src.value=value,profile.boxing().setUIValue(value==maskStr?"":value,null,null,"mask")}},_setCaret:function(profile,src,pos){profile.properties.mask&&("number"!=typeof pos&&(pos=src.value.indexOf(this._maskSpace)),xui(src).caret(pos,pos))},_checkValid2:function(profile){return!profile.renderId||this._checkValid(profile,profile.getSubNode("INPUT").get(0).value)},_checkValid:function(profile,value){var p=profile.properties,vf1=p.mask&&profile.$MaskFormat,vf2=p.valueFormat||profile.$valueFormat;if(profile.boxing()._toEditor&&(value=profile.boxing()._toEditor(value)),!(profile.beforeFormatCheck&&!1===profile.boxing().beforeFormatCheck(profile,value)||value&&value.length&&profile.$Mask!==value&&vf1&&"string"==typeof vf1&&!new RegExp(vf1).test((0===value?"0":value)||"")||vf2&&"string"==typeof vf2&&!new RegExp(vf2).test((0===value?"0":value)||"")))return profile._inValid=3,!0;profile._inValid=2},_asyCheck:function(profile,resetCaret){profile.destroyed||(profile.properties.dynCheck||profile.properties.mask)&&xui.resetRun(profile.$xid+":asycheck",(function(){if(profile.renderId){var src=profile.getSubNode("INPUT").get(0);if(src&&(profile.properties.mask&&src.value.length!=profile.$Mask.length&&profile.box._changeMask(profile,src,"",!0,resetCaret),profile.properties.dynCheck)){var v=src.value;profile.$Mask&&profile.$Mask==v&&(v=""),profile.boxing().setUIValue(v,!1,!0,"asycheck")}}}))},_onresize:function(profile,width,height){if(!profile._$ignoreonsize){var $hborder,$vborder,autoH,prop=profile.properties,f=function(k){return k?k=profile.getSubNode(k):null},root=f("KEY"),v1=f("INPUT"),box=f("BOX"),label=f("LABEL"),us=xui.$us(profile),adjustunit=function(v,emRate){return profile.$forceu(v,us>0?"em":"px",emRate)},fzrate=profile.getEmSize()/root._getEmSize(),v1fz=v1._getEmSize(fzrate),labelfz=label._getEmSize(fzrate),cb=xui.browser.contentBox,paddingH=cb?2*Math.round(v1._paddingH()/2):0,paddingW=cb?2*Math.round(v1._paddingW()/2):0,boxB=box._borderW();$hborder=$vborder=cb?boxB/2:0,height&&(height=(autoH="auto"==height)?profile.$em2px(cb?1:1.6666667,null,!0)+paddingH+boxB:profile.$isEm(height)?profile.$em2px(height,null,!0):height),width&&(width=profile.$isEm(width)?profile.$em2px(width,null,!0):width),autoH&&(profile._$ignoreonsize=1,root.height(adjustunit(height)),delete profile._$ignoreonsize);var labelPos=prop.labelPos,labelSize="none"!=labelPos&&labelPos&&profile.$px(prop.labelSize,labelfz)||0,labelGap="none"!=labelPos&&labelPos&&profile.$px(prop.labelGap)||0,ww=width,hh=height,left=Math.max(0,(prop.$b_lw||0)-$hborder),top=Math.max(0,(prop.$b_tw||0)-$vborder);null!==ww&&(ww-=Math.max(2*$hborder,(prop.$b_lw||0)+(prop.$b_rw||0)),xui.browser.ie6&&(ww=2*Math.round(parseFloat(ww/2)))),null!==hh&&(hh-=Math.max(2*$vborder,(prop.$b_lw||0)+(prop.$b_rw||0)),xui.browser.ie6&&(hh=2*Math.round(parseFloat(hh/2))),xui.browser.ie6&&null===width&&box.ieRemedy());var iL=left+("left"==labelPos?labelSize:0),iT=top+("top"==labelPos?labelSize:0),iW=null===ww?null:Math.max(0,ww-("left"==labelPos||"right"==labelPos?labelSize:0)),iH=null===hh?null:Math.max(0,hh-("top"==labelPos||"bottom"==labelPos?labelSize:0));null===hh||Math.max(0,height-("top"==labelPos||"bottom"==labelPos?labelSize:0)),null!==iW&&iW-paddingW>0&&v1.width(adjustunit(Math.max(0,iW-paddingW),v1fz)),null!==iH&&iH-paddingH>0&&v1.height(adjustunit(Math.max(0,iH-paddingH),v1fz)),box.cssRegion({left:adjustunit(iL),top:adjustunit(iT),width:adjustunit(iW),height:adjustunit(iH)}),labelSize&&label.cssRegion({left:adjustunit(null===ww?null:"right"==labelPos?ww-labelSize+labelGap+2*$hborder:0,labelfz),top:adjustunit(null===height?null:"bottom"==labelPos?height-labelSize+labelGap:0,labelfz),width:adjustunit(null===ww?null:Math.max(0,"left"==labelPos||"right"==labelPos?labelSize-labelGap:ww),labelfz),height:adjustunit(null===height?null:Math.max(0,("top"==labelPos||"bottom"==labelPos?labelSize-labelGap:height)-paddingH),labelfz)}),iL+=(iW||0)+2*$hborder,profile.$resizer&&xui.browser.ie&&box.ieRemedy()}}}}),xui.Class("xui.UI.CheckBox",["xui.UI","xui.absValue"],{Initialize:function(){xui.UI.SCheckBox=xui.UI.CheckBox;var key="xui.UI.SCheckBox";xui.absBox.$type[key.replace("xui.UI.","")]=xui.absBox.$type[key]=key},Instance:{fireClickEvent:function(){return this.getRoot().onClick(),this},activate:function(){return this.getSubNode("FOCUS").focus(!0),this},_setCtrlValue:function(value){return this.each((function(profile){profile.getSubNode("MARK").tagClass("-checked",!!value)}))},_setDirtyMark:function(){return arguments.callee.upper.apply(this,["CAPTION"])},notifyExcel:xui.UI.Input.prototype.notifyExcel,getExcelCellValue:xui.UI.Input.prototype.getExcelCellValue},Static:{Templates:{className:"{_className} ",style:"{_style} {_hAlign}",VALIGN:{$order:0,style:"{_vAlign}"},FOCUS:{tabindex:"{tabindex}",MARK:{$order:0,className:"{_iconPosCls} xuifont",$fonticon:"xui-uicmd-check"},ICON:{$order:1,className:"xuicon {imageClass}  {picClass}",style:"{backgroundImage}{backgroundPosition}{backgroundSize}{backgroundRepeat}{iconFontSize}{imageDisplay}{iconStyle}",text:"{iconFontCode}"},CAPTION:{$order:2,text:"{caption}"}}},Appearances:{KEY:{overflow:"visible"},MARK:{cursor:"pointer",margin:"0 .334em 0 .1667em","vertical-align":"middle"},VALIGN:{"font-size":0,width:0,display:"inline-block",height:"100%"},FOCUS:{cursor:"default","vertical-align":"middle",padding:".1667em 0"},CAPTION:{"vertical-align":xui.browser.ie6?"baseline":"middle","font-size":"1em"}},Behaviors:{HoverEffected:{KEY:"MARK",ICON:"ICON"},ClickEffected:{KEY:"MARK"},NavKeys:{FOCUS:1},onClick:function(profile,e,src){var p=profile.properties,b=profile.boxing();return!p.disabled&&!p.readonly&&(b.setUIValue(!p.$UIvalue,null,null,"click"),profile.onChecked&&b.onChecked(profile,e,p.$UIvalue),void profile.getSubNode("FOCUS").focus(!0))},FOCUS:{onKeydown:function(profile,e,src){var key=xui.Event.getKey(e).key;if(" "==key||"enter"==key)return profile.getRoot().onClick(!0),!1}}},DataModel:{value:!1,hAlign:{ini:"left",listbox:["left","center","right"],action:function(v){this.getRoot().css("textAlign",v)}},vAlign:{ini:"top",listbox:["top","middle","bottom"],action:function(v){this.getSubNode("VALIGN").css("verticalAlign",v||"")}},iconPos:{ini:"left",listbox:["left","right"],action:function(v){this.getSubNode("MARK").removeClass("xui-float-left xui-float-right").addClass("xui-float-"+v)}},image:{format:"image",action:function(v){xui.UI.$iconAction(this)}},imagePos:{action:function(value){this.getSubNode("ICON").css("backgroundPosition",value||"center")}},imageBgSize:{action:function(value){this.getSubNode("ICON").css("backgroundSize",value||"")}},imageClass:{ini:"",action:function(v,ov){xui.UI.$iconAction(this,"ICON",ov)}},iconFontCode:{action:function(v){xui.UI.$iconAction(this)}},caption:{ini:undefined,action:function(v){v=(xui.isSet(v)?v:"")+"",this.getSubNode("CAPTION").html(xui.adjustRes(v,!0))}},excelCellId:{ini:"",action:function(){this.boxing().notifyExcel(!1)}}},EventHandlers:{onChecked:function(profile,e,value){},onGetExcelCellValue:function(profile,excelCellId,dftValue){}},RenderTrigger:function(){this.properties.excelCellId&&this.boxing().notifyExcel()},_prepareData:function(profile){var data=arguments.callee.upper.call(this,profile);return data._hAlign="text-align:"+data.hAlign+";",data._vAlign="vertical-align:"+(data.vAlign||""),data._iconPosCls="xui-float-"+data.iconPos,data},_ensureValue:function(profile,value){return"0"!==value&&!!value}}}),xui.Class("xui.UI.HiddenInput",["xui.UI","xui.absValue"],{Instance:{activate:function(){return this},_setCtrlValue:function(value){return!xui.isNull(value)&&xui.isDefined(value)||(value=""),this.each((function(profile){profile.getSubNode("KEY").attr("value",value+"")}))},_getCtrlValue:function(){var node=this.getSubNode("INPUT"),v=node&&!node.isEmpty()?this.getSubNode("INPUT").attr("value"):"";return-1!=v.indexOf("\r")&&(v=v.replace(/(\r\n|\r)/g,"\n")),v}},Static:{$initRootHidden:!0,Templates:{className:"xui-display-none",style:"display:none",tagName:"input",type:"hidden"},DataModel:{locked:null,required:null,dataBinder:null,dataField:null,display:null,visibility:null,position:null,left:null,top:null,right:null,bottom:null,width:null,height:null,rotate:null,showEffects:null,hideEffects:null,activeAnim:null,tabindex:null,zIndex:null,defaultFocus:null,hoverPop:null,hoverPopType:null,disabled:null,readonly:null,disableClickEffect:null,disableHoverEffect:null,dock:null,dockOrder:null,dockMargin:null,dockMinW:null,dockMinH:null,dockMaxW:null,dockMaxH:null,dockFloat:null,dockIgnore:null,dirtyMark:null,showDirtyMark:null,selectable:null,autoTips:null,tips:null,disableTips:null,renderer:null,className:null},EventHandlers:{beforeDirtyMark:null,onContextmenu:null,onDock:null,onLayout:null,onMove:null,onRender:null,onResize:null,onShowTips:null,beforeAppend:null,afterAppend:null,beforeRender:null,afterRender:null,beforeRemove:null,afterRemove:null,onHotKeydown:null,onHotKeypress:null,onHotKeyup:null},_ensureValue:function(profile,value){return""+(xui.isSet(value)?value:"")}}}),xui.Class("xui.UI.RichEditor",["xui.UI","xui.absValue"],{Initialize:function(){this.addTemplateKeys(["TOOLBARBTN"])},Instance:{getEditorWin:function(){return this.get(0).$win},getEditorDoc:function(){return this.get(0).$doc},getEditorBody:function(){var doc=this.get(0).$doc;return doc&&(doc.body||doc.documentElement)},_setCtrlValue:function(value){return xui.isSet(value)||(value=""),this.each((function(profile){var sp=window["/"];sp&&-1!=sp.indexOf(":/")&&(value=value.replace(/{\/}/g,sp));var html=profile.$useOriginalText?value:xui.adjustRes(value,0,1);if(!profile.$inDesign){var doc=profile.$doc,body=doc&&(doc.body||doc.documentElement);if(body)return void(body.innerHTML=html)}profile.getSubNode("EDITOR").html(html)}))},_getCtrlValue:function(){var profile=this.get(0);if(profile.$inDesign)return profile.getSubNode("EDITOR").html();var doc=profile.$doc,body=doc&&(doc.body||doc.documentElement);if(body){var v=body.innerHTML,sp=window["/"];return sp&&-1!=sp.indexOf(":/")&&(v=v.replace(new RegExp(sp,"g"),"{/}")),v}return""}},Static:{DIRYMARKICON:"DIRTYMARK",Templates:{tagName:"div",style:"{_style}",className:"{_className} xui-ui-selectable",LABEL:{className:"{_required} xui-ui-ellipsis",style:"{labelShow};width:{_labelSize};{_labelHAlign};{_labelVAlign}",text:"{labelCaption}"},BOX:{EDITOR:{tagName:"div",className:"xui-uiborder-flat xui-uiborder-radius xui-uibase"},DIRTYMARK:{},POOL:{}}},DataModel:{selectable:!0,value:{ini:"",html:1},width:{$spaceunit:1,ini:"32em"},height:{$spaceunit:1,ini:"25em"},frameTemplate:{ini:'<html style="-webkit-overflow-scrolling: touch;padding:0;margin:0.25em;"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0"><style type="text/css">body{height: 100%;-webkit-overflow-scrolling: touch;border:0;padding:0;margin:.0;cursor:text;color:#000;font-family:arial,helvetica,clean,sans-serif;font-style:normal;font-weight:normal;font-size:12px;line-height:1.22}div, p{margin:0;padding:0;} body, p, div{word-wrap: break-word;} img, input, textarea{cursor:default;}</style></head><body scroll="auto" spellcheck="false"></body></html>',action:function(){this.boxing().refresh()}},frameStyle:"",cmdList:{ini:"font1;font2;align;list;font4;font3;insert;clear;html",action:function(v){this.properties.disabled||this.properties.readonly||this.box._iniToolBar(this)}},cmdFilter:{ini:""},disabled:{ini:!1,action:function(disabled){disabled=this.properties.disabled||this.properties.readonly;var doc=this.$doc;doc&&(doc.body.contentEditable!=undefined&&xui.browser.ie?doc.body.contentEditable=disabled?"false":"true":doc.designMode=disabled?"off":"on",this.box._iniToolBar(this,!disabled))}},readonly:{ini:!1,action:function(v){this.boxing().setDisabled(v)}},labelSize:{$spaceunit:2,ini:0,action:function(v){this.getSubNode("LABEL").css({display:v&&"auto"!=v?"":"none"}),xui.UI.$doResize(this,this.properties.width,this.properties.height,!0)}},labelPos:{ini:"left",listbox:["none","left","top","right","bottom"],action:function(v){xui.UI.$doResize(this,this.properties.width,this.properties.height,!0)}},labelGap:{$spaceunit:2,ini:4,action:function(v){xui.UI.$doResize(this,this.properties.width,this.properties.height,!0)}},labelCaption:{ini:"",action:function(v){v=(xui.isSet(v)?v:"")+"",this.getSubNode("LABEL").html(xui.adjustRes(v,!0))}},labelHAlign:{ini:"right",listbox:["","left","center","right"],action:function(v){this.getSubNode("LABEL").css({textAlign:v||"",justifyContent:"right"==v?"flex-end":"center"==v?"center":"left"==v?"flex-start":""})}},labelVAlign:{ini:"top",listbox:["","top","middle","bottom"],action:function(v){this.getSubNode("LABEL").css("align-items","bottom"==v?"flex-end":"middle"==v?"center":"top"==v?"flex-start":"")}}},Appearances:{KEY:{overflow:"hidden"},BOX:{left:0,top:0,width:"100%",position:"absolute",overflow:"hidden"},POOL:{position:"absolute",display:"none"},DIRTYMARK:{position:"absolute",width:"1em",height:"1em"},TOOLBARBTN:{},LABEL:{"z-index":1,top:0,left:0,display:xui.browser.isWebKit?"-webkit-flex":"flex",position:"absolute","padding-top":".5em"},EDITOR:{position:"absolute",display:"block",left:0,top:0,width:"100%",height:"100%",padding:0,margin:0,"z-index":"10"}},Behaviors:{LABEL:{onClick:function(profile,e,src){if(profile.properties.disabled)return!1;profile.onLabelClick&&profile.boxing().onLabelClick(profile,e,src)},onDblClick:function(profile,e,src){if(profile.properties.disabled)return!1;profile.onLabelDblClick&&profile.boxing().onLabelDblClick(profile,e,src)},onMousedown:function(profile,e,src){if("left"==xui.Event.getBtn(e))return!profile.properties.disabled&&void(profile.onLabelActive&&profile.boxing().onLabelActive(profile,e,src))}}},EventHandlers:{onInnerEvent:function(profile,type,node,e){},onUpdateToolbar:function(profile,etype,doc){},onReady:function(profile){},onLabelClick:function(profile,e,src){},onLabelDblClick:function(profile,e,src){},onLabelActive:function(profile,e,src){}},$cmds:{font1:[{id:"bold",command:"Bold",statusButton:!0,imageClass:"xuifont xui-icon-bold",_fi_:"xui-icon-bold"},{id:"italic",command:"Italic",statusButton:!0,imageClass:"xuifont xui-icon-italic",_fi_:"xui-icon-italic"},{id:"underline",command:"Underline",statusButton:!0,imageClass:"xuifont xui-icon-underline",_fi_:"xui-icon-underline"},{id:"strikethrough",command:"strikeThrough",statusButton:!0,imageClass:"xuifont xui-icon-strikethrough",_fi_:"xui-icon-strikethrough"}],font2:[{id:"subscript",command:"subscript",statusButton:!0,imageClass:"xuifont xui-icon-sub",_fi_:"xui-icon-sub"},{id:"superscript",command:"superscript",statusButton:!0,imageClass:"xuifont xui-icon-super",_fi_:"xui-icon-super"}],font3:[{id:"forecolor",command:"custom",imageClass:"xuifont xui-icon-forecolor",_fi_:"xui-icon-forecolor"},{id:"bgcolor",command:"custom",imageClass:"xuifont xui-icon-bgcolor",_fi_:"xui-icon-bgcolor"}],font4:[{id:"fontsize",command:"custom",caption:"$editor.fontsize",dropButton:!0},{id:"fontname",command:"custom",caption:"$editor.fontname",dropButton:!0},{id:"formatblock",command:"custom",caption:"$editor.formatblock",dropButton:!0}],align:[{id:"left",command:"justifyleft",imageClass:"xuifont xui-icon-alignleft",_fi_:"xui-icon-alignleft"},{id:"center",command:"justifycenter",imageClass:"xuifont xui-icon-aligncenter",_fi_:"xui-icon-aligncenter"},{id:"right",command:"justifyright",imageClass:"xuifont xui-icon-alignright",_fi_:"xui-icon-alignright"},{id:"justify",command:"justifyfull",imageClass:"xuifont xui-icon-alignjustify",_fi_:"xui-icon-alignjustify"}],list:[{id:"indent",command:"indent",imageClass:"xuifont xui-icon-indent",_fi_:"xui-icon-indent"},{id:"outdent",command:"outdent",imageClass:"xuifont xui-icon-outdent",_fi_:"xui-icon-outdent"},{id:"ol",command:"insertorderedlist",imageClass:"xuifont xui-icon-number",_fi_:"xui-icon-number"},{id:"ul",command:"insertunorderedlist",imageClass:"xuifont xui-icon-bullet",_fi_:"xui-icon-bullet"}],insert:[{id:"hr",command:"insertHorizontalRule",imageClass:"xuifont xui-icon-inserthr",_fi_:"xui-icon-inserthr"},{id:"insertimage",command:"custom",imageClass:"xuifont xui-icon-picture",_fi_:"xui-icon-picture"},{id:"createlink",command:"custom",imageClass:"xuifont xui-icon-link",_fi_:"xui-icon-link"},{id:"unlink",command:"unlink",imageClass:"xuifont xui-icon-breaklink",_fi_:"xui-icon-breaklink"}],clear:[{id:"removeformat",command:"removeformat",imageClass:"xuifont xui-icon-formatclear",_fi_:"xui-icon-formatclear"}],html:[{id:"html",command:"custom",imageClass:"xuifont xui-icon-html",_fi_:"xui-icon-html"}]},_prepareData:function(profile){var v,d=arguments.callee.upper.call(this,profile);return d._labelHAlign="text-align:"+(v=d.labelHAlign||"")+";justify-content:"+("right"==v?"flex-end":"center"==v?"center":"left"==v?"flex-start":""),d._labelVAlign="align-items:"+("bottom"==(v=d.labelVAlign)?"flex-end":"middle"==v?"center":"top"==v?"flex-start":""),d.labelShow="none"!=d.labelPos&&d.labelSize&&"auto"!=d.labelSize?"":"display:none",d._labelSize=d.labelSize?"":0+profile.$picku(),d.labelCaption&&(d.labelCaption=xui.adjustRes(d.labelCaption,!0)),d},_updateToolbar:function(domId,clear,etype){var toolbar,profile=xui.$cache.profileMap[domId];if(profile&&!profile.properties.disabled&&!profile.properties.readonly&&profile&&(toolbar=profile.$toolbar)){var doc=profile.$doc,bold=!clear&&doc.queryCommandState("bold"),italic=!clear&&doc.queryCommandState("italic"),underline=!clear&&doc.queryCommandState("underline"),strikethrough=!clear&&doc.queryCommandState("strikethrough"),subscript=!clear&&doc.queryCommandState("subscript"),superscript=!clear&&doc.queryCommandState("superscript"),tb=toolbar.boxing();tb.updateItem("bold",{value:bold}),tb.updateItem("italic",{value:italic}),tb.updateItem("underline",{value:underline}),tb.updateItem("strikethrough",{value:strikethrough}),tb.updateItem("subscript",{value:subscript}),tb.updateItem("superscript",{value:superscript}),profile.onUpdateToolbar&&profile.boxing().onUpdateToolbar(profile,etype,doc),doc=null}},RenderTrigger:function(){var self=this;if(self.properties.disabled||self.properties.readonly||self.box._iniToolBar(self),self.$inDesign)self.boxing()._setCtrlValue(self.properties.value||"");else{var div=self.getSubNode("EDITOR").get(0),domId=self.$domId,htmlTpl=self.properties.frameTemplate,style=self.properties.frameStyle,id=div.id;if(style&&(htmlTpl=htmlTpl.replace(/<\s*\/\s*head\s*>/,"<style>"+(style||"")+"</style></head>")),!self.$once){self.$once=!0;try{var iframe=self.$ifr=document.createElement("IFRAME")}catch(e){iframe=self.$ifr=document.createElement("<iframe name='"+id+"' id='"+id+"'></iframe>")}var doc,win,kprf=this,eventOutput=self._eventOutput=function(e){if(!kprf||!kprf.properties.disabled&&!kprf.properties.readonly)return kprf.onInnerEvent?kprf.boxing().onInnerEvent(kprf,e.type,xui.Event.getSrc(e),e):void 0},event=self._event=function(e){if(!kprf||!kprf.properties.disabled&&!kprf.properties.readonly){var etype=e.type;if("mouseover"!==etype&&"mouseout"!==etype&&(xui.resetRun("RichEditor:"+domId,(function(){kprf.box&&xui.UI.RichEditor._updateToolbar(domId,!1,etype)}),100),"mousedown"==etype)){if(xui.browser.applewebkit&&"IMG"==e.target.tagName){var sel=self.$win.getSelection(),range=self.$doc.createRange();range.selectNode(e.target),sel.removeAllRanges(),sel.addRange(range)}xui.doc.onMousedown(!0)}return kprf.onInnerEvent?kprf.boxing().onInnerEvent(kprf,etype,xui.Event.getSrc(e),e):void 0}},event2=self._event2=function(e){if((!kprf||!kprf.properties.disabled&&!kprf.properties.readonly)&&kprf.onInnerEvent){var etype=e.type;xui.resetRun(kprf.$xid+":frmInnerAsyEvent",(function(){kprf&&!kprf.destroyed&&kprf.boxing().onInnerEvent(kprf,etype,xui.Event.getSrc(e),e)}))}},_focus=function(e){kprf&&(kprf.properties.disabled||kprf.properties.readonly||kprf.box._onchange(kprf))},_blur=function(e){if(kprf&&!kprf.properties.disabled&&!kprf.properties.readonly){xui.resetRun("RichEditor:"+domId,(function(){kprf.box&&xui.UI.RichEditor._updateToolbar(domId,!0,"blur")}),100),kprf._onchangethread&&(clearInterval(kprf._onchangethread),kprf._onchangethread=null,kprf&&kprf.box&&kprf.box._checkc(kprf));var v=kprf.boxing()._getCtrlValue();kprf.boxing().setUIValue(v,null,!0,"blur")}},gekfix=function(e){if(kprf){var ins=kprf.boxing();xui.asyRun((function(){kprf.box&&ins.refresh()}))}},checkF=function(){xui.setTimeout((function(){if(window.frames[id]&&window.frames[id].document&&self.$win!=window.frames[id].window){win=self.$win=window.frames[id].window,(doc=self.$doc=win.document).open(),doc.write(htmlTpl),doc.close();try{doc.execCommand("styleWithCSS",0,!1)}catch(e){try{doc.execCommand("useCSS",0,!0)}catch(e){}}var disabled=self.properties.disabled||self.properties.readonly;if(doc.body.contentEditable!=undefined&&xui.browser.ie?doc.body.contentEditable=disabled?"false":"true":doc.designMode=disabled?"off":"on",disabled&&self.box._iniToolBar(self,!1),win._gekfix=gekfix,xui.browser.ie&&doc.attachEvent)doc.attachEvent("unload",gekfix),disabled||(doc.attachEvent("onmousedown",event),doc.attachEvent("ondblclick",event),doc.attachEvent("onclick",event),doc.attachEvent("oncontextmenu",eventOutput),doc.attachEvent("onkeyup",event),doc.attachEvent("onkeydown",event),doc.attachEvent("onmouseover",event),doc.attachEvent("onmouseout",event),doc.attachEvent("onmousemove",event2),win.attachEvent("onfocus",_focus),win.attachEvent("onblur",_blur),(self.$beforeDestroy=self.$beforeDestroy||{}).ifmClearMem=function(){var win=this.$win,doc=this.$doc,event=this._event,event2=this._event2;this._onchangethread&&(clearInterval(this._onchangethread),this._onchangethread=null);try{var status=doc.designMode;doc.designMode="off",doc.designMode="on",doc.designMode=status}catch(e){}win._gekfix=undefined;try{doc.detachEvent("unload",win._gekfix)}catch(e){}this.properties.disabled||this.properties.readonly||(doc.detachEvent("onmousedown",event),doc.detachEvent("ondblclick",event),doc.detachEvent("onclick",event),doc.detachEvent("oncontextmenu",eventOutput),doc.detachEvent("onkeyup",event),doc.detachEvent("onkeydown",event),doc.detachEvent("onmouseover",event),doc.detachEvent("onmouseout",event),doc.detachEvent("onmousemove",event2),win.detachEvent("onfocus",_focus),win.detachEvent("onblur",_blur)),win=doc=event=event2=null});else{var prf=self;xui.browser.opr||!win.addEventListener?prf.$repeatT=xui.Thread.repeat((function(){if(!window.frames[id])return!1;prf.$win.document&&prf.$win.document.defaultView||prf.boxing().refresh()}),99):win.addEventListener("unload",gekfix,!1),disabled||(doc.addEventListener("mousedown",event,!1),doc.addEventListener("dblclick",event,!1),doc.addEventListener("click",event,!1),doc.addEventListener("contextmenu",eventOutput,!1),doc.addEventListener("keyup",event,!1),doc.addEventListener("mouseover",event,!1),doc.addEventListener("mouseout",event,!1),doc.addEventListener("mousemove",event2,!1),xui.browser.gek||!win.addEventListener?(doc.addEventListener("focus",_focus,!1),doc.addEventListener("blur",_blur,!1),doc.addEventListener("keypress",event,!1)):(win.addEventListener("focus",_focus,!1),win.addEventListener("blur",_blur,!1),doc.addEventListener("keydown",event,!1))),(self.$beforeDestroy=self.$beforeDestroy||{}).ifmClearMem=function(){var win=this.$win,doc=this.$doc,ifr=this.$ifr,event=this._event,event2=this._event2;xui.browser.opr&&prf.$repeatT&&prf.$repeatT.abort(),ifr.detachEvent?ifr.detachEvent("onload",checkF):ifr.onload=null;try{win.removeEventListener("unload",win._gekfix,!1)}catch(e){}win._gekfix=undefined,delete window.frames[this.$frameId],this.properties.disabled||this.properties.readonly||!doc.removeEventListener||(doc.removeEventListener("mousedown",event,!1),doc.removeEventListener("dblclick",event,!1),doc.removeEventListener("click",event,!1),doc.removeEventListener("contextmenu",eventOutput,!1),doc.removeEventListener("keyup",event,!1),doc.removeEventListener("mouseover",event,!1),doc.removeEventListener("mouseout",event,!1),doc.removeEventListener("mousemove",event2,!1),xui.browser.gek||!win.removeEventListener?(doc.removeEventListener("focus",_focus,!1),doc.removeEventListener("blur",_blur,!1),doc.removeEventListener("keypress",event,!1)):(win.removeEventListener("focus",_focus,!1),win.removeEventListener("blur",_blur,!1),doc.removeEventListener("keydown",event,!1))),prf=gekfix=event=event2=win=doc=null}}self.boxing()._setCtrlValue(self.properties.$UIvalue||""),iframe.style.visibility="",iframe.style.overflow="auto",self.onReady&&self.boxing().onReady(self)}}))};self.$frameId=id,iframe.id=iframe.name=id,iframe.className=div.className,iframe.src="about:blank",iframe.frameBorder=0,iframe.border=0,iframe.scrolling="yes",iframe.marginWidth=0,iframe.marginHeight=0,iframe.tabIndex=-1,iframe.allowTransparency="allowtransparency",iframe.style.visibility="hidden",xui.$cache.domPurgeData[iframe.$xid=div.$xid].element=iframe,div.parentNode.replaceChild(iframe,div),iframe.attachEvent?iframe.attachEvent("onload",checkF):iframe.onload=checkF}}},_checkc:function(profile){if(profile&&profile.$doc){var doc=profile.$doc,body=doc&&(doc.body||doc.documentElement);if(profile.__oldv||(profile.__oldv=body.innerHTML),body.innerHTML!=profile.__oldv){var ov=profile.__oldv;profile.__oldv=body.innerHTML,profile.boxing().onChange(profile,ov,body.innerHTML)}}},_onchange:function(profile){profile.onChange&&(profile._onchangethread&&(clearInterval(profile._onchangethread),profile._onchangethread=null),profile._onchangethread=setInterval((function(){profile&&profile.box&&profile.box._checkc(profile)}),500))},_clearPool:function(profile){profile.getSubNode("POOL").empty(),profile.$colorPicker=profile.$fontsizeList=profile.$fontnameList=profile.$formatblockList=profile.$htmlEditor=null},_iniToolBar:function(profile,flag){var tbH,self=profile,pro=self.properties,cmdFilter=(pro.cmdFilter||"").split(/[\s,;]+/);if(self.$toolbar&&(self.$toolbar.boxing().destroy(!0),delete self._$tb,delete self.$toolbar),!1!==flag){var t,o,items=[],imageClass=self.getClass("TOOLBARBTN"),arr=pro.cmdList.split(/[\s,;]+/),h={};xui.arr.each(arr,(function(i){(o=self.box.$cmds[i])&&!h[i]&&(h[i]=1,xui.filter(o,(function(v){if(-1!==xui.arr.indexOf(cmdFilter,v.id))return!1;v.imagePos&&(v.imageClass=imageClass),v.tips=xui.wrapRes("editor."+v.id)})),items.push({id:i,sub:o}))})),(t=new xui.UI.ToolBar({selectable:!1,handler:!1,items:items,disabled:pro.disabled||pro.readonly})).setCustomStyle("ITEMS","border:none"),self.getSubNode("BOX").prepend(t),t.render(!0),profile.$_tbH=tbH=t.getRoot().offsetHeight(),xui.browser.ie&&t.getSubNode("BOX").query("*").attr("unselectable","on"),(t=self._$tb=t.get(0)).onClick=self.box._toolbarclick,(self._$composed={})[t.$xid]=t,self.$toolbar=t,t.$hostage=self}return profile.adjustSize(!0),tbH},_toolbarclick:function(profile,item,group,e,src){var first,editor=profile.$hostage;if(editor.$doc)if(editor.properties,editor.$win.focus(),"custom"==item.command){var o,_clear,node,items,items2,cmd=item.id;switch(cmd){case"forecolor":case"bgcolor":editor.$colorPicker||(first=!0,editor.$colorPicker=new xui.UI.ColorPicker({selectable:!1,barDisplay:!1}).render(!0)),o=editor.$colorPicker;break;case"fontsize":case"fontname":case"formatblock":if(editor.$lang!=xui.getLang()&&editor.box._clearPool(editor),editor.$lang=xui.getLang(),"fontsize"==cmd)editor.$fontsizeList||(items=(items=xui.getRes("editor.fontsizeList")).split(";"),items2=[],xui.arr.each(items,(function(o){o=o.split(","),t="..."==o[0]?"1":o[0],items2.push({id:o[0],caption:'<font size="'+o[0]+'" '+xui.$IEUNSELECTABLE()+">"+o[1]+"</font>"})})),first=!0,editor.$fontsizeList=new xui.UI.List({selectable:!1,height:"auto",items:items2,width:150}).render(!0)),o=editor.$fontsizeList;else if("fontname"==cmd)editor.$fontnameList||(items=(items=xui.getRes("editor.fontnameList")).split(";"),items2=[],xui.arr.each(items,(function(o){t="..."==o?"":o,items2.push({id:o,caption:'<span style="font-family:'+o+'" '+xui.$IEUNSELECTABLE()+">"+o+"</span>"})})),first=!0,editor.$fontnameList=new xui.UI.List({selectable:!1,height:"auto",items:items2}).render(!0)),o=editor.$fontnameList;else if("formatblock"==cmd){var t;editor.$formatblockList||(items=(items=xui.getRes("editor.formatblockList")).split(";"),items2=[],xui.arr.each(items,(function(o){o=o.split(","),t="..."==o[0]?"span":o[0],items2.push({id:o[0],caption:"<"+t+' style="display:inline;padding:0;margin:0" '+xui.$IEUNSELECTABLE()+">"+o[1]+"</"+t+">"})})),first=!0,editor.$formatblockList=new xui.UI.List({selectable:!1,height:"auto",items:items2}).render(!0)),o=editor.$formatblockList}break;case"html":editor.$htmlEditor||(first=!0,editor.$htmlEditor=new xui.UI.Input({multiLines:!0,width:400,height:300,resizer:!0})),o=editor.$htmlEditor}if(o){var sid=profile.key+":"+editor.$xid;if(_clear=function(){o.beforeUIValueSet(null),editor.getSubNode("POOL").append(o.getRoot()),node.setBlurTrigger(sid),xui.Event.keyboardHook("esc",0,0,0,sid),xui.asyRun((function(){editor&&editor.$win&&editor.$win.focus()}))},o.setValue("",!0,"clear"),node=o.reBoxing(),editor.$htmlEditor==o){editor.getRoot();var ifr=editor.getSubNode("EDITOR");o.setLeft(ifr.left()).setTop(ifr.top()).setWidth(ifr.offsetWidth()).setHeight(ifr.offsetHeight()),o.setZIndex(10),editor.getSubNode("BOX").append(node)}else node.popToTop(src);first&&xui.browser.ie&&o.getSubNode("BOX").query("*").attr("unselectable","on"),xui.tryF(o.activate,[],o),node.setBlurTrigger(sid,(function(){if(o==editor.$htmlEditor)var v=o._getCtrlValue();o.setUIValue(v,null,!0,"blur"),_clear()})),xui.Event.keyboardHook("esc",0,0,0,(function(){_clear()}),sid,null,null,profile.domId)}switch(cmd){case"forecolor":case"bgcolor":o.beforeUIValueSet((function(p,o,v){_clear();var doc=editor.$doc;return"bgcolor"==cmd&&xui.browser.gek?(doc.execCommand("useCSS",0,!1),doc.execCommand("hilitecolor",!1,"#"+v),doc.execCommand("useCSS",0,!0)):("bgcolor"==cmd&&(cmd=xui.browser.opr?"hilitecolor":"backcolor"),doc.execCommand(cmd,!1,xui.browser.kde?"#"+v:v)),doc=null,!1}));break;case"fontsize":case"fontname":case"formatblock":o.beforeUIValueSet((function(p,o,v){if(_clear(),xui.browser.ie&&("..."==v||"formatblock"==cmd)){var selection=editor.$doc.selection,range=selection?selection.createRange():null;range&&range.parentElement().ownerDocument!=editor.$doc&&(range=selection=null)}var f=function(cmd,v){var doc=editor.$doc;if(range){if(editor.$win.focus(),"formatblock"==cmd&&v){var html,p=range.parentElement();p.ownerDocument==doc&&(/^\s*</.test(range.htmlText)?(range.collapse(!0),"BODY"==(p=range.parentElement()).tagName?(html=p.innerHTML,p.innerHTML="<"+v+">"+html+"</"+v+">"):(html=(html=p.outerHTML).replace(/\<[\w]+/,"<"+v).replace(/[\w]+\>$/,v+">"),p.outerHTML=html)):range.pasteHTML("<"+v+">"+range.htmlText+"</"+v+">")),p=null}range.select(),selection=range=null}doc.execCommand(cmd,!1,v),doc=null};if("..."==v){var str=xui.getRes("editor."+cmd);xui.UI.Dialog.prompt(str,str,"",(function(v){v&&f(cmd,v)}),(function(){xui.browser.ie&&(range&&(editor.$win.focus(),range.select()),selection=range=null)}))}else f(cmd,v)}));break;case"insertimage":case"createlink":var str=xui.getRes("editor."+cmd),str2=xui.getRes("editor."+cmd+"2");if(xui.browser.ie){var selection=editor.$doc.selection,range=selection?selection.createRange():null;range&&range.parentElement().ownerDocument!=editor.$doc&&(range=selection=null)}xui.UI.Dialog.prompt(str,str2,"http://",(function(v){if(xui.browser.ie&&(range&&(editor.$win.focus(),range.select()),selection=range=null),v){var doc=editor.$doc;doc.execCommand(cmd,!1,xui.adjustRes(v,0,1)),doc=null}}),(function(){xui.browser.ie&&(range&&(editor.$win.focus(),range.select()),selection=range=null)}));break;case"html":var v=editor.boxing().getUIValue();xui.Coder&&(v=xui.Coder.formatText(v,"html")),o.setValue(v,!0,"editor"),o.beforeUIValueSet((function(p,o,v){_clear(),editor.boxing().setUIValue(v,null,null,"html")}))}}else editor.$doc.execCommand(item.command,!1,item.commandArgs||null),"removeformat"==item.id&&xui.UI.RichEditor._updateToolbar(editor.$domId,!0,"none"),editor.$win.focus()},_ensureValue:function(profile,value){var p=xui.$getGhostDiv();return p.innerHTML=(xui.isSet(value)?value:"")+"",value=p.innerHTML,p.innerHTML="",value},_onresize:function(profile,width,height){if(width||height){height||(height=profile.properties.height);var ww,hh,prop=profile.properties,root=profile.getRoot(),box=profile.getSubNode("BOX"),label=profile.getSubNode("LABEL"),us=xui.$us(profile),adjustunit=function(v,emRate){return profile.$forceu(v,us>0?"em":"px",emRate)},fzrate=profile.getEmSize()/root._getEmSize(),labelfz=label._getEmSize(fzrate),labelPos=prop.labelPos,labelSize="none"!=labelPos&&labelPos&&profile.$px(prop.labelSize,labelfz)||0,labelGap="none"!=labelPos&&labelPos&&profile.$px(prop.labelGap)||0;width&&"auto"!=width&&(width=profile.$px(width)),height&&"auto"!=height&&(height=profile.$px(height)),box.cssRegion({left:adjustunit("left"==labelPos?labelSize:0),top:adjustunit("top"==labelPos?labelSize:0),width:adjustunit(ww=null===width?null:Math.max(0,width-("left"==labelPos||"right"==labelPos?labelSize:0))),height:adjustunit(hh=null===height?null:Math.max(0,height-("top"==labelPos||"bottom"==labelPos?labelSize:0)))}),labelSize&&label.cssRegion({left:adjustunit(null===width?null:Math.max(0,"right"==labelPos?width-labelSize+labelGap:0),labelfz),top:adjustunit(null===height?null:Math.max(0,"bottom"==labelPos?height-labelSize+labelGap:0),labelfz),width:adjustunit(null===width?null:Math.max(0,"left"==labelPos||"right"==labelPos?labelSize-labelGap:width),labelfz),height:adjustunit(null===height?null:Math.max(0,"top"==labelPos||"bottom"==labelPos?labelSize-labelGap:height),labelfz)}),xui.asyRun((function(){if(profile.renderId){var _top,tbh,itb=profile._$tb,size={};itb&&(itb.getRoot().width(adjustunit(ww,itb.getRoot())),(tbh=itb.getRoot().offsetHeight(!0))?profile.$_tbH=tbh:tbh=profile.$_tbH),_top=itb?tbh-1:0,size.height=hh-_top-2,ww&&(size.width=ww-2),size.width<0&&(size.width=0),size.height<0&&(size.height=0),(ww||hh)&&profile&&profile.renderId&&(size.width=adjustunit(size.width),size.height=adjustunit(size.height),profile.getSubNode("EDITOR").top(adjustunit(_top)).cssSize(size,!0),profile.getSubNode("DIRTYMARK").left(0+profile.$picku()).top(adjustunit(_top+1)))}}),100)}}}}),xui.Class("xui.UI.ComboInput","xui.UI.Input",{Instance:{_adjustV:function(v){var profile=this.get(0),p=profile.properties;return profile.$isNumber?(v=(""+v).replace(/[^\d.-]/g,""),v=xui.isNumb(parseFloat(v))?xui.toFixedNumber(v,p.precision):null):"date"==profile.properties.type||"datetime"==profile.properties.type?v=xui.isDate(v)?v:xui.isFinite(v)?new Date(parseInt(v,10)):null:"string"==typeof v&&-1!=v.indexOf("\r")&&(v=v.replace(/(\r\n|\r)/g,"\n")),v},getValue:function(){var upper=arguments.callee.upper,v=upper.apply(this,xui.toArr(arguments));return upper=null,this._adjustV(v)},getUIValue:function(){var upper=arguments.callee.upper,v=upper.apply(this,xui.toArr(arguments));return upper=null,this._adjustV(v)},_getCtrlValue:function(){return this.get(0).properties.$UIvalue},_setCtrlValue:function(value){var ns=this,me=arguments.callee,r1=me._r1||(me._r1=/\</),r2=me._r2||(me._r2=/\<\/?[^>]+\>/g);return this.each((function(profile){profile.$typeOK||profile.box._iniType(profile);var o=profile.getSubNode("INPUT"),type=profile.properties.type;if("string"==typeof(value=profile.$_onedit?ns._toEditor(value):ns.getShowValue(value))&&"input"!=o.get(0).tagName.toLowerCase()&&"textarea"!=o.get(0).tagName.toLowerCase()&&r1.test(value)&&(value=value.replace(r2,"")),profile.$Mask&&!value&&(value=profile.$Mask),profile.$_inner=1,o.attr("value",value||""),delete profile.$_inner,"color"==type){var clr=xui.UI.ColorPicker.getTextColor(value);o.css({backgroundColor:value,color:clr}),"compact"==profile.properties.showMode&&profile.getRoot().query("button").css("color",clr)}profile.box._checkAutoexpand(profile)}))},_compareValue:function(v1,v2){var t,profile=this.get(0);return(t=profile.CF.compareValue||profile.$compareValue)?t(profile,v1,v2):v1===v2},getShowValue:function(value){var v,t,profile=this.get(0),pro=profile.properties;if(xui.isDefined(value)||(value=pro.$UIvalue),profile.$typeOK||profile.box._iniType(profile),t=profile.CF.getShowValue||profile.$getShowValue)v=t(profile,value);else if("listbox"==pro.type){var list=pro.listKey?xui.UI.getCachedData(pro.listKey):pro.items;list&&-1!=(t=xui.arr.subIndexOf(list,"id",value))?(v=list[t].caption+"")&&v.length>0&&(v=xui.adjustRes(v)):v=null}else v=profile.$showValue;return xui.isSet(v)||!profile.$inputReadonly&&!pro.inputReadonly||(v=xui.isSet(pro.caption)?pro.caption:null),""+(xui.isSet(v)?v:xui.isSet(value)?value:"")},_toEditor:function(value){var t,profile=this.get(0);return profile.properties,(t=profile.CF.toEditor||profile.$toEditor)?t(profile,value):value},_fromEditor:function(value){var t,profile=this.get(0);return profile.properties,(t=profile.CF.fromEditor||profile.$fromEditor)?t(profile,value):value},setPopWnd:function(drop){if(!this.isDestroyed()){var profile=this.get(0);profile.$poplink=drop?drop["xui.Module"]?drop.getRoot(!0):drop["xui.UI"]?drop.get(0):drop:null,(profile.$poplink.$beforeDestroy=profile.$poplink.$beforeDestroy||{}).$poplink_to=function(){delete profile.$poplink},(profile.$beforeDestroy=profile.$beforeDestroy||{}).$poplink=function(){profile.$poplink&&(xui.filter(profile.box.$drop,(function(o){return o!==profile.$poplink})),profile.$poplink.boxing().destroy(),profile.$poplink=null)}}},_cache:function(type,focus){if(!this.isDestroyed()){var profile=this.get(0),drop=profile.$poplink,cached=profile.properties.cachePopWnd;return drop&&(cached?profile.__tryToHide||(profile.__tryToHide=xui.asyRun((function(){profile.box&&(delete profile.__tryToHide,drop.destroyed||(xui.browser.opr&&drop.getRoot().css("display","none"),drop.boxing()._clearMouseOver&&drop.boxing()._clearMouseOver(),profile.getSubNode("POOL").append(drop.getRoot())),focus&&profile.boxing().activate())}))):(drop.destroyed||drop.boxing().destroy(!0),delete profile.$poplink,focus&&profile.boxing().activate())),delete profile.$poplink,profile.afterPopHide&&this.afterPopHide(profile,drop,type),cached}},clearPopCache:function(){var profile=this.get(0);return profile.renderId&&profile.getSubNode("POOL").empty(),delete profile.$poplink,this},setUploadObj:function(input){var profile=this.get(0),prop=profile.properties,c=xui(input).get(0);if(c.tagName&&"input"==c.tagName.toLowerCase()&&"file"==c.type&&profile.renderId&&"file"==prop.type){var o=profile.getSubNode("FILE").get(0);xui.setNodeData(c.$xid=o.$xid,"element",c),c.id=o.id,c.onclick=o.onclick,c.onchange=o.onchange,o.$xid=null,o.id=o.onclick=o.onchange=null,delete profile.$_domid[profile.keys.FILE],xui([o]).addPrev(c).remove(!1),this.setUIValue(c.value||"",null,null,"setfile",c)}return this},getUploadObj:function(){var profile=this.get(0),prop=profile.properties;if(profile.renderId&&"file"==prop.type){var o=profile.getSubNode("FILE").get(0);if(!o.value)return null;var c=o.cloneNode(!1);return c.value="",xui.setNodeData(c.$xid=o.$xid,"element",c),c.onclick=o.onclick,c.onchange=o.onchange,o.$xid=null,o.id=o.onclick=o.onchange=null,delete profile.$_domid[profile.keys.FILE],xui([o]).addPrev(c).remove(!1),c=null,this.setUIValue(this.getValue(),null,null,"getfile",o),o}},popFileSelector:function(accept,multiple){var profile=this.get(0),prop=profile.properties;if(profile.renderId&&"file"==prop.type){var input=profile.getSubNode("FILE"),fileInput=input.get(0);if(input.attr("accept",accept||prop.fileAccept||null),input.attr("multiple",multiple||prop.fileMultiple?"multiple":null),xui.browser.ie11){var label=document.createElement("div");fileInput.appendChild(label),label.click(),fileInput.removeChild(label)}else fileInput.click()}},resetValue:function(value){this.each((function(p){"file"==p.properties.type&&p.getSubNode("FILE").attr("value","")}));var upper=arguments.callee.upper,rtn=upper.apply(this,xui.toArr(arguments));return upper=null,rtn},_drop:function(e,src,baseNode,ignoreEvent){return this.each((function(profile){var pro=profile.properties,type=pro.type,cacheDrop=pro.cachePopWnd;if(!pro.disabled&&!pro.readonly&&!profile.$poplink){var o,drop,box=profile.boxing(),main=profile.getSubNode("BOX"),btn=profile.getSubNode("RBTN"),pos=main.offset();if(pos.top+=main.offsetHeight(),ignoreEvent||!profile.beforeComboPop||!1!==box.beforeComboPop(profile,pos,e,src)){if("combobox"==type||"listbox"==type||"helpinput"==type||"date"==type||"time"==type||"datetime"==type||"color"==type){var cachekey;if(profile.__tryToHide&&(xui.clearTimeout(profile.__tryToHide),delete profile.__tryToHide),cacheDrop){switch(type){case"time":case"date":case"datetime":case"color":cachekey=type;break;default:pro.listKey?"function"==typeof xui.get(xui.$cache,["UIDATA",pro.listKey])?drop=cachekey=null:cachekey="!"+pro.listKey:cachekey="$"+profile.$xid}cachekey&&(xui.filter(profile.box.$drop,(function(o){return!!o.renderId})),drop=profile.box.$drop[cachekey])}if(!drop){switch(type){case"combobox":case"listbox":case"helpinput":(o=xui.create("List")).setHost(profile).setDirtyMark(!1).setItems(xui.copy(pro.items)).setListKey(pro.listKey||""),pro.dropListWidth?o.setWidth(pro.dropListWidth):o.setWidth(profile.$forceu(main.offsetWidth()+btn.offsetWidth())),o.setHeight(pro.dropListHeight||"auto"),o.afterClick((function(){return this.destroyed?o.destroy(!0):this.boxing()._cache("",!0),!1})),o.beforeUIValueSet((function(p,ovalue,value){var item,b2=this.boxing();return"combobox"!=type&&"listbox"!=type||(item=p.queryItems(p.properties.items,(function(o){return o.id==value}),!1,!0),"combobox"==type&&item.length&&(value=item[0].caption)),b2.setUIValue(value,null,null,"pick",item&&item[0]),b2._cache("",!0)}));break;case"time":(o=xui.create("TimePicker")).setHost(profile),o.beforeClose((function(){return this.destroyed||this.boxing()._cache("",!0),!1})),o.beforeUIValueSet((function(p,o,v){var b2=this.boxing();return b2.setUIValue(v,null,null,"pick"),b2._cache("",!0)}));break;case"date":case"datetime":o=xui.create("DatePicker"),"datetime"==type&&o.setTimeInput(!0),o.setHost(profile),o.beforeClose((function(){return this.destroyed?o.destroy(!0):this.boxing()._cache("",!0),!1})),o.beforeUIValueSet((function(p,o,v){var b2=this.boxing();return b2.setUIValue(String(v.getTime()),null,null,"pick",v),b2._cache("",!0)}));break;case"color":(o=xui.create("ColorPicker")).setHost(profile),o.beforeClose((function(){return this.destroyed?o.destroy(!0):this.boxing()._cache("",!0),!1})),o.beforeUIValueSet((function(p,o,v){var b2=this.boxing();return b2.setUIValue(("transparent"==v?"":"#")+v,null,null,"pick"),b2._cache("",!0)}))}xui.isHash(pro.popCtrlProp)&&!xui.isEmpty(pro.popCtrlProp)&&o.setProperties(pro.popCtrlProp),xui.isHash(pro.popCtrlEvents)&&!xui.isEmpty(pro.popCtrlEvents)&&o.setEvents(pro.popCtrlEvents),drop=o.get(0),cachekey&&(profile.box.$drop[cachekey]=drop),o.render()}switch((o=drop.boxing()).setHost(profile),type){case"combobox":case"listbox":case"helpinput":case"time":o.setValue(profile.properties.$UIvalue,!0,"pop");break;case"date":case"datetime":var t=drop.properties;(t=profile.properties.$UIvalue)&&o.setValue(new Date(parseInt(t,10)),!0,"pop");break;case"color":o.setValue(profile.properties.$UIvalue.replace("#",""),!0,"pop")}if(profile.boxing().setPopWnd(o),!ignoreEvent&&profile.beforePopShow&&!1===box.beforePopShow(profile,drop,profile.properties.items))return;var node=o.reBoxing(),pid=pro.parentID||xui.ini.$rootContainer;node.popToTop(baseNode||profile.getSubNode("BOX"),null,pid?xui.get(profile,["host",pid])?profile.host[pid].getContainer():xui(pid):null),xui.tryF(o.activate,[],o);var sid=profile.key+":"+profile.$xid;node.setBlurTrigger(sid,(function(){box._cache("blur"),xui.Event.keyboardHook("esc",0,0,0,sid)})),xui.Event.keyboardHook("esc",0,0,0,(function(){return profile.$escclosedrop=1,xui.asyRun((function(){delete profile.$escclosedrop})),box.activate(),box._cache("esc",!0),xui.Event.keyboardHook("esc",0,0,0,sid),!1}),sid,null,null,profile.domId)}else"file"==type&&profile.boxing().popFileSelector();!ignoreEvent&&profile.afterPopShow&&box.afterPopShow(profile,drop)}}}))},expand:function(node,ignoreEvent,e){var profile=this.get(0);profile.renderId&&profile.boxing()._drop(e,node,node,ignoreEvent)},collapse:function(){var profile=this.get(0);profile.renderId&&profile.$poplink&&profile.boxing()._cache("call")},getPopWnd:function(){var profile=this.get(0);if(profile&&profile.$poplink)return profile.$poplink.boxing()}},Initialize:function(){var ns=this;ns.addTemplateKeys(["ICONB","ICON","UNIT","FILE","LMID","RMID","LBTN","RBTN","SPINBTN","R1","R1B","R2","R2B"]);var t=ns.getTemplate();xui.merge(t.FRAME.BORDER,{LBTN:{},RBTN:{},SPINBTN:{R1:{},R2:{}},CMD:{$order:50,tagName:"button",className:"xui-ui-unselectable xui-uiborder-radius-tr xui-uiborder-radius-br xui-uiborder-noradius-l xui-nofocus xui-ui-btn xui-uibar xui-uigradient",style:"{_cmdDisplay}",SMID:{className:"xuifont",$fonticon:"{_fi_commandCls}"}}},"all");var box=t.FRAME.BORDER.BOX;box.className="xui-ui-input xui-ui-shadow-input xui-uiborder-flat xui-uibase {_radius_input} ",box.ICONB={tagName:"button",className:"xui-ui-unselectable xui-nofocus xui-ui-clear-bg",tabindex:"-1",ICON:{className:"xuifont {imageClass}  {picClass}",style:"{backgroundImage}{backgroundPosition}{backgroundSize}{backgroundRepeat}{iconFontSize}{imageDisplay}{iconStyle}",text:"{iconFontCode}"}},box.UNIT={tagName:"button",tabindex:"-1",className:"xui-ui-unselectable xui-nofocus",text:"{unit}"},t.FRAME.POOL={},t.className+=" {typecls}",ns.setTemplate(t),ns._adjustItems=xui.absList._adjustItems;var a=ns.prototype,b=xui.absList.prototype;a.getItems=b.getItems,a.getItemByItemId=b.getItemByItemId},Static:{_beforeResetValue:function(profile){profile.properties.caption=undefined},_iniType:function(profile){var pro=profile.properties,type=pro.type,c=profile.box;if(delete profile.$beforeKeypress,delete profile.$inputReadonly,delete profile.$isNumber,delete profile.$compareValue,delete profile.$getShowValue,delete profile.$toEditor,delete profile.$fromEditor,delete profile.$typeOK,"listbox"!=type&&"file"!=type&&"cmdbox"!=type&&"button"!=type&&"dropbutton"!=type||(profile.$inputReadonly=!0),"file"==type&&(profile.$xuiFileCtrl=!0),"listbox"!=type&&"combobox"!=type&&"helpinput"!=type&&(pro.items=[]),"time"==type){var keymap={a:1,c:1,v:1,x:1};xui.merge(profile,{$beforeKeypress:function(p,c,k){return 1!=k.key.length||/[-0-9:]/.test(k.key)||k.ctrlKey&&!!keymap[k.key]},$getShowValue:function(p,v){return v?xui.UI.TimePicker._ensureValue(p,v):""},$fromEditor:function(p,v){return v&&"00:00"==(v=xui.UI.TimePicker._ensureValue(p,v))&&(v=p.properties.$UIvalue),v}},"all")}else if("date"==type||"datetime"==type){var date=xui.Date;keymap={a:1,c:1,v:1,x:1},xui.merge(profile,{$beforeKeypress:function(p,c,k){return 1!=k.key.length||/[0-9:/\-_ ]/.test(k.key)||k.ctrlKey&&!!keymap[k.key]},$compareValue:function(p,a,b){return!a&&!b||String(a)==String(b)},$getShowValue:function(p,v){return p.properties.dateEditorTpl?v?date.format(v,p.properties.dateEditorTpl):"":v?date.getText(new Date(parseInt(v,10)),"datetime"==p.properties.type?"ymdhn":"ymd").replace(/\<\/?[^>]+\>/g,""):""},$toEditor:function(p,v){if(!v)return"";if(v=new Date(parseInt(v,10)||0),p.properties.dateEditorTpl)return date.format(v,p.properties.dateEditorTpl);var m=date.get(v,"m")+1+"",d=date.get(v,"d")+"",h=date.get(v,"h")+"",n=date.get(v,"n")+"";return date.get(v,"y")+"-"+(1==m.length?"0":"")+m+"-"+(1==d.length?"0":"")+d+("datetime"==p.properties.type?" "+(1==h.length?"0":"")+h+":"+(1==n.length?"0":"")+n:"")},$fromEditor:function(p,v){return v&&((v=p.properties.dateEditorTpl?date.parse(v,p.properties.dateEditorTpl):xui.Date.parse(v))||(v=p.properties.$UIvalue,xui.isFinite(v)&&(v=new Date(parseInt(v,10)))),v&&("datetime"!=p.properties.type&&(v=date.getTimSpanStart(v,"d",1)),v.getFullYear()<p.properties.min&&v.setTime(p.properties.min),v.getFullYear()>p.properties.max&&v.setTime(p.properties.max))),v?String(v.getTime()):""}},"all")}else"currency"==type?(profile.$isNumber=1,keymap={a:1,c:1,v:1,x:1},xui.merge(profile,{$beforeKeypress:function(p,c,k){return 1!=k.key.length||/[-0-9,. ]/.test(k.key)||k.ctrlKey&&!!keymap[k.key]},$compareValue:function(p,a,b){return!(""===a&&""!==b||""===b&&""!==a)&&p.box._number(p,a)==p.box._number(p,b)},$getShowValue:function(p,v){var pp=p.properties;return xui.isSet(v)&&""!==v?(v=xui.formatNumeric(p.box._number(p,v),pp.precision,pp.groupingSeparator,pp.decimalSeparator,pp.forceFillZero,pp.trimTailZero),p.properties.currencyTpl&&(v=p.properties.currencyTpl.replace("*",v))):v="",v},$toEditor:function(p,v){var pp=p.properties;return xui.isSet(v)&&""!==v?xui.formatNumeric(p.box._number(p,v),pp.precision,pp.groupingSeparator,pp.decimalSeparator,pp.forceFillZero,pp.trimTailZero):""},$fromEditor:function(p,v){return xui.isSet(v)&&""!==v?p.box._number(p,v):""}},"all")):"number"!=type&&"spin"!=type&&"counter"!=type||(profile.$isNumber=1,keymap={a:1,c:1,v:1,x:1},xui.merge(profile,{$beforeKeypress:function(p,c,k){return 1!=k.key.length||/[-0-9. ]/.test(k.key)||k.ctrlKey&&!!keymap[k.key]},$compareValue:function(p,a,b){return!(""===a&&""!==b||""===b&&""!==a)&&p.box._number(p,a)==p.box._number(p,b)},$getShowValue:function(p,v){var pp=p.properties;return""!=(v=xui.isSet(v)&&""!==v?xui.formatNumeric(p.box._number(p,v),pp.precision,pp.groupingSeparator,pp.decimalSeparator,pp.forceFillZero,pp.trimTailZero):"")&&p.properties.numberTpl&&(v=p.properties.numberTpl.replace("*",v)),v},$toEditor:function(p,v){var pp=p.properties;return xui.isSet(v)&&""!==v?xui.formatNumeric(p.box._number(p,v),pp.precision,pp.groupingSeparator,pp.decimalSeparator,pp.forceFillZero,pp.trimTailZero):""},$fromEditor:function(p,v){return xui.isSet(v)&&""!==v?p.box._number(p,v):""}},"all"));pro.value&&(pro.$UIvalue=pro.value=c._ensureValue(profile,pro.value)),profile.$typeOK=!0},$drop:{},Appearances:{POOL:{position:"absolute",left:0,top:0,width:0,height:0,display:"none",visibility:"hidden"},FILE:{visibility:"hidden","z-index":30,border:0,width:"100%",height:"100%",position:"absolute",padding:0,top:0,right:0,cursor:"pointer",overflow:"hidden"},"KEY-type-number INPUT, KEY-type-spin INPUT, KEY-type-counter INPUT, KEY-type-currency INPUT":{$order:4,"text-align":"right"},"KEY-type-counter INPUT":{$order:4,"text-align":"center"},"KEY-type-file INPUT, KEY-type-button INPUT, KEY-type-dropbutton INPUT, KEY-type-cmdbox INPUT, KEY-type-listbox INPUT":{$order:4,cursor:"pointer","text-align":"left","white-space":"normal",overflow:"hidden"},"KEY-type-button INPUT, KEY-type-dropbutton INPUT":{$order:5,"text-align":"center"},"LBTN,RBTN,SPINBTN,CMD":{display:"block","z-index":20,cursor:"pointer",padding:0,position:"absolute",width:"1.5em",overflow:"visible"},"ICONB, UNIT":{"z-index":20,cursor:"pointer",position:"absolute",margin:0,border:0,background:"none",height:"100%",padding:"0 2px",display:xui.$inlineBlock,zoom:xui.browser.ie67?1:null,width:xui.browser.ie&&xui.browser.ver<=7?"auto":null,overflow:xui.browser.ie&&xui.browser.ver<=7?"visible":null},ICONB:{left:0,top:0},ICON:{width:"1em"},UNIT:{top:0,right:0},CMD:{$order:2,"z-index":22,padding:0},"R1,R2":{$order:1,display:"block",cursor:"pointer",padding:0,position:"absolute",height:"50%",width:"1.5em",overflow:"visible"},R1:{top:0},R2:{bottom:0},"R1B,R2B":{cursor:"pointer",position:"absolute",left:0,top:"50%",height:"6px","margin-top":"-2px",padding:0,"z-index":2},"SMID,LMID,RMID":{$order:2,cursor:"pointer",padding:0,left:0}},_objectProp:{popCtrlProp:1,popCtrlEvents:1},Behaviors:{HoverEffected:{BOX:"BOX",ICON:"ICON",ICONB:"ICONB"},ClickEffected:{BOX:"BOX"},ICONB:{onClick:function(profile,e,src){var prop=profile.properties;prop.disabled||prop.readonly||profile.onClickIcon&&profile.boxing().onClickIcon(profile,src)}},UNIT:{onClick:function(profile,e,src){var prop=profile.properties;if(!prop.disabled&&!prop.readonly&&prop.units){var o=xui.create("List",{dirtyMark:!1,items:prop.units.split(/[,;\:]/),width:"auto",height:"auto",value:prop.unit});o.afterClick((function(){return o.destroy(!0),!1})),o.beforeUIValueSet((function(p,o,v){profile.boxing().setUnit(xui.str.trim(v))})),o.render();var node=o.reBoxing(),pid=prop.parentID||xui.ini.$rootContainer;node.popToTop(src,null,pid?xui.get(profile,["host",pid])?profile.host[pid].getContainer():xui(pid):null),xui.tryF(o.activate,[],o);var sid=profile.key+":unit:"+profile.$xid;node.setBlurTrigger(sid,(function(){o.destroy(),xui.Event.keyboardHook("esc",0,0,0,sid)})),xui.Event.keyboardHook("esc",0,0,0,(function(){return o.destroy(),xui.Event.keyboardHook("esc",0,0,0,sid),!1}),sid,null,null,profile.domId)}}},FILE:{onClick:function(profile,e,src){var prop=profile.properties;prop.disabled||prop.readonly||profile.onFileDlgOpen&&profile.boxing().onFileDlgOpen(profile,src)},onChange:function(profile,e,src){var prop=profile.properties,input=xui.use(src).get(0),value=input.value+"";if("file"==prop.type){for(var arr=[],i=0,f=input.files,l=f.length;i<l;i++)arr.push(f[i].name);value=arr.length?'"'+arr.join('", "')+'"':""}profile.boxing().setUIValue(value,null,null,"onchange",input)}},LBTN:{onMousedown:function(profile){var prop=profile.properties;prop.disabled||prop.readonly||profile.box._spin(profile,!1)},onMouseout:function(profile){xui.Thread.abort(profile.$xid+":spin")},onMouseup:function(profile){xui.Thread.abort(profile.$xid+":spin")}},RBTN:{onMousedown:function(profile){var prop=profile.properties;"counter"==prop.type&&(prop.disabled||prop.readonly||profile.box._spin(profile,!0))},onMouseout:function(profile){"counter"==profile.properties.type&&xui.Thread.abort(profile.$xid+":spin")},onMouseup:function(profile){"counter"==profile.properties.type&&xui.Thread.abort(profile.$xid+":spin")},onClick:function(profile,e,src){var prop=profile.properties,type=prop.type;if("counter"!=type&&("popbox"!=type&&"cmdbox"!=type&&"getter"!=type&&"dropbutton"!=type||!profile.onClick||!1!==profile.boxing().onClick(profile,e,src,"right",prop.$UIvalue)))if("file"!=type){if(!prop.disabled&&!prop.readonly)return profile.boxing()._drop(e,src),!1}else profile.boxing().popFileSelector()}},CMD:{onClick:function(profile,e,src){var prop=profile.properties;prop.disabled||prop.readonly||profile.onCommand&&!1===profile.boxing().onCommand(profile,src,prop.commandBtn)||"delete"!=prop.commandBtn&&"remove"!=prop.commandBtn||profile.boxing().setUIValue("",!0,null,"cmd")}},BOX:{onClick:function(profile,e,src){var prop=profile.properties;if("cmdbox"==prop.type||"button"==prop.type||"dropbutton"==prop.type){if(profile.onClick)return profile.boxing().onClick(profile,e,src,"left",prop.$UIvalue)}else if(prop.inputReadonly||profile.$inputReadonly){if(prop.disabled||prop.readonly)return;profile.boxing()._drop(e,src)}}},INPUT:{onClick:function(p,e,src){return(!p.$cell||0!==(e=xui.Event.getPos(e)).left||0!==e.top)&&(p.onInputClick?p.boxing().onInputClick(p,e,src):void 0)},onChange:function(profile,e,src){if(!(profile.$_onedit||profile.$_inner||profile.destroyed)&&profile.box){var o=profile._inValid,p=profile.properties,b=profile.box,instance=profile.boxing(),v=instance._fromEditor(xui.use(src).get(0).value),uiv=p.$UIvalue;instance._compareValue(uiv,v)||(null===v?instance._setCtrlValue(uiv):(instance.setUIValue(v,null,null,"onchange"),p.$UIvalue!==v&&instance._setCtrlValue(p.$UIvalue),o!==profile._inValid&&profile.renderId&&instance._setDirtyMark())),b._asyCheck(profile)}},onKeyup:function(profile,e,src){var p=profile.properties,b=profile.box,key=xui.Event.getKey(e);if(p.disabled||p.readonly)return!1;if(!profile.$inputReadonly&&!p.inputReadonly){if("esc"==key.key){if(profile.$escclosedrop)return;profile.boxing()._setCtrlValue(p.$UIvalue),profile.onCancel&&profile.boxing().onCancel(profile)}if(p.dynCheck){var value=xui.use(src).get(0).value;profile.box._checkValid(profile,value),profile.boxing()._setDirtyMark()}return b._asyCheck(profile),"down"!=key.key&&"up"!=key.key||"spin"!=p.type&&"counter"!=p.type?void 0:(xui.Thread.abort(profile.$xid+":spin"),!1)}},onMousedown:function(profile,e,src){profile._mousedownmark=1,xui.asyRun((function(){profile&&delete profile._mousedownmark}))},onMouseup:function(profile,e,src){if(profile.properties.selectOnFocus&&profile._stopmouseupcaret){var node=xui.use(src).get(0);!node.readOnly&&node.select&&(profile.$mouseupDelayFun=xui.asyRun((function(){delete profile.$mouseupDelayFun,"input"!=node.tagName.toLowerCase()&&/[\n\r]/.test(node.value)||node.select()}))),delete profile._stopmouseupcaret}},onFocus:function(profile,e,src){if(profile.$ignoreFocus)return!1;if(profile.beforeFocus&&!1===profile.boxing().beforeFocus(profile))return profile.$ignoreBlur=1,xui(src).blur(),delete profile.$ignoreBlur,!1;var p=profile.properties,b=profile.box;if(p.disabled||p.readonly)return!1;if(profile.onFocus&&profile.boxing().onFocus(profile),!profile.$inputReadonly&&!p.inputReadonly){profile.getSubNode("BORDER").tagClass("-focus");var instance=profile.boxing(),uiv=p.$UIvalue,v=instance._toEditor(uiv),node=xui.use(src).get(0),nodev=node.value;if(uiv!==v&&nodev!==v&&(profile.$_onedit=!0,node.value=v,delete profile.$_onedit),p.mask){var value=node.value;value||(profile.$focusDelayFun=xui.asyRun((function(){profile.box&&(delete profile.$focusDelayFun,profile.$_onedit=!0,profile.boxing()._setCtrlValue(value=profile.$Mask),delete profile.$_onedit,b._setCaret(profile,node))})))}p.selectOnFocus&&!node.readOnly&&node.select&&(xui.browser.kde?profile.$focusDelayFun2=xui.asyRun((function(){delete profile.$focusDelayFun2,"input"!=node.tagName.toLowerCase()&&/[\n\r]/.test(node.value)||node.select()})):"input"!=node.tagName.toLowerCase()&&/[\n\r]/.test(node.value)||node.select(),profile._mousedownmark&&(profile._stopmouseupcaret=1)),profile.boxing()._setTB(3),b._asyCheck(profile)}},onBlur:function(profile,e,src){if(profile.$ignoreBlur)return!1;xui.resetRun(profile.$xid+":asycheck"),profile.$focusDelayFun&&xui.clearTimeout(profile.$focusDelayFun),profile.$focusDelayFun2&&xui.clearTimeout(profile.$focusDelayFun2),profile.$focusDelayFun2&&xui.clearTimeout(profile.$mouseupDelayFun);var p=profile.properties;if(p.disabled||p.readonly)return!1;if(profile.onBlur&&profile.boxing().onBlur(profile),!profile.$inputReadonly&&!p.inputReadonly){var b=profile.box,instance=profile.boxing(),uiv=p.$UIvalue,v=xui.use(src).get(0).value;profile.$Mask&&profile.$Mask==v&&(v="",uiv=profile.$Mask),v=instance._fromEditor(v),profile.getSubNode("BORDER").tagClass("-focus",!1),instance._compareValue(p.$UIvalue,v)&&(profile.box._checkValid(profile,v),instance._setCtrlValue(uiv)),instance._setDirtyMark(),b._asyCheck(profile,!1)}},onKeydown:function(profile,e,src){var p=profile.properties;if(!p.disabled&&!p.readonly){var b=profile.box,m=p.multiLines,k=xui.Event.getKey(e);if(parseInt(p.autoexpand)&&b._checkAutoexpand(profile),"enter"!=k.key||m&&!k.altKey||p.inputReadonly||profile.$inputReadonly||(profile.$_onedit=!0,profile.boxing().setUIValue(profile.boxing()._fromEditor(xui.use(src).get(0).value),!0,null,"enter"),profile.$_onedit=!1),b._asyCheck(profile),p.mask)switch(k.key.length>1?profile.$ignore=!0:delete profile.$ignore,k.key){case"backspace":return b._changeMask(profile,xui.use(src).get(0),"",!1),!1;case"delete":return b._changeMask(profile,xui.use(src).get(0),""),!1}if("down"==k.key||"up"==k.key)if("spin"==p.type||"counter"==p.type){if(!k.ctrlKey)return profile.box._spin(profile,"up"==k.key),!1}else if(k.ctrlKey&&"none"!=p.type&&"input"!=p.type&&"password"!=p.type)return profile.boxing()._drop(e,src),!1}},onDblclick:function(profile,e,src){profile.getSubNode("RBTN").onClick(!0)}},R1:{onMousedown:function(profile){var prop=profile.properties;prop.disabled||prop.readonly||profile.box._spin(profile,!0)},onMouseout:function(profile){xui.Thread.abort(profile.$xid+":spin")},onMouseup:function(profile){xui.Thread.abort(profile.$xid+":spin")}},R2:{onMousedown:function(profile){var prop=profile.properties;prop.disabled||prop.readonly||profile.box._spin(profile,!1)},onMouseout:function(profile){xui.Thread.abort(profile.$xid+":spin")},onMouseup:function(profile){xui.Thread.abort(profile.$xid+":spin")}}},EventHandlers:{onFileDlgOpen:function(profile,src){},onCommand:function(profile,src,type){},beforeComboPop:function(profile,pos,e,src){},beforePopShow:function(profile,popCtl,items){},afterPopShow:function(profile,popCtl){},afterPopHide:function(profile,popCtl,type){},onClick:function(profile,e,src,btn,value){},onInputClick:function(profile,e,src){},onClickIcon:function(profile,src){},beforeUnitUpdated:function(profile,unit){},afterUnitUpdated:function(profile,unit){}},DataModel:{cachePopWnd:!0,dateEditorTpl:"",groupingSeparator:",",decimalSeparator:".",forceFillZero:!0,trimTailZero:!1,parentID:"",popCtrlProp:{ini:{}},popCtrlEvents:{ini:{}},image:{format:"image",action:function(){xui.UI.$iconAction(this),this.boxing().reLayout(!0)}},imagePos:{action:function(value){this.getSubNode("ICON").css("backgroundPosition",value||"center")}},imageBgSize:{action:function(value){this.getSubNode("ICON").css("backgroundSize",value||"")}},imageClass:{ini:"",action:function(v,ov){xui.UI.$iconAction(this,"ICON",ov),this.boxing().reLayout(!0)}},iconFontCode:{action:function(v){xui.UI.$iconAction(this),this.boxing().reLayout(!0)}},dropImageClass:{action:function(){this.boxing().refresh()}},unit:{ini:"",set:function(v){var ns=this;ns.beforeUnitUpdated&&!1===ns.boxing().beforeUnitUpdated(ns,v)||(ns.properties.unit=v,ns.renderId&&(ns.getSubNode("UNIT").html(v),ns.boxing().reLayout(!0)),ns.afterUnitUpdated&&ns.boxing().afterUnitUpdated(ns,v))}},units:"",numberTpl:{ini:"",action:function(){this.boxing().setUIValue(this.properties.$UIvalue,!0,null,"tpl")}},currencyTpl:{ini:"$ *",action:function(){this.boxing().setUIValue(this.properties.$UIvalue,!0,null,"tpl")}},listKey:{set:function(value){var t=xui.UI.getCachedData(value),o=this;o.boxing().setItems(t?xui.clone(t):o.properties.items),o.properties.listKey=value}},dropListWidth:0,dropListHeight:0,items:{ini:[],set:function(value){var o=this;value=o.properties.items=o.box._adjustItems(value),o.renderId&&(o.SubSerialIdMapItem={},o.ItemIdMapSubSerialId={},o.box._prepareItems(o,value),o.$poplink&&o.$poplink.box?o.$poplink.boxing().setItems(value):o.boxing().clearPopCache())}},type:{ini:"combobox",listbox:xui.toArr("none,input,password,combobox,listbox,file,getter,helpinput,button,dropbutton,cmdbox,popbox,date,time,datetime,color,spin,counter,currency,number"),set:function(value){this.properties.type=value,this.renderId&&this.boxing().refresh(!0)}},showMode:{ini:"normal",listbox:["","normal","compact","transparent"],action:function(){this.boxing().refresh()}},precision:2,increment:.01,min:-Math.pow(10,15),max:Math.pow(10,15),commandBtn:{ini:"none",combobox:xui.toArr("none,save,delete,add,remove,pop,select,search"),action:function(){this.boxing().refresh()}},disabled:{ini:!1,action:function(v){this.box._handleInput(this,"xui-ui-disabled",v)}},inputReadonly:{ini:!1,action:function(v){this.box._handleInput(this,"xui-ui-inputreadonly",v)}},readonly:{ini:!1,action:function(v){this.box._handleInput(this,"xui-ui-readonly",v)}},caption:{ini:null,set:function(v){var p=this.properties;p.caption=v,xui.isSet(v)&&(v+="",p.caption=xui.adjustRes(v,!1)),this.renderId&&(this.$inputReadonly||p.inputReadonly)&&this.getSubNode("INPUT").attr("value",this.boxing().getShowValue())},get:function(){return this.boxing().getShowValue()}},fileAccept:"",fileMultiple:!1},RenderTrigger:function(){var instance=this.boxing(),p=this.properties;this.box._iniType(this),p.readonly?instance.setReadonly(!0,!0):p.inputReadonly&&instance.setInputReadonly(!0,!0)},_spin:function(profile,flag){if(!profile.$inDesign){var id=profile.$xid+":spin";if(!xui.Thread.isAlive(id)){var prop=profile.properties,off=Math.max(prop.increment,Math.pow(10,-prop.precision))*(flag?1:-1),task={delay:300},fun=function(){if(profile.destroyed)return!1;var v=(+prop.$UIvalue||0)+off;v=xui.isSet(v)&&""!==v?xui.formatNumeric(profile.box._number(profile,v),prop.precision,prop.groupingSeparator,prop.decimalSeparator,prop.forceFillZero,prop.trimTailZero):"",profile.boxing().setUIValue(v,null,null,"spin"),task.delay*=.9};task.task=fun,xui.Thread(id,[task],500,null,fun,null,!0).start()}}},_dynamicTemplate:function(profile){var properties=profile.properties,type=properties.type,multiLines=properties.multiLines,fileAccept=properties.fileAccept,fileMultiple=properties.fileMultiple,showMode=properties.showMode,hash=profile._exhash="$multiLines:"+multiLines+";type:"+type+";mode:"+showMode+";",template=profile.box.getTemplate(hash),adj=function(s){return showMode&&"normal"!=showMode?"xui-ui-clear-bg "+s.replace(/\b(xui-ui-btn|xui-uibar|xui-uigradient|xui-uibase)\b/g,""):s};if(properties.$UIvalue=properties.value,!template){var t=(template=xui.clone(profile.box.getTemplate())).FRAME.BORDER,ip=t.BOX.WRAP.INPUT;switch(delete t.LBTN,delete t.RBTN,delete t.SPINBTN,ip.tagName="input",ip.type="text",type){case"none":case"input":case"number":case"currency":break;case"button":ip.type="button";break;case"password":ip.type="password";break;case"spin":t.SPINBTN={$order:20,className:"xui-ui-unselectable",style:"{rDisplay}",R1:{tagName:"button",className:adj("xui-ui-btn xui-uibar xui-uigradient xui-nofocus {_radius_dropt}"),R1B:{className:"xuifont",$fonticon:"xui-icon-smallup"}},R2:{tagName:"button",className:adj("xui-ui-btn xui-uibar xui-uigradient xui-nofocus {_radius_dropb}"),R2B:{className:"xuifont",$fonticon:"xui-icon-smalldown"}}};break;case"counter":t.LBTN={$order:1,tagName:"button",className:adj("xui-ui-unselectable xui-ui-btn xui-uibar xui-uigradient xui-nofocus {_radius_dropl}"),style:"{_btnlDisplay}",LMID:{className:"xuifont",$fonticon:"{_fi_btnlClass}",style:"{_btnlStyle}"}};break;case"file":t.FILE={$order:20,className:"xui-ui-unselectable  {_radius_dropr}",tagName:"input",autocorrect:"off",autocomplete:"off",type:"file",accept:fileAccept||null,multiple:fileMultiple?"multiple":null,hidefocus:xui.browser.ie?"hidefocus":null,size:"1"};case"listbox":case"cmdbox":case"dropbutton":t.className+=" xui-ui-noshadow",ip.type="button"}if("none"!=type&&"input"!=type&&"password"!=type&&"button"!=type&&"spin"!=type&&"currency"!=type&&"number"!=type&&(t.RBTN={$order:20,tagName:"button",className:adj("xui-ui-unselectable xui-ui-btn xui-uibar xui-uigradient xui-nofocus {_radius_dropr}"),style:"{_btnrDisplay}",RMID:{className:"xuifont",$fonticon:"{_fi_btnrClass}"}}),"button"!=type&&"dropbutton"!=type||(t.BOX.className+=" xui-uigradient"),multiLines)switch(type){case"none":case"input":case"getter":case"helpinput":case"popbox":case"number":case"combobox":ip.tagName="textarea",ip.className="",delete ip.type}showMode&&"normal"!=showMode&&("transparent"==showMode&&(t.BOX.className="{_radius_input} "),t.CMD.className=adj(t.CMD.className)),profile.box.setTemplate(template,hash)}profile.template=template},_handleInput:function(prf,cls,v){var i=prf.getSubNode("INPUT"),btn="button"==(""+i.get(0).type).toLowerCase();!v&&(prf.properties.disabled||prf.properties.readonly||!btn&&prf.$inputReadonly)&&(v=!0),prf.getRoot()[v?"addClass":"removeClass"](cls),btn||i.attr("readonly",v)},_prepareData:function(profile){var a,b,data={},NONE="display:none",prop=profile.properties,type=prop.type,showMode=prop.showMode,arr=profile.box.$DataModel.commandBtn.combobox,tt=type,c="counter"==tt;return tt="combobox"==tt||"listbox"==tt||"dropbutton"==tt?"arrowdrop":tt,(data=arguments.callee.upper.call(this,profile,data))._fi_btnlClass="xui-icon-singleleft",data._fi_btnrClass="counter"==tt?"xui-icon-singleright":data.dropImageClass||"xui-uicmd-"+tt,data._type="text",data._cmdDisplay=(a=!data.commandBtn||"none"==data.commandBtn)?NONE:"",data._fi_commandCls=(-1!=xui.arr.indexOf(arr,data.commandBtn)?"xui-uicmd-":"")+data.commandBtn,data._btnrDisplay=(b="none"==type||"input"==type||"password"==type||"currency"==type||"number"==type||"button"==type)?NONE:"",data.typecls=profile.getClass("KEY","-type-"+data.type),showMode&&"normal"!=showMode?"compact"==showMode&&(data._radius_input="xui-uiborder-radius"):(data._radius_dropl="xui-uiborder-radius-tl xui-uiborder-radius-bl xui-uiborder-noradius-r",data._radius_input=a&&b?"xui-uiborder-radius":c?"xui-uiborder-noradius":"xui-uiborder-radius-tl xui-uiborder-radius-bl xui-uiborder-noradius-r",data._radius_dropr=a?"xui-uiborder-radius-tr xui-uiborder-radius-br xui-uiborder-noradius-l":"xui-uiborder-noradius",data._radius_dropt=a?"xui-uiborder-radius-tr xui-uiborder-noradius-l xui-uiborder-noradius-b":"xui-uiborder-noradius",data._radius_dropb=a?"xui-uiborder-radius-br xui-uiborder-noradius-l xui-uiborder-noradius-t":"xui-uiborder-noradius"),data},_ensureValue:function(profile,value){if(profile.properties,!xui.isSet(value)||""===value)return"";switch(profile.$Mask&&profile.$Mask==value&&(value=""),profile.properties.type){case"date":case"datetime":var d;return value&&(d=xui.isDate(value)?value:xui.isFinite(value)?new Date(parseInt(value,10)):xui.Date.parse(value+"")),d?String("datetime"==profile.properties.type?d.getTime():xui.Date.getTimSpanStart(d,"d",1).getTime()):"";case"color":var c=xui.UI.ColorPicker._ensureValue(null,value);return("transparent"==c?"":"#")+c;case"time":return xui.UI.TimePicker._ensureValue(null,value);case"currency":case"number":case"spin":case"counter":return this._number(profile,value);default:return"string"==typeof value?value:value||0===value?String(value):""}},_number:function(profile,value){var prop=profile.properties;return/^\s*\=/.test(value||"")&&(value=xui.ExcelFormula.calculate(value||"")||""),value=xui.toNumeric(value,prop.precision,prop.groupingSeparator,prop.decimalSeparator,prop.forceFillZero,prop.trimTailZero),xui.isSet(prop.max)&&(value=value>prop.max?prop.max:value),xui.isSet(prop.min)&&(value=value<prop.min?prop.min:value),value},_onresize:function(profile,width,height){if(!profile._$ignoreonsize){var $hborder,$vborder,paddingW,autoH,icbw,utw,btnw,prop=profile.properties,type=prop.type,cmp="compact"==prop.showMode,f=function(k){return k?k=profile.getSubNode(k):null},root=f("KEY"),v1=f("INPUT"),icb=f("ICONB"),ut=f("UNIT"),box=f("BOX"),label=f("LABEL"),cmdbtn=f("none"!=prop.commandBtn?"CMD":null),lbtn=f("counter"==type?"LBTN":null),rbtn=f("spin"==type?"SPINBTN":"none"==type||"input"==type||"password"==type||"currency"==type||"number"==type||"button"==type?null:"RBTN"),us=xui.$us(profile),adjustunit=function(v,emRate){return profile.$forceu(v,us>0?"em":"px",emRate)},fzrate=profile.getEmSize()/root._getEmSize(),v1fz=v1._getEmSize(fzrate),labelfz=label._getEmSize(fzrate),isB="button"==v1.get(0).type.toLowerCase(),cb=xui.browser.contentBox,paddingH=cb?isB?0:2*Math.round(v1._paddingH()/2):0,paddingH2=cb?2*Math.round(v1._paddingH()/2):0,pl=0,pr=0,boxB=box._borderW(),offset=boxB/2;$hborder=$vborder=cb?offset:0,btnw=parseInt(1.5*profile.getEmSize(),10),height&&(height=(autoH="auto"==height)?profile.$em2px(cb?1:1.6666667,null,!0)+paddingH2+boxB:profile.$isEm(height)?profile.$em2px(height,null,!0):height),width&&(width=profile.$isEm(width)?profile.$em2px(width,null,!0):width),autoH&&(profile._$ignoreonsize=1,root.height(adjustunit(height)),delete profile._$ignoreonsize);var labelPos=prop.labelPos||"left",labelSize="none"!=labelPos&&labelPos&&profile.$px(prop.labelSize,labelfz,!0)||0,labelGap="none"!=labelPos&&labelPos&&profile.$px(prop.labelGap,null,!0)||0,ww=width,hh=height,bwcmd=0,lbw=0,rbw=0,left=Math.max(0,(prop.$b_lw||0)-$hborder),top=Math.max(0,(prop.$b_tw||0)-$vborder);null!==ww&&(ww-=Math.max(2*$hborder,(prop.$b_lw||0)+(prop.$b_rw||0)),lbw=lbtn?btnw:0,rbw=rbtn?btnw:0,bwcmd=cmdbtn?btnw:0,xui.browser.ie6&&(ww=2*Math.round(ww/2))),null!==hh&&(hh-=Math.max(2*$vborder,(prop.$b_lw||0)+(prop.$b_rw||0)),xui.browser.ie6&&(hh=2*Math.round(hh/2)),xui.browser.ie6&&null===width&&box.ieRemedy());var iL=null===ww?null:left+("left"==labelPos?labelSize:0),iT=null===hh?null:top+("top"==labelPos?labelSize:0),iW=null===ww?null:Math.max(0,ww-("left"==labelPos||"right"==labelPos?labelSize:0)),iH=null===hh?null:Math.max(0,hh-("top"==labelPos||"bottom"==labelPos?labelSize:0)),iH2=null===hh?null:Math.max(0,height-("top"==labelPos||"bottom"==labelPos?labelSize:0)),iR="right"==labelPos?labelSize:0;labelSize?(label.css("display",""),label.cssRegion({left:adjustunit(null===ww?null:"right"==labelPos?ww-labelSize+labelGap+2*$hborder:0,labelfz),top:adjustunit(null===height?null:"bottom"==labelPos?height-labelSize+labelGap:0,labelfz),width:adjustunit(null===ww?null:Math.max(0,"left"==labelPos||"right"==labelPos?labelSize-labelGap:ww),labelfz),height:adjustunit(null===height?null:Math.max(0,("top"==labelPos||"bottom"==labelPos?labelSize-labelGap:height)-paddingH),labelfz)})):label.css("display","none"),null!==iW&&(cmp?(pl+=lbw,pr+=bwcmd+rbw):iW-=bwcmd+rbw+lbw),lbtn&&(null!==iH2&&lbtn.height(adjustunit(Math.max(0,iH2))),null!==iW&&lbtn.left(adjustunit(iL)),lbtn.top(adjustunit(iT)),cmp||(iL+=lbw),null!==iW&&(iL-=offset,iW+=offset)),(prop.image||prop.imageClass)&&(icb.setInlineBlock(),(icbw=icb.offsetWidth(!0))&&(pl+=icbw)),icbw?cmp&&lbw&&icb.left(adjustunit(lbw,icb)):icb.css("display","none"),bwcmd&&(cmdbtn.top(adjustunit(iT)),null!==iH2&&cmdbtn.height(adjustunit(Math.max(0,iH2))),null!==iW&&(cmdbtn.css("right",adjustunit(iR)),iR+=bwcmd-$hborder,iW+=offset)),rbw&&(rbtn.top(adjustunit(iT)),null!==iH2&&rbtn.height(adjustunit(Math.max(0,iH2))),null!==iW&&(rbtn.css("right",adjustunit(iR)),iW+=offset),null!==iH2&&"spin"==prop.type&&iH2/2-2*$vborder>0&&(f("R1").height(adjustunit(iH2/2)),f("R2").height(adjustunit(iH2/2+(Math.round(iH2)-2*Math.round(iH2/2)))))),prop.unit&&(ut.setInlineBlock(),(utw=ut.offsetWidth(!0))&&(pr+=utw)),utw?cmp&&(rbw||bwcmd)&&ut.css("right",adjustunit(rbw+bwcmd,ut)):ut.css("display","none"),box.cssRegion({left:iW?adjustunit(iL):null,top:iH?adjustunit(iT):null,width:iW?adjustunit(iW):null,height:iH?adjustunit(iH):null}),pl&&v1.css("paddingLeft",adjustunit(pl,icb)),pr&&v1.css("paddingRight",adjustunit(pr,ut)),paddingW=cb?isB?0:v1._paddingW():0,null!==iW&&iW-paddingW>0&&v1.width(adjustunit(Math.max(0,iW-paddingW),v1fz)),null!==iH&&iH-paddingH>0&&v1.height(adjustunit(Math.max(0,iH-paddingH),v1fz)),profile.$resizer&&xui.browser.ie&&box.ieRemedy()}}}}),xui.Class("xui.UI.ColorPicker",["xui.UI","xui.absValue"],{Instance:{activate:function(){return this.getSubNode("TOGGLE").focus(!0),this},_setCtrlValue:function(value,inner){return this.each((function(profile){if(profile.renderId){var cls=profile.box,p=profile.properties;value&&"transparent"==value.toLowerCase()&&(value="transparent");var hex=profile.$hex=cls._to3(value),hexs=profile.$hex.join(""),rgb=profile.$rgb=cls.hex2rgb(value),hsv=profile.$hsv=cls.rgb2hsv(rgb),f=function(s,v){profile.getSubNode(s).get(0).firstChild.nodeValue=String(v)},ff=function(v){return parseInt(100*v,10)};"transparent"==value&&(hex=profile.$hex=["00","00","00"],rgb=profile.$rgb=[0,0,0],hsv=profile.$hsv=[0,0,0]),f("R",rgb[0]),f("G",rgb[1]),f("B",rgb[2]),f("H",hex[0]),f("E",hex[1]),f("X",hex[2]),profile.$hexinhsv!=hexs&&(f("HH",hsv[0]),f("S",ff(hsv[1])),f("V",ff(hsv[2])),delete profile.$hexinhsv),cls._setClrName(profile,"transparent"==value?value:hexs),cls._updateDftTip(profile),p.advance&&profile.$hexinadv!=hexs&&(cls._updateMarks(profile,value,!0,hsv[0]),delete profile.$hexinadv),0!=inner&&profile.getSubNode("CAPTION").html(("transparent"==value?"":"#")+value,!1)}}))},getColorName:function(){return this.get(0).$clrN||""}},Initialize:function(){var i,data,id=xui.UI.$ID,cls=xui.UI.$CLS,tag=xui.UI.$tag_special,key=this.KEY,list=this._slist,l=list.length,arr=[],evs=xui.$IEUNSELECTABLE(),evs2='style="visibility:hidden;"',ddcls="xui-node xui-node-span xui-ui-draggable xui-uibase xui-uiborder-flat";for(this.addTemplateKeys(["DD1","DD2","DD3","R","G","B","TXT","HH","S","V","H","E","X"]),i=0;i<l;i++)arr.push('<span  id="'+key+"-SC:"+id+":"+list[i]+'" style="background-color:#'+list[i]+'" '+evs+' class="xui-node xui-span xuicon xui-uiborder-flat xui-icon-placeholder">'+(xui.__iefix2&&xui.__iefix2["xui-icon-placeholder"]||"")+"</span>"),(i+1)%17==0&&arr.push("<br />");data="<div "+evs+'><span class="'+cls+'-txt"'+evs+'>R: </span><span id="'+key+"-R:"+id+':" class="'+cls+"-dd2 "+ddcls+" "+tag+"DD2_CC"+tag+'" '+evs+">R</span><span "+evs2+'>%</span><span class="'+cls+'-txt"'+evs+'>G: </span><span id="'+key+"-G:"+id+':" class="'+cls+"-dd2 "+ddcls+"  "+tag+"DD2_CC"+tag+'" '+evs+">G</span><span "+evs2+'>°</span><span class="'+cls+'-txt"'+evs+'>B: </span><span id="'+key+"-B:"+id+':" class="'+cls+"-dd2 "+ddcls+"  "+tag+"DD2_CC"+tag+'" '+evs+">B</span></div><div "+evs+'><span class="'+cls+'-txt"'+evs+'>S: </span><span id="'+key+"-S:"+id+':" class="'+cls+"-dd2 "+ddcls+"  "+tag+"DD2_CC"+tag+'"  '+evs+">S</span><span "+evs+'>%</span><span class="'+cls+'-txt"'+evs+'>H: </span><span id="'+key+"-HH:"+id+':" class="'+cls+"-dd2 "+ddcls+"  "+tag+"DD2_CC"+tag+'" '+evs+">H</span><span "+evs+'>°</span><span class="'+cls+'-txt"'+evs+'>V: </span><span id="'+key+"-V:"+id+':" class="'+cls+"-dd2 "+ddcls+"  "+tag+"DD2_CC"+tag+'" '+evs+">V</span><span "+evs+">%</span></div><div "+evs+'><span class="'+cls+'-txt"'+evs+'>HEX: </span><span id="'+key+"-H:"+id+':" class="'+cls+"-dd3 "+ddcls+"  "+tag+"DD3_CC"+tag+'" '+evs+'>H</span><span id="'+key+"-E:"+id+':" class="'+cls+"-dd3 "+ddcls+"  "+tag+"DD3_CC"+tag+'" '+evs+evs+'>E</span><span id="'+key+"-X:"+id+':" class="'+cls+"-dd3 "+ddcls+"  "+tag+"DD1_CC"+tag+'" '+evs+">X</span></div>",this.setTemplate({style:"{_style};height:auto;width:auto",tagName:"div",BORDER:{tagName:"div",className:"xui-uiborder-outset xui-uiborder-box xui-uiborder-radius-big",BAR:{tagName:"div",className:"{classBar}",BARTDL:{className:"xui-uibar-tdl xui-uibar xui-uiborder-radius-big-tl",BARTDLT:{className:"xui-uibar-tdlt"}},BARTDM:{$order:1,className:"xui-uibar-tdm xui-uibar",BARTDMT:{className:"xui-uibar-tdmt"}},BARTDR:{$order:2,className:"xui-uibar-tdr xui-uibar xui-uiborder-radius-big-tr",BARTDRT:{className:"xui-uibar-tdrt"}},BARCMDL:{$order:3,tagName:"div",className:"xui-uibar-cmdl",SPACE:{className:"xuifont",$fonticon:"xui-icon-placeholder"}},BARCMDR:{$order:4,tagName:"div",className:"xui-uibar-cmdr",CLOSE:{className:"xuifont",$fonticon:"xui-uicmd-close",style:"{closeDisplay}"}},TBARTDB:{$order:5,tagName:"div",className:"xui-uibar-tdb xui-uiborder-inset xui-uiborder-radius"}},MAIN:{$order:2,tagName:"div",className:"xui-uicon-main xui-uibar",MAINI:{tagName:"div",className:"xui-uicon-maini xui-uibar",CON:{$order:1,tagName:"div",className:"xui-uiborder-inset xui-uiborder-radius",SIMPLE:{tagName:"div",TOP:{$order:1,tagName:"div",DATA:{$order:0,tagName:"div",text:data},EXAM:{$order:3,tagName:"div",className:"xui-uiborder-inset xui-uiborder-radius"}},LIST:{$order:2,tagName:"div",text:arr.join("")}},ADV:{$order:2,style:"{advDispay}",tagName:"div",ADVWHEEL:{$order:0,tagName:"div"},ADVCLR:{$order:1,tagName:"div"},ADVMARK1:{$order:3,tagName:"div"},ADVMARK2:{$order:4,tagName:"div"}}}}},TAIL:{$order:3,tagName:"div",className:"xui-uicon-main xui-uibar",TAILI:{tagName:"div",className:"xui-uibar xui-uicon-maini",TRANS:{className:"xuicon",$fonticon:"xui-icon-transparent",tabindex:"{tabindex}",title:"{_transparent}"},CAPTION:{text:"{caption}"},SET:{tagName:"button",className:"xui-ui-btn xui-uibar xui-uigradient xui-uiborder-radius",tabindex:"{tabindex}",text:"{_set}"},TOGGLE:{$order:2,className:"xuifont",$fonticon:"xui-icon-doubleright",tabindex:"{tabindex}"}}},BBAR:{$order:4,tagName:"div",className:"xui-uibar-bottom-s",BBARTDL:{className:"xui-uibar-tdl xui-uibar xui-uiborder-radius-big-bl"},BBARTDM:{$order:1,className:"xui-uibar-tdm xui-uibar"},BBARTDR:{$order:2,className:"xui-uibar-tdr xui-uibar xui-uiborder-radius-big-br"}}}})},Static:{_radius:84,_square:100,_bigRadius:97,DataModel:{height:{ini:"auto",readonly:!0},width:{ini:"auto",readonly:!0},value:{ini:"FFFFFF",format:"color"},barDisplay:{ini:!0,action:function(v){v?this.getSubNode("BAR").replaceClass("xui-uibar-top-s","xui-uibar-top"):this.getSubNode("BAR").replaceClass("xui-uibar-top","xui-uibar-top-s")}},closeBtn:{ini:!0,action:function(v){this.getSubNode("CLOSE").css("display",v?"":"none")}},advance:{ini:!1,action:function(v){var ns=this,tg=ns.getSubNode("TOGGLE");ns.getSubNode("ADV").css("display",v?"":"none"),ns.getSubNode("CON").css("padding-right",v?"205px":"0px"),xui.__iefix2?tg.html(xui.__iefix2[v?"xui-icon-doubleleft":"xui-icon-doubleright"]):v?tg.removeClass("xui-icon-doubleright").addClass("xui-icon-doubleleft"):tg.removeClass("xui-icon-doubleleft").addClass("xui-icon-doubleright"),v&&ns.box._updateMarks(ns,ns.properties.$UIvalue,!0,ns.$hsv[0])}}},Appearances:{KEY:{},"TBART, BBART":{"border-spacing":0,"border-collapse":"separate"},MAINI:{padding:".5em .3333em .3333em 0"},CON:{padding:".25em",position:"relative"},".xui-uibar-top BARCMDL":{padding:".25em 0 0 0"},".xui-uibar-top BARCMDR":{top:".3334em",right:".5em"},CMDL:{padding:".25em 0 .25em 0"},DATA:{},"DATA span":{padding:"0 1px","margin-left":"-1px","margin-right":"1px",width:"2em"},"DATA div":{padding:".5em 0"},CAPTION:{"vertical-align":xui.browser.ie6?"baseline":"middle","font-size":"1em"},EXAM:{padding:".125em",position:"absolute",width:"5.5em",height:"5.5em",top:".25em",right:".25em","white-space":"normal","text-align":"center"},"DD1, DD2, DD3":{"padding-right":"2px",cursor:"e-resize","text-align":"center"},TOP:{position:"relative"},LIST:{position:"relative",overflow:"hidden",padding:".25em","white-space":"nowrap","line-height":"1em"},TAILI:{position:"relative",padding:".5em 0 0 0","text-align":"center"},SIMPLE:{position:"relative"},ADV:{position:"absolute",right:"4px",bottom:"4px",width:"195px",height:"195px"},"ADV div":{cursor:"crosshair",position:"absolute"},ADVCLR:{background:xui.browser.ie6?null:"url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAGUAAABlCAYAAABUfC3PAAAABGdBTUEAANbY1E9YMgAAABh0RVh0U29mdHdhcmUAUGFpbnQuTkVUIHYzLjIyt5EXfQAATvhJREFUeF7t3AeUl+Wd8P3ZfXaTbHo1xsQSY2JMjLFHjS32rih2EVEUFEQFkSoCAgKiSG/Se++9997bAMPMML333v7v55qd8UyIKVvenOe85zXnuwzGxPX34Xdd9/0H8i8TJkyInH/++VH+iIT88cXX4Yu6P1f77zX4a77064Z/rf+emi/562vq/gbhm9p/v+77f/b1l/w19f+5L/vP/9mfa/jf2+Drs/+a8P9/7Z+r++OLv//Z//n6v+Csv75+Vl/2nz/736ufYfj7NZznf/7D/+efrJ97+PdvjVq7dm3tgFStSpWrTKUqVqHylatsZSpdKUpWguJ1WqcUrWM6rAPap93aoa3apA0Kf+OVWq7FWqh5mqUZmqKJGqcxGqmhGqRP1V991Us91E2d1UHv6h29qTfUQs3VTE30nJ5WYzXSI3pQ9+lu3aHbdLNu0vW6VlfpCl2uy3SpLtHFulDn6zydq3P0Q31f39W39E19XV/TV/Xv+jf9q/4liPTt2/fT/6+hdPEP1xClje+3qqmpaaHmaqYX9byeVmM10iN6UPfpbt2h23SzbtIfdK2u0hW6XJdVV1dfqkt0sS7U+TpPP6mqqjpHP9T39d3KyspvV1RUfLO8vPzrZWVlXystLf1qcXHxV/Ly8v4tMSHxX7dv2/4v/x717/+JsmbNmoj/khqFPypVrjKVqliFyleuspWpdKUoWQmK12mdUrSO6bAOaJ92a4e2apM2aK1WabmWaKHmabZ/iBmaqkkarzEaqWEarIH6WH3VWz30gbqoo9obQlu1USu11Kt6WS8azvN6Rk/qcT1qWA/pft1jaHfqdt2qPxrgDbpO15SUlFxpmL/Tb4uKin6tXxUWFv6ioKDg5/n5+Rca8s9yc3PPy87O/nFmZuaPMtIzfpiWmvb9pMSk78THxX/r1MlT3zhy+MjX9+3d9x9bNm/56vx58/+9z4d9/k/jRo3/Fcq/fvTRR/+J4h+iRtWqVLnKVKpiFSpfucpWptKVomQlKF6ndUrROqYjOqh9BrFHO7VNm7VR67RKK7REizRfszVTUzVJ4/W5RmmYBhviQH2sfuqtnuquruqk9wy3rd5Sa7U03Ff1sprqBQN+Vk/pCT1m2A/rAd1r4HfpT7rV0G829Bt0vcFfY/BX6grDv9zwL8vJyfkVgEsAXJyRkXFhelr6+ampqT9NSko6NyEh4RwQPzodc/oHx48d/+6hg4e+vXvX7m9u2rjpG6tXrv6P+XPnf23E0BFfaf1663+77ebb/g+U/wNlYNTq1asj/kFrVK3wR7nKVKpiFSpfucpWpn/odKUoWQmKV6xidELHdUQHtV97tFPbDGizNmqdVmmFlmqR5muOoc3UNE3WBI3VaMMbriH6TAPU3xD76EN11/vqZJgd1E5vG+qbel2v6RXDfUlN9JwhP63GhtxIjxr0gwZ9v+4x7DsM+/asrKxbsjIzbzL0P6Snp19r6Fcb+u9TUlIuT05K/o2j59Iz8Wd+afi/MPyfnzxx8oIT0SfOP3rk6HkHDxw810acs3PHzh9t3LDx+ytXrPzuwvkLvz1tyrRvjh0z9hsDBwz8+rvvvPu1h+9/+Cu/+dVv/h3Kv/Xp02dg1KpVqyIGUaNqVSr8UaZSFatQ+co1mGxlKkOpSlGizihWMTqh4zqigwa3X3u0U9u0RRu1TqsNcaWWarEWaI5mGeg0TdEEjdVoQx2hoRqkT/Sx4X6kXuqhbobcWR0N+V29ozaG3UotDftVNTPwpnre0J8x9Cf1uKE/5kf6Q+npGfenpaXd68i5y/D/ZPi3Gv4fHT83+pF/PYBr4mLjroo9HXtFzKmYywFcZgsudSRdAuFiCBft2rnrgq1btv7URpy3bu26c2Gcs2Degh/OmDbj++M+H/fdQQMHfbtvn77f6tyh8zdfavLS12+58ZavXfSzi74K5Su9e/f+LGrlypURw6lRtSpVrjKFP4pVqHyDylWOspShVKUoUWcUqxid0HFDPKJDOqC92qXt2qJNBrpeq7VSS7XYUBdormZpuqYY8ESN0xiNMOShGqxP9bFh91Vvw+6pbupi4B3V3tDb6i1Db63XDf5VvWz4TfWCH/nPAnjK8BunpqQ2AvBISnLKg46e+2zA3QlnEu6AcBuEm23BTRD+YBOuiz4effWxo8euBPE7EL/dv2//rx1Lv9qxfccl7omfb1i/4cJVK1f9bOmSpT9duGDhT2bPnP3jKZOm/GjMqDE/+OzTz77fq0ev73bp2OU7jq1vNX6s8TeuvfLar//0xz/9DyhfgzKoFsUQa1StSpWrTKUqVqEKDDJPOcpShlKVokSdUaxidMKAj+uoDumA9mqXtmuLYW/Seq3RSi3TYkNfqLmaremaYvATNc7gx2ikhhn8YH2qAYbfV731IYAP1BVAJ7UH0E5vAWit1yG8BuEVvQSiCYTnIDxtExrbhEYgHgHxEIj7HUf3wLgTxu0u51tsxE0wboBxHYxr3A9XHdh/4Iq9e/ZebjMu27Z126WbN23+pc24GMhFSxYvOd8l/rNZM2adN3ni5HM/H/35OUMGDflhvz79ftC1U9fvtXu73XdfffnVbz/8wMPf/P1vf/+Nn/zwJ1+H8h+9evUaFLVixYqIQdWoWpUqV5lKVazwR4Gh5SlHWcpQqlKUqDOKNcQYnVS0juqQDmivwe7SDm3VZm3QGkNepWVaooUGPU+zNUNTDXuSxutzAx+l4Rpi6AP1iaH3Ux/1MvjuBv++Oht8B71r+G/bgjcBvJGcnNwCQHMAzQC8COB5AM/qKQhPOJIeg/CwjXjARtwL4S5H0x3uh9sOHzp8s624yVb8Yc/uPdeCuNpj7O9txu/cF7+FcRmMX9mOS2zHxbbjwqmTp54/fuz4n40cPvK8Af0H/NhT1jnvd37/h++0eecHLV9t+b3nnn7uu3fdfte3L/vlZd8853vnfAPKN6AMjlq+fHnE0GpUrUqVq8zASlWiIhUoTznKUoZSDTFFiUpQnE7rpGFG66gO66D2Gepu7dBWbTbYDVqr1Ya7XEu1yHDna45mGvI0TdYEgx6r0QY9QkMN+zN9auAfG/hHfsT3NvAe6mboXQ29o9obfFtDf8vQW/uR/7rBv2bwrxj8SzagieE/bwueNvwnbUEjW/AogIcA3A/gXptwl6PpTy7rW23DzRBudFf8Yf269detXrX66hXLV/zeVvzOnfGbubPnXubeuNRR9UubcfGIYSMuclxd0O+jfufDOM92nPtGizd+/HLTl3/07FPP/tCW/OCm62/63sUXXPydH3z7B9+G8q0Pe344JGrZsmURg6xRtSpVrjKVGmaJilSgPOUoSxkGm6YUJSlBcTptyCcVrWM6rIOGvU+7tUPbDHyLNmqtga/WCi0z9EWab+hzNUvTDX6KJhr+OMMfY/gjNczwByUlJQ8EMMDw+6oPgJ76AML7EDpBeA9COwhvQ3gTwhsQWkBobguagXgRxAsgngHxFIgnHEmPuawftg0P2Ib73BN3u7TvcDTd7q64Ze2atTfBuAHG9bbi2kULFl01b86838+cPvNym/Ebm/FrIL8aNmTYJQM/GXixC/2inh/0vKB92/Y/a9Wy1XnNXmx27jNPPvPjJx594px777z3R+6TH1z40wu/971vfv+7UL7Ts2fPoVFLly6NGGaNqlWpcpUZZqhERSpQnnJkrlkZSlOqkpSgOEM+rVM6oWMGfVgHtV97DHyntmmLgW/UOq0x9BVapsVaYPjzDH6WZmgqgEkaD2CM4Y/ScMMfrM8ADADQTx9B+BBCdwjvQ+isDiDeBfEOiDYQWkFo6Th6FcTL7oWXQDQB8RyIp0E0thWNbMWjjqaHYNxvK+61FXfC+BOM22DcvHTx0ptg/MF7xnVzZs25xnZc5d64wpPV5Y6qy9wdl37y8Se/BHIJkItd6he91fqt890hP3NknffoQ4+e6zH43DtuveOcKy+/8kfnn3v+D777je9+H8r3evToMawWxUBrVK1KlYcMtUwlKlKB8pSjLAPOVJpSlaQEg45XrE7phI4Z+BEd0n7D3qOd2q6tBr9J6wx9jVY675cb/BItNPx5mm34MzTV8CdpPIDPNQrAcABD9BmETyD0V18IvSD0gNANQhfb0BFEexBtQbwFojWI10G8BqI5iGaOpxdBPG8rnrEVTzminnBEPQbjYZvxoLviPhh3w7jDZty+eOHiWx1Vf3RU3Wg7rrcd104cP/Fq23ElkCsGfzb4t0Au692z96VAfulSv8SWXPz6a69f2PSFpuc/2ejJnz1wzwPnuUt+4lH43Mt/ffk5Pz3npz/6zte/80MoP+jRvcfwqCVLlkQMtUbVqlSFgZarTCUqUoHyDDdH2cpU+CNVSYacoHjFOmZOGfYJHdcRAz9k4Pu118B3abu2GvomrTf0tVpl6Mu1xNAXar7mGP5Mg5+myYY/QWMNf7Thj9RQAIMADATwMYB+6g3hQwjdIXR1JHWG0AFCOwjvuCPagGhlI1pCeNVGvAziJRBNQDwH4mkQT4J4fM3qNY96v3ho+bLlD7gz7rUZd9uMO2zGbTBugfHHSRMm3egl8PpRI0ZdO3Tw0KvcH1f279v/d70/7H25O+Syju07Xuoe+dWbb7x5iXvkYsfWRY8++OgFQH528w03//T6q68/zyX/E09eP/72f3z7HCg/6t69+4ioxYsXRwy2RtWqVIXhlqtMJSpSgWHnGXKuspWpNANPVfhXouINO1YxOmngx3VUhw39gPZql8Hv0DZD36wNBr9Wq7TC8Jca/CItMPy5mmX40zUFwEQA4zQGwkgAwwAMAfAZgAHqbxM+gtBLPSB0g9AFQkfb0B5EWxBvgWjtaHodxGsgmrsrmnl6etER9YIj6llb8ZStaLxs6bLHlixa8giMh2DcD+MeGHd5G78Dxm2Oqlu8d9zkMr/BdlxvO65xXF31YY8Pr+z+fvcrOrzb4beesi5zj1zq2PrV8888f8njjz5+sS256LY/3nbBH675w/lX/e6qn/3y57/86Y+//+OffOtr3zoXyo8/+OCDkVGLFi2KGGiNqlWpCkMtV5lKVKQC5RtwrrKVqXSlGnSyEhVv2LGK0UkdN/SjOmzgB7RPuw1+p7YZ/GZt0DrDX62Vhr/M8BdrgeHP1WwAMwBM1SQI4yGM1SgAwzXUNgyC8Ilt+BhEXxC9QPSE8IFjqSuIziDesxHtQLzjnmgDohWIlrbiVVvxiq14yeNskxXLVjwH4xkYT/o45HEYjzmmHobx4PSp0+9zb9wzYdyEOx1Vf7Idt9mOm23HTR53b/io90fX9+ze8xobclWn9zpdCeR3Xg5/C+Q3Lz7/4q+feuKpXz3y4COX3P2nuy/+4x/++PNrfn/NRY6uC35x4S/O9zj8UyjnQTmvW7duo6I8U0cMt0bVqjTcCpWrTCUqUqEh5ytX2co07HSlKVmJBn5G4V8xhn5S0QZ+VId10ND3abfB79R2g9+ijVpv+GsMf6WWG/4SLQQwz/Dn2ICZmgZgMoAJGgthDIQREIZBGAxhoG0YAKIfiD4QPoTQ3Ua8D6KLjegIoj2ItiDeAtEaxOu2ooUjqrkjqpn7oqn74gUYz8J42mY09uL3OIxHYTwE4wFH1X2jR46+e/jQ4Xfajts9Xd3muLrZcXVTjw963ADkehtyDZCrbcjvX3vltSt8jHK5x9/fPPbwY7+2JZf+6ZY//dKW/MIFf/Glv7j0op+f//OLfvidH17wza9+83woP3v//fdHRy1YsCBiyDWqVqUBV6hcZSpRkQoNO1+5ylaWoacrTcmGnqQzijP40zqlaMM/piM6aPj7DX+Pdmk7gK3aBGA9gDVaBWG5lkBYBGG+5kCYCWE6hCkQJmociDEgRoIYDmIwiM9sxCcw+oP4CEQvG9EDRjf3RFcYnRxP78FoB+NtW9EGRqvlS5e3hPHa4kWLX/GD8yUX+Is243kYz3iiesq98YSjqpHH3Edsx0O2436Puvf67Ooux9UdQG7v06vPrT269bjZhX6jO+QGd8h17pBrgFzlHrnyhWdfuOLJx5+8/MF7H/zNPXfc8+tbb7r1Uo/Bv7ziN1dc4ui62OPwz72jXPSNr3zjQigXvN/1/TFRPgqIGGyNqlVlsBUqV5lKVKxCQ85XrnKUZdDpSlOKgSfpjOIN/LROGfgJHdMRgz+k/Qa/V7sMfoe2Gv4mg9+gtVoNYAWApQAWawGAuQBmAZihqRAmQRgP4XMIoyCMsBFDQQwCMRDCxzaiH4g+NuJDEN3dE++D6AyiI4j2tqItiLccUW8uWrjoDZvR0nvGqzbjZRgv2YwmMJ6D8QyMJ23HEzAesx2PeNR9yHbc/3G/j+9xf9ztM6w7Puj6we1Abn2v3Xs3t32r7U1AbvC2fr0NucY9cvXTjZ++qtHDjX4P5PLbb779t14WL3OX/Pq3l/72UkfXL8/70XmXfP9b378Yys+h/Lxrl66fR82bOy9iyDWqNuAqVahcZSox6GIVKl+5Bp6jLGUYeLpSlGToCYo39NOKMfQTOq6jhn9IBwx+r3Yb/k7D36bNhr/R8NdpDYCVhr9MSwAsBDAPwGwAMzUNwmQIEyGMswljIIyEMAzCYNvwGYhPbEN/EH0dTb1A9ATxAYiu7opOnqI6OKLeBfGOI6qNrWjt45A33BmvwWjuTbwZjKYwmtiMZx1VT8N4Esbj7o7H3B0Pezt/0HF1v8fde4Hc7ZPeOzzy3u7IutUdcrM75KZXXnrlRiDX25BrGz3S6BrvJFd7J/k9kN954rrclvzm15f8+rKf/+znv/bk9avvffN7v/z6v3/9Eii/6NK5y9iouXPmRgy4RtWqMuAKlatMJSo27ELlK085hp6lDKUbeoqSDD1B8Yo1+Bid1HEARw3/sA4A2KfdAHZqG4QtADZqPYQ1EFZBWK6lEBZBmA9hDoRZmg5iiibBGA/jcxCjQIwAMUSDbMSnMD6G0c8TVB8YH9qK7rbifRhdYHSE0R5GOxhvw3gTRiub0RLGa943XvFU9ZKnqhe9czzvqHrW3fH0pwM+bQzkcdvxaK+evR52fzzYrUu3+4HcY0PuAnKHDbndhtzqyLq5yXNNbvL4e4OnreuBXHf/3fdf64nrqhuuveH3LvgrXPC/c59c7uj6zbk/OPcyL46XQvkVlF917tx5XNTs2bMjBl2jakOuUoXKVaZSAy9WofINPE85yjLwDKUr1eCTlWDwZxSrGMM/qWjDP2b4h3XQ8PdpD4BdALZrC4BNADZoLYTVEFYAWOo4WgxggeZCmA1hho2YCmIyiAmOprE2YgyIkSCGgRgMYiCIAbaiv634CERvj7Q93RUfOKK6wugMowOMd2G0hfGWS/xNl/gbMFrAeNVR9bLteMl2NLEdz7s7nnV3PPVRrz6NPe428rj7qOPqYU9YD9qQ+99+8+17gdzdonmLO2zI7Z60bnOx3/LEY0/80TvJjUD+4L3kei+K11531XVX+0T4Sj+h9ftLLrrkigt+csHvPA7/FspvoFwG5dedOnUaHzVr1qyIIdeo2oCrVKFylanUsItVqALDzlOOsg08Q+lKNfhkJRr8GcUZ/GmdNPxoHTP8IzoIYL/h79UuAOFfWyFshrABwjqthrASwjIIiyEshDAPwhwIM23DNBBTQEwEMQ7E5yBGgRgOYiiIQS7tT0EMsBX9bEUfGB+6L7q7L7q5vLt4z+jkmHrPZrSD8Q6MNjBaw3jDO0cLj7nNXeQv246m7o4mtuN5x9UzjqunHFeNfWTSyIX+qJ8xfBjIg46s+4HcC+RuIHcC+ZNj67ZHHnjkFpf7ze6Sm9wlNzi6rr/6iquvsyXX2JKr3SdX+Xjl9568rvA2/zsol0P5bceOHSdGzZw5M2LINapWlSFXqFxlKjXsYhWpwMDzlKtsQ89UhqGnKlmJBn9GcYZ/WqcM/4SOG/4RHQKwH8Be7QawE8A2AFu0EcJ6CGsgrNJyEEtALAIxH8RcELMgTHdHTNUkEONBjHU8jXY8jbAVw0AMthWfwfjEVvS3FX1tRW9b0RNGdxjvw+gMoyOM9jDawXgbRhtHVStH1esu8ha2o7m7o5knq6aOqyaerp5zXD3juHrKI29jT1iNgDwG5GEgDwK5H8i9Pte62y+AuNM9cgeQ23zgeOudt915iy35o7vkRo/Bf/AGf52nrms9Cl/r45WrPXld6W3+9//xb/9xBZQrOnboOClqxvQZEQOvUbVhV6lC5SFDL1Wxigy9QHmGnqtsZRp8hlINPkVJBp+geMOP1SnDP6HjAI4COKwDAPYB2KOdELYD2ApgE4ANWgthNYQVEJbahsUgFkCYZyNmg5gJYpqNmAxiIohxtuJzEKNADAcxxFYMshUDbcUAGP0cUX0cUb1g9IDxgaeprjA6w+gAoz2MtjDedlS9CaOV7WhpO16zHa94GWzmuGrquGriuHrO/fGMJ6ynfLjY2HvI40Aec4c87DOth4Dc7wXxPiD3uEfuuu+u++4Acrstuc2W3Oox+I8u+JtsyQ1A/uCnf6+Hcp0nr2u8OF4N5SooV3Z4r8PkqOnTpkcMu0bVBl2lCpWHDLxUxSoy9ALlK9fgs5Vp8BlKM/gUJRl+guINP1YxAE4qGsBRAId1EMI+CHsA7AKwXVshbIKwAcI6CKu1EsRyEEtALLIN830yOxfELBDTQUwFMQnEBMfTWBCjbcVIWzEMxmBb8RmMT2B87PLu62mqt834EEZ3GN1gdIHRyb3xnqPqXUdVWxf5W7bjTdvRyna0tB2vOa5eAdLMcdXU/dHEhf5cm1ZtnvFzIk8BaQzkcRvyGJBHgDzkYn/AsXWfl8R7HVt3A7nTZ1x/csHf7i651dF1y68u/tUfgdx4wXkX3OjJ6wZPXtdDuQ7KtVCuea/9e1Oipk6dGjHoGlUbdJUqVB4y8FKVqMjQC5Rv6LnKUabBZyjN4FOUZPiJijf8OMOP0UkA0ToG4QiAg9oPYS+EXRB2aBuEzRA2QlgPYY1tWAViuY1YCmIxiAUg5oGYrRkwptmKySAm2opxMMbAGAVjuCNqqK0YBGMgjAE2oz+Mj2D0htETRncY78Po4qjqCOM9F3k72/GO7Xjrw+4ftu7erfsb3s5buD9eBfKK+6MZkKYu9BeAPOfF8BlH1lM2pLFH38e9izwG5BEfyT8M5AFbcr8393u9KN5z43U33uWCv/N3l/3udkfXbS74Wy8878Kb3Sc3Q7nJJX8DlBug/AHK9e3fbT81asqUKRHDrlG1qgy7oq5yAy9ViYoMvUD5yjX4HGUZfqbSDD9VyYafqDMA4nQawCkAJ3QMwlEAh3QAwj4IuyHs1HYQW0BsArEexFqX9WoQK0Asc08sBrHQRswHMcdWzAIxHcQUEJMcUeNtxVgYY2CMdEQNgzEExmfeNT6F8TGMfp6o+rjEe8HoAeMDR1VXR1Vn29HRdrS3He086r5jO9oAae24esNx1cL98ar74xUgzYA0BfICkOeAPOtt/Wkgjd0jTzz20GONHFuPukce9vnWQ0Du9xnXfT5SudcFf7ctudPR9ScX/O1AbvPSeKvH4Vug/NFHLDd97f987UYoN77b7t3pUZMnT44Yeo2qDbxKFSFDL1epSgy+SIUGn6885Rh+ljINP12pAJKVCOCM4iCcBnAKwAkdh3AUwGEAB7Qfwh4IuxxL223DVhCbIWzQOhBrbMNKEMtBLAWxyFYsgDEXxmwQM2zFVBiTHVETbcU4GJ87okbBGGEzhsEY7F1jIIxPYPSH0de90dtR9SGMHrajmw8Ru9qOzu6ODo6r9i7zdo6rt4G0cVy1AvIGkBZAXvXzIa8AaebIagqkCZDnvYs8C+Rpn2s9CeQJj7+NgDxqSx5xbD3k2HrAltzvgr/XY/A9tuQu98mdP/vxz/5kS273OHw7lFuh3ALlZih/bNeu3YyoSRMnRQy8RtWGXaWKkIGXq9TAS1SkQkPPV56h5yhLmYafbvhpSjb8JCUAiAcQqxgAJwFE6xiEwzbhIIT9NmEvgN0AdmqbbdgCYhOE9VoLYhWIFRCW2YjFIBaCmAdiDohZIKaDmGorJoGYYCvGeQMfA2KkzRjumBrimBoEY6DNGGAz+juqPrIZvWF8CKO7945uMLrC6ASjg6er9p6u2jmu3nFctXGht/aE9YaXwpbe1F8F8oo7pJkjqymQF4G8YEOedY88A+Qp90hjII/bkkaOrUeBPGxLHnLBP+gN/n5bcq/75B4X/F225E6fDt/pcfhPUG6HchuUW9u2bTszKvxWCIOuCRlylSpVoXIDL1OJgRerUAWGnqdcg89WpsGnK83wU5Rk+AmGH6/YpYuXxAA4ZQuiIRyDcATAIR2AsA/CbtuwE8J2CFshbLYNG0CsA7EGxEoIy7UExCLH0wIY80DMthUzQEyzFVNsxUQY423FWFsxGsZIGMNgDIExyGZ8ajMGwOgH4yMYvR1VPT1ZdXdUdYPRxd3R2XHVwXa0B9LOdrztuGoDpHXzZs3f8HPrLYG8BqS5I+tlIC950noRyAvukeeAPOtp62kgT9qSxh6BH/f2/pgL/lFH1yMu+IdsyQNeGO+Hcp8tucc7yj1Q7vKOcieUO6Dc0fadtrOjxo8fHzH4GgMPValSFQZfrjKDL1GxCg2/QHmGn6tsAFnKAJDmGEqxBckQEiGcgRAH4TSAUzoB4TiEoxAO6yCIfSD2gNgFYgeIbSC2gNhoI9aDWOueWA1iBYhltmIxjIW2Yj6MObZiJowZMKbCmGQzJsIYB+Nzx9RoGCNsxjCbMdgl/pl74xMfIH7sJbCf7ehjO3rZjp6Oqu62433HVRePu51sRwcg7YG09YT1tg15C0hrIG8AaQnkNSDNgbwMpJn3kaYu9iZAnve09SyQZ2zJU0Aa++DxCRd8I0fXY46uR2zJw+6TB90nD9iS+72j3Ocd5V6X/N1Q7oZy1ztvvzMnatzYcRGDrgkZdJUqVaFyAy9TiaEXq9DgC5Rv+LmGn23wWcow/HSlGn6y4SfqjOIgnAYQA+AkgGgdhXAYwiEI+yHshbAbwk4I2yFssRGbQGwAsQ7EGhArQSwHsdRWLAKxAMQ8ELNBzLQZ071nTIExyWZMgDEWxhgYo2AMhzEUxiD3xkAYn7jIP4bRz3b0sR29bEdP29HddnTzuNvFcdXJ/dHB/dHehd4OyDs+y3rLY++bQFoBed2nvi2AvPrQfQ+9AqSZe+Qlx9aLtuQFIM/bkmeBPG1LnvJp8JMu+Cf8MqJGPut6zJY84uh6+Eff/dFD3lEegvIAlPuh3Aflvrffentu1NjPP48YfE3I4KtUafAVBl+uMsMv9SO/2PCLVKB8ALkAspVl+JlKB5AKIFmJEBIUDyEWQgyEkxCidQzEERCHQBwAsQ/EHhA7QewAsRXEZhAbHU/rYawFscpWrICxzF2xGMZCGPNtxRwYs23FDJf3VBhTHFMT+3/UbzyMsTBGO6pGesQdDmOIo2qQo2qgx9wBtqM/jL7ujj62o5fLvIft6O6F8H3HVRcgnYB08PF7eyDtgLwD5C0gb9qQVj7Teh1IC/fIa0Ca+wT4ZSAvedpq6mmriRfFF1zuzzm2nrElTzu6nnJ0NfZu8oQtaeToegzKo1AegfIwkAe/+q9ffRDKA2+1eWt+1JjRYyIGX2PYoSpVGnqFyg29TKUqNvgiFRh+vsHnKUfZhp9p+OlKBZACIEkJAOIBxOk0hFMQTkA4DuEohMMQDkLYD2EvhF3aCWKbjdgCYhOIDSDW2Yo1IFaCWG4rloJYbCsW2Ip5MObAmAVjus2Y6s6YBGMCjPE243NH1WgYI2AMsx1DbMcg2zHQUTXAdvS3HX0dV31sRy/HVU/HVXfHVTcXeldPWJ08YXUA0h5IOyDvAHkbSBsgrYG84R5pCeQ1x9arjq1XPG297HJ/yeX+osu9iS153pY85+h61tH1tKPrSU9djR1dT7hPHvfk1cg7ymNQHoXyCJSH27zZZkHU6FGjI4ZdEzLwKlUadkVdZb4tNfgSQy9SofINP085hp9t+JnKMPw0pQBIApCoMxDiIJyGcEonQUSDOAbiCIRDEPbbhn0gdoPYCWG7toLYbCs2glgPYq2tWAVjha1YBmMJiEWOqPku77kwZsOYCWO6d40pNmOSzZgAY5x7YwyMUTBGwBhmO4bYjkEwPoUxwHb0tx19HVd9bEcvF3pPx1V3IN2AdPXhYmdv6h194vsekHeBtAXyNpA2QN50j7QC8jqQlo6t1xxbzd0lrzi2mgFp6mXxRVvSxFPXC14Yn/Mo/AyUp23JU1CedMk3hvIElMehNILSqE3rNgujRo0cFTH0mpCBV6nSwCvqKjP4UpUYfJEKDb5AeYafo2zDzzL8DKUBSFUygCQAZwDEKxZCDISTEKIhHINwBMIh23BA+yHsgbDLRuwAsQ3EFhCbQGywFetArLEVq0AstxVLYSx2RC2EMd9WzPU0NctmzIAxzZ0xBcYkGONhjIUxBsYoGCMcVcMcVUPcHYNgfApjgO3obzv6Oq4+clz1cqH3dKF398jbDUhXIF3cIR3dIR2AtAfSDsg7QN4C0saHja19tvWGY+t1IC0cW6/akuaOrZdtSTNb8tLF51/c1FNXE0fX8+6T54E865J/FsrTUJ6C8iSUJ6E0frP1m4ujRgwfETH0mpChV6nS0CvqKvNtqeGXGH6RCg2/QPmGn6scAFnKgJAOIFXJEJIgJECIVyyI0yBOgTgB4bhtOAriMIiDIPaD2AtiN4idILaD2GorNsPYaCvWw1gLYrWtWAljua1YAmORzVgAYx6MOTZjFowZMKa6Nya7NyZ6qhrvqBrrqBpjO0bZjuG2YyiQwe6Oz2zHp7ZjgOOqP5C+7o8+QHoB6QmkO5BuNuR9G9IFSCcgHYC09/Mj7YC0dY+8DaSNY+tNx1Yrx9YbtqSlu6SF95JXfRrc3Ja84uhq5uh6yZa86D5pAuUFKC9Aec47yrNQnoHyDJSnW7dqvSRq+LDhEUOvCRl6lSoNvSJk6OUqVYnBF6vQ8AuUb/i5hp+jLACZhp+uVAApAJKUCOEMhDgIpyHEQDgJIRrCMR2BcEgHIOyDsAfCLhuxA8R2EFtsxWYQG0CssxVrQKwCscIRtQzEYhCLbMYCd8ZcGHNsxkybMR3GNBiTYUyEMR7GWBhjYIyyHSNsxzDbMcR2DHJcDXRcfeK4+tj90c/98ZGfD+nts6wPvRj2sCEfeOx9H0hXIJ1tSEcg7wFp72JvB6StY+ttIG1syZtAWtmSNxxbLW1JCxf8ay745p66XoHysvukGZCmLvmmLvkXoTSB8jyU56E81+qNVsuihg4dGjH0mpChV6kyZPAVKjf8UpUYfrHhF6pA+QByAeQoC0CmMiCkQUiBkKxEEGdAxIOIhRBjG05CiNZxEEdBHNZBEPu1F8RuEDttxXYY22BssRUbYayHsRbGai99K4Esh7HUZiyGsRDGfJsxF8ZsGDMdVdMdVVMdVZMcVRNc5OOAjLUdo23HSNsx3HYMtR2DHVeDgHwK5BMgHwPpZ0M+8tFJbxvyoQ3pCaS7z7S62ZCuHn07+6ndTu6RDu6R9kDe9bTV1iPwO46tt9wlbWxJa1vSypa8YUtaOrpaOLpedXS96j55BcjLLvlmUF6C8hKUF6G8CKXJG6+/sTxqyOAhEQOvCRl2tSoNPFShckMvU4mhF6vI4AuVb/h5yjX8bMPPUgaANACpAJKVBCEBQLwjKQ7CaZ2CcMJGREM4ZiOOgDgE4gCIfRD22IhdIHaC2A5iK4jNnqI2glgPYi2I1TZjpSNqOYylNmMxjIUw5tuMuTBmwZgJY7rtmApjMowJtmO87RhrO8bYjlG2Y4TjahiMIY6rQY6rgZ6wPnn8kcc/tiH9bUhfG9IHSC8b0tOG9ADygQ1534Z0BdLZPdIJSAcg7YG8a0vaudzfcZe8DaQNkDdtSWtHVysor9uSlo6uFlBec3S9CqW5t/lXoLwMpRmUZq+3fH1l1OBBgyOGX2PwoWqDr6yrwvDLVWb4pSoGUKRCAAXKg5ALIVtZEDIgpCsVRAqIJAiJEM4oDkQsiBgQJ0FEgzgO4qiNOAzjIIz9MPaC2O3i3uWu2AFjG4wtMDbB2ABjHYw1MFbBWAFjmUt8ic1YBGMBjHmOqjkwZtmOGR5zpwGZYjsm2Y4JtmOc7RhrO8bYjlFARgAZZjuGABnk/hgI5BMfLg4A0h9IXxvSx4b0AvKhDenhYu/uHukGpKt7pItjq5Njq6M39/dsSXtb8q4taetl8W0ob9mSNp663nR0tYbyBpTX/RxKSygtXPItoLwKpTmU5lBegbIq6rOBn0UMvCZk4NWqNPBQhcoNvkylBl9s8EUqVIHh5ykXQA6ALACZSgeQBiAFQLISISRAiIcQCyEGwimdgHAcwlEbcQTEIRAHQOwDsRfEbvfFThjbQWx1RG2GsdERtR7GWhCrbcYqm7ECxjIYi2EsgrHAZsxzb8yBMct2zLAd02BMsR2TbMcE2zHOZT7W4+4Yx9UoICMcV8OADHVcDQbyGZBPvakPsCEfA+kH5CMgfYD0AtITSA8gH3ja6gakqy3pAqSTLekI5D13SXt3ybseg9vZkrbuk7dd8G85utq4T96E0hpKKyhvQHkdSMsQlBYtW7RcHTXw04ERQ68JGXy1qgy9UhWGXq4ylRp+ieEXqdDwCww/LwQgR9kAMgFkAEhTKoRkCEkAEmzCGQhxOg0iBsRJENGOpmMQjkI4DOEghP02Yh+IPSB2gdgBYhuILbZiM4yNtmI9jLUu8NUwVsFYYSuWtmrZegmMhTAW2Ix5NmMOjFkwZsCYZjum2o7JtmMijPEwxtqOMS700bZjpONquPtjqA8XhwAZBGSgI+sTIAOA9AfSD8hHQHq7R3oB6QmkB5APHFvdgHR1bHUB0tnR1clHKh1syXu2pL2j610obW3JO46ut90nbzm62rhP3oTSGkirEJQ3WrzWYm3UJwM+iRh6Tcjgq1Vl8JWqMPxylakUQImKARQCKFA+hDwAOcqGkAUhQ+kgUkGkQEiCkKgzIOJBxNqIGBtxCsYJGMdhHIVxBMQhHQCxX3th7IaxE8YOW7ENxhZbsUkbYKyDscZmrLIZKx1Ty4EstRmLbcZCIAuAzHNUzQEyC8YM2zHNdkwBMgnIRNsx3naMBfI5kNFARgIZDmQYkCFABgH5DMinQAYA6e9Jqx+QvkD6uEd6e/z9EEgPW9LdsfWBLXkfSFdb0sWWdLYlHW1JB0fXe7bkXVvyri1pB6UtlHegvA3lLSBtQlDebPFqi3VRAz4eEDHsmpCBV6vKwCvrKjf4MpUafInBF6vI4AuVb/h5ygWQAyBLmQDSAaQBSFEyhEQICRDOQIiDcBpCjI04CSHaRhyHcNQ9cRjEIRAHQOwDsQfEbluxE8R2EFtBbHaBb7IZG2CsA7HGZqyCsRLGcpf4UhiLYSyEscBRNQ/GHBizYMxwmU+3HVNtx2QvhBMdVxMcV+McV5+7P8a4P0b5LGsEkOFAhgIZDGQQkIFAPgUyAEh/IP2A9HWP9AHS25Z86BG4py3pcfH5P//AlnSzJe/bkq62pIunrs5QOkLpAOU9R1d7KO2hvOvDyHZA2uodKO+81vy1DVH9+/WPGHpNyOCrVWXwlXVVGH6ZSg2/xPCLVWT4hYafHwKQqxwAWQAyHUkZENIhpEJIgZCkRBBnQMSBiAURA+IUiBMgokEcczQd0WEQB7UfxF5H1B4Yu0DssBXbYWy1FZthbISxwTG1DsYaGKtgrISxHMZSGIthLHRULXCRz4Mxx3bMhjHDdky3HVNtx2TbMcl2TAAy3naMdX+MATIayEggwz32DgMyBMggIJ950hroYv8EyAAg/W1JPyAfObb6AOltS3q53Hvakh5AutuSD2xJN0fX+46uLlA625JOQDq6Tzr69cMdoLwHpH0IyruvNn91Y1S/vv0ihl4TMvhqVRl8ZV0VAMpVBqDE8ItVpEIIBRDylQchB0I2hCxlQEiHkAYhBUKyEkEkgIgHEQfiNIhTNuIkiBO24jiIo7biMIxDMA7Yin0w9sLYDWMnjB0wtsHYAmMTjI2OqfUw1ro3VgNZ5d5Y4ahaBmOp7VhsOxYCWWA75gGZ491jlu2YaTum246pQKYAmQRkApDxPlwc68XwcyCjb77hllFARgAZBmQokMFABrlHBgL5FMgnXhI/dmz1tyX9gHzk2OpjS3rbkl5QetqSHraku6eu7kC62ZL3bUlXIF1CUDpD6QSkYwhKh+avNN8U5X+gJWLoNYYeqlaVoVeGDL5C5SqzAaUqAVDsBa7I8AuUDyAPQK6yIWQByASQrjQIqRCSISRBSIRwBkIchFgIMRBOQTgBIdpGHANxFMRhEAdBHHBE7QOxF8RuR9QuGDtAbLMZW0BsArHRZqy3GWthrIGxCsZKGMthLIWxGMZC27HAdswDMhfIbBgzYcxwXE0DMhXIZNsxEcgE7yHjbMhYIGOAjAYyEshwIMOADHWxDwYyCMhnQAYC+cSWDPAI3N+W9APS113yEZA+tqS3Lenl6PoQSg8o3aF88K2vfVvf6gblfShdgXQJQenc/OXmW6L69O4T8aO9xsBrDLzaj/gqVRp8paFXqNzgy1Rq8CUqNvwiwy8IGX6e4ecqB0BWCEIGhHQIqRBSlAwiEUKC4kHEgTgNIgbESRAnQBwHcQzEEVtxGMRBEAdA7LMVe0DsshU7YWyHsc1WbIGxyTG1EcR6rYOxBsYqGCthLIex1HYsgbEIxgLbMR/IXJf5HBizYMx0XE0HMtV2THF/TAYyEcgET1njgIwFMgbIaCAjbchwIMOBDAUyBMggl/tntmSgLfnUlnxy/k/O/9iW9IfSz5b0Ped7P/4ISh9PXb2h9ILyIZCeISg9oHQH8kEISrdXmr2yLap3r94Rg48Yeo2qVWXwoUrDr1C5ygCUAihRsYogFAIoUD6EPAg5ygaRBSETQrrSbEQKiGQQSSASQJwBEQ8iFsRpEKdAnAQRbSuOwzgK4wiMQ7bioPbD2AtjD4xdNmMnjO0wtmoLjE3ujY0w1sNY66lqDZBVQFb6dVjL3R1L3R2LgSyyHQttx3wgc4HMcVzNAjITyHQg07ypTwEyGchEIBOAjAMyFsgYGzIayiggI9wjw4EMAzLUhgwGMgjIZ7ZkIJBP3SWfAPnYlvR3dPV3n/QD8hGQPu6T3kB6A+nlyetDL449v/IvX+kBpLaXm728Pcr/wkHE0COGXqNqA6+qq9LgK1Ru8GUqNfwSFRt+keEXqgBAvvIA5ALIBpClTAgZENIhpEJIgZCsRBAJIM6AiAMRCyIGxCkQJ0BE24pjII6COAziEIgDIPbbjL2OqN0gdjmmdoLYbjO2wdgCYxOMjT4iWW8z1jqq1sBYZTtWwlhhO5bZjiUwFnu6Wmg7FsCY57ia67iabTtmAZnpo5PpQKYCmeIpaxKQiUAmABkHZKwnrc+BjHGxjwIy0oaMgDLcsTXUxylDHFuDoQyyJZ9BGQjkU1vyCZQBUD6G0h9IP09dfaF8BOUjKH2g9AbSK/TySy/viOrZo2fEwCOGXaNqVRl6qNLQK1QeMvjSkOGXGH6xigy/0PDzQwBylQMhG0IWgAylQ0iDkAohGUIShEQlQIiHEAvhNIQYx9NJECdAHAdxDMRREIdtxUEYB0DstxV7YeyBscvT1E4Y22FssxlbYGxyTG2EsR7GOhhrYKy2HatsxwoYy23HUtuxGMYi27HQdswHMs92zHF/zAYyy5v6DCDTPfZOBTIFyGRH1kQgE4CMBzLWlnzuHhkDZDSQUZ62RgAZDmQYkKHukiFABgMZBOQzR9dAKJ9C+QTKACgDoHwMpT+UflD6AqmtWdNmu6LcHRFDjxh4japVZfChSlUYfqgcQJlKAZQYfrGKABSqAEI+gDzlQMiBkAUhUxkg0iCk2YYUEMlKhJEA4oziQMQqBsYpECcVDeI4iGO24giMwzAOwjhgK/bB2AtjD4xdMHbA2O6Y2gpkC4xNjqqNMDbAWAdjre1YDWOV7VgBZDmQpbZjCZBFtmMhkAVA5gGZC2QOkFlAZnrsnQ5kGpCpQKYAmQRkog2ZAGScLRkH5HPH1hjH1mggoxxbI4GMsCXDoQyDMtQFPwTKYI/Cgxxdn0EZCGUgkE/dJ59AGQDlYyC1vdT0pd1RH3T7IGLoEQOvUbWhV9VV6dtKw69QueGXGX6pSgy/WEUACgEUKB9AHoBc5UDIhpAFIEPpENJsRCqEZBuRBCERQoKNiIcQp1hbEQPiFIgTigZxHMRRW3EExmEYB2EcALHPfbEXxm4Yu2zGThjbYWyzHVtgbHZUbYKxwXasB7IWxmrH1SrbsRLICtuxDMhSx9ViIIscVwuAzAcyD8hcGzIbyCwgM4FMBzINyFQgk4FMBjLRPTIBynjH1jhbMhbK57ZkDJDR7pJRQEbakhFQhtuSYbZkKJQhQAaHoAyC8hmUz6AMBPJp6KUXX9ob5XejRgw8VGPg1aoy8PoqDb5C5QZfZvClKgkZfpHhhwoAFBh+vnIB5ADIVhaETAgZENKV9lKTZikgkiEkQUi0EWdAxEOIsxGxIGJAnAJxAkQ0iOMgjtqKIzAOews/6L44YCv2w9gLYw+IXTZjJ4wdNmMbjK0wNtuMTTA22oz1MNbBWANjNYxVMFbAWG47lsFYAmOx+2MRjAU2ZL77Yx6QuS712UBmAZnpyJoBZDqQqUCmXPjTiyYDmQRkIpAJQMbbknFAxtqSz4GMATLaloyCMgrKSFsyAshwR9cwKMOgDIUyBMpgILU1bdJ0X5TfjRqBEDH4GlUbfqgqZPiVqgBQrjIApSEIJQCKVQShEECB8iHkQchVDoRs25CpDBDpINJApIJIAZEMIvH5p59LgHEGRjyMWBinYcTAOAnjBIxoGMdgHIVxBMYhGAdhHICxD8ZeGHtsxi4gO2HssBnbgGy1GZuBbAKy0VG1Hsg6IGuBrIaxynasBLLCE9YyIEuBLAGyyIYsBLIAyHwg84DMATIbyCwgM90jM2zIdCDTHFtToUxxbE2CMtGWTIAy3paMgzIWyFggn2uMLRkNZRSUUUBGagSUEVCGQxkGZGjoxSYvHojq0qlLxMAjhl2j6pChV9VVafAVKjf8spDhl6oEQLHhF6kQQIHyAeQByAWQo2wIWRAyIWQoHUQahBQIyRCSICRCSIAQrzgIsToNIsYRdRLECUdUNIhjII46oo7AOAzjIIwDMPbbjL0w9sDYBWOX7dgBYzuMrTC2wNgMY6O7Y4PtWA9k3fVXXbcGxmobsspxtRLIciDLbMhSIEuALAayEMgCIPOBzAMy14bMATLbPTITyEwg04FMAzLVlkwBMsWWTIYyyZZMhDLBXTLeloyDMhbK51A+BzImBGS0RkEZCaS2F1948WBUp46dIoYeMfAaVYcMvaquSsOvMPhQucoMv9TwS1QcMvwiFaoAQL7yAOQqB0I2hCwImRAylAYiFUQKhGTbkAQhEcIZCPGKc1fEgjhtK2JgnIJxAkQ0iOMgjoI4YisOwzgI4wCI/SD22Yy9MHbD2OWo2gljO4xtMLbaji1ANtmOjTA2wFhvO9YCWQNjte1YBWSl+2MFkGVeDJcCWQJksXtkEZCFQBYAmedJay6QOUBmO7ZmA5kJZAaQ6UCmAZlqS6YCmWJDJkOZBGUSkAlAJji6xgMZFwIyNgTlcyBjQk2eb3I4yu+xixh8xMBrVB0y+KqQoVeqImQDylVm+KUhW1CiYghFAApVACEfQh6EXOVAyIaQpUwQGSDSQaSBSFUKhCQlOp4SbMUZEPEg4kDE2ooYGKdgnIRxAkY0jGMwjsI4YjMOAzkI5ACM/TD2wdhrO3YD2QVjJ4wdMLbZjq1AtgDZDGQTjA22Yz2QdUDW2o41QFYDWQlkBZDlMJbZkKVAlgBZDGSRDVng2FoAZT6QebZkLpDZjq3ZUGYBmQlkhi2ZDmRaCMpUWzIFymQok6FMAjIxBGRC6Cv/8tXxQMaFoByJ8tu5IoYdqjHsUPWLzzetMvBQpaGHKgy9XGUGHyo1/BIVG35RCECh4RcoH0AegFwAOcoGkKVMG5EBId02pEFIhZACIUmJIBJAnAERDyIORCyI0yBiQJwEcQJENIjjII7ZjCMwDsM4BOMgjAM2Yx+MvTD2wNgNYxeMnTC2w9hmO7YC2QJjM4yNtmMjkPUw1jmu1gJZYztWA1kFZKX7YwWQ5UCWAVkKY4kNWQxkEZCFQBYAmQ9kHpC5mgNkti2ZDWQWkJm2ZAaUGVCmA5mmqUBqAzLFxyuTbcokILW98NwLR6P8dq6I4UcMvqauasMPVRl+ZV0VAMoNP1QGoFQlAELFEIpUCKIAQr7yIORCyAmByLYNWSAyHE3pMNJBpIJIAZEMIkmJMBJgnIERDyMORiyM0zBOwTgJ4wSMaBjHYRyDcRTGYRiHYByEcQDGfhj7YOyBsRvGLhg7YeywHduBbAOyBchm27EJyEYgG4CsB7IOyFoga4CsBrIKyEpH1gogy4EsA7IUyBLH1mIoi4AsdGwtADLflswHMk9zgcwBMhtIaBaUmUBmhIBMBxKaBmUqlKlApoSef+7541Hvtn03YuARw66pq9q31YZeFTL0SlWo3ODLDb5MpSHDLzH8YhUZfmEIQIFNyFcehFwAOcqGkAUhE0KG0iGkQUiFkAIhWUkQEiEk6AyIeBBxIGJBnAYRA+LkbTfdegJEtCPqOIxjMI7COALjMIxDMA56qjoAZB+MvdoDYzeMXTB2wthhO7YD2QZkK4wtjqtNQDYB2QhkgyNrPZC1QNbYkDVAVgFZCWQFkBVAlgNZZkuWQlkCZDGQRbZkEZCFtmQBlPlQ5gOZB2Suo2sOkDmeuGaHgMwKQZkJZSaQGaHnn30+OspvUokYeMTAa+qq9m21oVeFDL5SFSHDLzf4spDhl6rE8Itre+ixIhUCKACQH4KQp1wIORCyIWQpE0QGhHTbkAYiVSkgkkEkgUgEkQDiDIh4EHGKtRWnYcTAOAXjJIxoGNEwjsE4CuMIjMMwDtmOgzAOwNivfTD2wtgDYzeMXTB22o4dQLYD2QZkC4zNMDbbkE1ANgJZb0PWA1kHZC2QNUBWA1kFZCWQlUBW2JLlQJYBWRqCsgTIYiCLtBDKQigLgMwPAZkXAjI3BGSOZgOp7blnnjsZ5TepRAw8YuA1dVX7ttrgq0IGX1nbw40qVA6g3BFUZvildZUAKDb8IsMvrKsAQj6APAC5IQg5ELJCEDIhZEBIVxqIVBApIJKVBCMRRAKIMyDiQcSBiAVxGkQMiFM6CeMEiGgQx0Ec01EYRxxVh2EcgnEQxgEY+2Hsg7EXxh4Yu2HsgrHTduwAsh3INiBbgWwBstmFvgnIRiAbgKwHsg7IOiBrgawBshrIKluyCspKICtsyHIgy0JAlgJZAmSJLVkMZFEIyMIQkAUhIPNDQOaFoJyK8vshIoYeMeyauqp9W+1HfajK4CtDBl+h8hCAMsMvDRl+SV3FEIoAFAIoqCsfQh6EXAg5ALJDELKUCSIDQjqENKWCSAGRDCIJRCKIRBBnFA8jDkQsiFhbcRpGDIxTIE5cc8XVJ0BEgzjumDoG4yiMIzAOwzgE46AOwNgPYx+MvTD2wNgNYxeMnTB2wNjuuNoGZCuQrUC2ANkMZBOQjUA2AFkPY10IyFoga4CsBrIqBGQlkJVAVgBZHoKyDMhSd8lSIEtghBaHgCwKAVkYevbpZ2Oi/H6IiKFHDLumrmrfVht8qMrgK0MGX1FXueGHygCUGn5JXcUAigCECiEUKB9CPoA85ULIgZAdgpAFIRNChtJBpIFIBZGiZBBJIJJAJIJI0BkY8TDiYMTCOG0rYmCcgnESxgkY0ToO5BiQoyCO2IzDMA7BOATjoA4A2Q9kH5C9QPYA2Q1kF5CdMHbC2KHtMLZpK5AtQLYA2WxDNgHZCGQDkA1A1juy1gFZG4KyBspqGKtCQFaGoKyAsgLKchihZe6TZUCWhoAsCUGJjXqz1ZsRQ48YeE1d1b6tzeCrQoZfafAVdZX7thxAWQhAqeGXqDgEoQhAYQhCAYB85UEI5YLIgZANISsEIhNChtJBpIFIBZECIRlCUghEohJgnIERDyMORiyM0zBiQJwCEToJ44TtiAZyHMgxIEeBHIFxGMYhGIdgHIRxAMZ+GPtg7LUde4DshrErZEN2AtkBZDuMbSEgW4FsAbL5R9/54WYgm4BshBHaAGQ9kHW2ZB2QtSEga0JAVgNZFQKyMgRlJZAVISDLQ8889UxcVOs3WkcMPWLQNXVV+7Y2Q68KGXylgYcqQgZfrrKQ4ZcafqjE8IvrKgJQCKAAQCgfQB6AUC6AHGVDyIKQBSFTGSDSIaQpFUIqhBQlg0gCkQgiAUQCiDMg4hUHIhbEaRAxIE6BOKkTME7AiIZxHMYxGEdhHIFxBMZhGId0EMgBIPuB7IexD8ZeGHtg7LYdu2Hs0k4gO4DsALLdhmwDshVIaAuQzUA2A9kEZGMIyAYY60O2ZD2UdUDWhoCsCUFZA2R1CMiqEJT4qFavt4oYesSwa+qqNuz6qnxdZfCVIYOvCBl8eV1lhl8aAlASAlCsIgihQggFAEL5EPIg5IYg5CgbRFYIRCaIDAjpENJCIFJBpCgZRhKMRBAJIRhnYMTDiIMRCyJ0GkYMjFMwTsIInQASDeQ4kGNAjsI4AuOIp6vDQA75efWDQA4AOQBkP5B9QPaGgOwBshvILiC7gOwEsiMEZDuQbSEgW0NAtgDZHAKyKQRkI4wN9QFZH4KyDkhtQNaGnn7y6YSo11u8HjHwiGGHakIGXt2gKl9XGXyloYcqQgZfXleZ4ZeGAJQYfqgYQFEIQKEKABQYfr7yAOQCyAWQo+wQhCxlgsiAkHHV5Vemg0gDkQohBUIKhGQlgUgEkQAhdAZEPIg4ELEQTodAxIA4BeIkiNAJGNEwjoM4ZjNCR2EcgXEExmEdAnIQxkEYB2Dsh7EPRmgvkD0wQruB7IKxy4bshLEjBGQ7jNA227E1BCS0BcjmEIxN9cHYGIKxoT4oiVEtX2sZMfCIQYdqQoZd3aAqX1cZemXI4CtCBl8eMviyukoNP1QCoNjwQ0UAQoUqAJEfgpAHIBdAKAdCNoBQFoRMCKGMKy77XTqMNBCpIEIpMJJBJINIUiKMBBgJIM4oHkYcjFgYodMwYmCcCgE5CeQEjGgY0TCO6xiMYzCOwjgCI3QYyCEgB0NADgDZDyO0D8beEJA9MEK7gYR2AdkZArIjBGR7CMi2EJCt9QHZEgKyub6nGj+VFOXXrkYMuzbDrgkZdnWDqnxdZfCVIUMPVRh8qNzgQ2UqDRl+Scjwiw2/KASgMASgAEB+XXkQQrkgciBkhyBkQQhlQsiAkA4hlAYhVSkgQskwkkCEEmEkwDgDIhQPIw5EHIhYnYYR45iKgXEKxEmdgHECRnQIyHEYx2AcDcE4AiN0GMghGIdsx0EYoQNA9sMI7QsB2Qtjj+NqD4zQbhi76gOyMwRkR31AtoeAbKsPSkqUXyYZMezaDLumPgOvrqvKt7UZemXI0CtCBl8eMviyukoNP1QSglCsIgihQgCFAAqUDyAfQF5duRByQiCylQUjC0SmMkBkQEiHkBaCkAohJQQiWUkgEkEkgkgIgTgDIl5xNiMORqxOwzgNIwbEqRCMkzoB5ASM6BCQ4zCOwTgK4yiMIyEYh0NADoVgHNQBIAeA7AdSG5B92gukNhh7QjB21+c+2QWkNiA763vyiSdTo/yKvIhB12bQNQ2qvu6q6+u6rsrwQ5WGX5uhV9RVbvDlhl4WMvjSukp8WwKgOAShSIUQQgUAQvkA8gCEcgGEciBkh0BkKRNEKANGBoh0pYFIBRFKgZECIllJMEKJMBJgJIA4o3gYoTggcTBidRrGaRgxIE6BCJ2EcQJGKBpI6DiQ4zCOhWAc1REYocMwaoNxSAdh1AbjQF37gdQGYl9de2F8EZA99UFJi/Ir8iKGHTHoUE19Bl7doCpfVxl+qDIEoCJk8OUhgw+VGXyoNGT4JXUVAwgVQQgVQigAEMoHEMoDkGv4oRwAoWwAoSwImSEIGUoHkQ4hTakQQikgUkAkKwlEKBFEIogEnYEQigcRF4IRG4JxGkYoBkboFIyTMEInYISiYYSOwzgWsiHHgByFEToSAnI4BORQCEbooA05CORAfVD21wdkX32NH2+cHuUXf0UMuTZDrmmYYVc3qMrXVQZfWZ/BV4QMvjxk6GX1GXxpyPBLQoZfXFcRgFBhCEQBhPwQhLwQhNwQhJwQhGwIWSEImSEIGSEQ6RDSQhBSIaSEICSHbERSCEYiiIQQiDMhGPEhGHEgQrEwTodgxIRgnArBOBkCcSIEI7o+GMdDMI6FYBytD8iREJTDQGqDcahhQA7WByUzyi/+ihhybQZc0zCDrq7PsKsaVOnrUIXB12bw5XWVGX5thl4aMviSkMEX11Vk+KHCEICCEID8EIS8EIRc5UCoDUK2skBkQcgMgcgIgUhXGohQKohQCowUEMkhEEkhEIkhGAkhGGcUD6M2GHEgYiGETtuK2mDEhGCcquskjNpgnAjBiK4PxvH6YByrD8jRhgE5Uh+UrKimLzaNGHxthlzTMMOurs/Aq86q0vcrDb8iZPihcsMPlYUAhEoNPlRi8KFigw8VhQy/sD4ABXXlQwjlQQjlggjlgMjxFJUNIgtCKBNCbRAyQiDSlQYilAoilAIilAwilAQilAiiNhgJMM6EYMSHYITiYIRiYYROg6gvBkboVAjIyRCM0In6gETXB+R4w4Acq++JRk9kR/nVExHDrc1waxpmyDWqrs+gqxpU6evaDL6iPsMvDxl+WX2GXxoy/JL6DL84ZPBFIYMPFRp8qMDwQ/mGH8oLAcitKwdCKBtCKAtCbRAylQGhNgjpSoNQG4TUEIQUCKFkCKGkEIjEEIiE+mCcCcGIDwGJqw9EbH0wTodAnHZcxdQH41R9ME6eHZAT9UHJifIT9RFDr82Aaxpm0DWqrs+wqxpm6JUNqvB1heGHykMAQmUhAKUhAKGSEITiEIRQEYRQIYBQQQhCfghAKA9AKPcnPwz9JAdAKDsEISsEIZQJIZQBIZQegpEWghFKBRFKARFKDsFICoEIJYZgJIRghM6EYITiQzBCcSEocUBi6wNyuj4gpxXTMCCn6gs/jR7lJ+ojBl2bodacneFWN8yAqxpm0JUNqvB1bYZeXp/Bl4UMvvSLfnJBCYDaDL+4PgBFIQCF9UEoCEHIDwEI5YUg5IYg5IQgZIcAZNUHITMEIaM+EOkhCGn1gUitD0RKfTCSQyCS6gORWB+IhBCMBBBnGgYjvmEw4s4OSGx9jz/2eF6UnxOOGPIXGWjN2Rlu9VlVGfIXGXRlgyp8XWHYofKGGXxZXaUG/0WGXxIy+OIGFQEIFRp+fQUAagOQXx+EvBCE3Pog5NSVDaI2CFl1ZYKoLwNEbRDSG5QGojYQqQ1KgVEbiGQQXwQjqUGJMP4sGAlnB+NMw6AURPnpx4iBf5Fh13xJ1Qb95/3kgioD/yLDrqzPwCvOqtz36ysDUBuA0gaVAKgNQnF9AIrqg1BYVwGE+vJB1JcHor5cELWByKkPRnZdWSDqy4TxRSAy6kqH8UUg0kB8EZDU+mCkNAxIcsNgJH1ZQBIb1ujRRgVRfqYrcuF5F9Rm8BGDrvF085ede361oX+RIVerqmEGXdkwA69omIGXN6jM12WGHyoNGX59Jb4uARAqBlBfEYD6Cn1dCCFUYPj15fs6H0J9eRBCubV9/Tu5MHJCIOrLhlBfFojaIGTWByOjPhDpDYOR1jAYaUptGJCULwtIcsOgFEb5SZWIYX+RIdd8WYZdfXYGXq2qhhl0ZcMMu6I+g65QeX0GXq6yBpUCaFiJ75cYfqi4PghF9QEoUmEIRKigPgj59UHIVx6I+nJB1AYgpz4IOcquD0S2suqDkdkwGBkNA5Gh9LMDknZ2MNKU2jAoxVE+v48Y6p9lqDV/pWp/vtqQG1bl+1UG3bBK36807IZV+H6FIddX7utygw6V1WfYZSqtz7BLVVKfgZeouD5DL1ZRyNBDhfUBKFRBfQAKlF8fiHzlhSDUl+vrXAj15fg6B0TDsn0/G0bDsnw/C0bDMn0/E8aXlQHjL/KLWIqjfFQcMdQ/y0Br/laGW312Blx1dgZdeXaGXXF2Bl5+doZe1jBDL22YwZc0zOCLG2bwRQ0z+MKGGXzB2Rl+/tkZft7ZGX7u2Rl+ztnByP5bQck6u8ceeaw0yqeSEQP+iwy45m9l2NVfloFXfUmVhv4XGXrF2Rl8+VmVGf7ZlQL4swCUnFUxhLMrAvFnQSg8OwgFX1I+iL8IRN6XBSP3bwUj58v6T5THn4wY7pdVY7h/M4Ou/htVff+b36sy9LOrNPSzqzD4L6vc8P8iwy87OwClZweg5EsqhvAXQSj6kgpBfFkFIP5a+TD+ZjDy/lpQyqJ8ABYx/C/NwGv+XoZe/dcy/GpVnR2AKlWeHYBKVZwdgAqVnx2EcpU1DEKZSs8ORKlKzg5EiYrPDkaxis4ORpEK/1pACv5eQPL/Wo8+/Gh5lNf6iKH91Qyu5h/NMKv/VoZa9fcy4Mq/lkFX/LUMu/yvZeBlfy1DL/17ASj5W0Eo/kcCUayivxWUiii/XjhikH83w6z5r2Sw1f9Ihlz19zLsyr+XoVf8vQy//O9l+GX/SBBK/yuBKPlHglIZ5bk4Yth/NwOu+e9k4NX/aAZf9Y9k+JX/SAAq/pEglP+jgSj77wSk9B/pP1H84u5vfOWb+sZ/pRrD+59Ubaj/naoM+b9apYH/d6ow/P9J5RD+y/kdDVVRbvuIAf+3Mtia/40MukbV/5MMvup/EoDK/61gVPx3e+ShR6qjrEvEMP7XM6Caf2YGWv3PysCrVfX/RlBqovyfiOH9UzO8iGr+b+7fo75SUzf8APBP6wsUf9PIP6+v/BP/Xv/Mf67/nb9XWJLa3zT0yIOP/P/9XzKD4PH/ABYzZXBSXEBtAAAAAElFTkSuQmCC)",height:"101px",left:"47px",top:"47px",width:"101px"},ADVWHEEL:{background:xui.browser.ie6?null:"url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAMMAAADDCAYAAAA/f6WqAAAAB3RJTUUH1gcOCDIojJpTggAALYlJREFUeNrtnXmYHUW58H9V1WdmMtlDQtijSSDKorLovRAWAwqyiBJugoCK6CfqRdSLityLkIsiF9SIyqIsRhZBlu+TK0JEQBBFUEAEZQ9LgkCABBPIJJnMdFd9f5wzM2d6qrqr+/SZmUy6nqef06e6z9Ld76/epd6qgrKUpSxlKUtZylKWspSlLGVxF1HeguKLAQmTp0JlOuitQU+BaHJ105NBj4JoDEQKolYwoxAmQtKBxKBYi6ITxWokK1GsQPI6ilcQLEWxjBfpFGDKu13CMBwEXsA2bTB+BzA7Qbgz6B0hmgl6GugxEAG6tkX0va/fr70XBhQgqb72bLb3kgjFy0ieQ/EUiscQPErAo/yNlaL6pWUpYWia8Cv4l21BzwYzG6K9IHo7mBarcPcTfG0BwROGNED67xsUy5E8gOSPBNyD5mH+VGqREoaGhX+/KSD3h+j9EL231uILt+AnaYACYcgCiKADxZ+R3IHgNlp4jFvpKuEoYUgBYL8A2mYB80AfDGZXiCp+gu8CwXY8AYaigHABInkJyW+R3Mga7uBu1pZglDDUAJinIJoOZh5ER0L0LjDSLsjaQ9BThN5VlwZDEUD0hwIkK1DcguQ61vN7cTPrShg2Sef3Q+Nh1GGgPwF6X9CV/K2/zghCThgaAUWmOuXLEPwcxZW8wBJxN2EJw4g3g6btCOLTEM0DPdXd6usMTnAW08hxrB4Gl3AH/YR3YF3Pq+08l3YIYucJulH8HskiWrlJXERHCcOIguC4NmjbB6KTQB8EumWgIOuMwp0Vjoww2IAIKN6UkgM0RP37JUguJeBKfshrI923ECMbghPaITgMzMmg31ONBLkEX3uaP41C4DgnDkMQa8HjMKiCwZBOvwIUKxFcTsAFLOQfI7UfQ4xMCL48GsLDgK+A3qNP2NNMH90kCNLMJgcMPj6ELxg2gQ88YOj/ugrJIgQX0MYL4syRBYUYWRCc1AptBwFngN7dHQnKA4GPo5xUlwJLEgxZBD5wCH1WcylZW6xCcAkB3xdn8koJw7CCYIGEaCcwZ4I+HLRyh0V9Wn2dQ6C1p4lUAAxJgGQxpdIiTK7XvnOXYvgGa7heLGTtxi5HcuMH4VtTQJ4N8o8gjwChqozXb5KBdSQcc21g/245NO2K628Iy99JuwwRuwyfWyh4CwGL2IxbzDnsba5HlTAMkUlk+NZc0PeA+BrIsenSkf50/QBwSdww1Pu+ly499utva/9z9kNwGy/wPfNttihhGDQIEIZzt4dtLgd5PcgdskGQZ8Mi/Hm+owmCPRSbDRbJKARfoMI95gfMNwtoK2Form/QBucdD8EfQH4EpHILv3S85tEOvsJdMBhZv6Z5gu7WEvE2SDEDyTVswU/NhWxbwtAUEH6wDUy+FOSlIKfadLW/VpANCn+jrX9B5lWjFl6WWyQTXgfWKeAjVLjL/ITDzAKCEoZCIJinDD/+AAR3gvgoSJluFskM2sH2HUU1szmBSPu478/JDIKfdgvTbqe0tkkzENzAWznHXMTEEoaGQLi4HQ78Ksj/C2p71x3P1pTZzofGfQhvqTZAN9AJrK1tbwJravvrgK5azNX9dUWYSdIRQUozh4SHU913bhuSLzOGX5irmDXc4w3DFISfbgFiIURHV9MojKW/QJPcsZanL8GzX8C5hRFE6yFcD3otRMsgeh7ClyH8J4SrIHoD9Bro6qyez3qgQkArCoVkDAHjUYwnYBIBUwiYRsAMFJuhaEPRTkCFAJHYv5Clv6K+r0KSrWNOpuz3ZMbC51DcJuZbYC9hsIFwza6gL4NoN7fw+/QupwHQQCdZddMQroNoNURPQPgg6Ceg+3nQS+GZ5YJiH7qZzngqbIdkOhVmongHinejmErAWAIquTvusiT3JeUyJQPSAfw3a7hQHE9nCYM7WiRh54MgvAz0VunCn0cz5Emr6N0MhJ0QrYDoftB3QfgIrH9M8MjqIbtv+xHQxUwUO6PYE8X+KKahGEeAStQasgEgkjTDQK1QX6cRXIThdHEEq0sYBoDwYAWWfRKib4MZlw5AxEDTqdG0bBcA0TqIXoDoFtC/gbV/EdyzatiamPsRUOHtVJhNhblI3oViEgHKy4RKy4LtEe7AA4Iks0lwM4bPig/yUglDLwg3tYM+tbZV0k2jpHyjJCiSxigPgKATwuerAES3QHS/4OaNblikAcFcZqI4AMlcAnZHMYGgFgBNM5V8/Qfbe5noP/TUP4Tgo+JAntjkYTDcNQY6zgZ9YnXscSMQZMlGtYKgQa+E6G4Ir4aOOwU3rWGEFAOSY9iJVo5EMg/FTBQtmf0IHxCUFwg9GmIJAUeJ9/LXTRYGw+3jofs8MJ/oP/CmZzMeplIaCF7aIaqZQdfChqsEVz3BCC/mWMYxhkNRnIDi3QS0o2qRKVfqt8wAhy8Q9ZEmwTHsx31DNaJODB0It04C9SPQ8/3MoiwOs7dmiEA/B9Fl0HWV4JLlbGLFzKOFrZiD4osE7ItktNOx9knz9neibdtyJB9nL347FECIoQHh9vGgLqmCYAoEwXuEmga9DKJFsP4ywUWvsIkXcwIVJvF+JCfXIlLtmUFQHjCkA/EaAUeKPbhnxMNg+NM46Dof9Mft5lBen8ErgmQgehX05dB5keB7/6As/Z/PSbQynkNp4atIdkfV9Vv4hliTzKN0cwkEL6GYL3bj3hELg+E3o2H098CcMBAA4wGAacA8CteCvhHEtwVn/L0U+5Rn9TXGM4GPIjkZyVt7e7obgcEHhD4gliGZK97JQyMOhmo/QvhNMKf0OcvGA4asKRgDHGZd7RXWC6Dzl4Izw1LUMzy3bzMDxQICjkTRnjjnUp6+BjsIPftP08LBYhbPjRgYqj3LH/wcmO+DDuwANAKDE4Q3wFwF684RfP2lUrRzPr+LqbCBuSjOQPE2VK2PwqdHOq926APiHhRzxQ6s2OhhqE7l+JcPgrgazJhk08jk1AoDHGYN0eNVLfT6bwRnlusVFPEsz2crWvgGAcegGOXVz5A9olSVStUPiJ8zhk+LLZs76cAgwPD4bhAthmiqn5/gA0RSx1vYCdENoE8TnFg6yM3QEq18FMkCJNv19k34RpOy+A19GsIgOJdlnC7mNG8OWNFcEJ6dCht+DXpXf7PIBwhnROk10N+AsZcK5neVotvEZ3s576CFHxKwNxLlBUNWEPqbSxsQfIptuUaI5vRBiOaB8GA7jF0E+qg+4faFISsQkQH9GIRfEHzirlJUBwmIq5lMC2ehOA5FW2KOUh4QBg4tXYnkELEVDzTjemRzQDASJn4J5Dz7lamMdyHxPA3yTlAfLkEY3CKOZSUv80UkZyB5I5ew26fHt4OkmIzgJ+bV5kxH06Rhny8cAPK06nhlm1clPO6KV1MSgrwO5NGCo58txXMIgPgiG/grCxGchOTV1MemUh6zcoLQE87dBcV3jaFl2JtJhqVbgrwLzCy3aZSlw81pGnXXcopOEczvKMVyGJhNt3EIkh+j2DZRoPOYSf3NpYiAzzCORUXmMMliQTAVqJwLalZygFmQX59KQG4AdR50fbkEYRhpiQNZjORjSJ5FYgqNLPUXJYXgf1jDTsPYTHrtGFBHu+cOSRsB4nVX1oH4FnScLpi/vhTBYQbE/tyN4WgUj6NiQLh6q33Npv7t6RQCLjCG0cPOTDL8cxroe6tjl02CWZQUUTIpppHeANHZIM4WzCnTKoazyXQ/uyK4DslMJKKBHuiBnXD9X79Che8VEW4VxYBgAlh9OZhj7RAYTxCiBP8h6gJzLrx8Vk8fgjGm7FkeIgXgPCBE7zHzAO8h4OcopjtGuKXHVUTKvmAVitlCND5stCAY3vww6BuAYKDwpznNPs6zCUFfDOu+IpjTO72IMaZrOFz/EP32UH7eCwYA8zD7U+FqJFvk6ltwOdK1VyPACBZLmCsEG4ZUGAxvbAbqPjDb24U/i3awwRLpaup15/GCvfuNRzbGrB3EaxcFnCMG+f8U9d+8/3scBgDzGEehuATFuLpVRf1iKo75XI3oe9WgNRzfKrhyyGAwGAFd3wR9mlsT2LSEC4q4mRSZ6voL+kjBbgOyFo0xqxoQNNEEYRVDCEqzrj9TnRUGEDzDSQjO7ddT7asZ7NogLllLu+A940T+7NYGYejcEeR91XmOkkwjHy1h1Q7PAIcKdnza+vvGrMhwTWIQIRGD9Ps+5zb7+0TMTJL2Z0XAUhYScGJvLpMtUzVhlu8ebaCFs4n9zhj4Wl5nWuQHwQTA9aCPSIYgyTxKNJlWgT5G8LZbnf/BmJcyPsyGH3ZOYRMb0ffn+S6RBgOAWck4urgBwfv7RZg8zCPTZxINkKq6/Y4QZk8S/G1QYejGHCzhJoEJql+SVytY07i7QP8nzDgvqYfRGLM06cEU8XBzfGeW80WD/6VZv5P7s0kwAJgXmEkri1Fs7wVB7dvi2iDBAP/VJDhCiOxz3IqcWqHSBXdK2Lsn3bz6ZYb8TrSp9xOuh67jBDskRgeMMUsyCE8RIOQVHFHQ8WYJtiiqLg0GAPMah1LhWiRjXH5CzEFOBaFOokIFcyaJ7LNr5IKhE3OogZskyP5T9Zve1+waofczS2D9+wQzXki9qcY8nvGBNyqAIid8RQleoYLr8epzLDsMBsEazkVwci21YgAIBn8QLFAsngqHZ9UOIo9WWAt3ippWsK9lUa8pMmmItaCPFWzxS6//YswjOYRBDJJgFfm5Is91fdanEUl69YYBwKxiAi3cgmLPHv/B5SBnAaFWFxrYf2vBH7LIdua1tt6EA4G96gEwdSBU90Vd0pOqQVF/po69CqqhYnE5XPirTK5L9pasaIHJKrB5fyuPgMbPNY738f363zEpdfWf92+FJ7LarOVkJL9GMdFYTKKsENTVBxr+0xj+KAS6KZrBYNQquF3AHJ8lhWXMfErWCtHTEOwnGOM9u50x5r6M2iDPa14zwxe0PN8lMv5n399Nq3Mdr3egMy2MbgxnaTjVgGoEBEtdGMLsGYL7m6IZVsBeAvZ1aYX6OtnvmKgBIeu0RD+tsAHU1wXtWad57M7Q0mcRwqyCluXz3oLlccz3901KnU+jaSz31hQQmfyuhkM07OobezR+YATAfxjDMb79Dt4wLMBIAyebatcIWACoh8JlOonavug7y4BcDC035orwNi6kaQLrC1bS7+eBQWT8ftt7E9tPOm6DxniYTA0VIVjdaTjDwPUaRukcELhMJgMffgpmAU8WaiYtx+xk4CEBLVmWDXavvdnrZP8T5P4C8UhmZ96YW5uh6nEvKisyAiRShDftu/N+n0i5bt/PCs//Vu9Aq+zPEdUB1xo4Uldbx8TwqQcEvceBC94mOKlQzRDCcS4Q4k2MTNAUfa8CAVohFuUBIaYZsgp9ViH0FTAfOLK+9xXGrIIsPZzjNIe5kKxfIYjWGM6MYH8NkzxCp17mUm37yNOG03YQvFkIDC9h2rvhWN81to0HJLXXVzfADxq4j905W/9mtqJ5W9ws/62+Tub8j9oRZRIpPoMrgtQQGGMFj64wXGPgRBPTDnm0Qt02eT0cAVyR9h+8YsKdVQdnqyyrISettRlVNY0O4ZLRiBcbhCFtCxPeh3Vbt2PftnUn1MUuc0Bd5FnnM0OCsfVaWupMhjrXhuUVhzOdq2j4voaVPstP+ixNWXdxn1xg0mU9lWaDEc/AzQIOyboAfXK4lZcE7DYW8Vrem2eM+VmDtrpPnSiotZc5fzvtPJnhs83aeq8tj8/QzwoxLNTwHz3awaYRyKYZalY+79xN8HhDZtKTsKWAA7LecekwnUxfJ+MVExsAoVa6ChTWLALo+9n649rzvKy32uQUXhP7vUb6pgrzH9bDjyvwSQMTsoRUiYFC/+OBgY8AZzRkJkUwV0OrzzKBOkF9xepWGbikgHvXnWNLM3fClM/4mlKhxUxy1UU5N98pyxOTwVLMpbgJFD9WqKk0U7Akgv8XgklamNhncYLYNv96g8qtGQxGPArzohzOsnBrBiPguimIZQXAEGYMS+Zp/X1b86Tv0I46mxbQHorWdcttXUDxvlBivyFjTrUcaMoPiDzFHehCx5ILuEDDRzSMzuEwD6C49vkdtoJdgQdzwfAIvEXAnjQgMZantl7CTwu6b90Z4+CNCr/M4A+k1aWZTtKjnZEOgdcOv0J71NmAMI4IeVNMpbfAI0/CHzUcaHJA4NgEcFRuGCI4TEDFN/aX9LTqDNS/bE1h63R1eQiqLxTS47hO+WzSucIhpGk2vchwjsvfMAxMLtYJmiEOhImBEBd+U6R2EALzqOEKA3M0VBqBIGbXfcgYTnGlZyTAYISBg4yj6ZUWMGwSEXtaoYFFAqEL1AxZW+8iIi8yQ4svE0wXFxw6BRjpMImwdO2kQU0KEMLiI8TrmjHlzk0hvGxgWh4AtCUWbGDGHbA98HQmGB6EURHs49IEJqWu3siseyKvATcWeMO6M9jwPnUyIxB4tPARfhkrLnPIODSCsfgCBnvOpIx1ssXNJCyaAIcTLYrWBLays6DjL4ZrIjiVujBr1s6Q2DGp4f2ZYeiCvYBxcS3gep8ERt3+r3dAvFHgPQubHGOXnsddLbm27MuYA+0j+PH38dBo/HbLmBYwlscU1xRxhU6d7yoHwzyymOk3aviSgVG+ppAjtFoPyYHAhZlgiOB9OLSASdEIWJ4w0CXgfwu+X12DJPhJpk7asA6RAIF2QCUTQLAlBUsGZs9Lh2kUb8fiZpELgDgEJmYuFQ7GUnhoK3gW2NnDH3Bpg/j+fosNrYdYZt8LXP5CBPvkyTwz7qZ6JVD0yjrdBdr5WTSCfbRr8nHtcaxeqHVCJ5kruiMtoU8bFDJmHtnqfGWsaZphviD6g+EXGnbq6ZHGw0ewmUx1x8dreBfwZy8YfgPtGnbzScK33X2Hl7p4d8TaYQCDSGjls9S5nF9bK+8KXwrHvq7TDjZzxWYyxf2GtDoXEMbS2rvqbB1yhZYQfmXgq9TGOvjAQLp22NsbBgF7aGhzAeBrMtVHkTTc0YTGo5viHN1GWn7XexcIwmLX21p9bdEA2qEdbEJvYvuqTm6wdNTVD04nBqgLCNFkLfFwBK8Ab9X+plCaQz0bWBj/IVc6xt6+XeEJ3d/1+QbrgN81CQafbFVbmoUt/SIpJSNL+kVaykZStmpIcpqGLRlYk57x6lp02zXs2KfjtynaoL7MEYQh3OFzM9Lq627WXrYs1sChmt5ta/mT6lL8i0dnI14dIs2Q1fzx0R6S9AF9OsEk0rFzjeO4TQu4Wn1jCY/aepJtDaC0aAzfKGbTp/XX8DsDx9fGNXs50ZCYXLX5DJgGPJ8CgxEadrGZRXFV4vIbLHD8sUn3qSgYpKf5IzPAIRMAS1q+Ly26Y1KO9dQpiwAnJWbGv98XjKZrhxDuN9XIYeDjJJMCRrWTm11SYVgMY7urOUkDhD5tigTHFBKhhD81EYYsznCaRiAmnHgKc2Spiwusy4GWFqfZJuz1Ah73H+LPXaaYwRY3sZ+fEAfL1gs9KCAAHA7P/gKWAzOSWn0PjVD/fhfgpkQYumFHXXcT07SCSIFBQOf6hOSogmDI6+SKlNbbt+X3eXUtyJTU0tvMJOlwklXsNa01t2mGJCjSvqdpUAiBud5wXxyGJMHXjj9WV79zqs/QBbu4Jh8yDhhSzKkXDod/DLKZJGksWlSE8MsEPyIu7PHlOXQCLEmmT1aNYNMOtkiWtsDBYJpLEdwr4JiehjpN8E1CzLd2MekwGNhe4zcHYhIMddri73X9JUMBQ5L5k0X4XX6AzZySHr6By0ewQSBJnxVFZdQEceWuU4AwGeSt8GLgqbAaYWvJoQUG/LkQZi4wyDPrpp8MLM7KdNdIDiyhA+k4Vvu8MSSPOx0EMylJ+NPMpEY1RBoItgVeXVDUH7OdB96ZzE67P2lGwqwTBBStGZ6Oqs/bG4YUWtu2hq2AF50waJhuPIWfBGh07zX4zWaWs3Q5hNRX+Mkh8FkiQ2mtv80kskWNkjrS6h+FItuQTNss0EkAJGmKppaPwUs/gVVQXQTdVz3phJsgYXoiDBFMT1oYIGl+QYs5FZpY+KoJmsFX+H3Mn0Yd4qSl+RTJS3271rGJawRXNoJ0+JQueUlacUg6zCWRYno1rwhMZFgCbJOh9U/09HUVht9bYfgpZoKGcSIh3ECC1rDMQBUKeKGJtygkexKdzOEwZzWFbFBoS51J0BhJGkHG4LBFler3SXhUrnTzeJdRnghV0Z1vzxmYYzyFPUkl1gh/i9OB7obNlaNHsSeYnhGGtR9vTs9zWj9DHi2RxfxpxDeIw5CkGWy+gcrQ+vtGkbAIvw8Ag6ohwioM/Xq9jR0aLxvRwBQnDBo2czUhUcpdtMFgmhdSTfIZfNIlmgmDzFCXpBHix5VFOxiHlqjvc3A5uq7Hlzbm2qSEe5vZ8r0o+oIJia2+cUel6vc3S4Jhiklu6Z130mZKGXi9yTB0F+An5DGRfPyEtDqfTVn6FOJ1PmaRSdEMPhDYhH9Qi4FV2gMGl3awhNDcmiGEKfEBtFlAIBaSYOhgyGMa5QmRpqxl3/BmUuqUBYI0c8k42jkXCPFxGTLFRGvmw14t6uTcpAh82p/SSTAIGOPzJcLjeA2mfzbfjMzkM8iMmsKnTnn6DMpyXFmO+8IQd55VgqaoN5mIWb1xS9g2e0fS4J9BC7GGsEp6wpCmHWplTJJmaBd+Qu7llQ0CDF0ZQqZJHWl5o0eupDtf/yAeMq2HQqXAYNMIqgEHuh4KYemDiHcADnrnWxesrtRk3PeHUhr3dicMUW0xEtedynqlBlYPIzMpr/BnjRjZWvk0bRDV7RuH8yxjEOAAIwkSm0kU1WkL11iMLDO0NLO8GTb4OzEbstUJgwEV75ExBf3wRghDI0BozwhRvIdZxLSFzVwyjqhSHJKefeVW3APg0HVQRHV19Vt8xr1B8xnWgWmluNFEJnZv4tGksUX2kWhYOwxgaDSvKClalOQfiDqhttW5IDEOAJKiS1giTGmCqiymURIIrmGgg1baYW036AK/MtFnKKwIiv3X1t8Q1WkqjTHC0cq6Jgo3jtbYNnAm3hoL0meOiMcZXIm9NoESObp00pa50ikhU+FpGhEDgsEGImrid8d9ho4Cv1tSS6rayMugjPMti5eZNNrkG6vhKmuSzKRQDAXuZSmLR+kEERT0XcISfY3D0FWUM1w7f0L5CMtSYBnXXR3Mn1lVO2zPDUkwrDN+Qp56Tm2bVD6/shQYLZkga2aSaACCumPrUn2GRoCIeYQlDGUprIQwUYIUHoIO9lXfY7La4YQhhBW+wWPjAYOwZMGWpSwNRDImRHUwJAFhG3IQ1xgGVjhhMLAi/gU6Iwyx8aglDGUprGiYSCyaJNyC7mM2rUjyGV7Pkh/uMcRu2/IRlqWo0gXbKA8YpKf/EB9iIGM+w2tR3fq78Vlssy5MHMLoT2Gmlo+xLAVphukhiLwLZlvqVjhh+AFitYY3fRahTlsgvbYFErYrH2NZCnKgp4f5hH7Ae1PdX5qoUSJ4rj4RxWf6b9vc6rX9IIS3lo+xLAV4z6Jngrs0INJAqJua/jmnz0DfCbu6/ACT7DDH/QcFvK18kmVptHwAtg5hou/M8Lb38c465QNDmmOcYWo/AexYPsqyNFoE7BBCRVqE3DXLQdLMkEDnLHg5EYYIluTQAE5IDOwCRjRxvtWybBJWErM0BMYTBkHyFKkCnqmfZ9XlM/zdZmuZDL5DbNvusDLEWpbGI0l7hSDzLGOlLT5DCI/Gf8M28fDjom4kU5oWSBsIq6EtgD1o7sx6ZRnhznMEe9q0QNos8HFtIfrkcgAMAzTD1bBGw1JfLZAUau2JKEXwr+UTLUvesi/MDGHLyDOSpD00h4G/p2oGEEZj/m5is3H7agTHvIezy0dalrwlgncLaPFYO3CABnDUmdACg3T8+AO2tVKT1lpN6X/Yef+yJ7os+WF4r65aGF5ZETZZjdW9djss84KhG+7J28XtOK9dwHvLx1qWHP5CEMH7fHqeM6QN3YsYmINqhWEtPKih00VXGomWLdDwvvLJliVr2RXeFcEWEf5awOXL1smndSlmKwy3w7oIHtIeP5ghxHrIOzCjy8dbliwlhA9G0JY3Mc8GRwj3eMNQdaL5g2/Sk6c3P3k0zCkfb1kymEhKw9zIkqmqM8hkTDu88Qo8nAEGCOGOPFohwZxq0fDh8gmXxbfsALtpmOHrC6TJaO393c+I/hMBpMKwEu4Na+ncOoXKDI7LwbtjxpePuSw+RcMRcRMpTdZ0SuPcDbe5fs8Jw19gvYY/pNlfaZGlWBRg8xCOKB9zWdLKFMOYCI6JEgbzJDXEDi2hu+D2zDCAMBH8JgsAOj36FETwKTCyfNxlSSqtcHgEW2VxmD3k89m/1RJRM8IAGm7W0K09QlgZPP3dZsFu5eMuS4LjLDQcF0El7xBPW8Mcwi8R7klfEmH4AywN4b5GQqqWPzVKw/HlEy+L00SCd4YwO0tOXJK5VNuMgeuSfjfFXBFGww05+hSSHBsRwVFvwUwrH3tZbCWEz2to90nP9oGkduzpR+GvDcAAG+AXEWxw+QRpuUsOWidqOKF87GWJl7GG7Q0cmda3kLUhDuF6RPKM9qkw/BWWR/Bbn8hRBnNKRnDcVMzm5eMvS393gc9GMD7J1HbJXEJiXmjg2rTf9ojqCKPhp0k/6mO3Weq2BP69fPxl6Y0gGWaE8DENIq1T1wWItoNy7zPwZAEwwKuwOISXfbSDT1Jf7ZjUcMIkzDalGJSl5it8ScPkLAN1fML7ISyyZanmgmE5Yp2Gq3WCNvDJUbJc2FQNXyzFoCwYdtaxTra0ccyefWAr18KNPn9B+v9XroigK01FaT8I6n2HT7Zj3llKwyYNggKxwMDEPONmUhroa/8peLNQGJ6AJzQsTnJefHunLZGlBWCCUio21aIOBnUoKEHNntGe1oUmscOtsxsu9P0XGdIihI5gYQRRXtPIEXUSGg5RZc7SpqoVJkDlG6BG1a8KbGpQRBmgsIDxv6/DU02AAZ6D+wz83icnJCkcZoGj1cBZYLYopWNTK2O/AuodVQjiW34oNITdcF5S+kVDMICIumGhri547kWo9gREw0wEXy+T+DYlrTD2X0D9OyhVD8DANePFgImw00x0Dbe/CQ9m+TuZBe8luE3DvQlEeneU9E4PLgCFRPEJWvhgKSWbAgjjJ0Dr90BN6A9B0tYfioSGOOyC//EJpzYEA4juLjgnimmHtE4Q2zFDrCFQjEbxHdpMuabDyPYTBIz6L1D/Ul2izaUVlONV9E536rBEbuuEe7P+rVwmyco67ZBmFrmAQFiuu7rNpMK3wbSWUjNSy9aHgPpcn3kkGQiESgGiCoVF3sKoqhWiQYEBRHcEZ2sIPXNDel+NsFxb/2sXKI5gIp+vnV2WEaUVtpkJwXmgxgzUADIHEH1Q1GRscQj35flruZ3VVXB7BL/yBaFXG7iut399CwGnMYWDSukZSSDMHAejLoRg5sBWUGY0ldQALWGgw8DpebRCQzCACDV8vX4NOBcIA7SBdJpI9dtEAs5nK7NDKUUjwk8IIPgmyAP6/ATpEGwfEGzniB9hmUN1EGCADngihPNdDnSvg5x0HQp3IxEwg4DL2MJMKaVpY3eYdzkR1Akglbt1lwnvU02lpWC+k6VfoVAYQJgNcF4ES5wmkXQArxLuRX//YTaj+RGzzNhSqjbWsut8kN8A1ebWCK79JEHq/R4NagGi/1K2gwwDgHhdwyk9znSiNvABYOB9kUg+BJzDNNNWCtbGphXesz+o70MwLtlOTmo1U0Ott0LndQ1LckFXHACXIzi2F2TXqxwQCPAAH5B0ITmXiLN4XHSVUrYxgPCv7wHxc9DTk3NLezbj2K9/b2L7ehVEsxEdTzT6dwtKfRAhcBqSl1Odf5ViMrn8CEULklNo49Qyw3VjAGHfXaHyM1Bvdbf8MqN2sGkJvgUdTxYixYXegIo5DsllCIIBrb5oSCvUb+tQnMMazi01xHAF4YB3g74czNtBC/dQMJOiHVzaovf1blhxKIK1ww8GTIVWfoLiY06hrzebVAoc7kDDBiQ/IOK/+ZNYX0rfcALhA/uB/gmY6RAJP/PIx1SKgxCtAPZHvPpoUX+9+B7edrMlkruQzLICIHNuAzVlN4pL0XyNu0VHKYXDAYRDDwF+DHpbv6kj8voMOoLoM7B8USOh1Cb5DHVlnViO5CQk65w97Ao/MzKpj0JSQXICLVzCB8p+iKGFAImZ+zGoLAK1rZ8vkGYPi6Rj18Lyq4oEoTmaoXp3JJM4Fck3kUjvaJJKMKHc7zWKu9B8hlvFs6VkDrpZ1ArjvwD6NIjGJw/Vr2/lXT6DTvIRAP13iA5ELHul6EtpYiKcaWdzfoLkI4l+gfBsQJL7JgySxwj4Ar8Qd5USOlggHD0Z1FkQHgemLXlmrSjFUfYymVZCeAji+QeacTnNzQrd3ExF8WsUu2aKIPmAYDefXkPyDeBSbigjTc0F4VPvgOiHoPeGSPkBkAWIATBsAP0peOqaos2jwYEBYEuzGwGLUUzNBYMrf8vdMdmJ4gYqnMbl4h+l1BYNwQkV4KNgFkC0XTV0GnkKvy8QA+oMROfCE6cjCJt1ac0fb7ycvwInIOjI5E8lgZD8mTYkx2JYzPHm4HJMdZEgnLgVVH4E6kKQ06rZp42qea8OqGuhclYzQRgczdDjUM/gc0i+j6x1yCkPLZElodFuOr1BwFUYzuFi8VIpzY1ogzFzITod9NtBS/c8FT7h1DTtUP8+ugfMXMTDK5p9mYM4ksxUmMU3UZyCROTqgfaBYWDqh0bxBJIFPMIvuVuEpXRneWxfmQFqAegjIWpPXrfJd1pqb4f5adAHIx58bjAudXCHVU41o5nMQhSfyeQ7pCU7puVBVffXIrkRwXf4rvhbKeVpEHxtPLR+FPTJEL21rzc5bUFknxU80mDQgFkGG+Yi/vLQYF3y4I8xnmnGMZrzkXy8KTAkgaEwKF5FcgVwId8qHeyBEPygFToOheiroHcHXUmd8N1r33iYT72pFi9CdBTivnsH89KHZsD97mY8cAmS+Q050T6v9jEjmoBlKBbRymWcIl4pIbi4Ah3vh+hkiPasmkQ+k/7oHBoicXsNuo9E/PGewb4FQzf7xI5mEmP4ESoBCIV/eobKAEPfFqF4DsllGH7G18TLmx4EC1pg8hzQXwS9L0Sjk9dj8lkZPC8I0XKIPga/u7NZfQnDE4YeDdHK91Ac3+tUZ8tPyqYVJBBYz4kI+AeKa5FcyYniiZEPwcXjQR4K0Qmg96g5xyLdJEozl9I63FwdbdEyMMcgbrt3qG7J0M9LtJ8Zg+FsJCfWhnjm8x3ShtbWw+AaVBSgkbyO4ncEXI3mTv6PWDOCtICE7XcCcySE80HPgKjFb7W+PP5CUii1X27SEgiPQtz616G8PcNjkq7dTTvjORXJqSgqDadlpDvS/evsgHQS8DyKW2jhFlq5n8PFuo0PAAT8aiZ0HwDhXAh3Bz0BIpm+IJSPv5AlH8m6PQTRsYibnxzqWzV8Zqzb3VSYxCeRfJuAcdbsVd/UjCwgpG8GxToULxBwCxVuw/Agh4lVwxeAuwII3w7de4M+AqJ3gZ4EofJbB8d3xbQsZpJthFt0M2z4LOKWYdEhOsymbzSSgzkIyWUotvLWCD490kEKIGlb0AtGJ4oVVHgAyV0EPIzgcfYZQjjMXQGMnQnrdwG9J0RzQE+DaFwVgKzLimfRCLk62zToi8B8HXHDG8NF+obnXKaHm10RXIZit960DZXDf0gPsbocahsItjpd0xpvEPAEAQ8geBLJc7SzlO1ZjhBRsYL/7HhgO+icDnp7CN8B+t0Qbg7hWIgq/QU1xHsxYnyXFvTRDM76DogWwMsXIe7uHE5iN3wn9j3EbMEoFqI4ul+kKW9vdJpjbRN86YAhSAQmQtFJhXW1Xu9lKJ6nhZeR/JOAVSjeoMIaJJ0ERFRYD90VoLWaDt01ttqqMx7CSRBOgXAaRDMg2gx0G4TtNcEX/YU6JB8MWcOoefoVomXQ/Tnovg1xQzTcRG54z3J9mGlnNCchOR3F6NwzEPoAoRJ8i8BTawQJwFToW5kpIKyFc6PauRFSi5pTK6A7AK2qYEQJQu1zLKtfkBY9ytvrHP2u6h9c/dRwFbfhnd58s1iH5rso/g3BEufEAj4Tl9XXxetdm8859ZuruRH93guggqANwWgEo4FxwFhgNNAOoqWGTsIX2Y75bDLjcdeNTdvvPb8TxELonDucQRj+MADcICJ+Jm5Fsz+CnyHQqc8r6bnLjLLhC4DrOwtX2PEfLwqSLDcnDYLeumdBzoOnTkVcs2q4i9rGM/DlavEihk8j+TSCV1PHhAjPBi1N0PPIkI+si0aAiJ+T96JkxgtMaoX6HYuqM1hEcxAX3oy4e6NIm9+4RoFdITq5lJ8C+yC4FkHopamFBxBpWiSTICfIrMj6wSwfEgVtPjfK2co8A+IYWH084kcbVVbwRjgkUhguFktQfALDUcDTTm2Q10zOoiFkgq8hizCZ6h+Va8ur2ijoJklArgfxQzD7IBZej7iic2OTrI13fPD5YgMXiF8QsTdwLoI1drO1yT7C8G44CtYYTrV7N5gD4ZmTEd/daNPhN/7B8ueLFYzmv4DZtZFsUaYGrSi/YVgIfpKN53uhMov2WArmk9BxKOJb9wzHvoOR08+QtZxkWpnAgQScgWSP1MxWnzEPPkl+efKeBnwuS85QWkeZz3FXz7JXZ9oqiC6B6DzEaa+OFPEZmUvLftmMZhKHIvkqkj1S0zTyJPVlzW+SRcGgyZdg10iaRVQHgV4E0fnQ8Q/EmXokic3IXmd5gWlnFIdR4WQk70HV0jp8YZAFgWFLEvSGIQ0Cn9Zfe9QlQrASwsthwwUjEYJNA4Y+KNqYyD4oTkJyUG0VIP90jaxp4ElawAmUT1pEoxAknWeFYQmYS2HdlfDF1xDCjGQx2TRg6IMiYHN2pMKngXkETE1cilfGWnJJtoFCSblNMg0G3YAfkPZdtvN684i6Qd9dNYc6foX4/Caz9sWmBUNvMYLzGM84DiPgEyj27R1h55vlakv/lp5aIBWGNBB8tUgmv2AZRD8HcSU8uQRx5iY32domCkNdud4oupmOZB6KI1G8C4nM5UNk9SlkVhiS6vOkYEcrILoFzHVQ+T3i8HWbsiiUMNSXu0zASmZR4d+QHFwbXFTJPAVNnjqpG2z5faZ7jAD9IoR3grkR1t4B89aOdF+ghKFhS8pIbmIKo9gfwfuRzEExDYXIPGCoKTB4j0/ugOjPYG6H7ttg1WMwv3so5iUqYRhJ5tQUtqXCbCSzUeyF5O0oWgoBIhEG7esgG9DLQd8P0b1g7oHoYdizs2z9SxiaqTkES2llFbNQ7ETAzkh2RDKzpkHGZAJEag8N0HssAv0yRM+Bfgq6HwPzKISPwo0rR2o/QAnDxmpiLWMqMJ1WtgamoJiMYjKSyQSMQjIGhULQhqINpaPqYHltIFoLUSdEq6sdXtEK0K9D9AqYpRAtQ2xXrn9dlrKUpSxlKUtZylKWwSj/HyHl/ePsagXCAAAAAElFTkSuQmCC)",height:"195px",width:"195px"},"ADVMARK1, ADVMARK2":{background:xui.browser.ie6?null:"url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABEAAAARCAYAAAA7bUf6AAAAK3RFWHRDcmVhdGlvbiBUaW1lAHZyIDE0IGp1bCAyMDA2IDEzOjMxOjIzICswMTAwHvJDZwAAAAd0SU1FB9YHDgsgJYiZ4bUAAAAJcEhZcwAALiIAAC4iAari3ZIAAAAEZ0FNQQAAsY8L/GEFAAAB5ElEQVR42q2Tz0sqURTH72Qq4mASSAoSIfSDdCEI8qJFLXSjLYSQNoGLINrI8/0ZD9q0KnDlKkIMebmP9xZRCEEiLQLBiMiNJDYq/Zg573vpCkM6CdGBD3Pn3OvXe77nDGPfENKwJBHx/CxYAtNAAVfgXJKk7khVCCyCP6ALVKAJXkEdbINxw5tgM4HHPphSFEUql8usXq8zWZZZKBRiPp+PH3sBx2Br4FbiBg+aplGxWKRgMPiMH1+YTKZDq9V64na7G+l0mprNJo7RG/g94IEoQSsUCuRyue6QToIJYAJWMA/Bo2QySZ1Ohws9gZBeZI570Gq1yO/395BKGJg+ZbFYznK5HAmf9vQiKW5iqVQim832Fyn5E+83Y7EYieAdY2Nig7dRqtVqrNfr3YiWGsVltVrtr2f0IrwEZrfbGeqWhQ9GMeFwOPprRS9SAWo4HGZOp/MH1l4DAS6+HolE+u9Xek9kcK+qKqVSKUL/s0hPDhFY83g8j5VKhcQg7nxs80/w0mg0KB6Pa2az+RTpDbDA3sd/lwvk8/l+Z7iS/FHEAor8H9rtNmWzWYpGo+T1eikQCFAmkyFxAy7AJ255aMHYcIID8d1oNBi8hGuwwkYFDq0CPlG3YsTb4B/4BRwjBb4S/wGzT16tu5THiAAAAABJRU5ErkJggg==)",height:"16px",margin:"-8px 0 0 -8px",overflow:"hidden",width:"16px"},".xui-nodatauri ADVCLR":{background:xui.browser.ie6?null:xui.UI.$oldBg("clrbg.png","no-repeat left top"),_filter:xui.UI.$ieOldBg("clrbg.png"),"-ms-filter":xui.browser.ie8?xui.UI.$ieOldBg("clrbg.png"):null},".xui-nodatauri ADVWHEEL":{background:xui.browser.ie6?null:xui.UI.$oldBg("clr.png","no-repeat left top"),_filter:xui.UI.$ieOldBg("clr.png"),"-ms-filter":xui.browser.ie8?xui.UI.$ieOldBg("clr.png"):null},".xui-nodatauri ADVMARK1, .xui-nodatauri ADVMARK2":{background:xui.browser.ie6?null:xui.UI.$oldBg("picker.png","no-repeat left top"),_filter:xui.UI.$ieOldBg("picker.png"),"-ms-filter":xui.browser.ie8?xui.UI.$ieOldBg("picker.png"):null},"LIST span":{overflow:"hidden",cursor:"pointer",margin:"0 -1px -1px 0",display:xui.$inlineBlock,"font-size":"1.18em"},TRANS:{position:"absolute",top:".25em",left:"0",display:xui.$inlineBlock,cursor:"pointer"},SET:{position:"absolute",display:"none",top:".125em",right:"2.5em"},TOGGLE:{position:"absolute",right:".5em",top:"0.25em",display:xui.$inlineBlock,cursor:"default"}},Behaviors:{HoverEffected:{CLOSE:"CLOSE",SET:"SET",TRANS:"TRANS",TOGGLE:"TOGGLE"},ClickEffected:{CLOSE:"CLOSE",SET:"SET",TRANS:"TRANS",TOGGLE:"TOGGLE"},KEY:{onClick:function(){return!1}},SC:{onMouseover:function(p,e,s){p.box._setTempUI(p,p.getSubId(s))},onClick:function(p,e,s){var sid=p.getSubId(s);return p.boxing()._setCtrlValue(p.$tempValue=sid,!1),p.box._vC(p),p.properties.advance||p.boxing().setUIValue(sid,!0,null,"click"),!1},onDblclick:function(p,e,s){var sid=p.getSubId(s);return p.boxing()._setCtrlValue(p.$tempValue=sid,!1),p.box._vC(p),p.boxing().setUIValue(sid,!0,null,"dblclick"),!1}},LIST:{onMouseout:function(p,e,s){p.box._updateDftTip(p)}},SET:{onClick:function(p,e,src){p.box._vC(p),p.boxing().setUIValue(p.$tempValue,!0,null,"setbtn")}},TRANS:{onClick:function(p,e,src){p.box._vC(p),p.boxing().setUIValue(p.$tempValue="transparent",!0,null,"transbtn")}},CANCEL:{onClick:function(p,e,src){p.getSubNode("CLOSE").onClick(!0)}},TOGGLE:{onClick:function(p,e,src){p.boxing().setAdvance(!p.properties.advance)}},R:{beforeMousedown:function(p,e,src){p.box._dd1(p,e,src)},onDrag:function(p,e,src){p.box._dd2(p,e,src,0)},onDragstop:function(p,e,src){p.box._dd3(p,e,src,0)}},G:{beforeMousedown:function(p,e,src){p.box._dd1(p,e,src)},onDrag:function(p,e,src){p.box._dd2(p,e,src,1)},onDragstop:function(p,e,src){p.box._dd3(p,e,src,1)}},B:{beforeMousedown:function(p,e,src){p.box._dd1(p,e,src)},onDrag:function(p,e,src){p.box._dd2(p,e,src,2)},onDragstop:function(p,e,src){p.box._dd3(p,e,src,2)}},HH:{beforeMousedown:function(p,e,src){p.box._dd1(p,e,src,!0)},onDrag:function(p,e,src){p.box._dd2(p,e,src,0,"hsv1")},onDragstop:function(p,e,src){p.box._dd3(p,e,src,0,!0,"hsv1")}},S:{beforeMousedown:function(p,e,src){p.box._dd1(p,e,src,!0)},onDrag:function(p,e,src){p.box._dd2(p,e,src,1,"hsv2")},onDragstop:function(p,e,src){p.box._dd3(p,e,src,1,!0,"hsv2")}},V:{beforeMousedown:function(p,e,src){p.box._dd1(p,e,src,!0)},onDrag:function(p,e,src){p.box._dd2(p,e,src,2,"hsv2")},onDragstop:function(p,e,src){p.box._dd3(p,e,src,2,!0,"hsv2")}},H:{beforeMousedown:function(p,e,src){p.box._dd1(p,e,src)},onDrag:function(p,e,src){p.box._dd2(p,e,src,0,"hex")},onDragstop:function(p,e,src){p.box._dd3(p,e,src,0)}},E:{beforeMousedown:function(p,e,src){p.box._dd1(p,e,src)},onDrag:function(p,e,src){p.box._dd2(p,e,src,1,"hex")},onDragstop:function(p,e,src){p.box._dd3(p,e,src,1)}},X:{beforeMousedown:function(p,e,src){p.box._dd1(p,e,src)},onDrag:function(p,e,src){p.box._dd2(p,e,src,2,"hex")},onDragstop:function(p,e,src){p.box._dd3(p,e,src,2)}},CLOSE:{onClick:function(profile,e,src){var properties=profile.properties,instance=profile.boxing();properties.disabled||properties.readonly||!1!==instance.beforeClose(profile)&&instance.destroy()}},ADVWHEEL:{beforeMousedown:function(p,e,src){var cls=p.box;cls._prepareAdv(p,e),cls._updateClrByPos(p,e,!0),p.getSubNode("ADVMARK1").startDrag(e,{dragType:"none"})}},ADVMARK1:{beforeMousedown:function(p,e,src){var cls=p.box;cls._prepareAdv(p,e),cls._updateClrByPos(p,e,!0),p.getSubNode("ADVMARK1").startDrag(e,{dragType:"none"})},onDrag:function(p,e,src){p.box._updateClrByPos(p,e,!0)},onDragstop:function(p,e,src){p.box._updateValueByPos(p,e)},onDblclick:function(p,e,src){p.box._updateValueByPos(p,e),p.box._vC(p),p.boxing().setUIValue(p.$tempValue,!0,null,"advdblclick")}},ADVCLR:{beforeMousedown:function(p,e,src){var cls=p.box;return cls._prepareAdv(p,e),cls._updateClrByPos(p,e),p.getSubNode("ADVMARK2").startDrag(e,{dragType:"none"}),!1}},ADVMARK2:{beforeMousedown:function(p,e,src){var cls=p.box;return cls._prepareAdv(p,e),cls._updateClrByPos(p,e),p.getSubNode("ADVMARK2").startDrag(e,{dragType:"none"}),!1},onDrag:function(p,e,src){p.box._updateClrByPos(p,e)},onDragstop:function(p,e,src){p.box._updateValueByPos(p,e)},onDblclick:function(p,e,src){p.box._updateValueByPos(p,e),p.box._vC(p),p.boxing().setUIValue(p.$tempValue,!0,null,"adv2dblclick")}}},_vC:function(profile){var d=profile.properties.$UIvalue==profile.$tempValue;profile.getSubNode("SET").css("display",d?"none":"block"),profile.getSubNode("CAPTION").css("color",d?"#000":"#ff0000")},_prepareData:function(profile){var data=arguments.callee.upper.call(this,profile),nodisplay="display:none";return data.classBar=data.barDisplay?"xui-uibar-top":"xui-uibar-top-s",data.closeDisplay=data.closeBtn?"":nodisplay,data.advDispay=data.advance?"":"display:none;",data._transparent=xui.getRes("inline.transparent"),data._set=xui.wrapRes("inline.set"),data},EventHandlers:{beforeClose:function(profile,src){}},RenderTrigger:function(){this.$onValueSet=this.$onUIValueSet=function(o,v){this.box._setClrName(this,v)}},_setClrName:function(profile,v){var p=profile,k="color.LIST.",vv=xui.getRes(k+v);vv==v?p.$clrN2=p.$clrN=("transparent"==v?"":"#")+v:(p.$clrN=vv,p.$clrN2=xui.wrapRes(k+v))},_slist:"FFFFFF,FFFFF0,FFFFE0,FFFF00,FFFAFA,FFFAF0,FFFACD,FFF8DC,FFF5EE,FFF0F5,FFEFD5,FFEBCD,FFE4E1,FFE4C4,FFE4B5,FFDEAD,FFDAB9,FFD700,FFC0CB,FFB6C1,FFA500,FFA07A,FF8C00,FF7F50,FF69B4,FF6347,FF4500,FF1493,FF00FF,FF00FF,FF0000,FDF5E6,FAFAD2,FAF0E6,FAEBD7,FA8072,F8F8FF,F5FFFA,F5F5F5,F5DEB3,F4A460,F0FFFF,F0FFF0,F0F8FF,F0E68C,F08080,EEE8AA,EE82EE,E9967A,E6E6FA,E1FFFF,DEB887,DDA0DD,DCDCDC,DC143C,DB7093,DAA520,DA70D6,D8BFD8,D3D3D3,D2B48C,D2691E,CD853F,CD5C5C,C71585,C0C0C0,BDB76B,BC8F8F,BA55D3,B22222,B0E0E6,B0C4DE,AFEEEE,ADFF2F,ADD8E6,A9A9A9,A52A2A,A0522D,9932CC,98FB98,9400D3,9370DB,90EE90,8FBC8F,8B4513,8B008B,8B0000,8A2BE2,87CEFA,87CEEB,808080,808000,800080,800000,7FFFAA,7FFF00,7CFC00,7B68EE,778899,708090,6B8E23,6A5ACD,696969,6495ED,5F9EA0,556B2F,4B0082,48D1CC,483D8B,4682B4,4169E1,40E0D0,3CB371,32CD32,2F4F4F,2E8B57,228B22,20B2AA,1E90FF,191970,00FFFF,00FFFF,00FF7F,00FF00,00FA9A,00CED1,00BFFF,008B8B,008080,008000,006400,0000FF,0000CD,00008B,000080,000000".split(","),_C16:"0123456789ABCDEF",_dd1:function(profile,e,src,hsv){if("left"==xui.Event.getBtn(e)){var p=profile.properties,cls=profile.box,f=function(){var rgb=cls.hex2rgb(profile.$tempValue||p.$UIvalue);return hsv?cls.rgb2hsv(rgb):rgb};xui.use(src).css("backgroundColor","red").startDrag(e,{dragType:"blank",targetReposition:!1,widthIncrement:2,dragCursor:!0}),profile.$temp=0,profile.$start=f(),profile.$temp2=f()}},_dd2:function(profile,e,src,i,type){var count,v,off=xui.DragDrop.getProfile().offset,old=(profile.properties,profile.$temp2),cls=profile.box,rate="hsv1"==type?361:"hsv2"==type?101:256;count=((count=("hsv2"==type?parseInt(100*profile.$start[i],10):parseInt(profile.$start[i],10))+parseInt(off.x/2,10))%rate+rate)%rate,profile.$temp!=count&&(old[i]=profile.$temp="hsv2"==type?count/100:count,v="hsv1"==type||"hsv2"==type?cls.hsv2rgb(old):old,v=cls.rgb2hex(v),cls._setTempUI(profile,v),xui.use(src).text("hex"==type?cls._toFF(count):count))},_dd3:function(profile,e,src,i,hsv){if(profile.$start[i]!==profile.$temp){profile.properties;var v,cls=profile.box,old=profile.$start;old[i]=profile.$temp,v=hsv?cls.hsv2rgb(old):old,v=cls.rgb2hex(v),hsv&&(profile.$hexinhsv=v),profile.boxing()._setCtrlValue(profile.$tempValue=v,!1),delete profile.$hexinhsv,profile.box._vC(profile)}xui.use(src).css("backgroundColor",""),profile.$temp=profile.$start=0},_setTempUI:function(p,v){var rgb=this.hex2rgb(v),ex=p.boxing().getSubNode("EXAM"),hsv=this.rgb2hsv(rgb),vv=xui.getRes("color.LIST."+v),v1=("transparent"==v?"":"#")+v;ex.css({backgroundColor:v1,color:hsv[2]>.6?"#000":"#FFF"}),ex.text(p.show_color=vv==v?v1:vv)},_updateDftTip:function(prf){prf.box;var p=prf.properties,trans="transparent"==(prf.$tempValue||p.$UIvalue),ex=prf.boxing().getSubNode("EXAM");ex.css({backgroundColor:trans?"transparent":"#"+prf.$hex.join(""),color:trans||prf.$hsv[2]>.6?"#000":"#FFF"}),ex.html(prf.$clrN2||"",!1)},_to3:function(s){return s&&"transparent"!=s||(s="FFFFFF"),[s.substr(0,2),s.substr(2,2),s.substr(4,2)]},_toFF:function(n){var C16=this._C16;return n=(n=parseInt(n,10)||0)>255||n<0?0:n,C16.charAt((n-n%16)/16)+C16.charAt(n%16)},_to255:function(str){var C16=this._C16,s=str.split("");return 16*C16.indexOf(s[0].toUpperCase())+C16.indexOf(s[1].toUpperCase())},_webSafe:function(r,g,b){var me=arguments.callee,f=me.f||(me.f=function(n){return 51*parseInt(n/51,10)});return"object"==typeof r&&(g=r[1],b=r[2],r=r[0]),[f(r),f(g),f(b)]},_updateMarks:function(profile,hex,forcePos,hsv0){var cls=this,rgb=cls.hex2rgb(hex),hsv=cls.rgb2hsv(rgb),angle=hsv[0]/360*6.28,clr=profile.getSubNode("ADVCLR");if(forcePos){var m1=profile.getSubNode("ADVMARK1"),m2=profile.getSubNode("ADVMARK2");m1.cssPos({left:Math.round(Math.sin(angle)*cls._radius+cls._bigRadius),top:Math.round(-Math.cos(angle)*cls._radius+cls._bigRadius)}),m2.cssPos({left:Math.round(cls._square*(hsv[1]-.5)+cls._bigRadius),top:Math.round(cls._square*(.5-hsv[2])+cls._bigRadius)})}hsv0!==undefined&&clr.css("backgroundColor","#"+cls.rgb2hex(cls.hsv2rgb([hsv0,1,1]))),cls._setTempUI(profile,hex)},_updateClrByPos:function(profile,e,flag){var angle,m1,m2,h,s,v,hsv,rgb,hex,cls=this,mPos=xui.Event.getPos(e),pos=profile.$tpos,left=mPos.left-pos.left,top=mPos.top-pos.top;flag?(m1=profile.getSubNode("ADVMARK1"),angle=Math.atan2(left,-top),m1.cssPos({left:Math.round(Math.sin(angle)*cls._radius+cls._bigRadius),top:Math.round(-Math.cos(angle)*cls._radius+cls._bigRadius)}),(h=Math.floor(angle/Math.PI*180))<0&&(h+=360),hsv=[h,profile.$hsv[1],profile.$hsv[2]],rgb=cls.hsv2rgb(hsv),hex=cls.rgb2hex(rgb),cls._updateMarks(profile,profile.$t_hex=hex,!1,h)):(m2=profile.getSubNode("ADVMARK2"),s=Math.max(0,Math.min(1,left/cls._square+.5)),v=Math.max(0,Math.min(1,.5-top/cls._square)),m2.cssPos({left:Math.round(cls._square*(s-.5)+cls._bigRadius),top:Math.round(cls._square*(.5-v)+cls._bigRadius)}),hsv=[profile.$hsv[0],s,v],rgb=cls.hsv2rgb(hsv),hex=cls.rgb2hex(rgb),cls._updateMarks(profile,profile.$t_hex=hex))},_updateValueByPos:function(profile,e){profile.$hexinadv=profile.$t_hex,profile.boxing()._setCtrlValue(profile.$tempValue=profile.$t_hex,!1),delete profile.$hexinadv,profile.box._vC(profile)},_prepareAdv:function(profile,e){var pos=profile.getSubNode("ADVWHEEL").offset();profile.$tpos={left:pos.left+this._bigRadius,top:pos.top+this._bigRadius}},_ensureValue:function(profile,v){var h,ns=this,me=arguments.callee,map=me.map||(me.map=(h={},xui.arr.each(ns._C16.split(""),(function(o,i){h[o]=1})),h)),reg=me._r||(me._r=/rgb\(([^)]*)\)/);if(!v||"string"!=typeof v||"transparent"==v)return"transparent";reg.test(v)&&((v=(v=v.replace(reg,"$1")).split(","))[0]=parseInt(v[0],10)||0,v[1]=parseInt(v[1],10)||0,v[2]=parseInt(v[2],10)||0,v=ns.rgb2hex(v)),"#"==v.charAt(0)&&(v=v.substr(1,v.length));for(var k,a="",i=0;i<6;i++)a+=map[k=v.charAt(i).toUpperCase()]?k:"F";return a},hsv2rgb:function(h,s,v){h instanceof Array&&(s=h[1],v=h[2],h=h[0]);var r,g,b,i,k,p,q,t,me=arguments.callee,f=me.f||(me.f=function(n){return Math.min(255,Math.round(256*n))});if(0==s)return[v=f(v),v,v];switch(p=v*(1-s),q=v*(1-(k=h/60-(i=Math.floor(h/60%6)))*s),t=v*(1-(1-k)*s),i){case 0:r=v,g=t,b=p;break;case 1:r=q,g=v,b=p;break;case 2:r=p,g=v,b=t;break;case 3:r=p,g=q,b=v;break;case 4:r=t,g=p,b=v;break;case 5:r=v,g=p,b=q}return 0==s?[v=f(v),v,v]:[f(r),f(g),f(b)]},rgb2hsv:function(r,g,b){r instanceof Array&&(g=r[1],b=r[2],r=r[0]),r/=255,g/=255,b/=255;var h,min=Math.min(r,g,b),max=Math.max(r,g,b),delta=max-min,s=0===max?0:1-min/max,v=max;switch(max){case min:h=0;break;case r:h=60*(g-b)/delta,g<b&&(h+=360);break;case g:h=60*(b-r)/delta+120;break;case b:h=60*(r-g)/delta+240}return[Math.round(h),s,v]},rgb2hex:function(r,g,b){return r instanceof Array&&(g=r[1],b=r[2],r=r[0]),this._toFF(r)+this._toFF(g)+this._toFF(b)},hex2rgb:function(hex){return hex&&"transparent"!=hex||(hex="FFFFFF"),"#"==hex.charAt(0)&&(hex=hex.slice(1)),[this._to255(hex.substr(0,2)),this._to255(hex.substr(2,2)),this._to255(hex.substr(4,2))]},getTextColor:function(value){return(value=this._ensureValue(0,value))&&"transparent"==value.toLowerCase()?"#000000":(value=this.hex2rgb(value),((value=this.rgb2hsv(value))&&value[2])>.6?"#000000":"#FFFFFF")},_onresize:function(){}}}),xui.Class("xui.UI.DatePicker",["xui.UI","xui.absValue"],{Required:["xui.Date"],Instance:{activate:function(){return this.getSubNode("PRE").focus(!0),this},_setCtrlValue:function(value){return this.each((function(profile){if(profile.renderId){var cls=profile.box,p=profile.properties;cls._to(profile,value,!0),profile.keys.CAPTION&&profile.getSubNode("CAPTION").html(xui.Date.getText(value,"ymd",xui.getFirstDayOfWeek(p)),!1)}}))},getDateFrom:function(){return this.get(0)._realstart}},Initialize:function(){var id=xui.UI.$ID,tag=xui.UI.$tag_special,cls=xui.UI.$CLS,key=this.KEY;this.addTemplateKeys(["H","COL","W","TBODY","THEADER","TD"]);var body,i,j,k,l,colgroup='<colgroup id="'+key+"-COL:"+id+':"  class="'+tag+"COL_CS"+tag+' xui-custom {comcls}"  style="'+tag+"COL_CS"+tag+'"><col width="1px"/><col width=""/><col width=""/><col width=""/><col width=""/><col width=""/><col width=""/><col width=""/></colgroup>',thead1='<thead ID="'+key+"-THEADER:"+id+':" class="'+tag+"THEADER_CS"+tag+' xui-custom {comcls}"  style="'+tag+"THEADER_CS"+tag+'" ><tr height="1px"><th id="'+key+"-H:"+id+':7" class="xui-node  xui-node-th xui-uiborder-b xui-uiborder-r '+cls+"-h "+cls+"-w "+tag+"H_CC"+tag+' xui-custom {comcls}" style="'+tag+"H_CS"+tag+'"></th>',th='<th id="'+key+"-H:"+id+':@" class="xui-node xui-node-th xui-uiborder-b xui-uiborder-r '+cls+"-h "+tag+"H_CC"+tag+' xui-custom {comcls}"  style="'+tag+"H_CS"+tag+'">@</th>',tbody1='<tbody id="'+key+"-TBODY:"+id+':"  class="'+tag+"TBODY_CS"+tag+' xui-custom {comcls}"  style="'+tag+"TBODY_CS"+tag+'" >',td1='<th id="'+key+"-W:"+id+':@"  class="xui-node xui-node-th xui-uiborder-b xui-uiborder-r '+cls+"-w "+tag+"W_CC"+tag+' xui-custom {comcls}"  style="'+tag+"W_CS"+tag+'">@</th>',td2='<td id="'+key+"-TD:"+id+':@" class="xui-node xui-uicell  xui-node-td xui-uiborder-b xui-uiborder-r '+cls+"-td "+tag+"TD_CC"+tag+' xui-custom {comcls}"  style="'+tag+"TD_CS"+tag+'" '+xui.$IEUNSELECTABLE()+" ></td>",a=[],b=[];for(i=0;i<7;i++)b[b.length]=th.replace(/@/g,i);for(k=l=0,i=0;i<48;i++)j=i%8,a[a.length]=(0==j?"<tr>":"")+(0==j?td1:td2).replace(/@/g,0==j?l:k)+(7==j?"</tr>":""),0!==j?k++:l++;body=colgroup+thead1+b.join("")+"</tr></thead>"+tbody1+a.join("")+"</tbody>",this.setTemplate({tagName:"div",style:"{_style};height:auto;",BORDER:{tagName:"div",className:"xui-uiborder-outset xui-uiborder-box xui-uiborder-radius-big",BAR:{tagName:"div",className:"xui-uibar-top",style:"{barDisplay};",BARTDL:{className:"xui-uibar-tdl xui-uibar xui-uiborder-radius-big-tl",BARTDLT:{className:"xui-uibar-tdlt"}},BARTDM:{$order:1,className:"xui-uibar-tdm xui-uibar",BARTDMT:{className:"xui-uibar-tdmt"}},BARTDR:{$order:2,className:"xui-uibar-tdr xui-uibar xui-uiborder-radius-big-tr",BARTDRT:{className:"xui-uibar-tdrt"}},BARCMDL:{$order:3,tagName:"div",className:"xui-uibar-cmdl",PRE2:{$order:0,className:"xuifont",$fonticon:"xui-icon-doubleleft",tabindex:"{tabindex}"},PRE:{$order:1,className:"xuifont",$fonticon:"xui-icon-singleleft",tabindex:"{tabindex}"},YEAR:{$order:2,className:"xui-ui-draggable xui-uibase xui-uiborder-flat xui-uiborder-radius"},YTXT:{$order:3,text:"-"},MONTH:{$order:4,className:"xui-ui-draggable xui-uibase xui-uiborder-flat xui-uiborder-radius"},MTXT:{$order:5,text:"-"},DAY:{$order:6,className:"xui-ui-draggable xui-uibase xui-uiborder-flat xui-uiborder-radius"},NEXT:{$order:7,className:"xuifont",$fonticon:"xui-icon-singleright",tabindex:"{tabindex}"},NEXT2:{$order:8,className:"xuifont",$fonticon:"xui-icon-doubleright",tabindex:"{tabindex}"}},BARCMDR:{$order:4,tagName:"div",className:"xui-uibar-cmdr",CLOSE:{className:"xuifont",$fonticon:"xui-uicmd-close",style:"{closeDisplay}"}},TBARTDB:{$order:5,tagName:"div",className:"xui-uibar-tdb xui-uiborder-inset xui-uiborder-radius"}},MAIN:{$order:2,tagName:"div",className:"xui-uicon-main xui-uibar",MAINI:{tagName:"div",className:"xui-uicon-maini xui-uicon-maini xui-uibar",CON:{tagName:"div",className:"xui-uiborder-inset",BODY:{tagName:"table",cellpadding:"0",cellspacing:"0",text:body}}}},TAIL:{$order:3,tagName:"div",className:"xui-uicon-main xui-uibar",TAILI:{tagName:"div",className:"xui-uicon-maini xui-uibar",CAPTION:{tagName:"div",style:"{_nocap}",text:"{caption}",$order:0},TIME:{style:"{_timectrl}",tagName:"div",TPRE2:{$order:0,className:"xuifont",$fonticon:"xui-icon-doubleleft",tabindex:"{tabindex}"},TPRE:{$order:1,className:"xuifont",$fonticon:"xui-icon-singleleft",tabindex:"{tabindex}"},HOUR:{$order:2,className:"xui-ui-draggable xui-uibase xui-uiborder-flat xui-uiborder-radius"},MTXT:{$order:3,text:":"},MINUTE:{$order:4,className:"xui-ui-draggable xui-uibase xui-uiborder-flat xui-uiborder-radius"},TNEXT:{$order:6,className:"xuifont",$fonticon:"xui-icon-singleright",tabindex:"{tabindex}"},TNEXT2:{$order:7,className:"xuifont",$fonticon:"xui-icon-doubleright",tabindex:"{tabindex}"}},TODAY:{tabindex:"{tabindex}",className:"xuifont",$fonticon:"xui-icon-date",title:"{_todaytitle}"},SET:{tagName:"button",className:"xui-ui-btn xui-uibar xui-uigradient xui-uiborder-radius",tabindex:"{tabindex}",text:"{_set}"}}},BBAR:{$order:4,tagName:"div",className:"xui-uibar-bottom-s",BBARTDL:{className:"xui-uibar-tdl xui-uibar xui-uiborder-radius-big-bl"},BBARTDM:{$order:1,className:"xui-uibar-tdm xui-uibar"},BBARTDR:{$order:2,className:"xui-uibar-tdr xui-uibar xui-uiborder-radius-big-br"}}}})},Static:{Appearances:{KEY:{},"TBART, BBART":{"border-spacing":0,"border-collapse":"separate"},BORDER:{},BODY:{position:"relative",overflow:"visible"},BARCMDL:{top:".125em"},TAILI:{position:"relative",padding:".5em 0 0 0"},TIME:{padding:".25em 1.5em"},SET:{position:"absolute",display:"none",top:".125em",right:".5em"},TODAY:{position:"absolute",top:".25em",left:".125em",display:xui.$inlineBlock,cursor:"default"},"PRE,PRE2,NEXT,NEXT2,TPRE,TPRE2,TNEXT,TNEXT2":{$order:0,display:xui.$inlineBlock,position:"relative",margin:"0 .25em","vertical-align":"middle",cursor:"default"},"YEAR,MONTH,DAY,HOUR,MINUTE":{$order:4,"font-weight":"bold","vertical-align":"middle",cursor:"e-resize",margin:"0 .25em",padding:"0 .25em"},YEAR:{},"MONTH, DAY,HOUR, MINUTE":{},CAPTION:{"text-align":"center","vertical-align":xui.browser.ie6?"baseline":"middle","font-size":"1em"},MAINI:{padding:".5em .3333em .3333em 0"},TD:{$order:1,"text-align":"center"},"TD-checked":{$order:4,"font-weight":"bold"},"W,H":{$order:3,"vertical-align":"middle","text-align":"center",padding:".25em"},W:{$order:4,padding:".125em"},H:{$order:4,padding:".25em 0.6666667em"}},Behaviors:{HoverEffected:{CLOSE:"CLOSE",TD:"TD",PRE:"PRE",PRE2:"PRE2",NEXT:"NEXT",NEXT2:"NEXT2",TPRE:"TPRE",TPRE2:"TPRE2",TNEXT:"TNEXT",TNEXT2:"TNEXT2",SET:"SET",TODAY:"TODAY"},ClickEffected:{CLOSE:"CLOSE",TD:"TD",PRE:"PRE",PRE2:"PRE2",NEXT:"NEXT",NEXT2:"NEXT2",TPRE:"TPRE",TPRE2:"TPRE2",TNEXT:"TNEXT",TNEXT2:"TNEXT2",SET:"SET",TODAY:"TODAY"},KEY:{onClick:function(){return!1}},TD:{onClick:function(profile,e,src){var p=profile.properties,id=profile.getSubId(src),v=profile.$daymap[id];if(p.disabled||p.readonly)return!1;xui.use(src).onMouseout(!0,{$force:!0}),v=xui.Date.add(profile.$tempValue,"d",xui.Date.diff(profile.$tempValue,v,"d",xui.getFirstDayOfWeek(p))),profile.box._to(profile,v),p.timeInput||profile.boxing().setUIValue(v,null,null,"click")},onDblclick:function(profile,e,src){profile.properties.timeInput&&(xui.use(src).onMouseout(!0,{$force:!0}),profile.boxing().setUIValue(profile.$tempValue,!0,null,"dblclick"))}},TODAY:{onClick:function(profile,e,src){xui.use(src).onMouseout(!0,{$force:!0}),profile.boxing().setUIValue(profile.properties.timeInput?new Date:xui.Date.getTimSpanStart(new Date,"d",1),!0,null,"today")}},SET:{onClick:function(profile,e,src){xui.use(src).onMouseout(!0,{$force:!0}),profile.boxing().setUIValue(profile.$tempValue,!0,null,"set")}},CLOSE:{onClick:function(profile,e,src){var p=profile.properties,instance=profile.boxing();p.disabled||p.readonly||!1!==instance.beforeClose(profile,src)&&instance.destroy(!0)}},PRE:{onClick:function(profile,e,src){var p=profile.properties;p.disabled||p.readonly||profile.box._to(profile,xui.Date.add(profile.$tempValue,"m",-1))}},NEXT:{onClick:function(profile,e,src){var p=profile.properties;p.disabled||p.readonly||profile.box._to(profile,xui.Date.add(profile.$tempValue,"m",1))}},PRE2:{onClick:function(profile,e,src){var p=profile.properties;p.disabled||p.readonly||profile.box._to(profile,xui.Date.add(profile.$tempValue,"y",-1))}},NEXT2:{onClick:function(profile,e,src){var p=profile.properties;p.disabled||p.readonly||profile.box._to(profile,xui.Date.add(profile.$tempValue,"y",1))}},TPRE:{onClick:function(profile,e,src){var p=profile.properties;p.disabled||p.readonly||profile.box._to(profile,xui.Date.add(profile.$tempValue,"n",-1))}},TNEXT:{onClick:function(profile,e,src){var p=profile.properties;p.disabled||p.readonly||profile.box._to(profile,xui.Date.add(profile.$tempValue,"n",1))}},TPRE2:{onClick:function(profile,e,src){var p=profile.properties;p.disabled||p.readonly||profile.box._to(profile,xui.Date.add(profile.$tempValue,"h",-1))}},TNEXT2:{onClick:function(profile,e,src){var p=profile.properties;p.disabled||p.readonly||profile.box._to(profile,xui.Date.add(profile.$tempValue,"h",1))}},YEAR:{beforeMousedown:function(profile,e,src){return profile.box._ondown(profile,e,src,10)},onDrag:function(profile,e,src){var count,off=xui.DragDrop.getProfile().offset;count=parseInt(profile.$year,10)+parseInt(off.x/10,10),profile.$temp!=count&&(profile.$temp2=parseInt(off.x/10,10),profile.getSubNode("YEAR").html(count,!1))},onDragstop:function(profile,e,src){return profile.box._onds(profile,e,src,"y")}},MONTH:{beforeMousedown:function(profile,e,src){return profile.box._ondown(profile,e,src,20)},onDrag:function(profile,e,src){var count,off=xui.DragDrop.getProfile().offset;count=((count=parseInt(profile.$month,10)+parseInt(off.x/20,10)%12)%12+12)%12,profile.$temp!=count&&(profile.$temp=count,profile.$temp2=count-profile.$month+1,profile.getSubNode("MONTH").html((count+1<=9?"0":"")+(count+1),!1))},onDragstop:function(profile,e,src){return profile.box._onds(profile,e,src,"m")}},DAY:{beforeMousedown:function(profile,e,src){return profile.box._ondown(profile,e,src,10)},onDrag:function(profile,e,src){var count,days=new Date(profile.$year,profile.$month,0).getDate(),off=(profile.properties,xui.DragDrop.getProfile().offset);count=((count=parseInt(profile.$day,10)+parseInt(off.x/10,10)%days)%days+days)%days+1,profile.$temp!=count&&(profile.$temp=count,profile.$temp2=count-profile.$day,profile.getSubNode("DAY").html((count<=9?"0":"")+count,!1))},onDragstop:function(profile,e,src){return profile.box._onds(profile,e,src,"d")}},HOUR:{beforeMousedown:function(profile,e,src){return profile.box._ondown(profile,e,src,20)},onDrag:function(profile,e,src){return profile.box._ondrag(profile,20,24,"HOUR",profile.$hour)},onDragstop:function(profile,e,src){return profile.box._onds(profile,e,src,"h")}},MINUTE:{beforeMousedown:function(profile,e,src){return profile.box._ondown(profile,e,src,10)},onDrag:function(profile,e,src){return profile.box._ondrag(profile,10,60,"MINUTE",profile.$minute)},onDragstop:function(profile,e,src){return profile.box._onds(profile,e,src,"n")}}},DataModel:{timeInput:{ini:!1,action:function(v){this.getSubNode("CAPTION").css("display",v?"none":"block"),this.getSubNode("SET").css("display",v?"block":"none"),this.getSubNode("TIME").css("display",v?"block":"none"),this.getSubNode("TODAY").attr("title",xui.getRes(v?"inline.now":"inline.today"))}},height:{$spaceunit:1,ini:"auto",readonly:!0},width:{$spaceunit:1,ini:"auto",readonly:!0},value:{ini:new Date,format:"date"},closeBtn:{ini:!0,action:function(v){this.getSubNode("CLOSE").css("display",v?"":"none")}},firstDayOfWeek:{ini:0,action:function(){this.boxing().refresh()}},offDays:{ini:"60",action:function(){this.boxing().refresh()}},hideWeekLabels:{ini:!1,action:function(){this.boxing().refresh()}},dateInputFormat:{ini:"yyyy-mm-dd",listbox:["yyyy-mm-dd","mm-dd-yyyy","dd-mm-yyyy"],action:function(){this.boxing().refresh()}}},EventHandlers:{beforeClose:function(profile,src){}},_prepareData:function(profile){var data=arguments.callee.upper.call(this,profile),nodisplay="display:none";data.closeDisplay=data.closeBtn?"":nodisplay;var none="display:none;";return profile.properties.timeInput?(data._todaytitle=xui.getRes("inline.now"),data._nocap=none):(data._todaytitle=xui.getRes("inline.today"),data._timectrl=none),data._set=xui.wrapRes("inline.set"),data},_ensureValue:function(profile,value){var d;return value&&(d=xui.isDate(value)?value:xui.isFinite(value)?new Date(parseInt(value,10)):xui.Date.parse(value+"")),d=d||new Date,profile.properties.timeInput||(d=xui.Date.getTimSpanStart(d,"d")),d},RenderTrigger:function(){var p=this.properties;this.boxing(),this.box._setWeekLabel(this);var hash={yyyy:"YEAR",mm:"MONTH",dd:"DAY"},arr=p.dateInputFormat.split("-");hash[arr[0]]&&hash[arr[1]]&&hash[arr[2]]&&(this.getSubNode("YTXT").addPrev(this.getSubNode(hash[arr[0]])),this.getSubNode("MTXT").addPrev(this.getSubNode(hash[arr[1]])),this.getSubNode("MTXT").addNext(this.getSubNode(hash[arr[2]])))},_getWeekNodes:function(profile){return profile.$weeks||(profile.$weeks=profile.getSubNode("W",!0))},_getTDNodes:function(profile){return profile.$tds||(profile.$tds=profile.getSubNode("TD",!0))},_getLabelNodes:function(profile){return profile.$days||(profile.$days=profile.getSubNode("TD",!0))},_getHeaderNodes:function(profile){return profile.$header||(profile.$header=profile.getSubNode("H",!0))},_setWeekLabel:function(profile){var p=profile.properties,fw=xui.getFirstDayOfWeek(p);profile.box._getHeaderNodes(profile).each((function(node,i){node.innerHTML=xui.wrapRes("date.WEEKS."+function(id){return"7"==(id=profile.getSubId(id))||(id=parseInt(id,10)+fw)<7?id:id-7}(node.id))})),p.hideWeekLabels&&(profile.getSubNode("BODY").query("TR").first().remove(),profile.getSubNode("COL").first().remove());var cls2="xui-uicell-alt",fdmap={};p.offDays&&(xui.arr.each(p.offDays.split(""),(function(i){(i=parseInt(i,10))>=0&&i<=6&&(fdmap[i]=1)})),profile.box._getTDNodes(profile).each((function(node,i){i=i+fw-7*parseInt((i+fw)/7,10),fdmap[i]?node.className=node.className+" "+cls2:node.className=node.className.replace(cls2,"")})))},_setBGV:function(profile,v,m){var t,n,date=xui.Date,p=profile.properties,daymap=profile.$daymap||(profile.$daymap=[]);profile.box._getLabelNodes(profile).each((function(node,i){n=date.add(v,"d",i),daymap[i]=n,t=date.get(n,"m")==m?"#":'<p class="xui-node xui-node-p xui-ui-readonly xui-custom {comcls}">#</p>',n=date.get(n,"d"),node.innerHTML=t.replace("#",n)})),p.hideWeekLabels||profile.box._getWeekNodes(profile).each((function(node,i){node.innerHTML=date.get(date.add(v,"ww",i),"ww",xui.getFirstDayOfWeek(p))}))},_to:function(profile,time,force){var node,temp,p=profile.properties,fw=xui.getFirstDayOfWeek(p),date=xui.Date,uiv=(profile.keys,p.$UIvalue),index=-1,_realstart=date.getTimSpanStart(date.getTimSpanStart(time,"m"),"ww",1,fw),m=date.get(time,"m",fw);profile.$tempValue=time,this._setBGV(profile,profile._realstart=_realstart,m),profile.$selnode&&profile.$selnode.tagClass("-checked",!1),xui.arr.each(profile.$daymap,(function(o,i){if(date.get(o,"m",fw)+"-"+date.get(o,"d",fw)==date.get(time,"m",fw)+"-"+date.get(time,"d",fw))return index=i,!1})),node=this._getTDNodes(profile).get()[index],profile.$selnode=xui([node]).tagClass("-checked"),profile.getSubNode("SET").css("display",force||uiv.getTime()==time.getTime()?"none":"block"),profile.getSubNode("CAPTION").css("color",force||uiv.getTime()==time.getTime()?"":"#ff0000"),temp=date.get(time,"y",fw),profile.$year!=temp&&(profile.$year=temp,profile.getSubNode("YEAR").html(temp,!1)),temp=date.get(time,"m",fw)+1,profile.$month!=temp&&(profile.$month=temp,profile.getSubNode("MONTH").html((temp<=9?"0":"")+temp,!1)),temp=date.get(time||time,"d",fw),profile.$day!=temp&&(profile.$day=temp,profile.getSubNode("DAY").html((temp<=9?"0":"")+temp,!1)),temp=date.get(time,"h",fw),profile.$hour!=temp&&(profile.$hour=temp,profile.getSubNode("HOUR").html((temp<=9?"0":"")+temp,!1)),temp=date.get(time,"n",fw),profile.$minute!=temp&&(profile.$minute=temp,profile.getSubNode("MINUTE").html((temp<=9?"0":"")+temp,!1))},_ondown:function(profile,e,src,increment){"left"==xui.Event.getBtn(e)&&(xui.use(src).startDrag(e,{dragType:"blank",targetReposition:!1,widthIncrement:increment,dragCursor:!0}),profile.$temp=profile.$temp2=0)},_ondrag:function(profile,increment,max,key,data){profile.properties;var count,off=xui.DragDrop.getProfile().offset;count=((count=parseInt(data,10)+parseInt(off.x/increment,10)%max)%max+max)%max,profile.$temp!=count&&(profile.$temp=count,profile.$temp2=count-data,profile.getSubNode(key).html((count<=9?"0":"")+count,!1))},_onds:function(profile,e,src,type){if(profile.$temp2){profile.properties;var v=xui.Date.add(profile.$tempValue,type,profile.$temp2);profile.box._to(profile,v)}profile.$temp=profile.$temp2=0},_onresize:function(){}}}),xui.Class("xui.UI.TimePicker",["xui.UI","xui.absValue"],{Required:["xui.Date"],Instance:{activate:function(){return this.getSubNode("PRE").focus(!0),this},_setCtrlValue:function(value){return this.each((function(profile){if(profile.renderId){var cls=profile.box,arr2=cls._v2a(value);profile.$hour=arr2[0],profile.$minute=arr2[1],profile.getSubNode("HI",!0).removeClass(cls._excls_c3).removeClass(cls._excls_mo3),profile.getSubNode("HI",arr2[0]).addClass(cls._excls_c3),profile.getSubNode("MI",!0).removeClass(cls._excls_c).removeClass(cls._excls_mo),profile.getSubNode("MI",arr2[1]).addClass(cls._excls_c),profile.getSubNode("HOUR").html(arr2[0],!1),profile.getSubNode("MINUTE").html(arr2[1],!1),profile.getSubNode("CAPTION").html(profile.box._showV(profile,profile.box._v2a(arr2)),!1)}}))}},Initialize:function(){var a,i,h,m,cls,cls2,id,t;for(this.addTemplateKeys(["HI","MI"]),cls=this._excls3,cls2=this._excls4,id=xui.UI.$ID,t='<span id="'+this.KEY+"-HI:"+id+':@" class="xui-node xui-node-span '+cls+' !" '+xui.$IEUNSELECTABLE()+" >@</span>",a=[],i=0;i<24;i++)a[a.length]=t.replace(/@/g,i<10?"0"+i:i).replace("!",(i%6==0?cls2:"")+" xui-custom {comcls}"),i+1==12&&(a[a.length]="<br />");for(h=a.join(""),a.length=0,cls=this._excls,cls2=this._excls2,id=xui.UI.$ID,t='<span id="'+this.KEY+"-MI:"+id+':@" class="xui-node xui-node-span '+cls+' !" '+xui.$IEUNSELECTABLE()+" >@</span>",a=[],i=0;i<60;i++)a[a.length]=t.replace(/@/g,i<10?"0"+i:i).replace("!",(i%5==0?cls2:"")+" xui-custom {comcls}"),(i+1)%10==0&&59!=i&&(a[a.length]="<br />");m=a.join(""),a.length=0,this.setTemplate({tagName:"div",style:"{_style};height:auto;",BORDER:{tagName:"div",className:"xui-uiborder-outset xui-uiborder-box xui-uiborder-radius-big",BART:{tagName:"div",className:"xui-uibar-top",style:"{barDisplay};",BARTDL:{className:"xui-uibar-tdl xui-uibar xui-uiborder-radius-big-tl",BARTDLT:{className:"xui-uibar-tdlt"}},BARTDM:{$order:1,className:"xui-uibar-tdm xui-uibar",BARTDMT:{className:"xui-uibar-tdmt"}},BARTDR:{$order:2,className:"xui-uibar-tdr xui-uibar xui-uiborder-radius-big-tr",BARTDRT:{className:"xui-uibar-tdrt"}},BARCMDL:{$order:3,tagName:"div",className:"xui-uibar-cmdl",PRE2:{$order:0,className:"xuifont",$fonticon:"xui-icon-doubleleft",tabindex:"{tabindex}"},PRE:{$order:1,className:"xuifont",$fonticon:"xui-icon-singleleft",tabindex:"{tabindex}"},HOUR:{$order:2,className:"xui-ui-draggable xui-uibase xui-uiborder-flat xui-uiborder-radius"},MTXT:{$order:3,text:":"},MINUTE:{$order:4,className:"xui-ui-draggable xui-uibase xui-uiborder-flat xui-uiborder-radius"},NEXT:{$order:6,className:"xuifont",$fonticon:"xui-icon-singleright",tabindex:"{tabindex}"},NEXT2:{$order:7,className:"xuifont",$fonticon:"xui-icon-doubleright",tabindex:"{tabindex}"}},BARCMDR:{$order:4,tagName:"div",className:"xui-uibar-cmdr",CLOSE:{className:"xuifont",$fonticon:"xui-uicmd-close",style:"{closeDisplay}"}},TBARTDB:{$order:5,tagName:"div",className:"xui-uibar-tdb xui-uiborder-inset xui-uiborder-radius"}},MAIN:{$order:2,tagName:"div",className:"xui-uicon-main xui-uibar",MAINI:{tagName:"div",className:"xui-uibar xui-uicon-maini xui-uibar",CONH:{tagName:"div",className:"xui-uibase xui-uiborder-flat",text:h},CONM:{$order:2,tagName:"div",className:"xui-uibase xui-uiborder-flat",text:m}}},TAIL:{$order:3,tagName:"div",className:"xui-uicon-main xui-uibar",TAILI:{tagName:"div",className:"xui-uibar xui-uicon-maini",CAPTION:{text:"{caption}"},SET:{tagName:"button",className:"xui-ui-btn xui-uibar xui-uigradient xui-uiborder-radius",tabindex:"{tabindex}",text:"{_set}"}}},BBAR:{$order:4,tagName:"div",className:"xui-uibar-bottom-s",BBARTDL:{className:"xui-uibar-tdl xui-uibar xui-uiborder-radius-big-bl"},BBARTDM:{$order:1,className:"xui-uibar-tdm xui-uibar"},BBARTDR:{$order:2,className:"xui-uibar-tdr xui-uibar xui-uiborder-radius-big-br"}}}})},Static:{_excls:"xuiex-timepicker xui-uicell",_excls2:"xuiex-timepicker xui-uicell xui-uicell-alt ",_excls3:"xuiex-timepicker3 xui-uicell",_excls4:"xuiex-timepicker xui-uicell xui-uicell-alt",_excls_mo:"xui-uicell-hover",_excls_c:"xui-uicell-checked",_excls_mo3:"xui-uicell-hover",_excls_c3:"xui-uicell-checked",_mover:function(src,type){var b=this,cn=src.className;2==type?-1==cn.indexOf(b._excls_mo3)&&(src.className=cn+" "+b._excls_mo3):-1==cn.indexOf(b._excls_mo)&&(src.className=cn+" "+b._excls_mo),src=null},_mout:function(src,type){var b=this,cn=src.className;2==type?-1!=cn.indexOf(b._excls_mo3)&&(src.className=cn.replace(b._excls_mo3,"")):-1!=cn.indexOf(b._excls_mo)&&(src.className=cn.replace(b._excls_mo,"")),src=null},Appearances:{KEY:{},"TBART, BBART":{"border-spacing":0,"border-collapse":"separate"},MAINI:{padding:".5em .3333em .3333em 0"},CONH:{"white-space":"nowrap","text-align":"center"},CONM:{"margin-top":".5em","white-space":"nowrap","text-align":"center"},BARCMDL:{top:".125em"},"PRE,PRE2,NEXT,NEXT2":{position:"relative",margin:"0 .25em","vertical-align":"middle",cursor:"default"},"HOUR, MINUTE":{$order:3,"font-weight":"bold","vertical-align":"middle",cursor:"e-resize",margin:"0 .25em",padding:"0 .25em"},SET:{position:"absolute",display:"none",top:".125em",right:".5em"},TAILI:{position:"relative",padding:".5em 0 0 0","text-align":"center"},CAPTION:{"vertical-align":xui.browser.ie6?"baseline":"middle","font-size":"1em"},".xuiex-timepicker":{width:"2em","text-align":"center",padding:".25em 0",margin:0},".xuiex-timepicker3":{width:"1.6666em","text-align":"center","font-weight":"bold",padding:".25em 0",margin:0}},Behaviors:{HoverEffected:{CLOSE:"CLOSE",PRE:"PRE",NEXT:"NEXT",PRE2:"PRE2",NEXT2:"NEXT2",SET:"SET"},ClickEffected:{CLOSE:"CLOSE",PRE:"PRE",NEXT:"NEXT",PRE2:"PRE2",NEXT2:"NEXT2",SET:"SET"},KEY:{onClick:function(){return!1}},HOUR:{beforeMousedown:function(profile,e,src){"left"==xui.Event.getBtn(e)&&(xui(src).startDrag(e,{dragType:"blank",targetReposition:!1,widthIncrement:5,dragCursor:!0}),profile.$temp2=0)},onDrag:function(profile,e,src){var off=xui.DragDrop.getProfile().offset,v=profile.properties.$UIvalue,a=v.split(":");a[0]=Math.round((parseFloat(a[0])||0)+parseInt(off.x/10)),a[0]=(a[0]%24+24)%24,profile.$temp2=(a[0]<=9?"0":"")+a[0],v[0]!=profile.$temp2&&profile.getSubNode("HOUR").html(profile.$temp2,!1)},onDragstop:function(profile,e,src){profile.$temp2&&(profile.$hour=profile.$temp2,profile.boxing()._setCtrlValue(profile.$hour+":"+profile.$minute)),profile.$temp2=0,profile.box._hourC(profile)}},MINUTE:{beforeMousedown:function(profile,e,src){"left"==xui.Event.getBtn(e)&&(xui(src).startDrag(e,{dragType:"blank",targetReposition:!1,widthIncrement:5,dragCursor:!0}),profile.$temp2=0)},onDrag:function(profile,e,src){var off=xui.DragDrop.getProfile().offset,v=profile.properties.$UIvalue,a=v.split(":");a[0]=Math.round((parseFloat(a[0])||0)+parseFloat(off.x/20)),a[0]=(a[0]%60+60)%60,profile.$temp2=(a[0]<=9?"0":"")+a[0],v[0]!=profile.$temp2&&profile.getSubNode("MINUTE").html(profile.$temp2,!1)},onDragstop:function(profile,e,src){profile.$temp2&&(profile.$minute=profile.$temp2,profile.boxing()._setCtrlValue(profile.$hour+":"+profile.$minute)),profile.$temp2=0,profile.box._hourC(profile)}},SET:{onClick:function(profile){var a=profile.properties.$UIvalue.split(":");a[0]=profile.$hour,a[1]=profile.$minute,profile.boxing().setUIValue(a.join(":"),!0,null,"click"),profile.box&&profile.box._hourC(profile)}},HI:{onMouseover:function(profile,e,src){profile.properties.disableHoverEffect||profile.box._mover(xui.use(src).get(0),2)},onMouseout:function(profile,e,src){profile.properties.disableHoverEffect||profile.box._mout(xui.use(src).get(0),2)},onClick:function(profile,e,src){profile.$hour=profile.getSubId(src),profile.boxing()._setCtrlValue(profile.$hour+":"+profile.$minute),profile.box&&profile.box._hourC(profile)},onDblclick:function(profile,e,src){profile.$hour=profile.getSubId(src),profile.boxing().setUIValue(profile.$hour+":"+profile.$minute,!0,null,"dblclick"),profile.box&&profile.box._hourC(profile)}},MI:{onMouseover:function(profile,e,src){profile.properties.disableHoverEffect||profile.box._mover(xui.use(src).get(0))},onMouseout:function(profile,e,src){profile.properties.disableHoverEffect||profile.box._mout(xui.use(src).get(0))},onClick:function(profile,e,src){profile.$minute=profile.getSubId(src),profile.boxing().setUIValue(profile.$hour+":"+profile.$minute,!0,null,"click2"),profile.box&&profile.box._hourC(profile)}},PRE:{onClick:function(profile,e,src){var p=profile.properties;if(!p.disabled&&!p.readonly){var v=profile.$minute;v=((v=(parseFloat(v)||0)-1)%60+60)%60,profile.$minute=v=(v<=9?"0":"")+v,profile.boxing()._setCtrlValue(profile.$hour+":"+profile.$minute),profile.box&&profile.box._hourC(profile)}}},NEXT:{onClick:function(profile,e,src){var p=profile.properties;if(!p.disabled&&!p.readonly){var v=profile.$minute;v=((v=(parseFloat(v)||0)+1)%60+60)%60,profile.$minute=v=(v<=9?"0":"")+v,profile.boxing()._setCtrlValue(profile.$hour+":"+profile.$minute),profile.box&&profile.box._hourC(profile)}}},PRE2:{onClick:function(profile,e,src){var p=profile.properties;if(!p.disabled&&!p.readonly){var v=profile.$hour;v=((v=(parseFloat(v)||0)-1)%24+24)%24,profile.$hour=v=(v<=9?"0":"")+v,profile.boxing()._setCtrlValue(profile.$hour+":"+profile.$minute),profile.box&&profile.box._hourC(profile)}}},NEXT2:{onClick:function(profile,e,src){var p=profile.properties;if(!p.disabled&&!p.readonly){var v=profile.$hour;v=((v=(parseFloat(v)||0)+1)%24+24)%24,profile.$hour=v=(v<=9?"0":"")+v,profile.boxing()._setCtrlValue(profile.$hour+":"+profile.$minute),profile.box&&profile.box._hourC(profile)}}},CLOSE:{onClick:function(profile,e,src){var properties=profile.properties,instance=profile.boxing();properties.disabled||properties.readonly||!1!==instance.beforeClose(profile,src)&&instance.destroy(!0)}}},DataModel:{height:{ini:"auto",readonly:!0},width:{ini:"auto",readonly:!0},value:{ini:"00:00",format:"time"},closeBtn:{ini:!0,action:function(v){this.getSubNode("CLOSE").css("display",v?"":"none")}}},EventHandlers:{beforeClose:function(profile,src){}},_hourC:function(profile){var a=profile.properties.$UIvalue.split(":"),d=a[0]+""==profile.$hour+""&&a[1]+""==profile.$minute+"";profile.getSubNode("SET").css("display",d?"none":"block"),profile.getSubNode("CAPTION").css("color",d?"":"#ff0000")},_prepareData:function(profile){var data=arguments.callee.upper.call(this,profile),nodisplay="display:none";return data.closeDisplay=data.closeBtn?"":nodisplay,data._set=xui.wrapRes("inline.set"),data},_ensureValue:function(profile,value){var a,b=[];return a=value&&"string"==typeof value?value.split(":"):value&&"object"==typeof value&&xui.isArr(value)?value:[],b[0]=parseFloat(a[0])||0,b[1]=parseFloat(a[1])||0,b[0]<0&&(b[0]=0),b[0]>23&&(b[0]=23),b[1]<0&&(b[1]=0),b[1]>59&&(b[1]=59),b[0]=(b[0]<=9?"0":"")+b[0],b[1]=(b[1]<=9?"0":"")+b[1],b.join(":")},formatValue:function(value){return value.join(":")},_v2a:function(v){return"string"==typeof v?v.split(":"):v},_showV:function(profile,a){var f=profile.CF;return"function"==typeof f.formatCaption?f.formatCaption(a):a.join(":")},_onresize:function(){}}}),xui.Class("xui.UI.List",["xui.UI","xui.absList","xui.absValue"],{Instance:{_setCtrlValue:function(value){return this.each((function(profile){if(profile.renderId){var box=profile.box,uiv=profile.boxing().getUIValue(),p=profile.properties,item=box._ITEMKEY||"ITEM",mk=(box._DIRTYKEY,"MARK"),getN=function(k,i){return profile.getSubNode(k,i)},getI=function(i){return profile.getSubIdByItemId(i)};if("single"==p.selMode){var itemId=getI(uiv);if(null!==uiv&&itemId&&(getN(item,itemId).tagClass("-checked",!1).tagClass("-hover",!1),getN(mk,itemId).tagClass("-checked",!1)),(itemId=getI(value))&&(getN(item,itemId).tagClass("-checked"),getN(mk,itemId).tagClass("-checked")),itemId){var o=getN(item,itemId);if(o){var items=profile.getSubNode("ITEMS"),offset=o.offset(null,items),top=offset?offset.top:0,height=o.offsetHeight(),sh=items.scrollHeight(),st=items.scrollTop(),hh=items.height();sh>hh&&(top<st||top+height>st+hh)&&items.scrollTop(top)}}}else"multi"!=p.selMode&&"multibycheckbox"!=p.selMode||(uiv=uiv?uiv.split(p.valueSeparator):[],value=value?value.split(p.valueSeparator):[],xui.arr.each(uiv,(function(o){getN(item,getI(o)).tagClass("-checked",!1).tagClass("-hover",!1),getN(mk,getI(o)).tagClass("-checked",!1)})),xui.arr.each(value,(function(o){getN(item,getI(o)).tagClass("-checked"),getN(mk,getI(o)).tagClass("-checked")})))}}))},_clearMouseOver:function(){var item=this.constructor._ITEMKEY||"ITEM";this.getSubNode(item,!0).tagClass("-hover",!1)},adjustSize:function(){return this.each((function(profile){var h,flag,root=profile.getRoot(),items=profile.getSubNode("ITEMS"),pp=profile.properties,mh=pp.maxHeight,h_em=profile.$isEm(pp.height);profile.$isEm(mh)&&(mh=profile.$em2px(mh,items,!0)),"none"==root.css("display")&&(flag=1,root.css("visibility","hidden")),items.height("auto"),"auto"!=profile.properties.height?(h=Math.min(mh,items.offsetHeight()),h_em&&(h=profile.$px2em(h,items)+"em"),items.height(pp.height=h)):(h=items.offsetHeight())>mh&&(items.height(pp.maxHeight),profile.getRoot().height(pp.maxHeight)),flag&&(root.css("visibility",""),root.css("display","none")),profile.getRoot().height("auto")}))},activate:function(){return xui.absList.prototype.activate.call(this)},getShowValue:function(value){var v,pro=this.get(0).properties;return xui.isDefined(value)||(value=pro.$UIvalue),v=-1!=(v=xui.arr.subIndexOf(pro.items,"id",value))?"$"==(v=pro.items[v].caption).charAt(0)?xui.getRes(v.slice(1)):v:""},_setDirtyMark:function(){return arguments.callee.upper.apply(this,["ITEMS"])}},Static:{_DIRTYKEY:"ITEM",Templates:{tagName:"div",style:"{_style}",className:"{_className}",LABEL:{className:"{_required} xui-ui-ellipsis",style:"{labelShow};width:{_labelSize};{_labelHAlign};{_labelVAlign}",text:"{labelCaption}"},ITEMS:{$order:10,tagName:"div",className:"xui-uibase {_cmdsalign} {_bordertype} {_itemscls1}",text:"{items}"},$submap:{items:{ITEM:{className:"xui-uitembg xui-uiborder-radius xui-showfocus {_itemCls} {_split} {itemClass} {disabled} {readonly}",style:"{itemStyle};{_itemDisplay};",tabindex:"{_tabindex}",LTAGCMDS:{$order:2,tagName:"span",style:"{_ltagDisplay}",text:"{ltagCmds}"},MARK:{$order:5,className:"xuifont",$fonticon:"xui-uicmd-check",style:"{_cbDisplay}"},ICON:{$order:10,className:"xuicon {imageClass}  {picClass}",style:"{backgroundImage}{backgroundPosition}{backgroundSize}{backgroundRepeat}{iconFontSize}{imageDisplay}{iconStyle}",text:"{iconFontCode}"},CAPTION:{style:"{_capDisplay}",text:"{caption}",$order:20},EXTRA:{style:"{_extraDisplay}",text:"{ext}",$order:30},RTAGCMDS:{$order:40,tagName:"span",style:"{_rtagDisplay}",text:"{rtagCmds}"},OPT:{$order:50,style:"{_optDisplay}",className:"xuifont",$fonticon:"{_fi_optClass}"}}},"items.ltagCmds":function(profile,template,v,tag,result){var me=arguments.callee,map=me._m||(me._m={text:".text",button:".button",image:".image"});xui.UI.$doTemplate(profile,template,v,"items.tagCmds"+(map[v.type]||".button"),result)},"items.rtagCmds":function(profile,template,v,tag,result){var me=arguments.callee,map=me._m||(me._m={text:".text",button:".button",image:".image"});xui.UI.$doTemplate(profile,template,v,"items.tagCmds"+(map[v.type]||".button"),result)},"items.tagCmds.text":xui.UI.$getTagCmdsTpl("text"),"items.tagCmds.button":xui.UI.$getTagCmdsTpl("button"),"items.tagCmds.image":xui.UI.$getTagCmdsTpl("image")}},Appearances:{KEY:{},LABEL:{"z-index":1,top:0,left:0,display:xui.browser.isWebKit?"-webkit-flex":"flex",position:"absolute","padding-top":".333em"},EXTRA:{display:"none"},ITEMS:{position:"relative",overflow:"auto","overflow-x":"hidden"},ITEM:{display:"block",zoom:xui.browser.ie?1:null,cursor:"pointer",position:"relative","white-space":"nowrap"},MARK:{$order:1,cursor:"pointer","vertical-align":"middle"},CAPTION:{"vertical-align":xui.browser.ie6?"baseline":"middle",padding:".167em","font-size":"1em","white-space":"normal"},OPT:{$order:10,position:"absolute",left:"auto",top:"50%","margin-top":"-0.5em",right:".167em",display:"none"},"LTAGCMDS, RTAGCMDS":{padding:0,margin:0,"vertical-align":"middle"},"ITEMS-tagcmdleft RTAGCMDS":{"padding-right":".333em",float:"left"},"ITEMS-tagcmdfloatright RTAGCMDS":{"padding-right":".333em",float:"right"}},Behaviors:{HoverEffected:{ITEM:"ITEM",OPT:"OPT",CMD:"CMD",ICON:"ICON"},ClickEffected:{ITEM:"ITEM",OPT:"OPT",CMD:"CMD"},DraggableKeys:["ITEM"],DroppableKeys:["ITEM","ITEMS"],ITEM:{onDblclick:function(profile,e,src){profile.properties;var item=profile.getItemByDom(src);profile.boxing().onDblclick(profile,item,e,src)},onClick:function(profile,e,src){var properties=profile.properties,item=profile.getItemByDom(src),box=(profile.getSubId(src),profile.boxing()),ks=xui.Event.getKey(e);if(profile.beforeClick&&!1===box.beforeClick(profile,item,e,src))return!1;if(properties.disabled||item.disabled||"split"==item.type)return!1;switch(profile.onClick&&box.onClick(profile,item,e,src),xui.use(src).focus(!0),properties.selMode){case"none":box.onItemSelected(profile,item,e,src,0);break;case"multibycheckbox":if(properties.readonly||item.readonly)return!1;if(profile.keys.MARK&&profile.getKey(xui.Event.getSrc(e).id||"")!=profile.keys.MARK){box.onItemSelected(profile,item,e,src,0);break}case"multi":if(properties.readonly||item.readonly)return!1;var value=box.getUIValue(),arr=value?value.split(properties.valueSeparator):[],checktype=1;if(arr.length&&(ks.ctrlKey||ks.shiftKey||properties.noCtrlKey||properties.$checkbox)){if(ks.shiftKey){var i,items=properties.items,i1=xui.arr.subIndexOf(items,"id",profile.$firstV.id),i2=xui.arr.subIndexOf(items,"id",item.id);for(arr.length=0,i=Math.min(i1,i2);i<=Math.max(i1,i2);i++)arr.push(items[i].id)}else-1!=xui.arr.indexOf(arr,item.id)?(xui.arr.removeValue(arr,item.id),checktype=-1):arr.push(item.id);arr.sort(),value=arr.join(properties.valueSeparator),box.getUIValue()!==value&&(box.setUIValue(value,null,null,"click"),box.get(0)&&box.getUIValue()==value&&box.onItemSelected(profile,item,e,src,checktype));break}case"single":if(properties.readonly||item.readonly)return!1;box.getUIValue()!==item.id&&(profile.$firstV=item,box.setUIValue(item.id,null,null,"click"),box.get(0)&&box.getUIValue()==item.id&&box.onItemSelected(profile,item,e,src,1))}return profile.afterClick?box.afterClick(profile,item,e,src):void 0},onKeydown:function(profile,e,src){var keys=xui.Event.getKey(e),shift=(keys[0],keys[2]),cur=xui(src),first=profile.getRoot().nextFocus(!0,!0,!1),last=profile.getRoot().nextFocus(!1,!0,!1);switch(xui.Event.getKey(e)[0]){case"tab":if(shift){if(cur.get(0)!=first.get(0))return first.focus(!0),!1}else if(cur.get(0)!=last.get(0))return last.focus(!0),!1;break;case"left":case"up":return cur.nextFocus(!1,!0,!1),cur.get(0)==first.get(0)?last.focus(!0):cur.nextFocus(!1),!1;case"right":case"down":return cur.nextFocus(!0,!1,!1),cur.get(0)==last.get(0)?first.focus(!0):cur.nextFocus(),!1;case"enter":cur.onClick(!0)}},onContextmenu:function(profile,e,src){if(profile.onContextmenu)return!1!==profile.boxing().onContextmenu(profile,e,src,profile.getItemByDom(src))},onMouseover:function(profile,e,src){if(!xui.browser.fakeTouch&&"touchOnly"!=xui.browser.deviceType){var item=profile.getItemByDom(src);item&&(profile.properties.optBtn||item.optBtn)&&profile.getSubNode("OPT",profile.getSubId(src)).setInlineBlock()}},onMouseout:function(profile,e,src){if(!xui.browser.fakeTouch&&"touchOnly"!=xui.browser.deviceType){var item=profile.getItemByDom(src);item&&(profile.properties.optBtn||item.optBtn)&&profile.getSubNode("OPT",profile.getSubId(src)).css("display","none")}}},OPT:{onClick:function(profile,e,src){if(profile.onShowOptions){var item=profile.getItemByDom(src);if(!item)return;if(!profile.properties.optBtn&&!item.optBtn)return;profile.boxing().onShowOptions(profile,item,e,src)}return!1},onDblclick:function(profile,e,src){return!1}},CMD:{onClick:function(profile,e,src){var prop=profile.properties,item=profile.getItemByDom(xui.use(src).parent().get(0));return!!item&&(prop.disabled||item.disabled||"split"==item.type||profile.onCmd&&profile.boxing().onCmd(profile,item,xui.use(src).id().split("_")[1],e,src),!1)}},LABEL:{onClick:function(profile,e,src){if(profile.properties.disabled)return!1;profile.onLabelClick&&profile.boxing().onLabelClick(profile,e,src)},onDblClick:function(profile,e,src){if(profile.properties.disabled)return!1;profile.onLabelDblClick&&profile.boxing().onLabelDblClick(profile,e,src)},onMousedown:function(profile,e,src){if("left"==xui.Event.getBtn(e))return!profile.properties.disabled&&void(profile.onLabelActive&&profile.boxing().onLabelActive(profile,e,src))}}},DataModel:{lite:{private:1,ini:!1,action:function(value){this.boxing().refresh()}},selMode:{ini:"single",listbox:["single","none","multi","multibycheckbox"],action:function(value){this.box._ITEMMARKED||this.getSubNode("MARK",!0).css("display","multi"==value||"multibycheckbox"==value?"":"none")}},borderType:{ini:"flat",listbox:["none","flat","inset","outset"],action:function(v){this.properties;var node=this.getSubNode("ITEMS");this.getRoot(),node.removeClass(/^xui-uiborder-/),node.addClass("xui-uiborder-"+v),this.adjustSize()}},noCtrlKey:!0,width:{$spaceunit:1,ini:"10em"},height:{$spaceunit:1,ini:"15em"},maxHeight:420,itemRow:{ini:"",combobox:["row","cell"],action:function(v){var ns=this.getSubNode("ITEM",!0);ns.removeClass(/xui-item-[\w]+/),v&&ns.addClass("xui-item-"+(v||"row"))}},optBtn:{ini:"",combobox:xui.toArr("xui-uicmd-opt,xui-icon-singleright"),action:function(){this.boxing().refresh()}},tagCmds:{ini:[],action:function(){this.boxing().refresh()}},tagCmdsAlign:{ini:"right",listbox:["left","right","floatright"],action:function(v){var box=this.getSubNode("ITEMS"),cls=this.getClass("ITEMS","-tagcmd");box.removeClass(new RegExp(cls+"[w]*")).addClass(this.getClass("ITEMS","-tagcmd"+v))}},labelSize:{$spaceunit:2,ini:0,action:function(v){this.getSubNode("LABEL").css({display:v?"":"none"}),xui.UI.$doResize(this,this.properties.width,this.properties.height,!0)}},labelPos:{ini:"left",listbox:["none","left","top","right","bottom"],action:function(v){xui.UI.$doResize(this,this.properties.width,this.properties.height,!0)}},labelGap:{$spaceunit:2,ini:4,action:function(v){xui.UI.$doResize(this,this.properties.width,this.properties.height,!0)}},labelCaption:{ini:"",action:function(v){v=(xui.isSet(v)?v:"")+"",this.getSubNode("LABEL").html(xui.adjustRes(v,!0))}},labelHAlign:{ini:"right",listbox:["","left","center","right"],action:function(v){this.getSubNode("LABEL").css({textAlign:v||"",justifyContent:"right"==v?"flex-end":"center"==v?"center":"left"==v?"flex-start":""})}},labelVAlign:{ini:"top",listbox:["","top","middle","bottom"],action:function(v){this.getSubNode("LABEL").css("align-items","bottom"==v?"flex-end":"middle"==v?"center":"top"==v?"flex-start":"")}}},EventHandlers:{onClick:function(profile,item,e,src){},onCmd:function(profile,item,cmdkey,e,src){},beforeClick:function(profile,item,e,src){},afterClick:function(profile,item,e,src){},onDblclick:function(profile,item,e,src){},onShowOptions:function(profile,item,e,src){},onItemSelected:function(profile,item,e,src,type){},onLabelClick:function(profile,e,src){},onLabelDblClick:function(profile,e,src){},onLabelActive:function(profile,e,src){}},_onStartDrag:function(profile,e,src,pos){return pos=xui.Event.getPos(e),xui.use(src).startDrag(e,{dragSource:profile.$xid,dragType:"icon",shadowFrom:src,targetLeft:pos.left+12,targetTop:pos.top+12,dragCursor:"pointer",dragDefer:2,dragKey:profile.box.getDragKey(profile,src),dragData:profile.box.getDragData(profile,e,src)}),!1},_onDropTest:function(profile,e,src,key,data,item){var fid=data&&data.domId,tid=xui.use(src).id();if(fid){if(fid==tid)return!1;if(xui.get(xui.use(src).get(0),["previousSibling","id"])==fid)return!1}},_onDrop:function(profile,e,src,key,data,item){var oitem,k=profile.getKey(xui.use(src).id()),po=data.profile,ps=data.domId,t=xui.absObj.$specialChars,uiv=profile.properties.$UIvalue;return oitem=xui.clone(po.getItemByDom(ps),(function(o,i){return!t[(i+"").charAt(0)]})),po.boxing().removeItems([oitem.id]),k==profile.keys.ITEM?profile.boxing().insertItems([oitem],item.id,!0):profile.boxing().insertItems([oitem]),oitem.id==uiv&&profile.boxing().setUIValue(oitem.id,!0,null,"drop"),data._new=oitem,!1},_prepareData:function(profile){var v,d=arguments.callee.upper.call(this,profile);return d._bordertype="xui-uiborder-"+d.borderType,d._labelHAlign="text-align:"+(v=d.labelHAlign||"")+";justify-content:"+("right"==v?"flex-end":"center"==v?"center":"left"==v?"flex-start":""),d._labelVAlign="align-items:"+("bottom"==(v=d.labelVAlign)?"flex-end":"middle"==v?"center":"top"==v?"flex-start":""),d.labelShow="none"!=d.labelPos&&d.labelSize&&"auto"!=d.labelSize?"":"display:none",d._labelSize=d.labelSize?"":0+profile.$picku(),d.labelCaption&&(d.labelCaption=xui.adjustRes(d.labelCaption,!0)),d._cmdsalign=profile.getClass("ITEMS","-tagcmd"+profile.properties.tagCmdsAlign),d},_prepareItem:function(profile,item){var t,p=profile.properties,m=p.selMode;item._cbDisplay="multi"==m||"multibycheckbox"==m?"":"display:none;",item._itemCls=(t=profile.properties.itemRow)?"xui-item-"+t:"",p.lite&&(item._itemCls+=" xui-ui-clear-size "),(xui.browser.fakeTouch||"mouseOnly"!==xui.browser.deviceType)&&(item._optDisplay=p.optBtn?"display:block;":""),item._fi_optClass=p.optBtn,"split"==item.type&&(item._split="xui-uitem-split",item._ltagDisplay=item._rtagDisplay=item.imageDisplay=item._cbDisplay=item._capDisplay=item._extraDisplay=item._optDisplay="display:none;"),this._prepareCmds(profile,item)},_dynamicTemplate:function(profile){var t,prop=profile.properties,hash=profile._exhash="$lite:"+prop.lite,template=profile.box.getTemplate(hash);prop.$UIvalue=prop.value,template||(template=xui.clone(profile.box.getTemplate()),prop.lite&&(delete template.LABEL,(t=template.$submap.items).ITEM={className:t.ITEM.className,style:t.ITEM.style,tabindex:t.ITEM.tabindex,text:"{caption}"}),profile.box.setTemplate(template,hash)),profile.template=template},RenderTrigger:function(){if("xui.UI.List"==this.key){var p=this.properties;xui.UI.$doResize(this,p.width,p.height)}},_onresize:function(profile,width,height){var ww,hh,prop=profile.properties,us=xui.$us(profile),adjustunit=function(v,emRate){return profile.$forceu(v,us>0?"em":"px",emRate)},root=profile.getRoot(),cb=xui.browser.contentBox,f=function(k){return profile.getSubNode(k)},items=f("ITEMS"),label=f("LABEL"),fzrate=profile.getEmSize()/root._getEmSize(),itemsfz=items._getEmSize(fzrate),labelfz=label._getEmSize(fzrate),border=cb&&"none"!=prop.borderType?items._borderW():0,dock=prop.dock,max=prop.maxHeight,labelPos=prop.labelPos,labelSize="none"!=labelPos&&labelPos&&profile.$px(prop.labelSize,labelfz)||0,labelGap="none"!=labelPos&&labelPos&&profile.$px(prop.labelGap)||0;width&&"auto"!=width&&(width=profile.$px(width)),height&&"auto"!=height&&(height=profile.$px(height)),items.cssRegion({left:adjustunit("left"==labelPos?labelSize:0,itemsfz),top:adjustunit("top"==labelPos?labelSize:0,itemsfz),width:adjustunit(ww=null===width?null:"auto"==width?width:Math.max(0,width-(cb?items._paddingW("both"):0)-("left"==labelPos||"right"==labelPos?labelSize:0)-border),itemsfz),height:adjustunit(hh=null===height?null:"auto"==height?height:Math.max(0,height-(cb?items._paddingH("both"):0)-("top"==labelPos||"bottom"==labelPos?labelSize:0)-border),itemsfz)}),"auto"==height&&"fill"!=dock&&"cover"!=dock&&"height"!=dock&&"left"!=dock&&"right"!=dock&&items.height()>max&&(items.height(adjustunit(max,itemsfz)),root.height("auto")),labelSize&&("auto"==width&&(ww=items.offsetWidth()),"auto"==height&&(hh=items.offsetHeight()),label.cssRegion({left:adjustunit(null===width?null:Math.max(0,"right"==labelPos?("auto"==width?ww:width-labelSize)+labelGap:0),labelfz),top:adjustunit(null===height?null:Math.max(0,"bottom"==labelPos?("auto"==height?hh:height-labelSize)+labelGap:0),labelfz),width:adjustunit(null===width?null:Math.max(0,"left"==labelPos||"right"==labelPos?labelSize-labelGap:"auto"==width?ww:width),labelfz),height:adjustunit(null===height?null:Math.max(0,"top"==labelPos||"bottom"==labelPos?labelSize-labelGap:"auto"==height?hh:height),labelfz)}))}}}),xui.Class("xui.UI.Gallery","xui.UI.List",{Instance:{getStatus:function(id){var item=this.get(0).getItemByItemId(id);return item&&item._status||"ini"},_afterInsertItems:function(profile){profile.getSubNodes("IMAGE",!0).each((function(o){o.src==xui.ini.img_bg&&(xui.browser.isFF&&(o.src=""),o.src=o.title,o.title="")}))}},Initialize:function(){var t=this.getTemplate();t.$submap={items:{ITEM:{tabindex:"{_tabindex}",className:"xui-uitembg xui-uiborder-radius xui-showfocus {itemClass} {disabled} {readonly}",style:"padding:{itemPadding};margin:{itemMargin};{_itemSize};{itemStyle}",ITEMFRAME:{style:"{_inneritemSize}",CAPTION:{tagName:"div",className:"xui-ui-ellipsis",style:"{capDisplay}",text:"{caption}",$order:0},CONTENT:{tagName:"div",$order:1,style:"{_loadbg}",ICON:{className:"xuifont {_imageClass}",style:"{_fontSize}",text:"{iconFontCode}"},IMAGE:{tagName:"img",src:xui.ini.img_bg,title:"{image}",style:"{_innerimgSize};{imgStyle}"}},COMMENT:{tagName:"div",className:"xui-ui-ellipsis",text:"{comment}",style:"{commentDisplay}",$order:2}},FLAG:{$order:20,className:"xui-display-none xui-uiflag {flagClass}",style:"{_flagStyle};{flagStyle}",text:"{flagText}"},EXTRA:{text:"{ext}",$order:30}}}},this.setTemplate(t),xui.UI.IconList=xui.UI.Gallery;var key="xui.UI.IconList";xui.absBox.$type[key.replace("xui.UI.","")]=xui.absBox.$type[key]=key},Static:{IMGNODE:1,Appearances:{EXTRA:{display:"none"},KEY:{overflow:"visible"},ITEMS:{position:"relative",overflow:"auto","overflow-x":"hidden",zoom:xui.browser.ie6?1:null},"ITEMS-nowrap":{"white-space":"nowrap"},ITEM:{display:xui.$inlineBlock,zoom:xui.browser.ie67?1:null,position:"relative",cursor:"pointer","vertical-align":"top",margin:0},ITEMFRAME:{display:xui.browser.ie67?xui.$inlineBlock:"block",zoom:xui.browser.ie67?1:null,position:"relative",overflow:"hidden",border:0,padding:0,margin:0,"-moz-box-flex":"1"},IBWRAP:{},IMAGE:{display:xui.$inlineBlock,zoom:xui.browser.ie6?1:null,"vertical-align":"middle"},CAPTION:{"text-align":"center",overflow:"hidden","white-space":"nowrap","font-weight":"bold","font-size":"1em"},CONTENT:{"text-align":"center","white-space":"nowrap","background-repeat":"no-repeat","background-position":"center center","font-size":"1em"},COMMENT:{display:"block",margin:".1667em","text-align":"center","font-size":"1em"},FLAG:{position:"absolute","z-index":10}},Behaviors:{IMAGE:{onLoad:function(profile,e,src){var path=xui.use(src).get(0).src;if(path!=xui.ini.img_bg){var p=profile.properties,nn=xui.use(src),node=nn.get(0),item=profile.getItemByDom(src);if(!item)return;var icon=profile.getSubNodeByItemId("ICON",item.id);item.autoImgSize||p.autoImgSize?(nn.attr("width",""),nn.attr("height","")):(nn.attr("width",item.imgWidth),nn.attr("height",item.imgWidth)),icon.removeClass("xui-icon-loading"),item.iconFontCode||item.imageClass||icon.addClass("xui-display-none"),nn.onLoad(null).onError(null).$removeEventHandler("load").$removeEventHandler("error"),item._status="loaded",xui.ini.img_blank==path?node.style.display="none":node.style.display=""}},onError:function(profile,e,src){var item=profile.getItemByDom(src);if("error"!=item._status){profile.properties;var nn=xui.use(src),node=nn.get(0);profile.getSubNodeByItemId("ICON",item.id).removeClass("xui-icon-loading xui-display-none").addClass("xui-load-error"),nn.onLoad(null).onError(null).$removeEventHandler("load").$removeEventHandler("error"),node.style.display="none",item._status="error"}}},FLAG:{onClick:function(profile,e,src){var item=profile.getItemByDom(src),box=profile.boxing();if(profile.onFlagClick)return box.onFlagClick(profile,item,e,src),!1}}},DataModel:{lite:null,tagCmds:null,tagCmdsAlign:null,autoImgSize:{ini:!1,action:function(){this.boxing().refresh()}},autoItemSize:{ini:!0,action:function(){this.boxing().refresh()}},iconOnly:{ini:!1,action:function(){this.boxing().refresh()}},iconFontSize:{ini:"",action:function(v){this.getSubNode("ICON",!0).css("font-size",v)}},itemMargin:{ini:6,action:function(v){this.getSubNode("ITEM",!0).css("margin",v||0)}},itemPadding:{ini:2,action:function(v){this.getSubNode("ITEM",!0).css("padding",v||0)}},itemWidth:{$spaceunit:1,ini:32,action:function(v){this.properties.autoItemSize||this.getSubNode("ITEMFRAME",!0).width(v||"")}},itemHeight:{$spaceunit:1,ini:32,action:function(v){this.properties.autoItemSize||this.getSubNode("ITEMFRAME",!0).height(v||"")}},imgWidth:{ini:16,action:function(v){this.properties.autoImgSize||this.getSubNode("IMAGE",!0).width(v||"")}},imgHeight:{ini:16,action:function(v){this.properties.autoImgSize||this.getSubNode("IMAGE",!0).height(v||"")}},width:{$spaceunit:1,ini:"16rem"},height:{$spaceunit:1,ini:"16rem"},columns:{ini:0,action:function(){this.boxing().refresh()}},rows:{ini:0,action:function(){this.boxing().refresh()}}},EventHandlers:{onCmd:null,onFlagClick:function(profile,item,e,src){}},_prepareData:function(profile){var d=arguments.callee.upper.call(this,profile),p=profile.properties;return p.cols&&(d._itemscls1=profile.getClass("ITEMS","-nowrap")),d},_prepareItem:function(profile,item){var t,p=profile.properties,cols=p.columns,rows=p.rows,auto1=item.autoItemSize||p.autoItemSize,auto2=item.autoImgSize||p.autoImgSize;xui.arr.each(xui.toArr("itemWidth,itemHeight,imgWidth,imgHeight,itemPadding,itemMargin,iconFontSize,autoItemSize,autoImgSize"),(function(i){item[i]=xui.isSet(item[i])?item[i]:p[i]})),item.itemWidth=!auto1&&(t=item.itemWidth)?profile.$forceu(t):"",item.itemHeight=!auto1&&(t=item.itemHeight)?profile.$forceu(t):"",item.itemMargin=(t=item.itemMargin)?profile.$forceu(t):0,item.itemPadding=(t=item.itemPadding)?profile.$forceu(t):0,item.imgWidth=!auto2&&(t=item.imgWidth)?profile.$forceu(t):"",item.imgHeight=!auto2&&(t=item.imgHeight)?profile.$forceu(t):"",item._tabindex=p.tabindex,(t=item.iconFontSize)&&(item._fontSize="font-size:"+t),item._imageClass="",item.iconFontCode||item.imageClass||(item._imageClass+="xui-icon-loading"),item.imageClass&&(item._imageClass+=" "+item.imageClass),(item.flagText||item.flagClass)&&(item._flagStyle="display:block"),item.flagClass||(item.flagClass="xui-uiflag-1"),p.iconOnly&&(delete item.caption,delete item.comment),""===(item.caption=item.caption||"")&&(item.capDisplay="display:none;"),""===(item.comment=item.comment||"")&&(item.commentDisplay="display:none;"),item._itemSize="",cols&&(item._itemSize+="width:"+100/cols+"%;border:0;margin-left:0;margin-right:0;padding-left:0;padding-right:0;"),rows&&(item._itemSize+="height:"+100/rows+"%;border:0;margin-top:0;margin-bottom:0;padding-top:0;padding-bottom:0;"),auto1||(item._inneritemSize=(!cols&&item.itemWidth?"width:"+item.itemWidth+";":"")+(!rows&&item.itemHeight?"height:"+item.itemHeight:"")),auto2||(item._innerimgSize=(item.imgWidth?"width:"+item.imgWidth+";":"")+(!rows&&item.imgHeight?"height:"+item.imgHeight:""))},RenderTrigger:function(){this.boxing()._afterInsertItems(this)}}}),xui.Class("xui.UI.Panel","xui.UI.Div",{Instance:{activate:function(){return this.get(0).getSubNode("CAPTION").focus(!0),this},resetPanelView:function(removeChildren,destroyChildren){var ins;return xui.isSet(removeChildren)||(removeChildren=!0),xui.isSet(destroyChildren)||(destroyChildren=!0),this.each((function(profile){profile.renderId&&(delete profile.$ini,removeChildren&&(ins=profile.boxing()).removeChildren(!0,destroyChildren),profile.properties.toggle&&ins.setToggle(!1))}))},iniPanelView:function(){return this.each((function(profile){if(!profile.$ini){profile.$ini=!0;var p=profile.properties;profile.onIniPanelView&&profile.boxing().onIniPanelView(profile),(p.iframeAutoLoad||p.ajaxAutoLoad)&&xui.UI.Div._applyAutoLoad(profile)}}))}},Static:{Templates:{tagName:"div",style:"{_style}",className:"{_className}",BORDER:{tagName:"div",className:"xui-uiborder-outset xui-uiborder-box xui-uiborder-radius-big",TBAR:{tagName:"div",className:"xui-uibar-top",BARTDL:{className:"xui-uibar-tdl xui-uibar xui-uiborder-radius-big-tl",BARTDLT:{className:"xui-uibar-tdlt"}},BARTDM:{$order:1,className:"xui-uibar-tdm xui-uibar",BARTDMT:{className:"xui-uibar-tdmt"}},BARTDR:{$order:2,className:"xui-uibar-tdr xui-uibar xui-uiborder-radius-big-tr",BARTDRT:{className:"xui-uibar-tdrt"}},BARCMDL:{$order:3,tagName:"div",className:"xui-uibar-cmdl",style:"{_align}",LTAGCMDS:{tagName:"span",className:"xui-ltag-cmds",style:"{_ltagDisplay}",text:"{ltagCmds}"},TOGGLE:{$order:1,className:"xuifont",$fonticon:"{_fi_toggleCls2}",style:"{toggleDisplay}"},ICON:{$order:2,className:"xuicon {imageClass}  {picClass}",style:"{backgroundImage}{backgroundPosition}{backgroundSize}{backgroundRepeat}{iconFontSize}{imageDisplay}{iconStyle}",text:"{iconFontCode}"},CAPTION:{tabindex:"{tabindex}",className:"xui-title-node",text:"{caption}",$order:3}},BARCMDR:{$order:4,tagName:"div",className:"xui-uibar-cmdr",RTAGCMDS:{$order:0,tagName:"span",className:"xui-rtag-cmds",style:"{_rtagDisplay}",text:"{rtagCmds}"},INFO:{className:"xuicon",$fonticon:"xui-uicmd-info",style:"{infoDisplay}",$order:1},OPT:{className:"xuicon",$fonticon:"xui-uicmd-opt",style:"{optDisplay}",$order:2},POP:{className:"xuicon",$fonticon:"xui-uicmd-pop",style:"{popDisplay}",$order:3},REFRESH:{className:"xuicon",$fonticon:"xui-uicmd-refresh",style:"{refreshDisplay}",$order:4},CLOSE:{className:"xuicon",$fonticon:"xui-uicmd-close",style:"{closeDisplay}",$order:5}}},MAIN:{$order:2,tagName:"div",className:"xui-uicon-main xui-uibar",style:"{_leftp}",MAINI:{tagName:"div",className:"xui-uicon-maini xui-uibar",style:"{_rightp}",PANEL:{tagName:"div",className:"xui-uibase xui-uicontainer {_bordertype}",style:"{panelDisplay};{_panelstyle};{_overflow};",text:"{html}"+xui.UI.$childTag}}},BBAR:{$order:3,tagName:"div",className:"xui-uibar-bottom-s",style:"{_bbarDisplay}",BBARTDL:{className:"xui-uibar-tdl xui-uibar xui-uiborder-radius-big-bl"},BBARTDM:{$order:1,className:"xui-uibar-tdm xui-uibar"},BBARTDR:{$order:2,className:"xui-uibar-tdr xui-uibar xui-uiborder-radius-big-br"}}},$submap:xui.UI.$getTagCmdsTpl()},Appearances:{KEY:{background:"transparent"},"LTAGCMDS, RTAGCMDS":{padding:0,margin:0,"vertical-align":"middle"},"KEY BORDER":{zoom:xui.browser.ie6?1:null},"TBART, BBART":{"border-spacing":0,"border-collapse":"separate"},PANEL:{position:"relative",left:0,top:0,overflow:"auto","line-height":"normal",zoom:xui.browser.ie6?1:null},CAPTION:{display:"inline",padding:".25em","vertical-align":xui.browser.ie6?"baseline":"middle"}},Behaviors:{DroppableKeys:["PANEL"],PanelKeys:["PANEL"],DraggableKeys:["TBAR"],NavKeys:{CAPTION:1},NoDraggableKeys:["INFO","OPT","CLOSE","POP","REFRESH","TOGGLE","CMD","TOGGLE"],HoverEffected:{INFO:"INFO",OPT:"OPT",CLOSE:"CLOSE",POP:"POP",REFRESH:"REFRESH",CMD:"CMD",TOGGLE:"TOGGLE",ICON:"ICON"},ClickEffected:{INFO:"INFO",OPT:"OPT",CLOSE:"CLOSE",POP:"POP",REFRESH:"REFRESH",CMD:"CMD",TOGGLE:"TOGGLE"},TOGGLE:{onClick:function(profile,e,src){if(profile.properties.toggleBtn)return profile.box._toggle(profile,!profile.properties.toggle),!1}},CAPTION:{onClick:function(profile,e,src){if(!profile.onClickBar||!1===profile.boxing().onClickBar(profile,src))return xui.Event.getKey(e).shiftKey}},PANEL:{onClick:function(profile,e,src){return!profile.properties.disabled&&(profile.onClickPanel?profile.boxing().onClickPanel(profile,e,src):void 0)}},INFO:{onClick:function(profile,e,src){profile.boxing().onShowInfo(profile,e,src)}},OPT:{onClick:function(profile,e,src){profile.boxing().onShowOptions(profile,e,src)}},REFRESH:{onClick:function(profile,e,src){profile.boxing().onRefresh(profile)}},CLOSE:{onClick:function(profile,e,src){if(!profile.properties.disabled){var instance=profile.boxing();!1!==instance.beforeClose(profile)&&instance.destroy()}}},POP:{onClick:function(profile,e,src){var properties=profile.properties;if(!properties.disabled){var pos=profile.getRoot().offset(),size=profile.getRoot().cssSize(),options={parent:null,host:null,properties:null,events:null,CS:null,CC:null,CB:null,CF:null,init:null};if(profile.beforePop&&0==profile.boxing().beforePop(profile,options,e,src))return!1;var pro=xui.copy(xui.UI.Dialog.$DataStruct),events={};xui.merge(pro,properties,"with"),xui.merge(pro,{dock:"none",width:Math.max(size.width,200),height:Math.max(size.height,100),left:pos.left,top:pos.top,landBtn:!0},"all"),options.properties&&xui.merge(pro,options.properties,"with"),options.events&&xui.merge(events,options.events,"all");var dialog=new xui.UI.Dialog(pro,events,options.host||profile.host,options.CS||null,options.CC||null,options.CB||null,options.CF||null);if(xui.isFun(options.init)&&!1===options.init(dialog,profile,options));else{dialog.show(options.parent||xui("body"));var arr=[];xui.arr.each(profile.children,(function(o){arr.push(o[0])})),arr.length&&dialog.append(xui.UI.pack(arr,!1)),profile.boxing().removeChildren().destroy(!0)}}}},CMD:{onClick:function(profile,e,src){return profile.properties.disabled||profile.onCmd&&profile.boxing().onCmd(profile,xui.use(src).id().split("_")[1],e,src),!1}}},DataModel:{rotate:null,selectable:!0,dock:"fill",caption:{ini:undefined,action:function(v){v=(xui.isSet(v)?v:"")+"",this.getSubNode("CAPTION").html(xui.adjustRes(v,!0))}},html:{action:function(v,ov,force){this.getSubNode("PANEL").html(xui.adjustRes(v,0,1),null,null,force)}},toggle:{ini:!0,action:function(v){this.box._toggle(this,v)}},image:{format:"image",action:function(v){xui.UI.$iconAction(this)}},imagePos:{action:function(value){this.getSubNode("ICON").css("backgroundPosition",value||"center")}},imageBgSize:{action:function(value){this.getSubNode("ICON").css("backgroundSize",value||"")}},imageClass:{ini:"",action:function(v,ov){xui.UI.$iconAction(this,"ICON",ov)}},iconFontCode:{action:function(v){xui.UI.$iconAction(this)}},borderType:{ini:"inset",listbox:["none","flat","inset","outset"],action:function(v){this.properties;var node=this.getSubNode("PANEL");this.getRoot(),node.removeClass(/^xui-uiborder-/),node.addClass("xui-uiborder-"+v),this.adjustSize()}},noFrame:{ini:!1,action:function(v){var ns=this;ns.getRoot(),ns.getSubNode("BBAR").css("display",v?"none":""),ns.getSubNode("MAIN").css("paddingLeft",v?"0":""),ns.getSubNode("MAINI").css("paddingRight",v?"0":"").css("backgroundImage",v?"none":""),ns.adjustSize()}},hAlign:{ini:"left",listbox:["left","center","right"],action:function(v){this.getSubNode("BARCMDL").css("textAlign",v)}},toggleIcon:{listbox:["xui-uicmd-toggle","xui-uicmd-check"],ini:"xui-uicmd-toggle",action:function(v,ov){this.getSubNode("TOGGLE").replaceClass(new RegExp("\\b"+ov,"img"),v)}},infoBtn:{ini:!1,action:function(v){this.getSubNode("INFO").css("display",v?"":"none")}},optBtn:{ini:!1,action:function(v){this.getSubNode("OPT").css("display",v?"":"none")}},toggleBtn:{ini:!1,action:function(v){this.getSubNode("TOGGLE").css("display",v?"":"none")}},closeBtn:{ini:!1,action:function(v){this.getSubNode("CLOSE").css("display",v?"":"none")}},refreshBtn:{ini:!1,action:function(v){this.getSubNode("REFRESH").css("display",v?"":"none")}},popBtn:{ini:!1,action:function(v){this.getSubNode("POP").css("display",v?"":"none")}},tagCmds:{ini:[],action:function(){this.boxing().refresh()}}},LayoutTrigger:function(){this.properties.toggle?this.boxing().iniPanelView():this.box._toggle(this,!1,!0)},EventHandlers:{onIniPanelView:function(profile){},beforeFold:function(profile){},beforeExpand:function(profile){},afterFold:function(profile){},afterExpand:function(profile){},onClickBar:function(profile,src){},onClickPanel:function(profile,e,src){},beforePop:function(profile,options,e,src){},beforeClose:function(profile){},onShowInfo:function(profile,e,src){},onShowOptions:function(profile,e,src){},onRefresh:function(profile){},onCmd:function(profile,cmdkey,e,src){}},_prepareData:function(profile){var data=arguments.callee.upper.call(this,profile),nodisplay="display:none";return data._bordertype="xui-uiborder-"+data.borderType,data._bbarDisplay=data.noFrame?nodisplay:"",data._leftp=data.noFrame?"padding-left:0;":"",data._rightp=data.noFrame?"padding-right:0;background-image:none;":"",data.toggleDisplay=data.toggleBtn?"":nodisplay,data.panelDisplay=data.toggleBtn&&!data.toggle?nodisplay:"",data._fi_toggleCls2=data.toggleIcon+(data.toggleBtn&&data.toggle?" xuifont-checked "+data.toggleIcon+"-checked":""),profile._toggle=!!data.toggle,data.infoDisplay=data.infoBtn?"":nodisplay,data.optDisplay=data.optBtn?"":nodisplay,data.closeDisplay=data.closeBtn?"":nodisplay,data.popDisplay=data.popBtn?"":nodisplay,data.refreshDisplay=data.refreshBtn?"":nodisplay,data._align="text-align:"+data.hAlign+";",xui.isEmpty(data.tagCmds)||this._prepareCmds(profile,data),data},_toggle:function(profile,value,ignoreEvent){var p=profile.properties,ins=profile.boxing();if(value&&ins.iniPanelView(),ignoreEvent||profile._toggle!==!!value){if(profile._toggle=p.toggle=!!value,!ignoreEvent)if(value){if(ins.beforeExpand&&!1===ins.beforeExpand(profile))return}else if(ins.beforeFold&&!1===ins.beforeFold(profile))return;p.toggleBtn&&profile.getSubNode("TOGGLE").tagClass("-checked",!!value),profile.adjustSize(!0),ignoreEvent||(value?ins.afterExpand&&ins.afterExpand(profile):ins.afterFold&&ins.afterFold(profile)),p.dock&&"none"!=p.dock&&ins.adjustDock(!0)}},_onresize:function(profile,width,height){var t,prop=profile.properties,us=xui.$us(profile),adjustunit=function(v,emRate){return profile.$forceu(v,us>0?"em":"px",emRate)},root=profile.getRoot(),isize={},noFrame=prop.noFrame,border=profile.getSubNode("BORDER"),v1=profile.getSubNode("TBAR"),panel=profile.getSubNode("PANEL"),v4=profile.getSubNode("BBAR"),v5=profile.getSubNode("MAIN"),v6=profile.getSubNode("MAINI"),fzrate=profile.getEmSize()/root._getEmSize(),panelfz=panel._getEmSize(fzrate),cb1=border.contentBox(),h0=border._borderH(),cb2=panel.contentBox(),bordersize="none"!=profile.properties.borderType?panel._borderW():0;width&&"auto"!=width&&(width=profile.$px(width,null,!0)),height&&"auto"!=height&&(height=profile.$px(height,null,!0)),height&&(profile._toggle?panel.css("display",""):panel.css("display","none"),"auto"==height?root.height(isize.height="auto"):profile._toggle?((t=height-h0-v1.offsetHeight(!0)-(noFrame?0:v4.offsetHeight(!0)))>0&&(isize.height=adjustunit(t-(cb2?bordersize:0),panelfz)),border.height(adjustunit(height-(cb1?h0:0),border)),root.height(adjustunit(height))):(border.height("auto"),root.height("auto"))),width&&(isize.width=adjustunit(width-(noFrame?0:Math.round(parseFloat(v6.css("paddingRight")))||0)-(noFrame?0:Math.round(parseFloat(v5.css("paddingLeft")))||0)-h0-bordersize-v5._borderW()-v6._borderW(),panelfz)),profile._toggle&&(panel.cssSize(isize,!0),width&&xui.UI._adjustConW(profile,panel,isize.width))}}}),xui.Class("xui.UI.Group","xui.UI.Panel",{Static:{Templates:{tagName:"div",style:"{_style}",className:"{_className}",BORDER:{tagName:"fieldset",className:"{_fieldCls} xui-uibar-top2",TBAR:{tagName:"legend",style:"{_align}",BARCMDL:{LTAGCMDS:{tagName:"span",className:"xui-ltag-cmds",style:"{_ltagDisplay}",text:"{ltagCmds}"},TOGGLE:{$order:1,className:"xuifont",$fonticon:"{_fi_toggleCls2}",style:"{toggleDisplay}"},ICON:{$order:2,className:"xuicon {imageClass}  {picClass}",style:"{backgroundImage}{backgroundPosition}{backgroundSize}{backgroundRepeat}{iconFontSize}{imageDisplay}{iconStyle}",text:"{iconFontCode}"},CAPTION:{tabindex:"{tabindex}",className:"xui-title-node",text:"{caption}",$order:3}},BARCMDR:{$order:4,tagName:"div",className:"xui-uibar-cmdr xui-uibase",RTAGCMDS:{$order:0,tagName:"span",className:"xui-rtag-cmds",style:"{_rtagDisplay}",text:"{rtagCmds}"},INFO:{className:"xuicon",$fonticon:"xui-uicmd-info",style:"{infoDisplay}",$order:1},OPT:{className:"xuicon",$fonticon:"xui-uicmd-opt",style:"{optDisplay}",$order:2},POP:{className:"xuicon",$fonticon:"xui-uicmd-pop",style:"{popDisplay}",$order:3},REFRESH:{className:"xuicon",$fonticon:"xui-uicmd-refresh",style:"{refreshDisplay}",$order:4},CLOSE:{className:"xuicon",$fonticon:"xui-uicmd-close",style:"{closeDisplay}",$order:5}}},PANEL:{$order:1,tagName:"div",style:"{panelDisplay};{_panelstyle};{_overflow};",className:"xui-uicontainer xui-uiborder-radius-bl xui-uiborder-radius-br",text:"{html}"+xui.UI.$childTag}},$submap:xui.UI.$getTagCmdsTpl()},Appearances:{KEY:{zoom:xui.browser.ie6?"1":null},BORDER:{position:"relative",overflow:"visible",zoom:xui.browser.ie6?"1":null},"LTAGCMDS, RTAGCMDS":{padding:0,margin:0,"vertical-align":"middle"},TBAR:{width:"auto",padding:"0 0 .1666667em 0",margin:"0 0 0 .5em",border:0,"font-size":"inherit"},"BORDER-checked TBAR":{"margin-left":"-.5em"},"BORDER-checked BARCMDL":{"padding-left":"1em"},BARCMDL:{cursor:"default","padding-right":".25em",display:xui.$inlineBlock},PANEL:{position:"relative",overflow:"auto","line-height":"normal",background:xui.browser.ie?"url("+xui.ini.img_bg+") no-repeat left top":null},CAPTION:{display:"inline","vertical-align":xui.browser.ie6?"baseline":"middle"},TOGGLE:{padding:"0 .334em 0 0"}},DataModel:{dock:"none",noFrame:null,borderType:null,toggleBtn:{ini:!0}},_prepareData:function(profile){var data=arguments.callee.upper.call(this,profile);return profile.properties.toggle||(data.height="auto"),data._fieldCls=data.toggleBtn&&!data.toggle?" xui-uiborder-t":" xui-uiborder-flat xui-uiborder-radius",data},_toggle:function(profile,value,ignoreEvent){var p=profile.properties,ins=profile.boxing();if(value&&ins.iniPanelView(),ignoreEvent||profile._toggle!==!!value){if(profile._toggle=p.toggle=!!value,!ignoreEvent)if(value){if(ins.beforeExpand&&!1===ins.beforeExpand(profile))return}else if(ins.beforeFold&&!1===ins.beforeFold(profile))return;p.toggleBtn&&profile.getSubNode("TOGGLE").tagClass("-checked",!!value);var border=profile.getSubNode("BORDER");value?border.removeClass("xui-uiborder-t").addClass("xui-uiborder-flat xui-uiborder-radius"):border.removeClass("xui-uiborder-flat xui-uiborder-radius").addClass("xui-uiborder-t"),profile.adjustSize(!0),ignoreEvent||(value?ins.afterExpand&&ins.afterExpand(profile):ins.afterFold&&ins.afterFold(profile)),p.dock&&"none"!=p.dock&&ins.adjustDock(!0)}},_onresize:function(profile,width,height){profile.properties;var us=xui.$us(profile),adjustunit=function(v,emRate){return profile.$forceu(v,us>0?"em":"px",emRate)},border=profile.getSubNode("BORDER"),panel=profile.getSubNode("PANEL"),root=profile.getRoot(),cb=border.contentBox(),h0=border._borderH(),ww=width?profile.$px(width):null,hh=height?profile.$px(height):null;height&&(profile._toggle?panel.css("display",""):panel.css("display","none"),"auto"==height?(panel.height("auto"),border.height("auto"),root.height("auto")):profile._toggle?(panel.height(adjustunit(hh-profile.getSubNode("TBAR").offsetHeight(!0)-h0/2,panel)),border.height(adjustunit(hh-(cb?h0:0),border)),root.height(adjustunit(hh))):(border.height("auto"),root.height("auto"))),width&&"auto"!=width&&ww>=2&&profile._toggle&&(panel.width(ww=adjustunit(ww-2)),xui.UI._adjustConW(profile,panel,ww))}}}),xui.Class("xui.UI.PageBar",["xui.UI","xui.absValue"],{Instance:{_setCtrlValue:function(value){return this.each((function(profile){if(profile.renderId){var t,prop=profile.properties,hidemore=!prop.showMoreBtns,arr=profile.box._v2a(value),min=arr[0],cur=arr[1],max=arr[2],fun=(profile.keys,function(p,k){return p.getSubNode(k)}),first=fun(profile,"FIRST"),prev=fun(profile,"PREV"),prem=fun(profile,"PREM"),current=fun(profile,"CUR"),next=fun(profile,"NEXT"),nextm=fun(profile,"NEXTM"),last=fun(profile,"LAST"),change=function(n,i,j,k,t){i?(n.attr("href",prop.uriTpl.replace("*",i)),n.attr("title",i)):t&&n.attr("title",t),xui.isSet(j)&&n.html(prop.textTpl.replace("*",j),!1),xui.isSet(k)&&(n.get(0)._real_page=k)},display=function(n,f){n.css("display",f?"":"none")};change(first,min,min),change(prem,"",".."+xui.str.repeat(".",String(cur-1-min).length),1,min+1+"~"+(cur-2)),change(prev,cur-1,prop.prevMark||cur-1),current.get(0).value=cur+"",change(next,cur+1,prop.nextMark||cur+1),change(nextm,"",".."+xui.str.repeat(".",String(max-cur-1).length),1,cur+2+"~"+(max-1)),change(last,max,max),(t=cur-min)<=0?(display(first,0),display(prem,0),display(prev,0)):1==t?(display(first,1),display(prem,0),display(prev,0)):2==t?(display(first,1),display(prem,0),display(prev,1),change(prev,cur-1,cur-1)):(display(first,1),display(prem,hidemore?0:1),display(prev,1),3==t&&(change(prev,cur-1,cur-1),change(prem,cur-2,cur-2,0))),(t=max-cur)<=0?(display(last,0),display(nextm,0),display(next,0)):1==t?(display(last,1),display(nextm,0),display(next,0)):2==t?(display(last,1),display(nextm,0),display(next,1),change(next,cur+1,cur+1)):(display(last,1),display(nextm,hidemore?0:1),display(next,1),3==t&&(change(next,cur+1,cur+1),change(nextm,cur+2,cur+2,0)))}}))},setPage:function(value,force,type){return this.each((function(o){if(/^[1-9]\d*$/.test(value+"")){var p=o.properties,pc=p.pageCount,a=((p.$UIvalue||p.value||"")+"").split(":"),b=parseInt(a[1],10);parseInt(value,10)>parseInt(a[2],10)||(a[1]=parseInt(value,10)||b,(force||a[1]!==b)&&(o.boxing().setUIValue(a.join(":"),!1,!1,"page"),o.onPageSet&&o.boxing().onPageSet(o,a[1],(a[1]-1)*pc,pc,type||"code",b,(b-1)*pc)))}}))},getPage:function(total){var p=this.get(0).properties;return((p.$UIvalue||p.value||"")+"").split(":")[total?2:1]},getTotalPages:function(){return this.getPage(!0)},setTotalCount:function(count){return count=parseInt(count,10)||0,this.each((function(o){var p=o.properties,pc=parseInt(p.pageCount,10),max=parseInt((count+pc-1)/pc,10),a=((p.$UIvalue||p.value||"")+"").split(":");a[2]=max,parseInt(a[1],10)>max&&(a[1]=1),o.boxing().setUIValue(a.join(":"),!1,!1,"settotal")}))}},Static:{Templates:{style:"{_style}",className:"{_className}",POOL:{style:"position:absolute;display:none;",POP:{tagName:"div",className:"xui-uibase xui-ui-reset xui-ui-ctrl"}},LABEL:{text:"{caption}"},FIRST:{$order:1,tagName:"a",className:"xui-ui-btn xui-uibar xui-uigradient xui-uiborder-radius",href:"#",tabindex:"{tabindex}"},PREM:{$order:2,className:"xui-ui-btn xui-uibar xui-uigradient xui-uiborder-radius",style:"{_css2}",tagName:"a",href:"#",tabindex:"{tabindex}"},PREV:{$order:3,className:"xui-ui-btn xui-uibar xui-uigradient xui-uiborder-radius",tagName:"a",href:"#",tabindex:"{tabindex}",text:"{prevMark}"},CUR:{$order:4,className:"xui-ui-input xui-ui-shadow-input xui-uiborder-flat xui-uiborder-radius xui-uibase",tagName:"input",autocorrect:"off",autocomplete:"off",tabindex:"{tabindex}",style:"{_css}"},NEXT:{$order:5,className:"xui-ui-btn xui-uibar xui-uigradient xui-uiborder-radius",tagName:"a",href:"#",tabindex:"{tabindex}",text:"{nextMark}"},NEXTM:{$order:6,className:"xui-ui-btn xui-uibar xui-uigradient xui-uiborder-radius",style:"{_css2}",tagName:"a",href:"#",tabindex:"{tabindex}"},LAST:{$order:7,className:"xui-ui-btn xui-uibar xui-uigradient xui-uiborder-radius",tagName:"a",href:"#",tabindex:"{tabindex}"}},Appearances:{LABEL:{padding:".25em .5em 0 .5em","vertical-align":"top","white-space":"nowrap"},KEY:{display:"inline",overflow:"visible"},"KEY a:focus, POP a:focus":{"outline-offset":"","-moz-outline-offset":xui.browser.gek&&xui.browser.ver<3?"":null},"KEY .xui-ui-btn, KEY .xui-ui-input, POP .xui-ui-btn":{"margin-right":".25em"},CUR:{"font-weight":"bold","text-align":"center",padding:".25em",width:"2em","margin-top":"-1px"},POP:{border:"dotted 1px gray",position:"absolute",padding:".25em","line-height":"2.25em"}},Behaviors:{HoverEffected:{FIRST:"FIRST",PREM:"PREM",PREV:"PREV",NEXT:"NEXT",NEXTM:"NEXTM",LAST:"LAST",POPI:"POPI",CUR:"CUR"},ClickEffected:{FIRST:"FIRST",PREM:"PREM",PREV:"PREV",NEXT:"NEXT",NEXTM:"NEXTM",LAST:"LAST",POPI:"POPI"},POP:{onClick:function(profile,e,src){var o=xui(src),r=xui.Event.getSrc(e);if(o.setBlurTrigger(profile.key+":"+profile.$xid,null),profile.getSubNode("POOL").append(o),"a"==r.tagName.toLowerCase()||(r=r.firstChild)&&"a"==r.tagName.toLowerCase()||(r=r.firstChild)&&"a"==r.tagName.toLowerCase()||(r=r.firstChild)&&"a"==r.tagName.toLowerCase())return profile.box._click(profile,r)}},FIRST:{onClick:function(profile,e,src){return profile.box._click(profile,src)}},PREM:{onClick:function(profile,e,src){return xui.use(src).get(0)._real_page?(profile.box._show(profile,e,src,0),!1):profile.box._click(profile,src)}},PREV:{onClick:function(profile,e,src){return profile.box._click(profile,src)}},CUR:{onKeypress:function(profile,e,src){var k=xui.Event.getKey(e),caret=xui.use(src).caret();return!!/^\d$/.test(k.key)&&("0"!==k.key||0!==caret[0])&&void 0},onChange:function(profile,e,src){var p=profile.properties;if(!p.disabled&&!p.readonly){var a=((p.$UIvalue||p.value||"")+"").split(":"),cur=parseInt(a[1]||"",10),max=parseInt(a[2]||"",10),value=xui.use(src).get(0).value||"";/^[1-9]\d*$/.test(value)?cur!==(value=parseInt(value,10))&&(value=value>max?max:value,xui(src).attr("value",value+""),profile.boxing().setPage(value,!1,"input")):xui(src).attr("value",cur+"")}},onKeydown:function(profile,e,src){var p=profile.properties,k=(profile.box,xui.Event.getKey(e));p.disabled||p.readonly||"enter"==k.key&&xui.use(src).onChange()}},NEXT:{onClick:function(profile,e,src){return profile.box._click(profile,src)}},NEXTM:{onClick:function(profile,e,src){return xui.use(src).get(0)._real_page?(profile.box._show(profile,e,src,1),!1):profile.box._click(profile,src)}},LAST:{onClick:function(profile,e,src){return profile.box._click(profile,src)}}},DataModel:{dataField:null,dataBinder:null,autoTips:!1,dirtyMark:!1,showDirtyMark:!1,parentID:"",isFormField:{hidden:!0,ini:!1},caption:{ini:" Page: ",action:function(v){v=(xui.isSet(v)?v:"")+"",this.getSubNode("LABEL").html(xui.adjustRes(v,!0))}},showMoreBtns:{ini:!0,action:function(v){this.getSubNodes(["PREM","NEXTM"]).css("display",v?"":"none")}},pageCount:20,disabled:{ini:!1,action:function(v){var i=this.getSubNode("CUR"),cls="xui-ui-disabled";v?this.getRoot().addClass(cls):this.getRoot().removeClass(cls),!v&&this.properties.readonly&&(v=!0),i.attr("readonly",v)}},readonly:{ini:!1,action:function(v){var i=this.getSubNode("CUR"),cls="xui-ui-readonly";v?this.getRoot().addClass(cls):this.getRoot().removeClass(cls),!v&&this.properties.disabled&&(v=!0),i.attr("readonly",v)}},value:"1:1:1",uriTpl:"#*",textTpl:"*",prevMark:"",nextMark:"",_moreStep:30},EventHandlers:{onClick:function(profile,page){},onPageSet:function(profile,page,start,count,eventType,opage,ostart){}},RenderTrigger:function(){var p=this.properties,a=((p.value||"")+"").split(":");p.readonly&&this.boxing().setReadonly(!0,!0),this.$inDesign||this.boxing().setPage(a[1]||a[0],!0,"inited")},_ensureValue:function(profile,value){var a=(value+="").split(":"),p=profile.properties,b=[],fun=function(a){return parseInt(a,10)||1};return a.length<3&&(b=((p.$UIvalue||p.value||"")+"").split(":"),a[1]=a[0],a[0]=b[0],a[2]=b[2]),b[0]=fun(a[0]),b[1]=fun(a[1]),b[2]=fun(a[2]),b[0]=Math.max(b[0],1),b[0]=Math.min(b[0],b[1]),b[2]=Math.max(b[1],b[2]),b.join(":")},_v2a:function(v){return(v="string"==typeof v?v.split(":"):v)[0]=parseInt(v[0],10),v[1]=parseInt(v[1],10),v[2]=parseInt(v[2],10),v},_click:function(profile,src){var p=profile.properties;if(p.disabled||p.readonly)return!1;var b=profile.boxing(),a=(p.$UIvalue||p.value||"").split(":"),nv=parseInt(xui(src).attr("href").split("#")[1],10)||a[1]||a[0],r=b.onClick(nv);return a.length&&nv+""==a[1]+""||b.setPage(nv,!1,"click"),"boolean"==typeof r&&r},_show:function(profile,e,src,flag){var prop=profile.properties;if(prop.disabled||prop.readonly)return!1;var t,m,n,l,pid=prop.parentID||xui.ini.$rootContainer,arr=profile.box._v2a(prop.value),min=arr[0],cur=arr[1],max=arr[2],fun=(profile.keys,function(p,k){return p.getSubNode(k)}),pool=fun(profile,"POOL"),pop=fun(profile,"POP"),ceil=function(n){return 10*Math.ceil((n+1)/10)},a=[];if(flag){if((t=max-1-cur)<=0)return;n=cur+1,l=max}else{if((t=cur-1-min)<=0)return;n=1,l=cur-1}(m=Math.ceil(t/prop._moreStep))>10?(n=ceil(n),l=ceil(l)-1,m=ceil(m)):n+=m;for(var _id=profile.keys.POPI+":"+profile.serialId+":";n<l;)a.push('<a style="margin-top:.25em;" id="'+_id+n+'" class="xui-node xui-node-span xui-ui-btn xui-uibar xui-uigradient xui-uiborder-radius" href="'+prop.uriTpl.replace("*",n)+'">'+prop.textTpl.replace("*",n)+"</a>"),n+=m;pop.width("auto"),pop.html(a.join(" ")),xui("body").append(pop),pop.width()>300&&pop.width(300),pop.popToTop(src,null,pid?xui.get(profile,["host",pid])?profile.host[pid].getContainer():xui(pid):null),pop.setBlurTrigger(profile.key+":"+profile.$xid,(function(){pool.append(pop)}))},_prepareData:function(profile){var data=arguments.callee.upper.call(this,profile);return data._css=xui.browser.kde?"resize:none;":"",data._css2=data.showMoreBtns?"":"display:none;",data}},Initialize:function(){this.addTemplateKeys(["POPI"])}}),xui.Class("xui.UI.Tabs",["xui.UI","xui.absList","xui.absValue"],{Instance:{_setCtrlValue:function(value){this.each((function(profile){profile.domId;var box=profile.boxing(),uiv=box.getUIValue(),prop=profile.properties,dm=profile.box.$DataModel,mcap=profile.getSubNode("MENUCAPTION"),mcls=profile.getSubNode("MENUCLOSE"),fold=function(itemId,arr){var subId=profile.getSubIdByItemId(itemId),item=profile.getItemByItemId(itemId);if(subId&&(arr.push(subId),!dm.hasOwnProperty("noPanel")||!prop.noPanel)){var pn=box.getPanel(itemId).get(0);pn&&(item._scrollTop=pn.scrollTop||0)&&(pn.scrollTop=0),box.getPanel(itemId).css("display","none")}},expand=function(itemId,arr){var subId=profile.getSubIdByItemId(itemId),item=profile.getItemByItemId(itemId);subId&&(arr.push(subId),mcap.html(item.caption),mcls.css("display",item.closeBtn?"":"none"),profile._menuId=item.id,dm.hasOwnProperty("noPanel")&&prop.noPanel||(box.getPanel(itemId).css("display","block"),item._scrollTop&&(box.getPanel(itemId).get(0).scrollTop=item._scrollTop),profile.adjustSize(!1,!1,value),profile.box._forLazyAppend(profile,item,value),profile.box._forIniPanelView(profile,item)))},arr1=[],arr2=[];dm.hasOwnProperty("selMode")&&dm.hasOwnProperty("noPanel")&&prop.noPanel&&"multi"==prop.selMode?(uiv=uiv?uiv.split(prop.valueSeparator):[],xui.arr.each(uiv,(function(key){fold(key,arr1)})),value=value?value.split(prop.valueSeparator):[],xui.arr.each(value,(function(key){expand(key,arr2)}))):(fold(uiv,arr1),expand(value,arr2)),arr1.length&&(profile.getSubNodes(["ITEM","TOGGLE"],arr1).tagClass("-checked",!1),profile.getSubNodes("ITEM",arr1).tagClass("-checked",!1)),arr2.length&&(profile.getSubNodes(["ITEM","TOGGLE"],arr2).tagClass("-checked"),profile.getSubNodes("ITEM",arr2).tagClass("-checked"))}))},append:function(target,subId,pre,base){var p=this.get(0).properties;return(subId=subId||p.$UIvalue||p.value)&&arguments.callee.upper.call(this,target,subId+"",pre,base),this},getCurPanel:function(){var profile=this.get(0),dm=profile.box.$DataModel,prop=profile.properties,v=prop.$UIvalue;return dm.hasOwnProperty("noPanel")&&dm.hasOwnProperty("selMode")&&"multi"==profile.properties.selMode&&(v=(v=v.split(prop.valueSeparator))[0]||null),v?this.getPanel(v):null},getPanel:function(subId){return this.get(0).getSubNodeByItemId("PANEL",subId+"")},addPanel:function(paras,children,item){var ns=this,i={},arr=[],id=item&&item.id,items=ns.getItems(),id2=paras.id||paras.tag;return(!items.length||-1==xui.arr.subIndexOf(items,"id",id2))&&(xui.merge(i,{caption:paras.caption,image:paras.image,closeBtn:paras.closeBtn||!1,popBtn:paras.popBtn||!1,optBtn:paras.optBtn||!1,imagePos:paras.imagePos,imageBgSize:paras.imageBgSize,dragKey:paras.dragKey,dropKeys:paras.dropKeys,id:paras.id||paras.tag||xui.id()}),id?ns.insertItems([i],id,!0):ns.insertItems([i]),xui.arr.each(children,(function(o){arr.push(o[0])})),ns.append(xui.UI.pack(arr,!1),i.id),ns)},removePanel:function(domId){var item=this.getItemByDom(domId);return this.removeItems([item.id])},getPanelPara:function(domId){var profile=this.get(0),pp=profile.properties,item=profile.getItemByDom(domId),paras=xui.clone(item,!1);return paras.dragKey||(paras.dragKey=pp.dragKey),paras.dropKeys||(paras.dropKeys=pp.dropKeys),paras},getPanelChildren:function(domId){var profile=this.get(0),id=profile.getItemIdByDom(domId),arr=[];return id&&xui.arr.each(profile.children,(function(o){o[1]==id&&arr.push(o)})),arr},resetPanelView:function(subId,removeChildren,destroyChildren){return xui.isSet(removeChildren)||(removeChildren=!0),xui.isSet(destroyChildren)||(destroyChildren=!0),this.each((function(profile){profile.renderId&&(xui.arr.each(profile.properties.items,(function(o){!0!==subId&&subId+""!==o.id||delete o._$ini})),removeChildren&&profile.boxing().removeChildren(subId,destroyChildren))}))},iniPanelView:function(subId){return this.each((function(profile){subId?(subId=profile.getItemByItemId(subId+""))&&profile.box._forIniPanelView(profile,subId):xui.arr.each(profile.properties.items,(function(item){profile.box._forIniPanelView(profile,item)}))}))},fireItemClickEvent:function(subId){var node=this.getSubNodeByItemId("ITEM",subId+"");return xui.Event,node.onClick(!0),this},_afterInsertItems:function(profile,data){if(profile.renderId){profile.box;var obj,v,pp=profile.properties;(obj=profile.getSubNode(profile.keys.BOX||profile.keys.KEY))&&(obj.append(profile._buildItems("panels",data)),profile.box.$DataModel.hasOwnProperty("noPanel")||(v=this.getUIValue())||this.fireItemClickEvent((v=pp.items[0])&&v.id),profile.adjustSize())}},removeItems:function(arr,purgeNow){var obj,serialId,self=this;return self.each((function(profile){var p=profile.properties;(arr=xui.isSet(arr)?xui.isArr(arr)?arr:(arr+"").split(p.valueSeparator):null)||(arr=((p.$UIvalue||p.value)+"").split(p.valueSeparator)),profile.box.$DataModel.hasOwnProperty("noPanel")&&profile.properties.noPanel||xui.arr.each(arr,(function(o){(serialId=profile.getSubIdByItemId(o+""))&&!(obj=profile.getSubNode("PANEL",serialId)).isEmpty()&&obj.remove(!0,purgeNow)}))})),arguments.callee.upper.apply(self,arguments),self.each((function(profile){profile.boxing().getUIValue()||xui.asyRun((function(){var i;profile&&profile.renderId&&profile.properties&&profile.properties.items.length&&profile.boxing().fireItemClickEvent((i=profile.properties.items[0])&&i.id)})),profile.adjustSize()})),self},clearItems:function(purgeNow){var self=this;return self.each((function(profile){profile.box.$DataModel.hasOwnProperty("noPanel")&&profile.properties.noPanel||profile.getSubNode("PANEL",!0).remove(!0,purgeNow)})),self.setValue(null,!0,"clear"),arguments.callee.upper.apply(self,arguments),self},markItemCaption:function(subId,mark,force,tag,cls){var profile=this.get(0);if((subId=profile.getItemByItemId(subId+""))._dirty!=mark||force){var id=subId.id,item=profile.getItemByItemId(id),caption=item.caption,node=profile.getSubNodeByItemId("CAPTION",id);tag?xui.isFun(tag)?(item.caption=tag(profile,item,mark),node.html(item.caption)):node.html(item.caption=mark?tag+caption:caption.replace(new RegExp("^"+tag),"")):node.html(item.caption=mark?"*"+caption:caption.replace(/^\*/,"")),cls?mark?node.addCalss(cls):node.removeCalss(cls):node.css({"font-weight":mark?"bold":"","font-style":mark?"italic":""}),subId._dirty=mark}return this}},Static:{Templates:{tagName:"div",style:"{_style};",className:"{_className}",LIST:{$order:1,tagName:"div",style:"{_liststyle}",LISTBG:{$order:0,className:"xui-uiborder-t xui-uiborder-b xui-uiborder-dark xui-uibar-checked"},MENU:{className:"xui-ui-unselectable xui-uiborder-hidden xui-uiborder-radius",MENUICON:{className:"xuicon",$fonticon:"xui-icon-menu"},MENUCAPTION:{},MENUCLOSE:{className:"xuifont",$fonticon:"xui-uicmd-close",$order:2}},MENU2:{tagName:"div",className:"xui-ui-unselectable",MENUICON2:{className:"xui-uiborder-hidden xui-uiborder-radius xuicon {_iconChecked}",$fonticon:"xui-icon-menu"}},ITEMS:{tagName:"div",className:"xui-ui-unselectable {_specialIconCls}",text:"{items}",style:"{HAlign}"}},PNAELS:{$order:2,tagName:"text",text:"{panels}"},$submap:{items:{ITEM:{className:"xui-uiborder-flat xui-uiborder-nob xui-uiborder-box xui-uiborder-radius-big-tl xui-uiborder-radius-big-tr xui-uibar {itemClass} {disabled} {readonly}",style:"{_itemDisplay};{itemStyle};",ITEMI:{ITEMC:{HANDLE:{tabindex:"{_tabindex}",className:"xui-showfocus",IBWRAP:{tagName:"div",style:"white-space:nowrap;",RULER:{},LTAGCMDS:{$order:1,tagName:"span",className:"xui-ltag-cmds",style:"{_ltagDisplay}",text:"{ltagCmds}"},ICON:{$order:2,className:"xuicon {imageClass}  {picClass}",style:"{backgroundImage}{backgroundPosition}{backgroundSize}{backgroundRepeat}{iconFontSize}{imageDisplay}{iconStyle}",text:"{iconFontCode}"},CAPTION:{$order:3,text:"{caption}",className:"xui-title-node",style:"{itemWidth};{itemAlign}"},CMDS:{$order:4,RTAGCMDS:{$order:0,tagName:"span",className:"xui-rtag-cmds",style:"{_rtagDisplay}",text:"{rtagCmds}"},OPT:{$order:1,className:"xuifont",$fonticon:"xui-uicmd-opt",style:"{_opt}"},POP:{className:"xuifont",$fonticon:"xui-uicmd-pop",style:"{popDisplay}",$order:1},CLOSE:{className:"xuifont",$fonticon:"xui-uicmd-close",style:"{closeDisplay}",$order:2}}}}}}}},panels:{PANEL:{tagName:"div",className:"xui-uibase xui-uicontainer",style:"{_overflow};{_bginfo}",text:"{html}"+xui.UI.$childTag}},"items.ltagCmds":function(profile,template,v,tag,result){var me=arguments.callee,map=me._m||(me._m={text:".text",button:".button",image:".image"});xui.UI.$doTemplate(profile,template,v,"items.tagCmds"+(map[v.type]||".button"),result)},"items.rtagCmds":function(profile,template,v,tag,result){var me=arguments.callee,map=me._m||(me._m={text:".text",button:".button",image:".image"});xui.UI.$doTemplate(profile,template,v,"items.tagCmds"+(map[v.type]||".button"),result)},"items.tagCmds.text":xui.UI.$getTagCmdsTpl("text"),"items.tagCmds.button":xui.UI.$getTagCmdsTpl("button"),"items.tagCmds.image":xui.UI.$getTagCmdsTpl("image")}},Appearances:{KEY:{position:"absolute",overflow:"hidden"},LIST:{position:"relative",overflow:"hidden",left:0,width:"100%",padding:".25em .25em 0 .25em ","white-space":"nowrap"},LISTBG:{position:"absolute",overflow:"hidden",left:0,bottom:0,height:"3px",width:"100%"},MENU:{display:"none",margin:".25em",padding:".16667em",cursor:"pointer"},MENU2:{display:"none"},MENUCAPTION:{"vertical-align":xui.browser.ie6?"baseline":"middle",margin:"0 4px","font-size":"1em"},ITEMS:{padding:xui.browser.contentBox?"0 0 4px 0":"0 0 2px 0",position:"relative",left:0,top:0,"white-space":"nowrap"},"ITEMS-icon CAPTION, ITEMS-icon OPT, ITEMS-icon POP, ITEMS-icon2 CAPTION, ITEMS-icon2 OPT, ITEMS-icon2 POP":{display:"none"},"ITEMS-icon ITEM-hover CAPTION, ITEMS-icon ITEM-hover OPT, ITEMS-icon ITEM-hover POP, ITEMS-icon ITEM-checked CAPTION, ITEMS-icon ITEM-checked OPT, ITEMS-icon ITEM-checked POP":{$order:1,display:xui.$inlineBlock},"ITEMS-menu ITEM":{display:"none"},ITEM:{$order:0,cursor:"pointer",padding:"0 .5em 0 0","vertical-align":"top",margin:"0 .25em","border-bottom":0,"border-radius":"6px 6px 0 0","-moz-border-radius":"6px 6px 0 0","-webkit-border-radius":"6px 6px 0 0","-o-border-radius":"6px 6px 0 0","-ms-border-radius":"6px 6px 0 0","-khtml-border-radius":"6px 6px 0 0"},ITEMI:{$order:0,"padding-left":".5em","vertical-align":"top"},ITEMC:{$order:0,padding:".33333333em","vertical-align":"top","text-align":"center"},HANDLE:{display:xui.$inlineBlock,zoom:xui.browser.ie6?1:null,cursor:"pointer","vertical-align":"middle",padding:0},"ITEM-checked HANDLE":{"padding-bottom":"1px"},RULER:{height:"1.5em",width:"0","vertical-align":"middle"},PANEL:{position:"relative",display:"none",width:"100%",overflow:"auto"},CAPTION:{"vertical-align":xui.browser.ie6?"baseline":"middle",margin:"0 4px",overflow:"hidden"},CMDS:{"vertical-align":"middle"},"LTAGCMDS, RTAGCMDS":{padding:0,margin:0,"vertical-align":"middle"},CMD:{padding:0,margin:0}},Behaviors:{NOTIPS:["GROUP","HANDLER"],DroppableKeys:["PANEL","LIST","ITEM"],PanelKeys:["PANEL"],DraggableKeys:["ITEM"],HoverEffected:{ITEM:"ITEM",MENU:"MENU",MENU2:"MENU2",MENUICON2:"MENUICON2",OPT:"OPT",CLOSE:"CLOSE",MENUCLOSE:"MENUCLOSE",POP:"POP",ICON:"ICON",CMD:"CMD"},ClickEffected:{ITEM:"ITEM",MENU:"MENU",MENU2:"MENU2",MENUICON2:"MENUICON2",OPT:"OPT",CLOSE:"CLOSE",MENUCLOSE:"MENUCLOSE",POP:"POP",CMD:"CMD"},CAPTION:{onMousedown:function(profile,e,src){if("left"==xui.Event.getBtn(e)){var properties=profile.properties,item=profile.getItemByDom(src),box=profile.boxing();return!properties.disabled&&!item.disabled&&!properties.readonly&&!item.readonly&&void(box.getUIValue()==item.id&&profile.onCaptionActive&&profile.boxing().onCaptionActive(profile,profile.getItemByDom(src),e,src))}}},ITEM:{onClick:function(profile,e,src){if("left"!=xui.Event.getBtn(e))return!1;var t;if((t=xui.Event.getSrc(e).parentNode)&&t.id&&profile.getKey(t.id)==profile.keys.CMDS)return!1;var prop=profile.properties,dm=profile.box.$DataModel,item=(profile.getSubId(src),profile.getItemByDom(src)),box=profile.boxing();if(prop.disabled||item.disabled)return!1;if(prop.readonly||item.readonly)return!1;if(dm.hasOwnProperty("selMode")&&dm.hasOwnProperty("noPanel")&&prop.noPanel&&"multi"==prop.selMode){var value=box.getUIValue(),arr=value?value.split(prop.valueSeparator):[],checktype=1,rt=!1,rt2=!1;if(arr.length)return-1!=xui.arr.indexOf(arr,item.id)?(xui.arr.removeValue(arr,item.id),checktype=-1):arr.push(item.id),arr.sort(),value=arr.join(prop.valueSeparator),box.getUIValue()==value?rt=!1:(box.setUIValue(value,null,null,"md"),box.get(0)&&box.getUIValue()==value&&(rt=box.onItemSelected(profile,item,e,src,checktype)||rt2)),rt}return box.getUIValue()!=item.id&&(box.setUIValue(item.id,null,null,"md"),box.getUIValue()==item.id)?rt=box.onItemSelected(profile,item,e,src)||rt2:void 0}},HANDLE:{onKeydown:function(profile,e,src){var keys=xui.Event.getKey(e),key=keys.key,shift=keys.shiftKey;if(" "==key||"enter"==key)return profile.getSubNode("ITEM",profile.getSubId(src)).onClick(),!1;var cur=xui(src),target=profile.getSubNode("ITEMS"),first=target.nextFocus(!0,!0,!1),last=target.nextFocus(!1,!0,!1);switch(key){case"tab":if(shift){if(cur.get(0)!=first.get(0))return first.focus(!0),!1}else if(cur.get(0)!=last.get(0))return last.focus(!0),!1;break;case"left":case"up":return cur.nextFocus(!1,!0,!1),cur.get(0)==first.get(0)?last.focus(!0):cur.nextFocus(!1),!1;case"right":case"down":return cur.nextFocus(!0,!1,!1),cur.get(0)==last.get(0)?first.focus(!0):cur.nextFocus(),!1}}},CMD:{onClick:function(profile,e,src){var prop=profile.properties,item=profile.getItemByDom(xui.use(src).parent().get(0));return!!item&&(prop.disabled||item.disabled||"split"==item.type||profile.onCmd&&profile.boxing().onCmd(profile,item,xui.use(src).id().split("_")[1],e,src),!1)}},OPT:{onClick:function(profile,e,src){return profile.boxing().onShowOptions(profile,profile.getItemByDom(src),e,src),!1}},CLOSE:{onClick:function(profile,e,src){var bak,properties=profile.properties,item=profile.getItemByDom(src),uiv=properties.$UIvalue;if(!properties.disabled&&!item.disabled){if(properties.readonly||item.readonly)return!1;var instance=profile.boxing();if(!1!==instance.beforePageClose(profile,item,src)){if(bak=xui.copy(item),uiv&&uiv==item.id){var t,items=properties.items,index=xui.arr.subIndexOf(items,"id",item.id),nuiv=(t=items[index+1])||(t=items[index-1])||(t=items[0])?t.id:null;nuiv&&nuiv!=uiv&&profile.boxing().fireItemClickEvent(nuiv)}return instance.removeItems(item.id),instance.afterPageClose(profile,bak),profile.adjustSize(),!1}}}},MENUCLOSE:{onClick:function(profile,e,src){profile.getSubNodeByItemId("CLOSE",profile._menuId).onClick(!0)}},POP:{onClick:function(profile,e,src){var properties=profile.properties,item=profile.getItemByDom(src),options={parent:null,host:null,properties:null,events:null,CS:null,CC:null,CB:null,CF:null,init:null},id=item.id;if(properties.disabled||item.disabled)return!1;if(properties.readonly||item.readonly)return!1;if(profile.beforePagePop&&0==profile.boxing().beforePagePop(profile,item,options,e,src))return!1;profile.boxing().getPanel(id);var pos=profile.getRoot().offset(),size=profile.getRoot().cssSize(),pro=xui.copy(xui.UI.Dialog.$DataStruct),events={};xui.merge(pro,item,"with"),xui.merge(pro,{dragKey:item.dragkey||properties.dragKey,dock:"none",tag:item.tag||item.id,width:Math.max(size.width,200),height:Math.max(size.height,100),left:pos.left,top:pos.top,landBtn:!0},"all"),options.properties&&xui.merge(pro,options.properties,"with"),options.events&&xui.merge(events,options.events,"all");var dialog=new xui.UI.Dialog(pro,events,options.host||profile.host,options.CS||null,options.CC||null,options.CB||null,options.CF||null);if(xui.isFun(options.init)&&!1===options.init(dialog,profile,options));else{dialog.show(options.parent||xui("body"));var arr=[];xui.arr.each(profile.children,(function(o){o[1]==id&&arr.push(o[0])})),arr.length&&dialog.append(xui.UI.pack(arr,!1)),profile.boxing().removeChildren(id).removeItems(id)}return!1}},MENU:{onMouseover:function(profile,e,src){var menu=profile._droppopmenu;if(!menu){var ll,ins=profile.boxing(),items=profile.properties.items,nitems=[],l=items.length;if(items.length>15){ll=Math.ceil(l/15);for(var i=0;i<ll;i++)nitems.push({caption:15*i+1+" - "+Math.min(l,15*(i+1)+1),sub:[]});xui.arr.each(items,(function(item,i){nitems[parseInt(i/15)].sub.push(xui.clone(item,!1,1))}))}else nitems=xui.clone(items,!1,2);(menu=profile._droppopmenu=new xui.UI.PopMenu({items:nitems,autoHide:!0},{onMenuSelected:function(profile,item){ins.fireItemClickEvent(item.id)},beforeHide:function(p,e){if(e){var node=xui(src),p1=xui.Event.getPos(e),size=node.cssSize(),p2=node.offset();if(p1.left>p2.left&&p1.top>p2.top-3&&p1.left<p2.left+size.width&&p1.top<p2.top+size.height)return!1}},onHide:function(){profile._droppopmenu.destroy(!0),delete profile._droppopmenu}})).popUp(src)}},onMouseout:function(profile,e,src){var pop;if(pop=profile._droppopmenu){var node=pop.get(0).getRoot(),p1=xui.Event.getPos(e),size=node.cssSize(),p2=node.offset();p1.left>p2.left&&p1.top>p2.top-3&&p1.left<p2.left+size.width&&p1.top<p2.top+size.height||pop.hide()}},onClick:function(p,e,src){xui(src).onMouseover(!0)}},PANEL:{onClick:function(profile,e,src){var p=profile.properties,item=profile.getItemByDom(src);return!p.disabled&&!item.disabled&&(profile.onClickPanel?profile.boxing().onClickPanel(profile,item,e,src):void 0)}}},DataModel:{rotate:null,selectable:!0,dirtyMark:!1,lazyAppend:!0,isFormField:{hidden:!0,ini:!1},dock:"fill",width:{$spaceunit:1,ini:"18em"},height:{$spaceunit:1,ini:"18em"},position:"absolute",itemWidth:{ini:0,action:function(value){this.getSubNode("CAPTION",!0).width(value)}},itemAlign:{ini:"",listbox:["","left","center","right"],action:function(value){this.getSubNode("CAPTION",!0).css("text-align",value)}},HAlign:{ini:"left",listbox:["left","center","right"],action:function(value){this.getSubNode("ITEMS").css("textAlign",value)}},dropKeysPanel:"",value:{ini:""},selMode:{ini:"single",listbox:["single","multi"]},noPanel:{ini:!1,action:function(value){this.getSubNode("PANEL",!0).css("display",value?"none":"block"),this.adjustSize(null,!0)}},noHandler:{ini:!1,action:function(value){this.getSubNode("LIST").css("display",value?"none":"block"),this.adjustSize(null,!0)}},tagCmds:{ini:[],action:function(){this.boxing().refresh()}}},EventHandlers:{onCmd:function(profile,item,cmdkey,e,src){},onIniPanelView:function(profile,item){},beforePagePop:function(profile,item,options,e,src){},beforePageClose:function(profile,item,src){},afterPageClose:function(profile,item){},onShowOptions:function(profile,item,e,src){},onItemSelected:function(profile,item,e,src,type){},onCaptionActive:function(profile,item,e,src){},onClickPanel:function(profile,item,e,src){}},RenderTrigger:function(){var v,i,ins;(v=this.properties.value)&&((ins=this.boxing()).setUIValue(v,null,null,"render"),(i=this.getItemByItemId(v))&&ins.onItemSelected(this,i))},_prepareData:function(profile){var data=arguments.callee.upper.call(this,profile);return data.panels=data.items,data.HAlign&&(data.HAlign="text-align:"+data.HAlign+";"),data._liststyle=data.noHandler?"display:none":"","fold"==data.sideBarStatus&&(data._specialIconCls=profile.getClass("ITEMS")+"-icon2",data._iconChecked=" xui-uiborder-hidden-checked xui-icon-menu-checked "),data},_prepareItem:function(profile,item){var t,dpn="display:none",p=profile.properties;item.closeDisplay=item.closeBtn?"":dpn,item.popDisplay=item.popBtn?"":dpn,item._opt=item.optBtn?"":dpn,item._itemDisplay=item.hidden?dpn:"",(t=item.itemWidth||p.itemWidth)&&(item.itemWidth="width:"+t+(xui.isFinite(t)?"px":"")),(t=item.itemAlign||p.itemAlign)&&(item.itemAlign="text-align:"+t),item._bginfo="",(t=item.panelBgClr||p.panelBgClr)&&(item._bginfo+="background-color:"+t+";"),(t=item.panelBgImg||p.panelBgImg)&&(item._bginfo+="background-image:url("+xui.adjustRes(t)+");"),(t=item.panelBgImgPos||p.panelBgImgPos)&&(item._bginfo+="background-position:"+t+";"),(t=item.panelBgImgRepeat||p.panelBgImgRepeat)&&(item._bginfo+="background-repeat:"+t+";"),(t=item.panelBgImgAttachment||p.panelBgImgAttachment)&&(item._bginfo+="background-attachment:"+t+";"),xui.isStr(item.overflow)?item._overflow=-1!=item.overflow.indexOf(":")?item.overflow:item.overflow?"overflow:"+item.overflow:"":xui.isStr(p.overflow)&&(item._overflow=-1!=p.overflow.indexOf(":")?p.overflow:p.overflow?"overflow:"+p.overflow:""),this._prepareCmds(profile,item)},getDropKeys:function(profile,node){var prop=profile.properties,item=profile.getItemByDom(node);return profile.getKey(xui.use(node).id())==profile.keys.PANEL?item&&item.dropKeysPanel||prop.dropKeysPanel:item&&item.dropKeys||prop.dropKeys},_forLazyAppend:function(profile,item,value){var prop=profile.properties,box=profile.boxing(),moduleHash={},zz=profile.moduleClass+"["+profile.moduleXid+"]";if(prop.lazyAppend){var arr=profile.children,a=[];if(xui.arr.each(arr,(function(o){o[1]!=value||o[0].renderId&&xui.UIProfile.getFromDom(xui(o[0].renderId).parent().id())==profile||a.push(o[0])})),a.length&&xui.arr.each(a,(function(o,y,z){o.moduleClass&&o.moduleXid&&(y=xui.SC.get(o.moduleClass))&&(y=y.getInstance(o.moduleXid))&&y["xui.Module"]&&(z=o.moduleClass+"["+o.moduleXid+"]",zz==z||moduleHash[z]||(moduleHash[z]=y)),box.append(xui(o),value)})),profile.$attached){for(var v,i=0;v=profile.$attached[i++];)v._render&&v._render(!0);delete profile.$attached}(arr=profile.exchildren)&&arr.length&&(a=[],xui.filter(arr,(function(o){if(o[1]==value)return a.push(o[0]),!1})),a.length&&xui.arr.each(a,(function(o,y,z){o.moduleClass&&o.moduleXid&&(y=xui.SC.get(o.moduleClass))&&(y=y.getInstance(o.moduleXid))&&y["xui.Module"]&&(z=o.moduleClass+"["+o.moduleXid+"]",zz==z||moduleHash[z]||(moduleHash[z]=y)),box.append(xui(o),value)}))),(arr=profile.excoms)&&arr.length&&(a=[],xui.filter(arr,(function(o){if(o[1]==value)return a.push(o[0]),!1})),a.length&&xui.arr.each(a,(function(o){o.show(null,box,value,!1)}))),xui.each(moduleHash,(function(o){o.render()}))}},_forIniPanelView:function(profile,item){if(item){profile.properties;var box=profile.boxing();if(!item._$ini)if(item._$ini=!0,profile.onIniPanelView&&box.onIniPanelView(profile,item),item.iframeAutoLoad){box.getPanel(item.id).css("overflow","hidden");var _if="string"==typeof item.iframeAutoLoad?{url:item.iframeAutoLoad}:xui.clone(item.iframeAutoLoad,!0),id="diframe_"+xui.rand(),e=xui.browser.ie&&xui.browser.ver<9,ifr=document.createElement(e?"<iframe name='"+id+"'>":"iframe");_if.url=xui.adjustRes(_if.url,!1,!0),ifr.id=ifr.name=id,xui.isHash(item.iframeAutoLoad)&&(item.iframeAutoLoad.frameName=id),item._frameName=id,_if.query||(_if.query={}),_if.query._rand=xui.rand(),ifr.frameBorder="0",ifr.marginWidth="0",ifr.marginHeight="0",ifr.vspace="0",ifr.hspace="0",ifr.allowTransparency="true",ifr.width="100%",ifr.height="100%",box.getPanel(item.id).html("").append(ifr),"post"==(_if.method||"").toLowerCase()?xui.Dom.submit(_if.url,_if.query,"post",id,_if.enctype):ifr.src=_if.url}else if(item.ajaxAutoLoad){var _ajax="string"==typeof item.ajaxAutoLoad?{url:item.ajaxAutoLoad}:xui.clone(item.ajaxAutoLoad,!0),options={rspType:"text"};xui.merge(options,_ajax.options),_ajax.query||(_ajax.query={}),_ajax.query._rand=xui.rand(),box.busy(!1,null,"PANEL",profile.getSubIdByItemId(item.id));var node=box.getPanel(item.id);xui.Ajax(xui.adjustRes(_ajax.url,!1,!0),_ajax.query,(function(rsp){node.html(rsp,!0,!0),box.free()}),(function(err){node.html("<div>"+err+"</div>",!0,!1),box.free()}),null,options).start()}}},_showTips:function(profile,node,pos){if(!profile.properties.disableTips){if(profile.onShowTips)return profile.boxing().onShowTips(profile,node,pos);if(xui.Tips){var pid,ppid,id=node.id,ks=profile.keys;if(pid=xui.get(node,["parentNode","id"])||"",ppid=xui.get(node,["parentNode","parentNode","id"])||"",0===id.indexOf(ks.ITEM)||0===pid.indexOf(ks.ITEM)||0===ppid.indexOf(ks.ITEM)||0===id.indexOf(ks.HANDLE)||0===pid.indexOf(ks.HANDLE)||0===ppid.indexOf(ks.HANDLE)||0===id.indexOf(ks.CMDS)||0===pid.indexOf(ks.CMDS)||0===ppid.indexOf(ks.CMDS)){var upper=arguments.callee.upper,rtn=upper.apply(this,xui.toArr(arguments));return upper=null,rtn}}}},_onDrop:xui.UI.List._onDrop,_onresize:function(profile,width,height,force,key){var prop=profile.properties,item=profile.getItemByItemId(key);if(item||(key=prop.$UIvalue||prop.value,item=profile.getItemByItemId(key)),item||(key=(item=prop.items[0])&&item.id),item){var listH,panel=profile.boxing().getPanel(key),us=xui.$us(profile),adjustunit=function(v,emRate){return profile.$forceu(v,us>0?"em":"px",emRate)},root=profile.getRoot(),list=profile.getSubNode("LIST"),fzrate=profile.getEmSize()/root._getEmSize(),panelfz=panel._getEmSize(fzrate),listfz=list._getEmSize(fzrate),wc=null,hc=null;width&&"auto"!=width&&(width=profile.$px(width,null,!0)),height&&"auto"!=height&&(height=profile.$px(height,null,!0)),panel&&!panel.isEmpty()&&(prop.noHandler||(listH=list.offsetHeight(!0),profile._listH!=listH&&(profile._listH=listH,force=!0)),force&&(item._w=item._h=null),height&&item._h!=height&&(item._h=height),"auto"==height?hc="auto":height&&(prop.noHandler||(height-=listH),height>0&&(hc=height)),width&&item._w!=width&&(list.width(wc=adjustunit(item._w=width,listfz)),prop.noHandler||this._adjustHScroll(profile,key)),prop.noPanel||!hc&&!wc||panel.height(adjustunit(hc,panelfz)).onSize(),wc&&xui.UI._adjustConW(profile,panel,wc))}},_adjustHScroll:function(profile,value){var itemsW,ignoreCap,w,items=profile.getSubNode("ITEMS"),charW=xui.CSS.$px("1em"),showCount=0,cur=xui.isSet(value)&&profile.getSubNode("CAPTION",profile.getSubIdByItemId(value)).id(),innerW=items.width(),menu=(profile.getSubNode("LIST"),profile.getSubNode("MENU")),caps=profile.getSubNode("CAPTION",!0),getItemsW=function(){var w=0;return items.children().each((function(item){if(0!=item.offsetWidth)return w?void 0:(w=item.offsetLeft+item.offsetWidth,!1)}),!0),w};if(items.tagClass("-icon",!1),items.tagClass("-icon2",!1),items.tagClass("-menu",!1),menu.css("display","none"),caps.css("width",""),profile._mode="normal",(itemsW=getItemsW())>innerW){var otherCapsW=(w=0,caps.each((function(item){0!=item.clientWidth&&(showCount++,xui.isSet(cur)&&item.id===cur?item.clientWidth:w+=item.clientWidth)})),w),min=itemsW-otherCapsW+charW;if(innerW>min+charW*(showCount-1)){var percent=(innerW-min)/otherCapsW;caps.each((function(cap){xui(cap).width(xui.isSet(cur)&&cap.id===cur?"auto":Math.floor(cap.clientWidth*percent)+"px")})),profile._mode="narrow"}else ignoreCap=1;(ignoreCap||getItemsW()>innerW)&&(caps.css("width",""),items.tagClass("-icon",!0),profile._mode="icon",getItemsW()>innerW&&(items.tagClass("-menu",!0),menu.setInlineBlock(),profile._mode="menu"))}}}}),xui.Class("xui.UI.Stacks","xui.UI.Tabs",{Initialize:function(){var t=this.getTemplate(),keys=this.$Keys;t.BOX={tagName:"div",LIST:t.LIST,PNAELS:t.PNAELS},delete t.LIST.LEFT,delete t.LIST.RIGHT,delete t.LIST.DROP,delete t.LIST,delete t.PNAELS,t.$submap.items.ITEM.className="xui-uibar xui-uiborder-t xui-uiborder-b",t.$submap.items.ITEM.ITEMI.ITEMC.HANDLE.IBWRAP.TOGGLE={$order:1,className:"xuifont {_tlgchecked}",$fonticon:"xui-uicmd-toggle"},this.setTemplate(t),delete keys.LEFT,delete keys.RIGHT,delete keys.DROP},Static:{Behaviors:{DroppableKeys:["PANEL","KEY","ITEM"]},Appearances:{BOX:{position:"absolute",overflow:"hidden",left:0,top:0},LIST:{position:"static"},ITEMS:{position:"static"},ITEM:{$order:0,display:"block",position:"absolute",cursor:"pointer",width:"100%",left:0},ITEMC:{display:"block"},ITEMI:{display:"block"},"ITEM-hover":{$order:1},"ITEM-active ITEMC, ITEM-checked ITEMC":{$order:2},"ITEM-active ITEMI, ITEM-checked ITEMI":{$order:2},"ITEM-active, ITEM-checked":{$order:3},HANDLE:{cursor:"pointer",display:"block",padding:".58333em","white-space":"nowrap"},"ITEM-checked HANDLE":{},PANEL:{position:"absolute",display:"none",overflow:"auto"},CMDS:{position:"absolute",top:".5em",right:".75em","text-align":"right","vertical-align":"middle"}},DataModel:{noPanel:null,noHandler:null,selMode:null,borderType:{ini:"flat",listbox:["none","flat","inset","outset"],action:function(v){this.properties;var n1=this.getSubNode("BOX");switch(this.getRoot(),n1.removeClass(/^xui-uiborder-/),v){case"flat":n1.addClass("xui-uiborder-flat  xui-uiborder-radius");break;case"inset":n1.addClass("xui-uiborder-inset  xui-uiborder-radius");break;case"outset":n1.addClass("xui-uiborder-outset  xui-uiborder-radius")}this.adjustSize()}}},LayoutTrigger:function(){var v=this.properties.borderType;v&&"none"!=v&&this.boxing().setBorderType(v,!0)},_onresize:function(profile,width,height,force,key){var prop=profile.properties,cb=(prop.noPanel,xui.browser.contentBox),item=profile.getItemByItemId(key);if(item||(key=prop.$UIvalue||prop.value,item=profile.getItemByItemId(key)),item||(item=prop.items[0],key=item&&item.id),item){var off,temp,t1,t2,obj,top,panel=profile.boxing().getPanel(key),us=xui.$us(profile),adjustunit=function(v,emRate){return profile.$forceu(v,us>0?"em":"px",emRate)},root=profile.getRoot(),box=profile.getSubNode("BOX"),list=profile.getSubNode("LIST"),fzrate=profile.getEmSize()/root._getEmSize(),panelfz=panel._getEmSize(fzrate),listfz=list._getEmSize(fzrate),type=prop.borderType,bw=!cb||"flat"!=type&&"inset"!=type&&"outset"!=type?0:box._borderW(),wc=null,hc=null;panel&&!panel.isEmpty()&&(width=width?profile.$px(width,null,!0):width,(height=height?profile.$px(height,null,!0):height)&&(height-=bw,t2=t1=0,xui.arr.each(prop.items,(function(o){if((obj=profile.getSubNodeByItemId("ITEM",o.id)).cssRegion({bottom:"auto",top:adjustunit(t1,obj)}),off=o.hidden?0:obj.offsetHeight(!0),t1+=off,o.id==key)return!1})),xui.arr.each(prop.items,(function(o){if(o.id==key)return!1;(obj=profile.getSubNodeByItemId("ITEM",o.id)).cssRegion({top:"auto",bottom:adjustunit(t2,obj)}),off=o.hidden?0:obj.offsetHeight(!0),t2+=off}),null,!0),(temp=height-t1-t2)>0&&(top=t1,hc=temp),box.height(adjustunit(height))),width&&(wc=width-=bw,box.width(adjustunit(width))),panel.cssRegion({width:wc?adjustunit(wc,panelfz):null,height:hc?adjustunit(hc,panelfz):null,top:adjustunit(top,panelfz),left:0+profile.$picku()},!0),wc&&(list.width(wc=adjustunit(wc,listfz)),xui.UI._adjustConW(profile,panel,wc)))}},_adjustScroll:null}}),xui.Class("xui.UI.ButtonViews","xui.UI.Tabs",{Initialize:function(){var t=this.getTemplate(),keys=this.$Keys;t.LIST.className="xui-uibar",this.setTemplate(t),t.$submap.items.ITEM.className="xui-ui-btn xui-uibar xui-uigradient xui-uiborder-radius {itemClass} {disabled} {readonly} {itemPosCls}",delete keys.LEFT,delete keys.RIGHT,delete keys.DROP},Static:{Appearances:{LIST:{"z-index":"2",position:"absolute","white-space":"nowrap",overflow:"hidden"},"LIST-attop, LIST-atbottom":{$order:2,position:"relative"},LISTBG:{display:"none"},MENU:{display:"none",margin:".25em",padding:".25em",cursor:"pointer"},MENU2:{display:"none","text-align":"center"},MENUICON2:{position:"relative",margin:".09375em",padding:".1875em",cursor:"pointer"},ITEMS:{"z-index":"2",position:"relative",left:0,top:0,width:"100%",height:"100%","white-space":"nowrap","overflow-x":"hidden","overflow-y":"scroll"},"ITEMS-left, ITEMS-left ITEMC":{$order:1,height:"auto","text-align":"left"},"ITEMS-center, ITEMS-center ITEMC":{$order:1,height:"auto","text-align":"center"},"ITEMS-right, ITEMS-right ITEMC":{$order:1,height:"auto","text-align":"right"},"ITEMS-left HANDLE, ITEMS-right HANDLE":{$order:2,display:"block"},ITEM:{$order:0,margin:".166667em",position:"relative",cursor:"pointer",padding:"0 .125em 0 0","vertical-align":"top"},ITEMI:{$order:0,"padding-left":".125em","vertical-align":"top"},"ITEMS-block ITEM, ITEMS-block ITEMI, ITEMS-block ITEMC":{$order:2,display:"block"},ITEMC:{$order:0,padding:".15em 0 .125em 0","vertical-align":"top","text-align":"center"},HANDLE:{display:xui.$inlineBlock,zoom:xui.browser.ie6?1:null,cursor:"pointer","vertical-align":"middle",margin:".125em"},"ITEM-checked HANDLE":{}},DataModel:{HAlign:null,barLocation:{ini:"top",listbox:["top","bottom","left","right"],action:function(v){var hs=this.getSubNode("LIST"),h=this.getSubNode("ITEMS"),unit=0+this.$picku();switch(v){case"left":hs.cssRegion({left:unit,top:unit,right:"auto",bottom:unit});break;case"top":hs.cssRegion({left:unit,top:unit,right:unit,bottom:"auto"});break;case"right":hs.cssRegion({left:"auto",top:unit,right:unit,bottom:unit});break;case"bottom":hs.cssRegion({left:unit,top:"auto",right:unit,bottom:unit})}switch(v){case"left":case"right":h.tagClass("-block",!0);break;case"top":case"bottom":h.tagClass("-block",!1),hs.height("auto")}hs.tagClass("(-attop|-atbottom|-atleft|-atright)",!1).tagClass("-at"+v,!0),this.adjustSize()}},barHAlign:{ini:"left",listbox:["left","center","right"],action:function(v){this.getSubNode("ITEMS").tagClass("(-left|-right|-center)",!1).tagClass("-"+v,!0)}},barVAlign:{ini:"top",listbox:["top","bottom"],action:function(v){var hl=this.getSubNode("ITEMS"),unit=0+this.$picku();"top"==v?hl.cssRegion({top:unit,bottom:"auto"}):hl.cssRegion({bottom:unit,top:"auto"}),this.adjustSize()}},barSize:{$spaceunit:1,ini:"2em",action:function(v){this.adjustSize()}},borderType:{ini:"none",listbox:["none","flat","inset","outset"],action:function(v){this.properties;var n1=this.getSubNode("LIST");switch(this.getRoot(),n1.removeClass(/^xui-uiborder-/),v){case"flat":n1.addClass("xui-uiborder-flat xui-uiborder-radius");break;case"inset":n1.addClass("xui-uiborder-inset xui-uiborder-radius");break;case"outset":n1.addClass("xui-uiborder-outset xui-uiborder-radius")}this.adjustSize()}},sideBarStatus:{ini:"expand",listbox:["expand","fold","none"],action:function(v){var self=this,t=self.properties,hl=(xui.$us(self),self.getSubNode("ITEMS")),menu2=self.getSubNode("MENU2"),menuicn2=self.getSubNode("MENUICON2");"none"==t.sideBarStatus?menu2.css("display","none"):"fold"==t.sideBarStatus?(hl.tagClass("-icon2",!0),menu2.css("display","block"),menuicn2.tagClass("-checked",!0)):(hl.tagClass("-icon2",!1),menu2.css("display","block"),menuicn2.tagClass("-checked",!1)),this.adjustSize()}},sideBarSize:{ini:"3em",action:function(v){this.adjustSize()}}},Behaviors:{MENU2:{onClick:function(profile,e,src){profile.boxing().setSideBarStatus("fold"==profile.properties.sideBarStatus?"expand":"fold",!0)}}},LayoutTrigger:function(){var pro=this.properties;this.boxing().setBarLocation(pro.barLocation,!0).setBarHAlign(pro.barHAlign,!0).setBarVAlign(pro.barVAlign,!0),"top"!=pro.barLocation&&"bottom"!=pro.barLocation||this.getSubNode("ITEMS").addClass("xui-css-noscroll"),pro.borderType&&"none"!=pro.borderType&&this.boxing().setBorderType(pro.borderType,!0)},_onresize:function(profile,width,height,force,key){var prop=profile.properties,noPanel=prop.noPanel,noHandler=prop.noHandler,item=profile.getItemByItemId(key);if(item||(key=prop.$UIvalue||prop.value,item=profile.getItemByItemId(key)),item||(key=(item=prop.items[0])&&item.id),item){var left,itmsH,t,panel=profile.boxing().getPanel(key),us=xui.$us(profile),adjustunit=function(v,emRate){return profile.$forceu(v,us>0?"em":"px",emRate)},ww=width?profile.$px(width,null,!0):width,hh=height&&"auto"!=height?profile.$px(height,null,!0):height,root=profile.getRootNode(),hs=profile.getSubNode("LIST"),hl=profile.getSubNode("ITEMS"),menu2=profile.getSubNode("MENU2"),fzrate=profile.getEmSize()/profile.getRoot()._getEmSize(),panelfz=panel._getEmSize(fzrate),hsfz=hs._getEmSize(fzrate),hlfz=hl._getEmSize(fzrate),cb=xui(root).contentBox(),type=prop.borderType,bw=!cb||"flat"!=type&&"inset"!=type&&"outset"!=type?0:hs._borderW(),wc=null,hc=null;if(menu2.css("display","none"),noHandler)wc=ww,hc=hh;else if("top"==prop.barLocation||"bottom"==prop.barLocation)xui.browser.isTouch&&(xui.browser.isAndroid||xui.browser.isBB)||hl.css("overflow-y","hidden"),itmsH=hs.height(prop.barSize||"auto").offsetHeight(!0),hl.css("position","relative"),width&&(hs.width(adjustunit(ww-bw,hsfz)),hl.width(adjustunit(ww-bw,hlfz)),noPanel&&"auto"!=height&&(hs.height(adjustunit(hh-bw,hsfz)),hl.height(adjustunit(hh-bw,hsfz))),noHandler||profile.box._adjustHScroll(profile),left=0,wc=ww),"auto"!=hh?hh-itmsH>0&&(hc=hh-itmsH-bw):hc=hh,"top"==prop.barLocation?(t=root.firstElementChild||root.firstChild)!=hs.get(0)&&(t?root.insertBefore(hs.get(0),t):root.appendChild(hs.get(0))):"bottom"==prop.barLocation&&(root.lastElementChild||root.lastChild)!=hs.get(0)&&root.appendChild(hs.get(0));else if(xui.browser.isTouch&&(xui.browser.isAndroid||xui.browser.isBB)||hl.css("overflow-y","scroll"),menu2.css("display","none"!==prop.sideBarStatus&&prop.sideBarSize?"block":"none"),noHandler||profile.getSubNode("CAPTION",!0).css("width",""),"auto"==hh&&(hh=300),height&&(noPanel&&(xui.browser.isTouch&&(xui.browser.isAndroid||xui.browser.isBB)||hl.css("overflow-y","hidden"),hs.width(adjustunit(ww-bw,hsfz)),hl.width(adjustunit(ww-bw,hsfz))),hs.height(adjustunit(hh-bw,hsfz)),hl.height("auto"),hl.height()>=hs.height()&&hl.height(adjustunit(hh-bw-(prop.sideBarSize?menu2.offsetHeight():0),hlfz)),hl.css("position","bottom"==prop.barVAlign?"absolute":"relative"),hc=hh),height||width){var v=profile.$px("fold"==prop.sideBarStatus?prop.sideBarSize:prop.barSize,hlfz,!0),vv=cb?hl._paddingW()+hl._marginW():0;left="left"==prop.barLocation?bw+profile.$px(v+vv,hsfz,!0):0,wc=ww-profile.$px(v+vv,hsfz,!0)-bw,hl.width("auto"),noPanel||(hs.width(adjustunit(v+vv,hsfz)),hl.width(adjustunit(v+xui.Dom.getScrollBarSize(),hlfz)))}noPanel||(panel.cssRegion({width:wc=wc?adjustunit(wc,panelfz):null,height:hc?adjustunit(hc,panelfz):null,left:noHandler?0:adjustunit(left,panelfz)},!0),wc&&xui.UI._adjustConW(profile,panel,wc))}}}}),xui.Class("xui.UI.RadioBox","xui.UI.List",{Initialize:function(){var t=this.getTemplate();t.className="{_className}",t.ITEMS.className="{_bordertype}",t.$submap={items:{ITEM:{className:"xui-showfocus {_itemRow} {itemClass} {disabled} {readonly}",style:"{itemStyle};{_itemDisplay};",tabindex:"{_tabindex}",MARK:{$order:0,className:"xuifont",$fonticon:"{_fi_markcls}"},ICON:{$order:1,className:"xuicon {imageClass}  {picClass}",style:"{backgroundImage}{backgroundPosition}{backgroundSize}{backgroundRepeat}{iconFontSize}{imageDisplay}{iconStyle}",text:"{iconFontCode}"},CAPTION:{text:"{caption}",$order:2}}}},this.setTemplate(t)},Static:{_DIRTYKEY:"MARK",_ITEMMARKED:!0,Appearances:{ITEM:{display:xui.$inlineBlock,border:0,padding:".5em",position:"relative",zoom:xui.browser.ie?1:null,cursor:"pointer",overflow:"hidden","vertical-align":"middle"},"ITEM-checked":{padding:".5em"},CAPTION:{"vertical-align":xui.browser.ie6?"baseline":"middle","font-size":"1em"},ITEMS:{overflow:"auto","overflow-x":"hidden",position:"relative","line-height":"1.25em"},MARK:{$order:1,cursor:"pointer",margin:"0 .5em 0 .25em","vertical-align":"middle"}},DataModel:{lite:null,tagCmds:null,borderType:{ini:"none"},checkBox:{ini:!1,action:function(v){this.getSubNode("MARK",!0).replaceClass(v?/(uicmd-radio)|(\s+uicmd-radio)/g:/(^uicmd-check)|(\s+uicmd-check)/g,v?" xui-uicmd-check":" xui-uicmd-radio")}}},Behaviors:{HoverEffected:{ITEM:null,MARK:"MARK"},ClickEffected:{ITEM:null,MARK:"MARK"}},EventHandlers:{onCmd:null},_prepareItem:function(profile,item){item._fi_markcls=profile.properties.checkBox?"xui-uicmd-check":"xui-uicmd-radio",item._itemRow=profile.properties.itemRow?"xui-item-row":""}}}),xui.Class("xui.UI.StatusButtons",["xui.UI.List"],{Initialize:function(){var t=this.getTemplate();t.className="{_className}",t.ITEMS.className="{_bordertype}",t.$submap.items.ITEM={className:"{_itemClass} {itemClass} {disabled} {readonly}",style:"{itemPadding};{itemMargin};{itemWidth};{itemAlign};{itemStyle}",tabindex:"{_tabindex}",LTAGCMDS:{$order:2,tagName:"span",style:"{_ltagDisplay}",text:"{ltagCmds}"},ICON:{$order:10,className:"xuicon {imageClass}  {picClass}",style:"{backgroundImage}{backgroundPosition}{backgroundSize}{backgroundRepeat}{iconFontSize}{imageDisplay}{iconStyle}",text:"{iconFontCode}"},CAPTION:{$order:11,text:"{caption}"},DROP:{$order:12,className:"xuifont",$fonticon:"xui-uicmd-arrowdrop",style:"{_dropDisplay}"},RTAGCMDS:{$order:40,tagName:"span",style:"{_rtagDisplay}",text:"{rtagCmds}"},FLAG:{$order:13,className:"xui-display-none xui-uiflag {flagClass}",style:"{_flagStyle};{flagStyle}",text:"{flagText}"}},this.setTemplate(t)},Static:{Appearances:{ITEMS:{position:"relative",overflow:"visible"},ITEM:{"vertical-align":"middle",position:"relative",padding:".5em",margin:".166667em",cursor:"pointer","white-space":"nowrap"},"ITEM-hover, ITEM-active, ITEM-checked":{},"ITEM-hover":{},"ITEM-active":{},"ITEM-checked":{},CAPTION:{display:xui.$inlineBlock,zoom:xui.browser.ie6?1:null,"vertical-align":"middle","font-size":"1em"},DROP:{"vertical-align":"middle"},FLAG:{top:"-.5em",right:"-.5em",position:"absolute","z-index":10}},DataModel:{lite:null,maxHeight:null,height:"auto",itemMargin:{ini:"",action:function(v){this.getSubNode("ITEM",!0).css("margin",v)}},itemPadding:{ini:"",action:function(v){this.getSubNode("ITEM",!0).css("padding",v)}},itemWidth:{$spaceunit:1,ini:"auto",action:function(v){this.getSubNode("ITEM",!0).width(v||"auto")}},itemAlign:{ini:"",listbox:["","left","center","right"],action:function(value){this.getSubNode("ITEM",!0).css("text-align",value)}},itemType:{ini:"button",listbox:["text","button","dropButton"],action:function(value){this.boxing().refresh()}},connected:{ini:!1,action:function(){this.boxing().refresh()}}},Behaviors:{DroppableKeys:["ITEMS"]},_prepareItem:function(profile,item,a,b,i,l){var t,p=profile.properties,type=item.type||p.itemType;item._tabindex=p.tabindex,p.connected?item.itemMargin="margin:"+(0===i?"0":"0 0 0 -1px"):(t=item.itemMargin||p.itemMargin)&&(item.itemMargin="margin:"+t),(t=item.itemPadding||p.itemPadding)&&(item.itemPadding="padding:"+t),(t=item.itemWidth||p.itemWidth)&&(item.itemWidth="width:"+profile.$forceu(t||"auto")),(t=item.itemAlign||p.itemAlign)&&(item.itemAlign="text-align:"+t),(item.flagText||item.flagClass)&&(item._flagStyle="display:block"),item.flagClass||(item.flagClass="xui-uiflag-1"),item._itemClass="text"==type?"xui-node-a":"xui-ui-btn xui-uibar xui-uigradient "+(p.connected?0==i?"xui-uiborder-radius-tl xui-uiborder-radius-bl xui-uiborder-noradius-r":i===l-1?"xui-uiborder-radius-tr xui-uiborder-radius-br xui-uiborder-noradius-l":"xui-uiborder-noradius":"xui-uiborder-radius"),item._dropDisplay="dropButton"==type?"":"display:none",this._prepareCmds(profile,item)}}}),xui.Class("xui.UI.TreeBar",["xui.UI","xui.absList","xui.absValue"],{$Start:function(t){(t=this.Static.RenderTrigger)&&(t.$order=-1)},Instance:{_setCtrlValue:function(value,flag){return this.each((function(profile){if(profile.renderId){var uiv=profile.boxing().getUIValue(),properties=profile.properties,fun=function(key,o,b){profile.getSubNodeByItemId(key,o).tagClass("-checked",b)},selmode=properties.selMode;if("single"==selmode){var itemId=profile.getSubIdByItemId(uiv);if(uiv&&itemId&&fun("BAR",uiv,!1),(itemId=profile.getSubIdByItemId(value))&&(fun("BAR",value,!0),!profile._noScroll)){var o=profile.getSubNode("ITEM",itemId);if(o){var items=profile.getSubNode("BOX"),offset=o.offset(null,items),top=offset?offset.top:0,height=o.offsetHeight(),sh=items.scrollHeight(),st=items.scrollTop(),hh=items.height();sh>hh&&(top<st||top+height>st+hh)&&items.scrollTop(top)}}}else"multi"!=selmode&&"multibycheckbox"!=selmode||(uiv=uiv?uiv.split(properties.valueSeparator):[],value=value?value.split(properties.valueSeparator):[],flag||xui.arr.each(uiv,(function(o){fun("BAR",o,!1),fun("MARK",o,!1)})),xui.arr.each(value,(function(o){fun("BAR",o),fun("MARK",o)})))}}))},insertItems:function(arr,pid,base,before,toggle){var node,data,v,b=this._afterInsertItems;return this.each((function(profile){var tar,r,k,newsub,prop=profile.properties;if(data=profile.box._adjustItems(arr),!0===pid&&((v=prop.$UIvalue||prop.value)&&(v=(v+"").split(prop.valueSeparator)),k=profile.getItemByItemId(v[0]),pid=k?k.id:null),xui.isSet(pid)){if(!(k=profile.getItemByItemId(pid)))return;tar=xui.isArr(k.sub)?k.sub:(newsub=!0,k.sub=[])}else tar=(k=prop).items||(k.items=[]);if(profile.renderId&&(!0===base&&((v=prop.$UIvalue||prop.value)&&(v=(v+"").split(prop.valueSeparator)),k=profile.getItemByItemId(v[0]),base=k?k.id:null),base?(node=profile.getSubNodeByItemId("ITEM",base))&&(r=profile._buildItems("items",profile.box._prepareItems(profile,data,pid)),before?node.addPrev(r):node.addNext(r)):(xui.isSet(pid)?(newsub&&profile.getSubNodeByItemId("TOGGLE",pid).removeClass("xui-icon-placeholder xui-uicmd-none").addClass("xui-uicmd-toggle"),k._inited&&(node=profile.getSubNodeByItemId("SUB",pid))):node=profile.getSubNode("ITEMS"),node&&(r=profile._buildItems("items",profile.box._prepareItems(profile,data,pid)),before?node.prepend(r):node.append(r)))),base){var index=xui.arr.subIndexOf(tar,"id",base);xui.arr.insertAny(tar,data,before?index:index+1)}else xui.arr.insertAny(tar,data,before?0:-1);profile.renderId&&!1!==toggle&&(xui.isSet(pid)?profile.getItemByItemId(pid)._inited&&(("iniFold"in k?k.iniFold:profile.properties.iniFold)||profile.boxing()._toggleNodes(data,!0,!0,!0)):profile.boxing()._toggleNodes(data,!0,!0,!0)),b&&profile.renderId&&profile.boxing()._afterInsertItems(profile,data,pid,base,before),profile.renderId&&xui.isSet(pid)&&profile.box._tofold(profile,k,pid)}))},_toggleNodes:function(items,expand,recursive,init){var self=this,pro=self.get(0).properties,f=function(items,expand,recursive,init){xui.isArr(items)&&xui.arr.each(items,(function(o){init&&(xui.isBool(o.iniFold)?o.iniFold:pro.iniFold)||(self.toggleNode(o.id,expand,!1,recursive),recursive&&o.sub&&xui.isArr(o.sub)&&o.sub.length&&f(o.sub,expand,!0,init))}))};return f(items,expand,recursive,init),self},toggleNode:function(id,expand,recursive,stopanim,callback){var profile=this.get(0),ns=this,self=arguments.callee;if(xui.isSet(id)){var o=profile.getItemByItemId(id);!o||!o.sub||xui.isSet(expand)&&!!expand==!!o._checked||profile.box._setSub(profile,o,xui.isSet(expand)?!!expand:!o._checked,recursive,stopanim||recursive,callback)}else xui.arr.each(profile.properties.items,(function(item){item.sub&&self.call(ns,item.id,expand,recursive)}));return this},openToNode:function(id,triggerEvent){return this.each((function(profile){var res=!1,a=[];!function(arr,catId,layer){layer=layer||0;var me=arguments.callee;xui.arr.each(arr,(function(o){return o.id==catId?(a.push(o),res=!0,!1):o.sub&&xui.isArr(o.sub)&&(res=me.call(me,o.sub,catId,++layer))?(a.push(o),!1):void 0}))}(profile.properties.items,id),res&&(a.reverse(),xui.arr.each(a,(function(o,i){o.sub?(profile.boxing().toggleNode(o.id,!0),!1===triggerEvent||i!=a.length-1||(o.hasOwnProperty("group")?o.group:profile.properties.group)||profile.boxing().fireItemClickEvent(o.id)):!1!==triggerEvent&&profile.boxing().fireItemClickEvent(o.id)})))}))},isSubInited:function(id){var item=this.getItemByItemId(id);return item&&item.sub&&xui.isArr(item.sub)}},Static:{_focusNodeKey:"BAR",Templates:{tagName:"div",style:"{_style}",className:"{_className}",BORDER:{tagName:"div",className:"xui-uibase",BOX:{tagName:"div",ITEMS:{tagName:"div",className:"{_cmdsalign}",text:"{items}"}}},$submap:{items:{ITEM:{className:"",style:"{_itemDisplay}",tagName:"div",BAR:{$order:0,tabindex:"{_tabindex}",className:"xui-uitembg  xui-showfocus  {itemClass} {cls_group} {cls_fold} {_split} {disabled} {readonly}",style:"{itemStyle};{_splitstyle}",RULER:{$order:2,style:"{_ruleDisplay};{rulerStyle}",text:"{innerIcons}"},TOGGLE:{$order:3,style:"{_tglDisplay}",className:"xuifont",$fonticon:"{_fi_togglemark}"},LTAGCMDS:{$order:4,tagName:"span",style:"{_ltagDisplay}",text:"{ltagCmds}"},MARK:{$order:5,className:"xuifont",$fonticon:"xui-uicmd-check",style:"{mark2Display}"},ITEMICON:{$order:6,className:"xuicon {imageClass} {picClass}",style:"{backgroundImage}{backgroundPosition}{backgroundSize}{backgroundRepeat}{iconFontSize}{imageDisplay}{iconStyle}",text:"{iconFontCode}"},ITEMCAPTION:{text:"{caption}",style:"{_capDisplay}",className:"{disabled}  {readonly}",$order:7},EXTRA:{style:"{_extraDisplay}",text:"{ext}",$order:8},RTAGCMDS:{$order:9,tagName:"span",style:"{_rtagDisplay}",text:"{rtagCmds}"},OPT:{$order:10,style:"{_optDisplay}",className:"xuifont",$fonticon:"{_fi_optClass}"}},SUB:{$order:1,tagName:"div",text:xui.UI.$childTag}}},"items.ltagCmds":function(profile,template,v,tag,result){var me=arguments.callee,map=me._m||(me._m={text:".text",button:".button",image:".image"});xui.UI.$doTemplate(profile,template,v,"items.tagCmds"+(map[v.type]||".button"),result)},"items.rtagCmds":function(profile,template,v,tag,result){var me=arguments.callee,map=me._m||(me._m={text:".text",button:".button",image:".image"});xui.UI.$doTemplate(profile,template,v,"items.tagCmds"+(map[v.type]||".button"),result)},"items.tagCmds.text":xui.UI.$getTagCmdsTpl("text"),"items.tagCmds.button":xui.UI.$getTagCmdsTpl("button"),"items.tagCmds.image":xui.UI.$getTagCmdsTpl("image")}},Appearances:{KEY:{border:0},EXTRA:{display:"none"},BOX:{left:0,overflow:"auto","overflow-x":"hidden",position:"relative",clear:"both"},ITEMS:{overflow:"hidden"},ITEM:{"white-space":"nowrap",position:"relative",overflow:"hidden"},BAR:{cursor:"pointer",zoom:xui.browser.ie?1:null,position:"relative",display:"block",overflow:"hidden",padding:".25em .5em","border-radius":".3px 0 0 3px","-moz-border-radius":"3px 0 0 3px","-webkit-border-radius":"3px 0 0 3px","-o-border-radius":"3px 0 0 3px","-ms-border-radius":"3px 0 0 3px","-khtml-border-radius":"3px 0 0 3px","outline-offset":"-1px","-moz-outline-offset":xui.browser.gek&&xui.browser.ver<3?"-1px !important":null},SUB:{overflow:"hidden",zoom:xui.browser.ie?1:null,height:0,"font-size":xui.browser.ie68?"1px":null,"line-height":xui.browser.ie68?"1px":null,position:"relative","margin-left":"1.75em"},MARK:{cursor:"pointer","vertical-align":"middle"},"BAR-group":{$order:4,border:"none"},ITEMCAPTION:{"vertical-align":xui.browser.ie6?"baseline":"middle",padding:".167em","white-space":"normal"},OPT:{$order:10,position:"absolute",left:"auto",top:"50%","margin-top":"-0.5em",right:".167em",display:"none"},"LTAGCMDS, RTAGCMDS":{padding:0,margin:0,"vertical-align":"middle"},"ITEMS-tagcmdleft RTAGCMDS":{"padding-right":".333em",float:"left"},"ITEMS-tagcmdfloatright RTAGCMDS":{"padding-right":".333em",float:"right"},TOGGLE:{padding:"0 .334em 0 0"}},Behaviors:{HoverEffected:{TOGGLE:"TOGGLE",BAR:"BAR",OPT:"OPT",CMD:"CMD"},ClickEffected:{TOGGLE:"TOGGLE",BAR:"BAR",OPT:"OPT",CMD:"CMD"},DraggableKeys:["BAR"],NoDraggableKeys:["TOGGLE"],DroppableKeys:["BAR","TOGGLE","BOX"],TOGGLE:{onClick:function(profile,e,src){var properties=profile.properties,domId=xui.use(src).id(),item=profile.getItemByDom(domId);return!properties.disabled&&!item.disabled&&"sub"in item&&(profile.box._setSub(profile,item,!item._checked),!1)}},BAR:{onDblclick:function(profile,e,src){profile.properties;var item=profile.getItemByDom(src),rtn=profile.onDblclick&&profile.boxing().onDblclick(profile,item,e,src);item.sub&&!1!==rtn&&profile.getSubNode("TOGGLE",profile.getSubId(src)).onClick()},onClick:function(profile,e,src){return profile.box._onclickbar(profile,e,src)},onKeydown:function(profile,e,src){return profile.box._onkeydownbar(profile,e,src)},onContextmenu:function(profile,e,src){if(profile.onContextmenu)return!1!==profile.boxing().onContextmenu(profile,e,src,profile.getItemByDom(src))},onMouseover:function(profile,e,src){if(!xui.browser.fakeTouch&&"touchOnly"!=xui.browser.deviceType){var item=profile.getItemByDom(src);item&&(profile.properties.optBtn||item.optBtn)&&profile.getSubNode("OPT",profile.getSubId(src)).setInlineBlock()}},onMouseout:function(profile,e,src){if(!xui.browser.fakeTouch&&"touchOnly"!=xui.browser.deviceType){var item=profile.getItemByDom(src);item&&(profile.properties.optBtn||item.optBtn)&&profile.getSubNode("OPT",profile.getSubId(src)).css("display","none")}}},OPT:{onClick:function(profile,e,src){if(profile.onShowOptions){var item=profile.getItemByDom(src);if(!item)return;if(!profile.properties.optBtn&&!item.optBtn)return;profile.boxing().onShowOptions(profile,item,e,src)}return!1},onDblclick:function(profile,e,src){return!1}},CMD:{onClick:function(profile,e,src){var prop=profile.properties,item=profile.getItemByDom(xui.use(src).parent().get(0));return!!item&&(prop.disabled||item.disabled||"split"==item.type||profile.onCmd&&profile.boxing().onCmd(profile,item,xui.use(src).id().split("_")[1],e,src),!1)}},BOX:{onScroll:function(profile,e,src){0!==(e=xui.use(src)).scrollLeft()&&e.scrollLeft(0)}}},EventHandlers:{onShowOptions:function(profile,item,e,src){},beforeClick:function(profile,item,e,src){},onClick:function(profile,item,e,src){},afterClick:function(profile,item,e,src){},onCmd:function(profile,item,cmdkey,e,src){},onDblclick:function(profile,item,e,src){},onGetContent:function(profile,item,callback){},onItemSelected:function(profile,item,e,src,type){},beforeFold:function(profile,item){},beforeExpand:function(profile,item){},afterFold:function(profile,item){},afterExpand:function(profile,item){}},DataModel:{listKey:null,isFormField:{hidden:!0,ini:!1},width:{$spaceunit:1,ini:"18em"},height:{$spaceunit:1,ini:"18em"},iniFold:!0,animCollapse:!0,dock:"fill",group:{ini:!1,action:function(v){var self=this,items=self.properties.items,results=self.queryItems(items,(function(o){return o.sub&&o.group===undefined})),nodes=xui();xui.arr.each(results,(function(o){nodes.merge(self.getSubNodeByItemId("BAR",o.id))})),v?nodes.addClass("xui-uigradient xui-uibar "+self.getClass("BAR","-group")):nodes.removeClass("xui-uigradient xui-uibar "+self.getClass("BAR","-group"))}},selMode:{ini:"single",listbox:["single","none","multi","multibycheckbox"],action:function(value){var ns=this,p=this.properties,sels=[];xui.each(this.SubSerialIdMapItem,(function(o){o.sub&&(o.hasOwnProperty("group")?o.group:p.group)||sels.push(ns.getSubNodeByItemId("MARK",o.id).get(0))})),xui(sels).css("display","multi"==value||"multibycheckbox"==value?"":"none")}},noCtrlKey:!0,singleOpen:!1,dynDestory:!1,position:"absolute",optBtn:{ini:"",combobox:xui.toArr("xui-uicmd-opt,xui-icon-singleright"),action:function(){this.boxing().refresh()}},togglePlaceholder:!1,tagCmds:{ini:[],action:function(){this.boxing().refresh()}},tagCmdsAlign:{ini:"right",listbox:["left","right","floatright"],action:function(v){var box=this.getSubNode("ITEMS"),cls=this.getClass("ITEMS","-tagcmd");box.removeClass(new RegExp(cls+"[w]*")).addClass(this.getClass("ITEMS","-tagcmd"+v))}}},RenderTrigger:function(){this.boxing()._toggleNodes(this.properties.items,!0,!0,!0)},_onclickbar:function(profile,e,src){var properties=profile.properties,domId=xui.use(src).id(),item=profile.getItemByDom(domId),itemId=profile.getSubId(domId),box=profile.boxing(),ks=xui.Event.getKey(e),sk=profile.getKey(xui.Event.getSrc(e).id||""),ignoreClick=sk==profile.keys.TOGGLE||sk==profile.keys.MARK;if(!ignoreClick&&profile.beforeClick&&!1===box.beforeClick(profile,item,e,src))return!1;if(properties.disabled||item.disabled||"split"==item.type)return!1;if(!ignoreClick&&profile.onClick&&box.onClick(profile,item,e,src),!item.sub||!(item.hasOwnProperty("group")?item.group:properties.group)){switch(profile.getSubNode(profile.box._focusNodeKey,itemId).focus(!0),properties.selMode){case"none":box.onItemSelected(profile,item,e,src,0);break;case"multibycheckbox":if(properties.readonly||item.readonly)return!1;if(profile.keys.MARK&&sk!=profile.keys.MARK){box.onItemSelected(profile,item,e,src,0);break}case"multi":if(properties.readonly||item.readonly)return!1;var value=box.getUIValue(),arr=value?value.split(properties.valueSeparator):[],checktype=1;if(arr.length&&(ks.ctrlKey||ks.shiftKey||properties.noCtrlKey)){if(ks.shiftKey){if(profile.$firstV._pid!=item._pid)return;var items=properties.items;if(item._pid){var pitem=profile.getItemByItemId(item._pid);pitem&&(items=pitem.sub)}var i,i1=xui.arr.subIndexOf(items,"id",profile.$firstV.id),i2=xui.arr.subIndexOf(items,"id",item.id);for(arr.length=0,i=Math.min(i1,i2);i<=Math.max(i1,i2);i++)arr.push(items[i].id)}else-1!=xui.arr.indexOf(arr,item.id)?(xui.arr.removeValue(arr,item.id),checktype=-1):arr.push(item.id);arr.sort(),value=arr.join(properties.valueSeparator),box.getUIValue()!=value&&(profile._noScroll=1,box.setUIValue(value,null,null,"click"),delete profile._noScroll,box.get(0)&&box.getUIValue()==value&&box.onItemSelected(profile,item,e,src,checktype));break}case"single":box.getUIValue()!=item.id&&(profile.$firstV=item,profile._noScroll=1,box.setUIValue(item.id,null,null,"click"),delete profile._noScroll,box.get(0)&&box.getUIValue()==item.id&&box.onItemSelected(profile,item,e,src,1))}return!ignoreClick&&profile.afterClick&&box.afterClick(profile,item,e,src),!ignoreClick}profile.getSubNode("TOGGLE",itemId).onClick()},_onkeydownbar:function(profile,e,src){var keys=xui.Event.getKey(e),key=keys.key,shift=keys.shiftKey,ctrl=keys.ctrlKey,cur=profile.getSubNode(profile.box._focusNodeKey,profile.getSubId(src)),root=profile.getRoot(),first=root.nextFocus(!0,!0,!1),last=root.nextFocus(!1,!0,!1);switch(key){case"enter":cur.onClick();break;case"tab":if(shift){if(cur.get(0)!=first.get(0))return first.focus(!0),!1}else if(cur.get(0)!=last.get(0))return last.focus(!0),!1;break;case"up":return ctrl?(profile.getSubNode("TOGGLE",profile.getSubId(src)).onClick(),!1):(cur.get(0)==first.get(0)?last.focus(!0):cur.nextFocus(!1,!0,!1).focus(!0),!1);case"down":return ctrl?(profile.getSubNode("TOGGLE",profile.getSubId(src)).onClick(),!1):(cur.get(0)==last.get(0)?first.focus(!0):cur.nextFocus(!0,!1,!1).focus(!0),!1);case"right":case"left":return profile.getSubNode("TOGGLE",profile.getSubId(src)).onClick(),!1}},_onStartDrag:function(profile,e,src,pos){return pos=xui.Event.getPos(e),xui.use(src).startDrag(e,{dragSource:profile.$xid,dragType:"icon",shadowFrom:src,targetLeft:pos.left+12,targetTop:pos.top+12,dragCursor:"pointer",dragDefer:2,dragKey:profile.box.getDragKey(profile,src),dragData:profile.box.getDragData(profile,e,src)}),!1},_onDropTest:function(profile,e,src,key,data,item){var fid=data&&data.domId;if(fid){if(fid==xui.use(src).id())return!1;if(xui.get(xui.use(src).get(0),["parentNode","previousSibling","firstChild","id"])==fid)return!1;var oitem=profile.getItemByDom(fid);if(oitem&&item&&oitem._pid==item.id)return!1;for(var p=xui.use(src).get(0),rn=profile.getRootNode();p=p.parentNode;){if(profile.getSubId(p.id)==profile.getSubId(fid))return!1;if(p.id==xui.get(rn,["parentNode","id"]))break}}},_onDrop:function(profile,e,src,key,data,item){var oitem,k=profile.getKey(xui.use(src).id()),po=data.profile,ps=data.domId,ks=profile.keys,t=xui.absObj.$specialChars,b=profile.boxing(),arr=xui.copy(b.getUIValue(!0));return oitem=xui.clone(po.getItemByDom(ps),(function(o,i){return!t[(i+"").charAt(0)]})),po.boxing().removeItems([oitem.id]),k==ks.BOX?b.insertItems([oitem],null,null,!1):k==ks.BAR?b.insertItems([oitem],item._pid,item.id,!0):k==ks.TOGGLE&&b.insertItems([oitem],item.id,null,!1),arr&&arr.length&&-1!=xui.arr.indexOf(arr,oitem.id)&&(profile._noScroll=1,b.setUIValue(arr,!0,null,"drop"),delete profile._noScroll),data._new=oitem,!1},_prepareData:function(profile){var d=arguments.callee.upper.call(this,profile);return d._cmdsalign=profile.getClass("ITEMS","-tagcmd"+profile.properties.tagCmdsAlign),d},_prepareItem:function(profile,item,oitem,pid,index,len){var p=profile.properties;profile.ItemIdMapSubSerialId,profile.SubSerialIdMapItem,pid&&(oitem._pid=pid),item.isFolder&&(oitem.sub||(oitem.sub=!0),item.sub||(item.sub=!0)),item._fi_togglemark=item.sub?"xui-uicmd-toggle"+(item._checked?" xuifont-checked xui-uicmd-toggle-checked":""):p.togglePlaceholder?"xui-icon-placeholder":"xui-uicmd-none",item.disabled=item.disabled?"xui-ui-disabled":"",item.mark2Display="showMark"in item?item.showMark?"":"display:none;":"multi"==p.selMode||"multibycheckbox"==p.selMode?"":"display:none;",item._tabindex=p.tabindex,item._fi_optClass=p.optBtn,item.group&&!item.sub&&(item.sub=oitem.sub=[]),item.sub&&(item.hasOwnProperty("group")?item.group:p.group)&&(item.cls_group="xui-uigradient xui-uibar "+profile.getClass("BAR","-group"),item.mark2Display="display:none"),this._prepareCmds(profile,item),(xui.browser.fakeTouch||"mouseOnly"==xui.browser.deviceType)&&(item._optDisplay=p.optBtn?"display:block;":""),"split"==item.type&&(item._split="xui-uitem-split",item._ruleDisplay=item._ltagDisplay=item._tglDisplay=item._rtagDisplay=item.imageDisplay=item.mark2Display=item._capDisplay=item._extraDisplay=item._optDisplay="display:none;")},_setSub:function(profile,item,flag,recursive,stopanim,cb){var id=profile.domId,ins=profile.boxing(),prop=profile.properties,itemId=profile.getSubIdByItemId(item.id),markNode=profile.getSubNode("TOGGLE",itemId),subNs=profile.getSubNode("SUB",itemId),barNode=profile.getSubNode("BAR",itemId),icon=profile.getSubNode("ITEMICON",itemId);if(!xui.Thread.isAlive(profile.key+":"+profile.$xid))if(flag){if(!item._checked){if(ins.beforeExpand&&!1===ins.beforeExpand(profile,item))return;onend=function(empty){subNs.css({display:"",height:"auto"}),xui.browser.ie&&xui.browser.ver<=8?markNode.css({backgroundImage:"",backgroundRepeat:"",backgroundPositionX:"",backgroundPositionY:"",backgroundColor:"",backgroundAttachment:""}):markNode.removeClass("xui-icon-loading"),empty||(item._checked=!0,ins.afterExpand&&ins.afterExpand(profile,item)),xui.resetRun(id,(function(cb){cb&&xui.tryF(cb,[profile,item],ins)}),0,[cb])};var t,sub=item.sub,callback=function(sub){!function(profile,item,id,markNode,subNs,barNode,icon,sub){var b=profile.boxing(),p=profile.properties,empty=!1===sub;if(!empty&&!item._inited&&(delete item.sub,item._inited=!0,sub)){"string"==typeof sub?subNs.html(item.sub=sub,!1):sub["xui.Template"]||sub["xui.UI"]?subNs.append(item.sub=sub.render(!0)):xui.isArr(sub)&&(b.insertItems(sub,item.id),item.sub||(item.sub=sub));var s=0,arr=b.getUIValue(!0);arr&&arr.length&&(xui.arr.each(sub,(function(o){if(-1!=xui.arr.indexOf(arr,o.id||o))return s=1,!1})),s&&(profile._noScroll=1,b._setCtrlValue(b.getUIValue()),delete profile._noScroll))}if(p.singleOpen&&b._toggleNodes(item._pid?profile.getItemByItemId(item._pid).sub:p.items,!1),empty||(markNode.tagClass("-checked"),barNode.tagClass("-expand").tagClass("-fold",!1),icon.tagClass("-fold",!1).tagClass("-expand")),stopanim)onend(empty);else if(subNs.css("height","0px").css("display",""),p.animCollapse){var h=0;subNs.children().each((function(o){h+=o.offsetHeight})),subNs.animate({height:[0,h]},null,(function(){onend(empty)}),200,null,"expoIn",profile.key+":"+profile.$xid).start()}else onend(empty)}(profile,item,0,markNode,subNs,barNode,icon,sub)};if("string"==(t=typeof sub)||"object"==t)callback(sub);else if(profile.onGetContent){xui.browser.ie&&xui.browser.ver<=8?markNode.css("background","url("+xui.ini.img_busy+") no-repeat"):markNode.addClass("xui-icon-loading");var r=profile.boxing().onGetContent(profile,item,callback);(r||!1===r)&&(!0===r&&(item._inited=!0),callback(r))}}recursive&&item.sub&&xui.arr.each(item.sub,(function(o){o.sub&&o.sub.length&&!o._checked&&profile.box._setSub(profile,o,flag,recursive,!0,cb)}))}else{if(item._checked){if(ins.beforeFold&&!1===ins.beforeFold(profile,item))return;var onend=function(){if(subNs.css({display:"none",height:0}),markNode.tagClass("-checked",!1),barNode.tagClass("-expand",!1).tagClass("-fold"),icon.tagClass("-expand",!1).tagClass("-fold"),item._checked=!1,prop.dynDestory||item.dynDestory){for(var s=item.sub,arr=[],i=0,l=s.length;i<l;i++)arr.push(s[i].id);profile.boxing().removeItems(arr),item.sub=!0,delete item._inited}ins.afterFold&&ins.afterFold(profile,item),xui.resetRun(id,(function(cb){cb&&xui.tryF(cb,[profile,item],ins)}),0,[cb])};stopanim?onend():prop.animCollapse?subNs.animate({height:[subNs.height(),0]},null,onend,200,null,"expoOut",profile.key+":"+profile.$xid).start():onend()}recursive&&item.sub&&!prop.dynDestory&&!item.dynDestory&&xui.arr.each(item.sub,(function(o){o.sub&&o.sub.length&&profile.box._setSub(profile,o,flag,recursive,!0,cb)}))}},_tofold:function(profile,item,pid){profile.getSubNodeByItemId("BAR",pid).addClass(profile.getClass("BAR","-fold")),profile.getSubNodeByItemId("TOGGLE",pid).replaceClass(new RegExp("\\buicmd-(none|empty)\\b"),"xui-uicmd-toggle")},_onresize:function(profile,width,height){profile.getSubNode("BORDER").cssSize({width:width||null,height:height||null}),profile.getSubNode("BOX").cssSize({width:width||null,height:height||null})}}}),xui.Class("xui.UI.TreeView","xui.UI.TreeBar",{Initialize:function(){this.addTemplateKeys(["IMAGE"]);var t=this.getTemplate();t.$submap.items.ITEM.BAR.className="xui-uitembg xui-uiborder-radius xui-showfocus {cls_group} {cls_fold} {_split} {disabled} {readonly}",t.$submap.items.ITEM.BAR.ITEMICON.$fonticon="{_fi_cls_file}",this.setTemplate(t)},Static:{Appearances:{ITEMS:{padding:".25em"},ITEM:{"white-space":"nowrap",position:"relative",overflow:"hidden"},BAR:{zoom:xui.browser.ie?1:null,position:"relative",display:"block","outline-offset":"-1px","-moz-outline-offset":xui.browser.gek&&xui.browser.ver<3?"-1px !important":null},SUB:{zoom:xui.browser.ie?1:null,height:0,"font-size":xui.browser.ie68?"1px":null,"line-height":xui.browser.ie68?"1px":null,position:"relative",overflow:"hidden"},BOX:{left:0,overflow:"auto",position:"relative"}},Behaviors:{MARK:{onClick:function(profile,e,src){return profile.box._onclickbar(profile,e,xui.use(src).parent().xid()),!1}},ITEMICON:{onClick:function(profile,e,src){return profile.box._onclickbar(profile,e,xui.use(src).parent().xid()),!1}}},DataModel:{$subMargin:1.8,group:null,noIcon:{ini:!1,action:function(v){this.getSubNode("ITEMICON",!0).css("display",v?"none":"")}}},_prepareItem:function(profile,item,oitem,pid,index,len){var pitem,p=profile.properties,map1=profile.ItemIdMapSubSerialId,map2=profile.SubSerialIdMapItem;item.isFolder&&(oitem.sub||(oitem.sub=!0),item.sub||(item.sub=!0)),xui.isSet(pid)?(oitem._pid=pid,(pitem=map2[map1[pid]])&&(oitem._deep=pitem._deep+1,item.rulerStyle="width:"+oitem._deep*p.$subMargin+"em;",item._fi_togglemark=item.sub?"xui-uicmd-toggle"+(item._checked?"-checked xui-uicmd-toggle":""):p.togglePlaceholder?"xui-uicmd-empty":"xui-uicmd-none")):(oitem._deep=0,item.rulerStyle="",item.innerIcons="",item._fi_togglemark=item.sub?"xui-uicmd-toggle"+(item._checked?"-checked xui-uicmd-toggle":""):p.togglePlaceholder?"xui-uicmd-empty":"xui-uicmd-none"),item.imageDisplay=item.noIcon||p.noIcon?"display:none;":"",item.cls_fold=item.sub?profile.getClass("BAR","-fold"):"",item.imageClass||item.image||item.iconFontCode||(item._fi_cls_file="xui-icon-file"+(item.sub?" xui-icon-file-fold":"")),item._fi_optClass=p.optBtn,item.disabled=item.disabled?"xui-ui-disabled":"",item._itemDisplay=item.hidden?"display:none;":"",item.mark2Display="showMark"in item?item.showMark?"":"display:none;":"multi"==p.selMode||"multibycheckbox"==p.selMode?"":"display:none;",item._tabindex=p.tabindex,this._prepareCmds(profile,item),"split"==item.type&&(item._split="xui-uitem-split",item._splitstyle="margin-left:"+oitem._deep*p.$subMargin+"em;",item._ruleDisplay=item._ltagDisplay=item._tglDisplay=item._rtagDisplay=item.imageDisplay=item.mark2Display=item._capDisplay=item._extraDisplay=item._optDisplay="display:none;")},_tofold:function(profile,item,pid){var cls=profile.getClass("IMAGE");profile.getSubNodeByItemId("BAR",pid).addClass(profile.getClass("BAR","-fold")),profile.getSubNodeByItemId("TOGGLE",pid).replaceClass(new RegExp("\\b"+cls+"-path([-\\w]+)\\b"),cls+"-fold$1")}}}),xui.Class("xui.UI.PopMenu",["xui.UI.Widget","xui.absList"],{Instance:{adjustSize:function(){return this.each((function(profile){if(profile.renderId){var root=profile.getRoot(),border=profile.getSubNode("BORDER"),box=profile.getSubNode("BOX"),bg=profile.getSubNode("BOXBGBAR"),items=profile.getSubNode("ITEMS"),nodes=profile.getSubNode("ITEM",!0),prop=profile.properties,us=xui.$us(profile),cb=border.contentBox(),adjustunit=function(v,emRate){return profile.$forceu(v,us>0?"em":"px",emRate)},ww=0,hh=0;items.cssSize({width:"auto",height:"auto"}),hh=items.height()+(cb?0:border._borderH()),xui.browser.ie67&&hh%2==1&&(hh+=1),items.addClass(profile.getClass("ITEMS","-inline")),nodes.each((function(n){ww=Math.max(ww,n.offsetWidth)})),ww%2==1&&(ww+=1),items.removeClass(profile.getClass("ITEMS","-inline")),items.cssSize({width:adjustunit(ww),height:adjustunit(hh)}),bg.height(adjustunit(hh));var h=adjustunit(Math.min(prop._maxHeight,hh)),w=adjustunit(Math.min(prop._maxWidth,ww)),size={width:w,height:h};prop.width=w,prop.height=h,root.cssSize(size),border.cssSize(size),box.cssSize({width:adjustunit(Math.min(prop._maxWidth,ww)+xui.Dom.getScrollBarSize()),height:size.height})}})),this._setScroll()},_setScroll:function(){return this.each((function(profile){if(profile.getRootNode()){var o=profile.getSubNode("BOX"),t=o.scrollTop(),h=o.scrollHeight(),hh=profile.getRoot().offsetHeight();profile.getSubNode("TOP").css("display",0===t?"none":"block"),profile.getSubNode("BOTTOM").css("display",hh>=h-t?"none":"block")}}))},_scrollToBottom:function(){var profile=this.get(0),o=profile.getSubNode("BOX"),border=profile.getSubNode("BORDER"),y=o.scrollTop(),b=!1,h=o.scrollHeight(),bh=border.height();bh<h-y&&(bh>=h-(y+=profile.$scrollStep=Math.max(5,1.005*(profile.$scrollStep||1)))&&(y=h-bh,b=!0),o.scrollTop(y),b?(profile.getSubNode("BOTTOM").css("display","none"),profile.$scrollTobottom=!1,profile.$scrollStep=1):(profile.getSubNode("TOP").css("display","block"),profile.$scrollTobottom&&xui.asyRun(this._scrollToBottom,0,[],this)))},_scrollToTop:function(){var profile=this.get(0),o=profile.getSubNode("BOX"),y=o.scrollTop(),b=!1;y>0&&((y-=profile.$scrollStep=Math.max(5,1.005*(profile.$scrollStep||1)))<0&&(y=0,b=!0),o.scrollTop(y),b?(profile.getSubNode("TOP").css("display","none"),profile.$scrollToTop=!1,profile.$scrollStep=1):(profile.getSubNode("BOTTOM").css("display","block"),profile.$scrollToTop&&xui.asyRun(this._scrollToTop,0,[],this)))},_initGrp:function(){var root,profile=this.get(0);profile.$popGrp&&profile.$popGrp.length||(root=profile.getRoot(),profile.$popGrp=[root._get(0)],root.setBlurTrigger(profile.$xid,null),root.setBlurTrigger(profile.$xid,(function(){profile.box&&(profile.boxing().hide(),profile.$popGrp&&(profile.$popGrp.length=0))}),profile.$popGrp))},pop:function(pos,type,parent,ignoreEffects){var ns=this,profile=ns.get(0),pid=profile.properties.parentID||xui.ini.$rootContainer;return profile.renderId||xui.Dom.getEmptyDiv().append(ns.render(!0)),profile.$highLight&&xui([profile.$highLight]).tagClass("-hover",!1),profile._conainer=pid?xui.get(profile,["host",pid])?profile.host[pid].getContainer():xui(pid):parent||null,profile.getRoot().popToTop(pos,type,profile._conainer,null,null,ignoreEffects),ns._setScroll(),ns.adjustSize(),ns._initGrp(),profile.$childPopMenu=profile.$subPopMenuShowed=profile.$highLight=null,ns},hide:function(triggerEvent,ignoreEffects,e){var t,profile=this.get(0),root=(profile.properties,profile.getRoot()),sms="$subPopMenuShowed",hl="$highLight",cm="$childPopMenu";return root.hide((function(){if(!1!==triggerEvent&&!1===profile.boxing().beforeHide(profile,ignoreEffects,e))return this;if(root&&"none"!=root.css("display")){xui.get(profile,["$hideMenuPool","_nodes",0])?profile.$hideMenuPool.append(root):root.css("display","none"),(t=profile[hl])&&xui([t]).tagClass("-hover",!1);var q,p=profile[cm];for((t=profile[sms])&&t.hide(triggerEvent,ignoreEffects);p;)p.boxing().hide(triggerEvent,ignoreEffects),p=(q=p)[cm],q[cm]=q[sms]=q[hl]=null;profile[cm]=profile[sms]=profile[hl]=null,(t=profile.$parentPopMenu)&&(t[sms]=null),profile.$popGrp&&xui.arr.removeValue(profile.$popGrp,root._get(0)),profile.$popGrp&&profile.$popGrp.length||root.setBlurTrigger(profile.$xid,null),!1!==triggerEvent&&profile.boxing().onHide(profile)}}),null,ignoreEffects),this},_afterInsertItems:function(profile){profile.renderId&&profile.boxing().adjustSize()},_afterRemoveItems:function(profile){profile.renderId&&profile.boxing().adjustSize()}},Initialize:function(){var t=this.getTemplate();xui.merge(t.FRAME.BORDER,{className:"xui-uiborder-outset xui-uiborder-radius",TOP:{className:"xuifont xui-uibar xui-uiborder-b",$fonticon:"xui-icon-circleup"},BOTTOM:{className:"xuifont xui-uibar xui-uiborder-t",$fonticon:"xui-icon-circledown"},BOX:{tagName:"div",className:"xui-uibase",BOXBGBAR:{tabName:"div",className:"xui-uibar",style:"{_iconDisplay}"},ITEMS:{tagName:"div",text:"{items}"}},POOL:{}},"all"),t.$submap={items:function(profile,template,v,tag,result){var t;tag=tag+"."+v.type,(t=v.object)?result[result.length]=t.build(v):template[tag]&&xui.UI.$doTemplate(profile,template,v,tag,result)},"items.split":{ITEMSPLIT:{style:"{_itemDisplay}",className:"xui-uiborder-b"}},"items.button":{ITEM:{tabindex:-1,className:" xui-uimenu {itemClass} {disabled}",style:"{itemStyle};{_itemDisplay};",ICON:{$order:0,className:"xuicon xui-icon-placeholder {imageClass}  {picClass}",style:"{backgroundImage}{backgroundPosition}{backgroundSize}{backgroundRepeat}{iconFontSize}{_iconDisplay}{iconStyle}",text:"{iconFontCode}"},CAPTION:{text:"{caption}",$order:1},RULER:{style:"{displayAdd}",$order:2},ADD:{tagName:"div",style:"{displayAdd}",text:"{add}",$order:2},SUB:{className:"xuifont",$fonticon:"xui-icon-singleright",style:"{displaySub}"}}},"items.checkbox":{ITEM:{tabindex:-1,className:"  xui-uimenu {itemClass} {disabled}",style:"{itemStyle};{_itemDisplay};",CHECKBOX:{$order:0,className:"xuifont",$fonticon:"{_fi_checkboxCls1} {_fi_checkboxCls2}  {_iconDisplay}"},CAPTION:{text:"{caption}",$order:1},RULER:{style:"{displayAdd}",$order:2},ADD:{tagName:"div",style:"{displayAdd}",text:"{add}",$order:2}}},"items.radiobox":{ITEM:{tabindex:-1,className:"  xui-uimenu {itemClass} {disabled}",style:"{itemStyle};{_itemDisplay};",RADIOBOX:{$order:0,className:"xuifont",$fonticon:"{_fi_radioboxCls1} {_fi_radioboxCls2}  {_iconDisplay}"},CAPTION:{text:"{caption}",$order:1},RULER:{style:"{displayAdd}",$order:2},ADD:{tagName:"div",style:"{displayAdd}",text:"{add}",$order:3}}}},this.setTemplate(t),this.prototype.popUp=this.prototype.pop},Static:{$initRootHidden:!0,Appearances:{KEY:{visibility:"hidden"},POOL:{position:"absolute",display:"none"},BOX:{overflow:"hidden",position:"relative","overflow-y":"auto","z-index":"3"},BORDER:{position:"relative",overflow:"hidden"},ITEMS:{position:"relative",top:0,left:0,overflow:"hidden","white-space":"nowrap"},BOXBGBAR:{"z-index":-1,position:"absolute",left:0,top:0,width:"2em",height:"100%"},"ITEMS-inline ITEM":{$order:5,display:xui.$inlineBlock},ITEM:{display:"block",position:"relative",overflow:"visible","white-space":"nowrap",cursor:"pointer",padding:".25em 1.75em .25em .25em",outline:0},ITEMSPLIT:{display:"block",position:"relative",overflow:"visible","white-space":"nowrap",margin:".25em .25em .25em 2em"},ICON:{margin:0},TOP:{cursor:"pointer",display:"none",position:"absolute","z-index":"10",top:0,"text-align":"center",width:"100%"},BOTTOM:{cursor:"pointer",display:"none",position:"absolute",bottom:0,"z-index":"10","text-align":"center",width:"100%"},"RADIOBOX, CHECKBOX, RADIOBOX-checked, CHECKBOX-checked":{cursor:"pointer","vertical-align":"middle"},CAPTION:{"vertical-align":xui.browser.ie6?"baseline":"middle","padding-left":".75em","font-size":"1em"},RULER:{width:"8em"},ADD:{position:"absolute",top:".25em",right:0,width:"7em","padding-right":"1.75em","text-align":"right","z-index":"10",zoom:xui.browser.ie?1:null},SUB:{position:"absolute",top:".15em",right:".15em"}},Behaviors:{HoverEffected:{TOP:"TOP",BOTTOM:"BOTTOM"},BOX:{onScroll:function(profile,e,src){profile.boxing()._setScroll()}},ITEM:{onMouseover:function(profile,e,src){var sms="$subPopMenuShowed",all="$allPops",hl="$highLight",showp="$showpops";if(profile[hl]!=src){profile[all]=profile[all]||{},profile.properties;var pop,popp,t,item=profile.getItemByDom(src),itemId=item.id,Cancel=!1;if((t=profile[sms])&&(t==xui.get(profile,[all,itemId])?Cancel=!0:(t.hide(),profile[sms]=null)),!Cancel){(t=profile[hl])&&xui([t]).tagClass("-hover",!1),profile[hl]=src,xui.use(src).tagClass("-hover");try{xui.use(src).get(0).focus()}catch(e){}}if(!Cancel&&item.sub){if((!xui.isArr(item.sub)||!item.sub.length)&&profile.onShowSubMenu){var r=profile[all][itemId];if(r&&r["xui.UI"]&&!r.isEmpty()||(r=profile.boxing().onShowSubMenu(profile,item,src)),r&&r["xui.UI"]&&!r.isEmpty())return profile[all][itemId]=profile[sms]=r,(r=r.reBoxing()).onMouseout((function(p,e,src){profile.box._mouseout(profile,e,src)}),null,-1),profile.boxing()._initGrp(),profile.$popGrp.push(r._get(0)),void r.popToTop(src,2,profile._conainer);r&&xui.isArr(r)&&r.length&&(item.sub=r)}if(xui.isArr(item.sub)&&item.sub.length){if(pop=profile[all][itemId])popp=pop.get(0);else{var pro=profile.properties;(pop=new xui.UI.PopMenu({position:"absolute",items:item.sub,autoHide:pro.autoHide,showEffects:pro.showEffects,hideEffects:pro.hideEffects}).render(!0)).onShowSubMenu((function(pro,item,src){return profile.boxing().onShowSubMenu(profile,item,src)})),pop.onMenuSelected((function(pro,item,src){return profile.boxing().onMenuSelected(profile,item,src)})),(popp=pop.get(0)).$hideMenuPool=xui.get(profile,["$hideMenuPool","_nodes",0])||profile.getSubNode("POOL"),profile[all][itemId]=pop,profile[showp]=profile[showp]||[profile],popp[showp]=profile[showp],profile[showp].push(popp)}profile.boxing()._initGrp(),profile.$popGrp.push(popp.getRoot()._get(0)),popp.$popGrp=profile.$popGrp,popp.$parentPopMenu=profile,profile.$childPopMenu=popp,pop.popUp(src,2,profile._conainer),profile[sms]=pop}}}},onMouseout:function(profile,e,src){profile.properties,profile.getItemByDom(src).id;var t,hl="$highLight";if(profile[hl]!=src){if(t=profile.$subPopMenuShowed){var node=e.toElement||e.relatedTarget,target=t.get(0).getRootNode();try{do{if(node==target)return}while(node&&(node=node.parentNode))}catch(a){}}xui.use(src).tagClass("-hover",!1),profile[hl]=null}},onClick:function(profile,e,src){var prop=profile.properties,item=profile.getItemByDom(src);if(item.id,prop.disabled||item.disabled)return!1;item.group||("checkbox"==item.type?profile.getSubNodeByItemId("CHECKBOX",item.id).tagClass("-checked",item.value=!item.value):"radiobox"==item.type&&(profile.getSubNode("RADIOBOX",!0).tagClass("-checked",!1),xui.arr.each(prop.items,(function(o){"radiobox"==o.type&&(o.value=!1)})),profile.getSubNodeByItemId("RADIOBOX",item.id).tagClass("-checked",item.value=!0)),profile.onMenuSelected&&profile.boxing().onMenuSelected(profile,item,src),prop.hideAfterClick&&(xui.use(src).tagClass("-hover",!1),xui.asyRun((function(){var q,p=profile;if(p.renderId){for(p.$childPopMenu&&p.$childPopMenu.boxing().hide(),p.$childPopMenu=null;p;)p.boxing().hide(),p=(q=p).$parentPopMenu,q.$parentPopMenu=q.$subPopMenuShowed=null;profile.$subPopMenuShowed=null,profile.$popGrp&&(profile.$popGrp.length=0)}}),100)))},onFocus:function(profile,e,src){var box=profile.getSubNode("BOX"),top=box.scrollTop(),h=box.scrollHeight(),n=xui.use(src).offsetTop();(n<top||n>top+h)&&xui.use(src).offsetTop(top),xui.use(src).onMouseover()},onKeydown:function(profile,e,src){var flag,r,tid,node,t,item=profile.getItemByDom(src),items=profile.properties.items,key=xui.Event.getKey(e).key,itemId=item.id;switch(key){case"enter":xui(src).onClick();break;case"up":r=!0,flag=!1,xui.arr.each(items,(function(o,i){if("split"!=o.type)return flag?(tid=o.id,r=!1):void(o.id==itemId&&(flag=!0))}),null,!0),r&&(tid=items[items.length-1].id),node=profile.getSubNodeByItemId("ITEM",tid).get(0);break;case"down":r=!0,flag=!1,xui.arr.each(items,(function(o,i){if("split"!=o.type)return flag?(tid=o.id,r=!1):void(o.id==itemId&&(flag=!0))})),r&&(tid=items[0].id),node=profile.getSubNodeByItemId("ITEM",tid).get(0);break;case"left":(t=profile.$parentPopMenu)&&(t=profile.$parentPopMenu.$highLight)&&(node=t);break;case"right":(t=profile.$subPopMenuShowed)&&t==profile.$allPops[itemId]&&t.activate()}if(node&&node.tagName)try{node.focus()}catch(e){}}},TOP:{onMouseover:function(profile){profile.$scrollToTop=!0,profile.$scrollStep=1,profile.boxing()._scrollToTop()},onMouseout:function(profile){profile.$scrollToTop=!1,profile.$scrollStep=1},onClick:function(profile){profile.$scrollStep*=2}},BOTTOM:{onMouseover:function(profile){profile.$scrollTobottom=!0,profile.$scrollStep=1,profile.boxing()._scrollToBottom()},onMouseout:function(profile){profile.$scrollTobottom=!1,profile.$scrollStep=1},onClick:function(profile){profile.$scrollStep*=2}},ITEMS:{afterKeydown:function(profile,e){var key=xui.Event.getKey(e).key;if("tab"==key||"enter"==key)return!0;if("esc"==key){do{profile.boxing().hide()}while(profile=profile.$parentPopMenu);return!1}return!1}},BORDER:{onMouseout:function(profile,e,src){profile.box._mouseout(profile,e,src)}}},DataModel:{dock:null,tabindex:null,tips:null,border:null,resizer:null,dragSortable:null,showEffects:"Blur",hideEffects:"",autoTips:!1,shadow:!0,_maxHeight:360,_maxWidth:460,left:-1e4,parentID:"",hideAfterClick:!0,autoHide:!1,height:{$spaceunit:1,ini:"auto"},width:{$spaceunit:1,ini:"auto"},position:"absolute",noIcon:{ini:!1,action:function(){this.boxing().refresh()}},$hborder:0,$vborder:0},EventHandlers:{onShowSubMenu:function(profile,item,src){},beforeHide:function(profile,e){},onHide:function(profile){},onMenuSelected:function(profile,item,src){}},RenderTrigger:function(){var prf=this;prf.boxing().adjustSize(),(prf.$beforeDestroy=prf.$beforeDestroy||{})["sub-pops"]=function(t){xui.each(prf.$allPops,(function(pop){pop&&!pop.$noDestroyByParentMenu&&(!pop["xui.UI"]||pop.isEmpty()||pop.isDestroyed()?pop["xui.UIProfile"]&&!pop.destroyed?pop.__gc():pop["xui.Dom"]&&!pop.isEmpty()&&pop.remove():pop.destroy())}))}},_beforeSerialized:function(profile){var o=arguments.callee.upper.call(this,profile),op=o.properties;return delete op.left,delete op.top,delete op.right,delete op.bottom,delete op.width,delete op.height,o},_mouseout:function(profile,e){if(profile.properties.autoHide){var size,p2,b,p1=xui.Event.getPos(e);if(xui.arr.each(profile.$popGrp,(function(o){if(o=xui([o]),p2=o.offset(),size=o.cssSize(),p1.left>=p2.left&&p1.top>=p2.top&&p1.left<=p2.left+size.width&&p1.top<=p2.top+size.height)return b=1,!1})),!b){for(;b=profile.$parentPopMenu;)profile=b;profile.boxing().hide(!0,null,e),profile.$popGrp&&(profile.$popGrp.length=0)}}},_prepareData:function(profile){var data=arguments.callee.upper.call(this,profile),NONE="display:none",prop=profile.properties;return prop.noIcon&&(data._iconDisplay=NONE),data},_prepareItem:function(profile,item){var NONE="display:none;",prop=profile.properties;item.add=item.add||"",item.displayAdd=item.add?"":NONE,item.displaySub=item.sub?"":NONE,item._itemDisplay=item.hidden?NONE:"",item._iconDisplay=prop.noIcon?NONE:"",item.type=item.type||"button","checkbox"==item.type?(item._fi_checkboxCls1="xui-uicmd-check",item._fi_checkboxCls2=item.value?"xuicon-checked xui-uicmd-check-checked":""):"radiobox"==item.type&&(item._fi_radioboxCls1="xui-uicmd-radio",item._fi_radioboxCls2=item.value?"xuicon-checked xui-uicmd-radio-checked":"")},_onresize:null}}),xui.Class("xui.UI.MenuBar",["xui.UI","xui.absList"],{Instance:{updateItem:function(subId,options){var self=this,profile=self.get(0),items=profile.properties.items;if(-1!=xui.arr.subIndexOf(items,"id",subId))arguments.callee.upper.call(self,subId,options);else{var ok=0;xui.each(profile.$allPops,(function(o){o.updateItem(subId,options),ok=1})),ok||arguments.callee.upper.call(self,subId,options)}return self},_pop:function(item,src){var self=this,profile=self.get(0);if(profile.$curPop&&self.hide(),item.sub&&(!profile.beforePopMenu||0!=profile.boxing().beforePopMenu(profile,item,src))){xui.use(src).tagClass("-active");var id=item.id,pro=profile.properties,pid=pro.parentID||xui.ini.$rootContainer,all="$allPops";if(profile.$curPop=id,profile.$curElem=src,profile.$menuPop=id,profile[all]=profile[all]||{},!profile[all][id]){var callback=function(sub){var hash={position:"absolute",items:sub,autoHide:!!pro.autoShowTime};pro.showEffects&&(hash.showEffects=pro.showEffects),pro.hideEffects&&(hash.hideEffects=pro.hideEffects);var menu=xui.create("PopMenu",hash);profile.getSubNode("POOL").append(menu),menu.onHide((function(pro){self.hide(!1)})).onMenuSelected((function(pro,item,src){return profile.boxing().onMenuSelected(profile,pro,item,src)})).onShowSubMenu((function(pro,item,src){return profile.boxing().onShowSubMenu(profile,pro,item,src)})),menu.get(0).$hideMenuPool=profile.getSubNode("POOL"),menu.get(0)[all]=profile[all],profile[all][id]=menu};if(xui.isArr(item.sub)&&item.sub.length)callback(item.sub);else if(profile.onGetPopMenu){var r=profile.boxing().onGetPopMenu(profile,item,callback);xui.isArr(r)&&r.length&&callback(item.sub=r)}}return profile[all][id]&&profile[all][id].popUp(xui(src),1,pid?xui.get(profile,["host",pid])?profile.host[pid].getContainer():xui(pid):null),!1}},_afterInsertItems:function(){this.clearPopCache()},hide:function(ignoreEffects){var menu,profile=this.get(0),id=profile.$curPop,node=profile.$curElem;(menu=profile.$allPops[id])&&(!1!==arguments[0]&&menu.hide(!1,ignoreEffects),profile.getSubNode("POOL").append(menu.reBoxing()),xui([node]).tagClass("-active",!1)),profile.$menuPop=profile.$curPop=profile.$curElem=null},clearPopCache:function(){var profile=this.get(0);profile.renderId&&(profile.getSubNode("POOL").empty(),profile.$allPops=profile.$curPop=profile.$curElem=null)}},Initialize:function(){xui.SC("xui.UI.PopMenu")},Static:{_nocap2tip:!0,Templates:{tagName:"div",className:"{_className}",style:"{_style}",POOL:{tagName:"div"},BORDER:{className:"xui-uibar xui-uiborder-outset xui-uiborder-radius",tagName:"div",LIST:{tagName:"div",HANDLER:{className:"xuifont",$fonticon:"xui-icon-placeholder",style:"{handler}"},ITEMS:{$order:1,text:"{items}"}}},$submap:{items:{ITEM:{style:"{itemStyle};{_itemDisplay};",className:"xui-uimenu",ITEMI:{ITEMC:{ITEMA:{tabindex:"{_tabindex}",className:" {typeCls} {disabled}",ICON:{$order:1,className:"xuicon {imageClass}  {picClass}",style:"{backgroundImage}{backgroundPosition}{backgroundSize}{backgroundRepeat}{iconFontSize}{imageDisplay}{iconStyle}",text:"{iconFontCode}"},CAPTION:{$order:2,text:"{caption}",style:"{captionDisplay}"}}}}}}}},Appearances:{KEY:{position:"absolute",left:0,top:0},POOL:{width:0,height:0,visibility:"hidden",position:"absolute",left:"-10000px",top:"-10000px"},BORDER:{left:0,top:0},HANDLER:{height:"100%",width:"0.5em",background:"url("+xui.ini.img_handler+") repeat-y left top",cursor:"move","vertical-align":"middle"},LIST:{padding:".125em"},ITEMS:{"vertical-align":"middle"},ITEM:{"white-space":"nowrap","vertical-align":"top",overflow:"hidden",margin:"0 .25em 0 .25em","padding-right":".5em"},"ITEM *":{cursor:"pointer"},ITEMI:{padding:"0 .25em","vertical-align":"top"},ITEMC:{padding:".25em 0","vertical-align":"top"},ITEMA:{display:xui.$inlineBlock},CAPTION:{"vertical-align":xui.browser.ie6?"baseline":"middle","font-size":"1em"}},Behaviors:{ITEM:{onMouseover:function(profile,e,src){var p=profile.properties,ns=src;if(!p.disabled){var item=profile.getItemByDom(src),itemId=item.id;item.disabled||(xui.use(ns).tagClass("-hover"),profile.$menuPop?profile.$menuPop!=itemId&&profile.boxing()._pop(item,ns):p.autoShowTime&&xui.resetRun(profile.$xid+":autoShowTime",(function(){profile.boxing()._pop(item,ns)}),p.autoShowTime))}},onMouseout:function(profile,e,src){var p=profile.properties;if(!p.disabled&&!profile.getItemByDom(src).disabled&&(xui.use(src).tagClass("-hover",!1),p.autoShowTime)){var pop=profile.$allPops;if(pop=pop&&pop[profile.$curPop]){var node=pop.get(0).getRoot(),p1=xui.Event.getPos(e),size=node.cssSize(),p2=node.offset();p1.left>p2.left&&p1.top>p2.top-3&&p1.left<p2.left+size.width&&p1.top<p2.top+size.height||pop.hide()}xui.resetRun(profile.$xid+":autoShowTime",null)}},onMousedown:function(profile,e,src){if(!profile.properties.disabled){var item=profile.getItemByDom(src);if(item.id,!item.disabled)return xui.use(src).tagClass("-active"),profile.boxing()._pop(item,src)}},onMouseup:function(profile,e,src){var item=profile.getItemByDom(src);profile.$menuPop!=item.id&&xui.use(src).tagClass("-active",!1)},onKeydown:function(profile,e,src){var keys=xui.Event.getKey(e),shift=(keys.key,keys.shiftKey),cur=xui(src),first=profile.getRoot().nextFocus(!0,!0,!1),last=profile.getRoot().nextFocus(!1,!0,!1);switch(xui.Event.getKey(e).key){case"tab":if(shift){if(cur.get(0)!=first.get(0))return first.focus(!0),!1}else if(cur.get(0)!=last.get(0))return last.focus(!0),!1;break;case"left":case"up":return cur.nextFocus(!1,!0,!1),cur.get(0)==first.get(0)?last.focus(!0):cur.nextFocus(!1),!1;case"right":case"down":return cur.nextFocus(!0,!1,!1),cur.get(0)==last.get(0)?first.focus(!0):cur.nextFocus(),!1;case"enter":cur.onMousedown()}},onClick:function(profile,e,src){var item=profile.getItemByDom(src);profile.$menuPop!=item.id&&profile.onMenuBtnClick&&profile.boxing().onMenuBtnClick(profile,item,src)}}},DataModel:{listKey:null,dragSortable:null,autoTips:!1,height:{$spaceunit:1,ini:"auto",readonly:!0},width:{$spaceunit:1,ini:"auto"},parentID:"",$hborder:1,$vborder:1,left:0,top:0,autoShowTime:200,handler:{ini:!0,action:function(v){this.getSubNode("HANDLER").css("display",v?"":"none")}},position:"absolute",dock:{ini:"top",listbox:["top","bottom"]}},LayoutTrigger:function(){var v=this.properties,nd=this.getSubNode("BORDER");v.$hborder=v.$vborder=nd._borderW("left")},EventHandlers:{onGetPopMenu:function(profile,item,callback){},onMenuBtnClick:function(profile,item,src){},beforePopMenu:function(profile,item,src){},onShowSubMenu:function(profile,popProfile,item,src){},onMenuSelected:function(profile,popProfile,item,src){}},RenderTrigger:function(){this.properties.disabled&&this.boxing().setDisabled(!0,!0)},_prepareData:function(profile){var none="display:none;",data=arguments.callee.upper.call(this,profile);return data.handler=data.handler?"":none,data._itemDisplay=data.hidden?none:"",data}}}),xui.Class("xui.UI.ToolBar",["xui.UI","xui.absList"],{Instance:{updateItem:function(subId,options){if(options.type)return arguments.callee.upper.call(this,subId,options);var nid,item,n1,n2,n3,n4,n5,self=this,profile=self.get(0),items=(profile.box,profile.properties.items),rst=profile.queryItems(items,(function(o){return"object"==typeof o?o.id===subId:o==subId}),!0,!0,!0);if(xui.isStr(options)&&(options={caption:options}),rst.length&&(item=(rst=rst[0])[0])){if(xui.isSet(options.id)&&(options.id+=""),options.id&&subId!==options.id){nid=options.id;var v,m2=profile.ItemIdMapSubSerialId;m2[nid]||((v=m2[subId])?(m2[nid]=v,delete m2[subId],profile.SubSerialIdMapItem[v].id=nid):item.id=nid)}if(delete options.id,xui.isEmpty(options))return self;if(n1=profile.getSubNodeByItemId("ICON",nid||subId),n2=profile.getSubNodeByItemId("CAPTION",nid||subId),n3=profile.getSubNodeByItemId("ITEM",nid||subId),n4=profile.getSubNodeByItemId("LABEL",nid||subId),n5=profile.getSubNodeByItemId("BTN",nid||subId),"value"in options&&options.value!==item.value&&profile.getSubNodeByItemId("BTN",nid||subId).tagClass("-checked",!!options.value),"caption"in options&&options.caption!==item.caption&&(n2.html(options.caption),options.caption&&!item.caption&&n2.css("display",""),!options.caption&&item.caption&&n2.css("display","none")),"label"in options&&options.label!==item.label&&(n4.html(options.label),options.label&&!item.label&&n4.css("display",""),!options.label&&item.label&&n4.css("display","none")),"disabled"in options&&options.disabled!==item.disabled&&(options.disabled?n3.addClass("xui-ui-itemdisabled"):n3.removeClass("xui-ui-itemdisabled"),n5.onMouseout(!0,{$force:!0})),"image"in options&&options.image!==item.image&&n1.css("background-image",options.image),"imagePos"in options&&options.imagePos!==item.imagePos&&n1.css("background-position",options.imagePos),"imageClass"in options&&options.imageClass!==item.imageClass&&(item.imageClass&&n1.removeClass(item.imageClass),options.imageClass&&n1.addClass(options.imageClass)),"hidden"in options){var b=!!options.hidden;b?!0!==item.hidden&&n3.css("display","none"):!0===item.hidden&&n3.css("display","")}xui.merge(item,options,"all")}return self},showItem:function(itemId,value){return this.each((function(profile){var item=profile.getItemByItemId(itemId);item&&(item.hidden=!1===value,profile.getSubNodeByItemId("ITEM",itemId).css("display",!1===value?"none":""))}))},showGroup:function(grpId,value){return this.each((function(profile){xui.arr.each(profile.properties.items,(function(o){if(o.id==grpId)return o.hidden=!1===value,!1})),profile.getSubNodeByItemId("GROUP",grpId).css("display",!1===value?"none":""),xui.resetRun(profile.$xid+":showgrp",(function(){profile.renderId&&profile.getRootNode().offsetWidth&&xui.UI.$dock(profile,!0,!0)}))}))}},Static:{_focusNodeKey:"BTN",_ITEMKEY:"GROUP",Templates:{tagName:"div",className:"{_className}",style:"{_style}",ITEMS:{className:"xui-uibar xui-uiborder-outset xui-uiborder-radius",tagName:"div",style:"{mode}",text:"{items}"},$submap:{items:{GROUP:{className:"{groupClass}",style:"{grpDisplay} {groupStyle}",HANDLER:{className:"xuifont",$fonticon:"xui-icon-placeholder",style:"{mode2}"},LIST:{$order:1,tagName:"text",text:"{sub}"}}},"items.sub":{ITEM:{style:"{_itemDisplay}",className:" {disabled}",IBWRAP:{tagName:"div",SPLIT:{style:"{splitDisplay}",className:"xui-uiborder-l xui-uiborder-r",text:"&nbsp;"},LABEL:{style:"{labelDisplay}",text:"{label}"},BTN:{tagName:"button",className:"xui-uiborder-hidden xui-uiborder-radius xui-showfocus {itemcls} {itemClass}",style:"{itemStyle};{_boxDisplay};",tabindex:"{_tabindex}",BOXWRAP:{tagName:"div",RULER:{},ICON:{$order:1,className:"xuicon {imageClass}  {picClass}",style:"{backgroundImage}{backgroundPosition}{backgroundSize}{backgroundRepeat}{iconFontSize}{imageDisplay}{iconStyle}",text:"{iconFontCode}"},CAPTION:{$order:2,text:"{caption}",style:"{captionDisplay}"},DROP:{$order:3,className:"xuifont",$fonticon:"xui-uicmd-arrowdrop",style:"{_dropDisplay}"}}}}}}}},Appearances:{KEY:{position:"absolute",overflow:"hidden",left:0,top:0},RULER:{padding:"0",margin:"0",width:"0"},ICON:{margin:0,"vertical-align":"middle"},ITEMS:{display:"block",overflow:"hidden","padding-bottom":".125em"},HANDLER:{height:"100%",width:".75em",background:"url("+xui.ini.img_handler+") repeat-y left top",cursor:"move","vertical-align":"middle"},GROUP:{position:"static",display:"inline",padding:".125em .25em 0 .125em","vertical-align":"middle"},ITEM:{"vertical-align":"middle",padding:"0 .125em",margin:"0"},SPLIT:{$order:1,width:"0","vertical-align":"middle",margin:"0 .25em"},BTN:{padding:".25em",cursor:"pointer","*width":"auto","*overflow":"visible"},BOX:{height:"auto"},"LABEL, CAPTION":{"vertical-align":"middle","margin-left":".25em","margin-right":".25em","font-size":"1em"},LABEL:{cursor:"default",padding:".25em"},DROP:{"vertical-align":"middle"}},Behaviors:{NoTips:["GROUP","HANDLER"],HoverEffected:{BTN:["BTN"]},ClickEffected:{BTN:["BTN"]},DraggableKeys:["HANDLER"],DroppableKeys:["GROUP","ITEMS"],BTN:{onClick:function(profile,e,src){if(profile.properties.disabled)return!1;var id2=xui.use(src).parent(3).id(),item2=profile.getItemByDom(id2);if(item2.disabled)return!1;var item=profile.getItemByDom(src);return item.disabled||(xui.use(src).focus(!0),"statusButton"==item.type&&xui.use(src).tagClass("-checked",item.value=!item.value),profile.boxing().onClick(profile,item,item2,e,src)),!1}}},DataModel:{listKey:null,height:{ini:"auto",readonly:!0},width:{$spaceunit:1,ini:"auto"},left:{$spaceunit:1,ini:0},top:{$spaceunit:1,ini:0},handler:{ini:!0,action:function(v){this.getSubNode("HANDLER",!0).css("display",v?"":"none")}},position:"absolute",hAlign:{ini:"left",listbox:["left","center","right"],action:function(v){this.getSubNode("ITEMS",!0).css("textAlign",v)}},dock:{ini:"top",listbox:["top","bottom"]}},EventHandlers:{onClick:function(profile,item,group,e,src){}},_adjustItems:function(arr){arr||(arr=[xui.stamp()+""]),xui.isStr(arr)&&(arr=[arr]);var a=xui.copy(arr);return xui.arr.each(a,(function(o,i){xui.isArr(o)&&(o={id:xui.id(),sub:o}),xui.isHash(o)&&(a[i]=xui.copy(o),a[i].sub=[],o.sub&&xui.arr.each(o.sub,(function(v){a[i].sub.push(xui.isHash(v)?xui.copy(v):{id:v+""})})))})),a},_onDrop:function(profile,e,src,key,data,item){var oitem,k=profile.getKey(xui.use(src).id()),po=data.profile,ps=data.domId,t=xui.absObj.$specialChars;return oitem=xui.clone(po.getItemByDom(ps),(function(o,i){return!t[(i+"").charAt(0)]})),po.boxing().removeItems([oitem.id],"GROUP",!0),k==profile.keys.GROUP?profile.boxing().insertItems([oitem],item.id,!0):profile.boxing().insertItems([oitem]),data._new=oitem,!1},_prepareData:function(profile){var d=arguments.callee.upper.call(this,profile),p=profile.properties;return d.mode="left"!=p.hAlign?"text-align:"+p.hAlign+";":"",d},_prepareItem:function(profile,oitem,sitem,pid,index,len,mapCache,serialId){var ns=this,dn="display:none;",tabindex=profile.properties.tabindex,fun=function(profile,dataItem,item,pid,index,len,mapCache,serialId){var id=dataItem[xui.UI.$tag_subId]="string"==typeof serialId?serialId:"a_"+profile.pickSubId("aitem");"string"==typeof item&&(item={caption:item}),!1!==mapCache&&(profile.ItemIdMapSubSerialId[item.id]=id,profile.SubSerialIdMapItem[id]=item),item.object?dataItem.object=ns._prepareInlineObj(profile,item,tabindex):(item.statusButton?(item.type="statusButton",delete item.statusButton):item.dropButton?(item.type="dropButton",delete item.dropButton):item.split&&(item.type="split",delete item.split),"split"===item.type||item.caption||(item.caption=""),xui.UI.adjustData(profile,item,dataItem),"statusButton"==item.type&&item.value&&(dataItem.itemcls=" xui-uiborder-hidden-checked "+profile.getClass("BTN","-checked",!!item.value)),dataItem._tabindex=tabindex,dataItem.splitDisplay="split"==dataItem.type?"":dn,dataItem.labelDisplay=dataItem.label?"":dn,dataItem.captionDisplay=dataItem.caption?"":dn,dataItem._dropDisplay="dropButton"==item.type?"":dn,dataItem._boxDisplay="split"!==dataItem.type&&(dataItem.caption||dataItem.image||dataItem.imageClass)?"":dn),dataItem._itemDisplay=item.hidden?dn:"",item._pid=pid};if(pid)fun(profile,oitem,sitem,pid,0,0,mapCache,serialId);else{var dataItem,arr=[],a=sitem.sub||[];pid=sitem.id,oitem.mode2="handler"in sitem?sitem.handler?"":dn:profile.properties.handler?"":dn,oitem.grpDisplay=sitem.hidden?dn:"",oitem.sub=arr,xui.arr.each(a,(function(item){dataItem={id:item.id},fun(profile,dataItem,item,pid,0,0,mapCache,serialId),arr.push(dataItem)}))}}}}),xui.Class("xui.UI.Layout",["xui.UI","xui.absList"],{Instance:{getPanel:function(subId){return this.get(0).getSubNodeByItemId("PANEL",subId)},append:function(target,subId,pre,base){return this.get(0),arguments.callee.upper.call(this,target,subId||"main",pre,base)},insertItems:function(arr,base,before,all){return this._insertItems(arr,base,before,all)},_insertItems:function(arr,base,before,all){var arr2,items,index,r,data,box,pos="before",b=this._afterInsertItems;return this.each((function(profile){if(box=profile.box,items=profile.properties.items,all?arr2=box._adjustItems(arr):(index=xui.arr.subIndexOf(items,"id",base),pos=-1==index||"main"==items[index].id?before?"before":"after":items[index].pos||"after",arr2=box._adjustItems2(arr,pos)),-1==index?xui.arr.insertAny(items,arr2,before?0:-1):xui.arr.insertAny(items,arr2,before?index:index+1),profile.renderId){if(data=box._prepareItems(profile,arr2,base),r=profile._buildItems("items",data),profile.$attached){for(var v,i=0;v=profile.$attached[i++];)v._render&&v._render(!0);delete profile.$attached}profile.getRoot().prepend(r),profile.adjustSize()}b&&profile.boxing()._afterInsertItems(profile,data,base,before)}))},_afterRemoveItems:function(profile){profile.renderId&&profile.adjustSize()},updateItem:function(subId,options){var nid,item,node,profile=this.get(0),vertical="vertical"==profile.properties.type,getN=function(key,subId){return profile.getSubNodeByItemId(key,subId)},items=(profile.box,profile.properties.items),rst=profile.queryItems(items,(function(o){return"object"==typeof o?o.id===subId:o==subId}),!0,!0,!0);if("object"==typeof options){if(rst.length){if(item="object"!=typeof(rst=rst[0])[0]?rst[2][rst[1]]={id:rst[0]}:rst[0],xui.isSet(options.id)&&(options.id+=""),options.id&&subId!==options.id){nid=options.id;var m2=profile.ItemIdMapSubSerialId;m2[nid]||((v=m2[subId])?(m2[nid]=v,delete m2[subId],profile.SubSerialIdMapItem[v].id=nid):item.id=nid)}if(delete options.id,xui.isEmpty(options))return this;var bResize=!1;if(!(node=getN("ITEM",subId)).isEmpty()){options.hasOwnProperty("size")&&(options.size=Math.round(parseFloat(""+options.size)),options.size!=item._size&&(item._size=options.size,vertical?node.height(options.size):node.width(options.size),bResize=!0)),options.hasOwnProperty("hidden")&&(options.hidden=!!options.hidden,options.hidden!==item.hidden&&(getN("ITEM",subId).css("display",options.hidden?"none":""),bResize=!0)),options.hasOwnProperty("locked")&&(options.locked=!!options.locked,options.locked!==item.locked&&(getN("MOVE",subId).css({display:options.locked?"none":"",cursor:options.locked?"default":vertical?"n-resize":"w-resize"}),getN("CMD",subId).css("display",("cmd"in options?options.cmd:item.cmd)&&!options.locked?"":"none"),bResize=!0)),options.hasOwnProperty("folded")&&(options.folded=!!options.folded,options.folded!==item.folded&&profile.boxing().fireCmdClickEvent(subId)),options.hasOwnProperty("cmd")&&(options.cmd=!!options.cmd,options.cmd!==item.cmd&&getN("CMD",subId).css("display",options.cmd&&!("locked"in options?options.locked:item.locked)?"":"none"));var v,hash={};options.hasOwnProperty("panelBgClr")&&(hash["background-color"]=options.panelBgClr),options.hasOwnProperty("panelBgImg")&&(hash["background-image"]=options.panelBgImg?"url("+xui.adjustRes(options.panelBgImg)+")":""),options.hasOwnProperty("panelBgImgPos")&&(hash["position-color"]=options.panelBgImgPos),options.hasOwnProperty("panelBgImgRepeat")&&(hash["background-repeat"]=options.panelBgImgRepeat),options.hasOwnProperty("panelBgImgAttachment")&&(hash["background-attachment"]=options.panelBgImgAttachment),options.hasOwnProperty("overflow")&&((v=options.overflow)&&-1!=v.indexOf(":")&&xui.arr.each(v.split(/\s*;\s*/g),(function(s){var a=s.split(/\s*:\s*/g);a.length>1&&(hash[xui.str.trim(a[0])]=xui.str.trim(a[1]||""))})),hash.overflow=v||""),xui.isEmpty(hash)||getN("PANEL",subId).css(hash)}xui.merge(item,options,"all"),bResize&&profile.adjustSize()}return this}},disableItem:null,enableItem:null,fireCmdClickEvent:function(subId){return this.getSubNodeByItemId("CMD",subId).onMousedown(),this}},Static:{Templates:{tagName:"div",style:"{_style}",className:"{_className} {_trans}",text:"{items}",$submap:{items:{ITEM:{tagName:"div",className:"{cls1} {itemClass}",style:"{itemStyle};{display}",MOVE:{$order:0,tagName:"div",className:"xui-ui-unselectable xui-uibar {clsmovebg} {cls2} ",style:"{moveDisplay};cursor:{_cursor}"},CMD:{$order:1,tagName:"span",style:"{cmdDisplay}",className:"xui-node xui-ui-unselectable xuifont {cls3}",$fonticon:"{_fi_cls3} "},PANEL:{tagName:"div",className:"xui-uibase xui-uicontainer",style:"position:absolute;{_bginfo};{_overflow};",text:xui.UI.$childTag}}}}},Appearances:{KEY:{position:"absolute",overflow:"hidden",left:0,top:0},"KEY-trans, KEY-trans > ITEM, KEY-trans > ITEM > PANEL, KEY-trans > ITEM > MOVE, KEY-trans > ITEM > CMD":{$order:100,"background-color":"transparent",border:"none"},MOVE:{$order:0,position:"absolute",cursor:"pointer","z-index":"10"},CMD:{position:"absolute",cursor:"pointer","z-index":"20"},ITEM:{position:"absolute","z-index":1,overflow:"hidden","border-width":xui.browser.opr?"0":null},PANEL:{position:"absolute",overflow:"auto",left:0,top:0,"border-width":xui.browser.opr?"0":null},"ITEM-MAIN":{left:0,right:0,top:0,bottom:0},"ITEM-TOP, ITEM-BOTTOM":{left:0,right:0},"ITEM-LEFT, ITEM-RIGHT":{top:0,bottom:0},"MOVE-TOP, MOVE-BOTTOM":{width:"100%",height:xui.browser.contentBox?".75em":".83333em",cursor:"n-resize"},"MOVE-LEFT, MOVE-RIGHT":{height:"100%",width:xui.browser.contentBox?".75em":".83333em",cursor:"w-resize"},"MOVE-TOP":{bottom:0},"MOVE-BOTTOM":{top:0},"MOVE-LEFT":{right:"0"},"MOVE-RIGHT":{left:0},"CMD-TOP, CMD-BOTTOM, CMD-LEFT, CMD-RIGHT":{padding:0,"border-radius":"0","-moz-border-radius":"0","-webkit-border-radius":"0","-o-border-radius":"0","-ms-border-radius":"0","-khtml-border-radius":"0"},"CMD-TOP":{$order:1,left:"50%","margin-left":"-1em",bottom:0,width:"2em",height:xui.browser.contentBox?".66667em":".75em","text-align":"center"},"CMD-BOTTOM":{$order:1,left:"50%","margin-left":"-1em",top:0,width:"2em",height:xui.browser.contentBox?".66667em":".75em","text-align":"center"},"CMD-LEFT":{$order:1,top:"50%","margin-top":"-1em",right:0,height:"2em",width:xui.browser.contentBox?".66667em":".75em","line-height":"2em"},"CMD-RIGHT":{$order:1,top:"50%","margin-top":"-1em",left:0,height:"2em",width:xui.browser.contentBox?".66667em":".75em","line-height":"2em"},"MOVE-MAIN":{$order:5,display:"none"},"CMD-MAIN":{$order:5,display:"none"}},Behaviors:{DroppableKeys:["PANEL"],PanelKeys:["PANEL"],HoverEffected:{MOVE:"MOVE",CMD:["MOVE","CMD"]},ClickEffected:{CMD:"CMD"},MOVE:{beforeMousedown:function(profile,e,src){if("left"==xui.Event.getBtn(e)){var itemId=profile.getSubId(src),item=profile.getItemByDom(src);if(!item.folded&&!item.locked){var h,w,mh,mw,offset1,offset2,main=profile.getItemByItemId("main"),o=profile.getSubNode("ITEM",itemId),m=profile.getSubNodeByItemId("ITEM","main"),cursor=xui.use(src).css("cursor"),t=profile.properties;profile.pos=item.pos,"vertical"==t.type?(h=profile._cur=o.height(),mh=m.height(),"before"==item.pos?(offset1=h-item.min,offset2=Math.round(item.max?Math.min(parseFloat(item.max)-h,mh-main.min):mh-main.min)):(offset1=Math.round(item.max?Math.min(parseFloat(item.max)-h,mh-main.min):mh-main.min),offset2=h-item.min),xui.use(src).startDrag(e,{dragType:"copy",targetReposition:!1,verticalOnly:!0,maxTopOffset:offset1,maxBottomOffset:offset2,dragCursor:cursor,targetWidth:xui.browser.ie?xui.use(src).offsetWidth():null,targetHeight:xui.browser.ie?xui.use(src).offsetHeight():null,targetCallback:xui.browser.ie?function(n){n.tagClass("-(top|bottom)",!1)}:null})):(w=profile._cur=o.width(),mw=m.width(),"before"==item.pos?(offset1=w-item.min,offset2=Math.round(item.max?Math.min(parseFloat(item.max)-w,mw-main.min):mw-main.min)):(offset1=Math.round(item.max?Math.min(parseFloat(item.max)-w,mw-main.min):mw-main.min),offset2=w-item.min),xui.use(src).startDrag(e,{dragType:"copy",targetReposition:!1,horizontalOnly:!0,maxLeftOffset:offset1,maxRightOffset:offset2,dragCursor:cursor,targetWidth:xui.browser.ie?xui.use(src).offsetWidth():null,targetHeight:xui.browser.ie?xui.use(src).offsetHeight():null,targetCallback:xui.browser.ie?function(n){n.tagClass("-(left|right)",!1)}:null})),profile._limited=0}}},onDrag:function(profile,e,src){var t=profile.properties,p=(xui.DragDrop,xui.DragDrop._profile),b=0;"vertical"==t.type?(p.y<=p.restrictedTop||p.y>=p.restrictedBottom)&&(b=!0):(p.x<=p.restrictedLeft||p.x>=p.restrictedRight)&&(b=!0),b?profile._limited||(p.proxyNode.addClass("xui-alert"),profile._limited=!0):profile._limited&&(p.proxyNode.removeClass("xui-alert"),profile._limited=0)},onDragstop:function(profile,e,src){for(var cur,mainItem,t=profile.properties,height=t.height,width=t.width,o=xui.use(src).parent(),r=profile.getRoot(),item=profile.getItemByDom(src),sum=0,innerW=null,innerH=null,i=0,l=t.items.length;i<l;i++)t.items[i].hidden||(sum+=t.items[i].size||80),"main"==t.items[i].id&&(mainItem=t.items[i]);"vertical"==t.type?(innerH=r.height(),item._size=profile._cur+("before"==profile.pos?1:-1)*xui.DragDrop.getProfile().offset.y,o.height(profile.$isEm(height)?profile.$px2em(item._size,o)+"em":item._size),cur=sum*item._size/innerH):(innerW=r.width(),item._size=profile._cur+("before"==profile.pos?1:-1)*xui.DragDrop.getProfile().offset.x,o.width(profile.$isEm(width)?profile.$px2em(item._size,o)+"em":item._size),cur=sum*item._size/innerW),mainItem.size-=cur-item.size,item.size=cur,xui.UI.$tryResize(profile,innerW,innerH,!0),profile._limited=0},onMousedown:function(profile,e,src){if("left"==xui.Event.getBtn(e)){profile.properties;var itemId=profile.getSubId(src);profile.getItemByDom(src).folded&&profile.getSubNode("CMD",itemId).onMousedown(!0)}}},CMD:{onMousedown:function(profile,e,src){if("left"==xui.Event.getBtn(e)){var t=profile.properties,itemId=profile.getSubId(src),item=profile.getItemByDom(src),r=profile.getRoot(),o=(profile.getItemByItemId("main"),profile.getSubNodeByItemId("ITEM","main"),profile.getSubNode("ITEM",itemId)),panel=profile.getSubNode("PANEL",itemId),move=profile.getSubNode("MOVE",itemId),_handlerSize=item.locked?0:"vertical"==t.type?move.offsetHeight():move.offsetWidth();return"vertical"==t.type?(item.folded?(o.height(item._size),panel.show(),item.folded=!1,"before"==item.pos?xui.use(src).replaceClass(/bottom/g,"top"):xui.use(src).replaceClass(/top/g,"bottom"),item.locked||move.css("cursor","n-resize"),profile.getSubNode("MOVE").tagClass("-checked",!1)):(o.height(_handlerSize),panel.hide(),item.folded=!0,"before"==item.pos?xui.use(src).replaceClass(/top/g,"bottom"):xui.use(src).replaceClass(/bottom/g,"top"),item.locked||move.css("cursor","pointer"),profile.getSubNode("MOVE").tagClass("-checked")),xui.UI.$tryResize(profile,null,r.height(),!0)):(item.folded?(o.width(item._size),panel.show(),item.folded=!1,"before"==item.pos?xui.use(src).replaceClass(/right/g,"left"):xui.use(src).replaceClass(/left/g,"right"),item.locked||move.css("cursor","w-resize"),profile.getSubNode("MOVE").tagClass("-checked",!1)):(o.width(_handlerSize),panel.hide(),item.folded=!0,"before"==item.pos?xui.use(src).replaceClass(/left/g,"right"):xui.use(src).replaceClass(/right/g,"left"),item.locked||move.css("cursor","pointer"),profile.getSubNode("MOVE").tagClass("-checked")),xui.UI.$tryResize(profile,r.width(),null,!0)),!1}}},PANEL:{onClick:function(profile,e,src){var p=profile.properties,item=profile.getItemByDom(src);return!p.disabled&&!item.disabled&&(profile.onClickPanel?profile.boxing().onClickPanel(profile,item,e,src):void 0)}}},DataModel:{rotate:null,selectable:!0,disabled:null,position:"absolute",type:{listbox:["vertical","horizontal"],ini:"vertical",action:function(value,ovalue){if(value!=ovalue){var nodes2=this.getSubNode("ITEM",!0),nodes1=this.getSubNode("MOVE",!0),nodes3=this.getSubNode("CMD",!0);nodes1.merge(nodes2).merge(nodes3),"vertical"==value?(nodes1.replaceClass(/(-left)(\b)/gi,"-top$2"),nodes1.replaceClass(/(-right)(\b)/gi,"-bottom$2"),nodes2.each((function(o){xui(o).height(xui(o).width())})).css({left:0,top:"auto",right:"auto",bottom:"auto"})):(nodes1.replaceClass(/(-top)(\b)/gi,"-left$2"),nodes1.replaceClass(/(-bottom)(\b)/gi,"-right$2"),nodes2.each((function(o){xui(o).width(xui(o).height())})).css({left:"auto",top:0,right:"auto",bottom:"auto"})),this.adjustSize()}}},dock:"fill",listKey:null,width:{$spaceunit:1,ini:"18em"},height:{$spaceunit:1,ini:"18em"},dragSortable:null,flexSize:{ini:!1,action:function(){this.adjustSize()}},transparent:{ini:!1,action:function(v){this.getRoot().tagClass("-trans",!!v)}},items:{ini:[]}},EventHandlers:{onClickPanel:function(profile,item,e,src){}},_adjustItems2:function(items,pos){var arr=[];return xui.arr.each(items,(function(o){"main"!=o.id&&(arr.push(o=xui.isHash(o)?o:{id:""+o}),o.pos=pos)})),xui.arr.each(arr,(function(o){o.id=xui.isStr(o.id)?o.id:xui.id(),o.min=o.min||10,o._size=o.size=Math.round(parseFloat(o.size))||80,o.locked="boolean"==typeof o.locked&&o.locked,o.folded="boolean"==typeof o.folded&&o.folded,o.hidden="boolean"==typeof o.hidden&&o.hidden,o.cmd="boolean"!=typeof o.cmd||o.cmd})),arr},_adjustItems:function(items){var main,before=[],after=[],watershed=0;return xui.arr.each(items,(function(o,i){"main"==(o=xui.copy(o)).id?(main=o,watershed=i):"before"==o.pos?before.push(o):"after"==o.pos?after.push(o):watershed?(o.pos="after",after.push(o)):(o.pos="after",before.push(o))})),(main=main||{}).id="main",main.min=main.min||10,main.size=Math.round(parseFloat(main.size))||80,items.length=0,xui.arr.insertAny(items,this._adjustItems2(before,"before")),xui.arr.insertAny(items,main),xui.arr.insertAny(items,this._adjustItems2(after,"after")),items},_prepareData:function(profile){var prop=profile.properties;prop.items&&xui.isArr(prop.items)||(prop.items=xui.clone([{id:"before",pos:"before",locked:!1,size:60,min:50,max:200},{id:"after",pos:"after",locked:!1,size:60,min:50,max:200}])),prop.items=this._adjustItems(prop.items);var data=arguments.callee.upper.call(this,profile);return data._trans=data.transparent?profile.getClass("KEY","-trans"):"",data},_prepareItems:function(profile,items){var data=arguments.callee.upper.apply(this,arguments);return xui.arr.each(items,(function(o){delete o.caption})),data},_prepareItem:function(profile,data,item){var t,pos,p=profile.properties;p.width,p.height,"main"==data.id?(data.cls1=profile.getClass("ITEM","-main"),data.cls2=profile.getClass("MOVE","-main"),data.cls3=profile.getClass("CMD","-main")):("vertical"==p.type?(data.clsmovebg="xui-uiborder-t xui-uiborder-b",pos="before"==data.pos?"top":"bottom"):(data.clsmovebg="xui-uiborder-l xui-uiborder-r",pos="before"==data.pos?"left":"right"),data.cls1=profile.getClass("ITEM","-"+pos),data.cls2=profile.getClass("MOVE","-"+pos),data.cls3=profile.getClass("CMD","-"+pos),data._fi_cls3="xui-icon-arrow"+pos,data.display=data.hidden?"display:none":"",data._cursor=data.locked?"default":"vertical"==p.type?"n-resize":"w-resize",data.cmdDisplay=data.cmd&&!data.locked?"":"display:none",data.moveDisplay=data.locked?"display:none":""),data._bginfo="",(t=data.panelBgClr||p.panelBgClr)&&(data._bginfo+="background-color:"+t+";"),(t=data.panelBgImg||p.panelBgImg)&&(data._bginfo+="background-image:url("+xui.adjustRes(t)+");"),(t=data.panelBgImgPos||p.panelBgImgPos)&&(data._bginfo+="background-position:"+t+";"),(t=data.panelBgImgRepeat||p.panelBgImgRepeat)&&(data._bginfo+="background-repeat:"+t+";"),(t=data.panelBgImgAttachment||p.panelBgImgAttachment)&&(data._bginfo+="background-attachment:"+t+";"),xui.isStr(data.overflow)?data._overflow=-1!=data.overflow.indexOf(":")?data.overflow:data.overflow?"overflow:"+data.overflow:"":xui.isStr(p.overflow)&&(data._overflow=-1!=p.overflow.indexOf(":")?p.overflow:p.overflow?"overflow:"+p.overflow:"")},RenderTrigger:function(){var t,profile=this;xui.arr.each(profile.properties.items,(function(item){"main"!=item.id&&item.folded&&(t=profile.getSubIdByItemId(item.id))&&(item.folded=!1,profile.getSubNode("CMD",t).onMousedown())}))},_onresize:function(profile,width,height){var itemId,move,_handlerSize,t=profile.properties,mainmin=(profile.keys.ITEM,profile.keys.PANEL,profile.getItemByItemId("main").min||10),pct=t.flexSize,sum=0,us=xui.$us(profile),fzrate=profile.getEmSize()/profile.getRoot()._getEmSize();width&&(width=profile.$px(width)),height&&(height=profile.$px(height));var obj={},obj2={};xui.arr.each(t.items,(function(o){itemId=profile.getSubIdByItemId(o.id),obj[itemId]={},obj2[itemId]={},pct&&!o.hidden&&(sum+=o.size||80)}));var fun=function(prop,w,width,left,right,offset,forceoffset){var _t,m,itemId,temp1=0,temp2=0,temp=0,blocknumb=0,offsetbak=offset;if(xui.arr.each(prop.items,(function(o){"main"!=o.id&&"before"==o.pos&&(itemId=profile.getSubIdByItemId(o.id),move=profile.getSubNode("MOVE",itemId),_handlerSize=o.locked?0:"vertical"==t.type?move.offsetHeight():move.offsetWidth(),o.hidden?(m=0,obj2[itemId][width]=Math.round(pct?parseFloat(w*Math.min(1,o.size/sum)):o._size)):o.folded?m=obj2[itemId][width]=_handlerSize:(blocknumb++,(m=Math.round(pct?parseFloat(w*Math.min(1,o.size/sum)):o._size))>offset+o.min?m-=offset:(offset=m-o.min,m=o.min),m-=forceoffset,m=Math.max(m,_handlerSize)),obj2[itemId][left]=temp1,temp1+=m,obj[itemId][left]=0,obj[itemId][width]=m-_handlerSize,obj2[itemId][right]=obj[itemId][right]="auto",obj2[itemId][width]=m,mainmin+=_handlerSize)})),xui.arr.each(prop.items,(function(o){"main"!=o.id&&"after"==o.pos&&(itemId=profile.getSubIdByItemId(o.id),move=profile.getSubNode("MOVE",itemId),_handlerSize=o.locked?0:"vertical"==t.type?move.offsetHeight():move.offsetWidth(),o.hidden?(m=0,obj2[itemId][width]=Math.round(pct?parseFloat(w*Math.min(1,o.size/sum)):o._size)):o.folded?m=obj2[itemId][width]=_handlerSize:(blocknumb++,(m=Math.round(pct?parseFloat(w*Math.min(1,o.size/sum)):o._size))>offset+o.min?m-=offset:(offset=m-o.min,m=o.min),m-=forceoffset,m=Math.max(m,_handlerSize)),obj2[itemId][right]=temp2,temp2+=m,obj[itemId][right]=0,obj[itemId][width]=m-_handlerSize,obj2[itemId][left]=obj[itemId][left]="auto",obj2[itemId][width]=m,mainmin+=_handlerSize)}),null,!0),w-(temp=temp1+temp2)>=mainmin||forceoffset)_t=profile.getSubIdByItemId("main"),obj2[_t][width]=obj[_t][width]=w-temp,obj2[_t][left]=temp1;else{var args=xui.toArr(arguments);offsetbak?(args[args.length-2]=offsetbak,args[args.length-1]=(mainmin-(w-temp))/blocknumb):args[args.length-2]=(mainmin-(w-temp))/blocknumb,fun.apply(null,args)}};"vertical"!=t.type?(xui.isNull(width)||fun(t,width,"width","left","right",0,0),xui.isNull(height)||xui.each(obj,(function(o,id){obj2[id].height=o.height=height}))):(xui.isNull(height)||fun(t,height,"height","top","bottom",0,0),xui.isNull(width)||xui.each(obj,(function(o,id){obj2[id].width=o.width=width})));var ff_w=function(o,emRate){xui.arr.each("left,width,right".split(","),(function(t){t in o&&(o[t]=profile.$forceu(o[t],"em",emRate))}))},ff_h=function(o,emRate){xui.arr.each("top,height,bottom".split(","),(function(t){t in o&&(o[t]=profile.$forceu(o[t],"em",emRate))}))};xui.each(obj2,(function(o,id){var p=profile.getSubNode("PANEL",id),i=profile.getSubNode("ITEM",id);if(us>0){var pfz=us>0?p._getEmSize(fzrate):null,ifz=us>0?i._getEmSize(fzrate):null;ff_w(obj[id],ifz),ff_w(obj2[id],ifz),ff_h(obj[id],pfz),ff_h(obj2[id],pfz)}p.cssRegion(obj[id],!0),obj[id].width&&xui.UI._adjustConW(profile,p,obj[id].width),i.cssRegion(obj2[id])}))}}}),xui.Class("xui.UI.TreeGrid",["xui.UI","xui.absValue"],{Instance:{activate:function(){var profile=this.get(0);if(profile.renderId)return profile.getSubNode("ROWS22").nextFocus(!0,!0,!0),this},_setCtrlValue:function(value){return this.each((function(profile){if(profile.renderId&&"none"!=profile.properties.activeMode){var uiv=profile.boxing().getUIValue(),p=profile.properties,rowMap=profile.rowMap,k="row"==p.activeMode?["CELLS1","CELLS2","MARK"]:"CELLA",getN=function(k,i){return profile.getSubNodes(k,i)},getI=function(i){var map1=profile.rowMap2;if("row"==p.activeMode)return map1[i];if(i){var r=(""+i).split("|");return xui.get(profile.rowMap,[map1[r[0]],"_cells",r[1]])}};if("single"==p.selMode){var itemId=getI(uiv);uiv&&itemId&&getN(k,itemId).tagClass("-checked",!1),(itemId=getI(value))&&getN(k,itemId).tagClass("-checked")}else"multi"!=p.selMode&&"multibycheckbox"!=p.selMode||(uiv=uiv?(""+uiv).split(p.valueSeparator):[],value=value?(""+value).split(p.valueSeparator):[],xui.arr.each(uiv,(function(o,i){(o=getI(o))&&((i=rowMap[o])&&delete i._selected,getN(k,o).tagClass("-checked",!1))})),xui.arr.each(value,(function(o,i){(o=getI(o))&&((i=rowMap[o])&&(i._selected=1),getN(k,o).tagClass("-checked"))})),0===value.length&&(getN("HFMARK").tagClass("-checked",!1),delete profile._$checkAll))}}))},calculateGridValue:function(){var refs,coo,v2,cellsMap,tcell,colMax,rowMax,profile=this.get(0),prop=profile.properties,f=prop.gridValueFormula,value=null,xformula=xui.ExcelFormula;return profile.beforeGridValueCalculated&&!1!==(v2=profile.boxing().beforeGridValueCalculated(profile))?value=v2:f&&(colMax=prop.header.length,rowMax=prop.rows.length,xformula.validate(f)&&(cellsMap={},(refs=xformula.getRefCells(f,colMax,rowMax))&&xui.each(refs,(function(v,i){coo=xformula.toCoordinate(i),tcell=prop.rows[coo.row].cells[coo.col],cellsMap[i]=tcell.value})),value=xformula.calculate(f,cellsMap,colMax,rowMax))),profile.afterGridValueCalculated&&profile.boxing().afterGridValueCalculated(profile,value),profile._$gridvalue=value,prop.excelCellId&&profile._$oldgridvalue!==profile._$gridvalue&&profile.boxing().notifyExcel(!1),profile._$oldgridvalue=value},notifyExcel:xui.UI.Input.prototype.notifyExcel,getExcelCellValue:function(){var value,v2,profile=this.get(0),prop=profile.properties;return xui.ExcelFormula,prop.excelCellId?(value="_$gridvalue"in profile?profile._$gridvalue:this.caculateGridValue(),xui.isSet(v2=profile.onGetExcelCellValue&&profile.boxing().onGetExcelCellValue(profile,prop.excelCellId,value))&&(value=v2),value):null},applyCellFormula:function(cellTo,dirtyMark,triggerEvent){return this.each((function(prf){var formula,needUpdate,t2,coo,tcell,tg=prf.box,cellsMap={},prop=prf.properties,rows=prop.rows,colMax=xui.arr.indexOf(prop.header,cellTo._col),rowMax=xui.arr.indexOf(rows,cellTo._row),xformula=xui.ExcelFormula;if(formula=tg._getCellFormula(prf,cellTo,xformula.toColumnChr(colMax+1),rowMax+1)){var refs=xformula.getRefCells(formula,colMax,rowMax);if(!refs)return;xui.each(refs,(function(v,i){coo=xformula.toCoordinate(i),tcell=rows[coo.row].cells[coo.col],cellsMap[i]=tcell.value})),(t2=xformula.calculate(formula,cellsMap,colMax,rowMax))!==cellTo.value&&(needUpdate=[cellTo._serialId,t2,cellTo,formula],prf.beforeApplyFormula&&!1===prf.boxing().beforeApplyFormula(prf,cellTo,t2,formula,cellTo._row,cellTo._col)||tg._updCell(prf,needUpdate[0],{value:needUpdate[1]},dirtyMark,triggerEvent,!0),prf.afterApplyFormulas&&prf.boxing().afterApplyFormulas(prf,[needUpdate]))}}))},triggerFormulas:function(cellFrom,dirtyMark,triggerEvent){return this.each((function(prf){var cellId,formula,tcell,tg=prf.box,prop=prf.properties,rows=prop.rows,rowMax=rows.length,colMax=prop.header.length,xformula=xui.ExcelFormula,formulaCells={};if(xui.arr.each(prop.rows,(function(row,i){xui.arr.each(row.cells,(function(c,j){c===cellFrom&&(cellId=xformula.toCellId(j,i)),(formula=tg._getCellFormula(prf,c,xformula.toColumnChr(j+1),i+1))&&(formulaCells[xformula.toCellId(j,i)]=[c,formula])}))})),cellId&&delete formulaCells[cellId],!xui.isEmpty(formulaCells)){var refs={};xui.each(formulaCells,(function(a,id){(a=xformula.getRefCells(a[1],colMax,rowMax))&&(refs[id]=a)}));var count,noFormulaRef,coo,t1,t2,needRec,cellsMap={},needUpdate=[],changed={};cellId&&(changed[cellId]=1);do{count=0,xui.filter(refs,(function(v,k){if(needRec=0,cellId){for(var i in v)if(i in changed){needRec=1;break}}else needRec=1;if(!needRec)return!1;for(var i in noFormulaRef=!0,v)!cellId&&i in formulaCells?noFormulaRef=!1:i in cellsMap||(coo=xformula.toCoordinate(i),tcell=rows[coo.row].cells[coo.col],cellsMap[i]=tcell.value);return noFormulaRef?(t1=formulaCells[k],(t2=xformula.calculate(t1[1],cellsMap,colMax,rowMax))!==t1[0].value&&(needUpdate.push([t1[0],t2,t1[1],t1[0]._serialId]),cellId&&(changed[k]=1)),delete formulaCells[k],count++,!1):void 0}))}while(!xui.isEmpty(formulaCells)&&count>0);for(var i=0,l=needUpdate.length;i<l;i++)prf.beforeApplyFormula&&!1===prf.boxing().beforeApplyFormula(prf,needUpdate[i][0],needUpdate[i][1],needUpdate[i][2],needUpdate[i][0]._row,needUpdate[i][0]._col)||tg._updCell(prf,needUpdate[i][3],{value:needUpdate[i][1]},dirtyMark,triggerEvent,!1);prf.afterApplyFormulas&&prf.boxing().afterApplyFormulas(prf,needUpdate),prop.gridValueFormula&&prf.boxing().calculateGridValue(!1)}}))},_insertRowsToDom:function(profile,arr,pid,base,before,temp){if(pid){var parent=profile.rowMap[pid];if(parent&&!parent._inited)return}arr||(arr=[]);var obj21,obj22,hw,box=profile.box;profile.properties,(hw=profile.getSubNode("FHCELL").width())&&(hw=profile.$forceu(hw)),xui.arr.each(arr,(function(o){o._row0DfW=hw?"width:"+hw:"",xui.arr.each(o.cells,(function(v,i){v.width=v._col._colWidth}))})),profile.properties.freezedRow&&!(t=profile.getSubNode("ROWS12")).isEmpty()&&t.query("div","id",/-ROWS12\:/).isEmpty()&&delete profile._passFreezedRow;var nodes21=profile._buildItems("rows21",arr),nodes22=profile._buildItems("rows22",arr);if(base?(obj21=profile.getSubNode("ROW1",base),obj22=profile.getSubNode("ROW2",base),before?(obj21.addPrev(nodes21),obj22.addPrev(nodes22)):(obj21.addNext(nodes21),obj22.addNext(nodes22))):(pid?(obj21=profile.getSubNode("SUB1",pid),obj22=profile.getSubNode("SUB2",pid)):(obj21=profile.getSubNode("ROWS21"),obj22=profile.getSubNode("ROWS22")),before?(obj21.prepend(nodes21),obj22.prepend(nodes22)):(obj21.append(nodes21),obj22.append(nodes22))),xui.arr.each(arr,(function(o){o.sub&&(o.open=!1,!1===box.getCellOption(profile,o,"iniFold")&&profile.boxing()._toggleRows([o],!0,!1,!0))})),temp&&temp.length){var needshowinput=[],arrt=[];if(xui.arr.each(temp,(function(o){!box.getCellOption(profile,o,"editable")||"inline"!=box.getCellOption(profile,o,"editMode")&&"dropbutton"!=box.getCellOption(profile,o,"type")||needshowinput.push(o)})),temp.length=0,needshowinput.length){for(var t,i=0,l=needshowinput.length;i<l;i++)t=parseInt(i/25,10),arrt[t]||(arrt[t]=[]),arrt[t].push(needshowinput[i]);needshowinput.length=0;var fun=function(){if(arrt.length){var a=arrt.shift();if(a&&a.length){for(var i=0,l=a.length;i<l;i++)profile&&profile.box&&!profile.destroyed&&a[i]&&a[i]._row&&profile.box._editCell(profile,a[i],null,!0);xui.asyRun(fun)}}else arrt=null};xui.asyRun(fun)}}delete profile.$allrowscache1,delete profile.$allrowscache2,profile.box._adjustBody(profile,"addrow")},_refreshHeader:function(header){var arr,arr2,nodes1,nodes2,profile=this.get(0),prop=profile.properties,box=profile.box,grpcols=xui.clone(prop.grpCols,!1,2),rows=this.getRows("data");xui.breakO(profile.colMap,2),header=box._adjustHeader(header||[]),arr=box._prepareHeader(profile,header),prop.header=header,this.removeAllRows(),profile.getSubNodes(["HCELL","HSCELL"],!0).remove(),arr.length&&(nodes1=profile._buildItems("header1",arr),profile.getSubNode("HCELLS1").append(nodes1),nodes2=profile._buildItems("header2",arr),profile.getSubNode("LHCELL").addPrev(nodes2)),grpcols&&xui.isArr(grpcols)&&grpcols.length>0&&(grpcols=box._adjustGrpColsData(profile,grpcols),prop.grpCols=grpcols,(arr2=box._prepareGrpCols(profile,grpcols,arr))&&arr2.length&&(nodes1=profile._buildItems("grpCols1",arr2),profile.getSubNode("GRPCELLBOX1").append(nodes1),nodes2=profile._buildItems("grpCols2",arr2),profile.getSubNode("GRPCELLBOX2").append(nodes2)),box._adjustColsWidth(profile),box._adjustColsHeight(profile),profile.adjustSize()),rows&&rows.length&&this.setRows(rows),box._adjustBody(profile,"refreshheader");var co=profile.properties.colOptions;xui.arr.each(arr,(function(o){xui.isFun(o.colRenderer||co.colRenderer)&&(o.colRenderer||co.colRenderer).call(null,profile,o)})),"infirstcell"==prop.treeMode&&profile.getSubNode("HCELLA",arr[0]._serialId).prepend(profile.getSubNode("LTAGCMDS")).prepend(profile.getSubNode("HFMARK")),profile.$col_pop&&(profile.$col_pop.destroy(!0),delete profile.$col_pop),xui.each(profile.$cache_editor,(function(o){o.destroyed||o.destroy(!0)})),profile.$cache_editor={}},_toggleRows:function(rows,expand){var self=this;rows&&rows.length&&xui.arr.each(rows,(function(o){o.id&&self.toggleRow(o.id,expand)}))},isSubInited:function(id){var row=this.getRowbyRowId(id);return row&&row.sub&&xui.isArr(row.sub)},autoRowHeight:function(rowId){return this.each((function(prf){if(prf.renderId){var ev=xui.Event;ev.__realtouch&&(ev.__simulatedMousedown=1),rowId&&prf.rowMap2[rowId]?prf.getSubNode("FHANDLER",prf.rowMap2[rowId]).onDblclick(!0):xui.each(prf.rowMap,(function(o,i){prf.getSubNode("FHANDLER",i).onDblclick(!0)})),ev.__realtouch&&(ev.__simulatedMousedown=0)}}))},autoColWidth:function(colId){return this.each((function(prf){if(prf.renderId){var ev=xui.Event;ev.__realtouch&&(ev.__simulatedMousedown=1),colId&&prf.colMap2[colId]?prf.getSubNode("HHANDLER",prf.colMap2[colId]).onDblclick(!0):xui.each(prf.colMap,(function(o,i){prf.getSubNode("HHANDLER",i).onDblclick(!0)})),ev.__realtouch&&(ev.__simulatedMousedown=0)}}))},autoColHeight:function(){return this.each((function(prf){if(prf.renderId){var ev=xui.Event;ev.__realtouch&&(ev.__simulatedMousedown=1),prf.getSubNode("FHANDLER").onDblclick(!0),ev.__realtouch&&(ev.__simulatedMousedown=0)}}))},addHotRow:function(focusPos,pid,baseRow){var prf=this.get(0);return prf.renderId&&prf.box._addTempRow(prf,focusPos||null,pid,baseRow),this},focusHotRow:function(focusPos){var prf=this.get(0);return prf.renderId&&prf.__hastmpRow&&this.focusCellbyRowCol(prf.box._temprowid,focusPos||0),this},getHotRow:function(type){return this.getRowbyRowId(this.Class._temprowid,type)},updateHotRow:function(cells,dirtyMark,triggerEvent){return this.updateRow(this.Class._temprowid,{cells:cells},dirtyMark,triggerEvent)},removeHotRow:function(){var profile=this.get(0);return profile.box._sethotrowoutterblur(profile,!0),delete profile.__hastmpRow,this.removeRows([profile.box._temprowid],!1),this},isDirtied:function(){var dirty=!1,prf=this.get(0);return!!prf._dirty||(xui.each(prf.rowMap,(function(v){if(v._dirty||v._oValue!==v.value||"unit"in v&&v._oUnit!==v.unit)return dirty=!0,!1})),xui.each(prf.cellMap,(function(v){if(v._dirty||v._oValue!==v.value||"unit"in v&&v._oUnit!==v.unit)return dirty=!0,!1})),dirty)},isCellDirtied:function(cell){return cell._dirty||cell._oValue!==cell.value||"unit"in cell&&cell._oUnit!==cell.unit},isRowDirtied:function(row){var prf=this.get(0);if(row._dirty||(row._oValue,row.value),prf._dirty)return!0;for(var i=0,l=row.cells.length;i<l;i++)if(this.isCellDirtied(row.cells[i]))return!0;return!1},_getObjByDom:function(src,type){var prf=this.get(0),subId=prf.getSubId("string"==typeof src?"!"==src.charAt(0)?(src=xui.use(src).get(0))&&src.id:src:src.id);return prf["row"==type?"rowMap":"col"==type?"colMap":"cellMap"][subId]},getRowByDom:function(src,type,splitMixColumn){return this.get(0).box._getRow(this.get(0),this._getObjByDom(src,"row"),type,splitMixColumn)},getHeaderByDom:function(src){return this._getObjByDom(src,"col")},getCellByDom:function(src){return this._getObjByDom(src,"cell")},getRows:function(type,splitMixColumn){var a,b,v=this.get(0).properties.rows;return xui.isArr(v)?"data"==type||"min"==type||"value"==type||"map"==type?((a=xui.clone(v,!0))&&a.length&&a[a.length-1]&&a[a.length-1].id==this.constructor._temprowid&&a.pop(),"min"==type||"value"==type?xui.arr.each(a,(function(o,i){a[i].cells&&xui.each(b=a[i]=a[i].cells,(function(v,j){b[j]="value"in v?v.value:v}))})):"map"==type&&(a=this.getRawData(null,splitMixColumn)),a):v:[]},getRowbyRowId:function(rowId,type,splitMixColumn){var profile=this.get(0),v=profile.rowMap2,rows=profile.properties.rows;return xui.isNumb(rowId)&&(rowId=xui.get(rows,[-1==rowId?rows.length-1:rowId,"id"])),v&&v[rowId]?profile.box._getRow(profile,profile.rowMap[v[rowId]],type,splitMixColumn):(v=profile.queryItems(rows,(function(v,k){return v.id==rowId}),1,1))&&v.length?profile.box._getRow(profile,v[0],type,splitMixColumn):void 0},getRowbyCell:function(cell,type,splitMixColumn){return this.constructor._getRow(this.get(0),cell._row,type,splitMixColumn)},toggleRow:function(rowId,expand,recursive,stopanim,callback){var ns=this,profile=this.get(0),self=arguments.callee,v=profile.rowMap2,rows=profile.properties.rows;if(xui.isNumb(rowId)&&(rowId=xui.get(rows,[-1==rowId?rows.length-1:rowId,"id"])),v&&v[rowId]){var row=profile.rowMap[v[rowId]];!row||!row.sub||xui.isSet(expand)&&!!expand==!!row._checked||profile.box._setSub(profile,row,xui.isSet(expand)?!!expand:!row._checked,recursive,stopanim||recursive,callback)}else xui.arr.each(rows,(function(row){row.sub&&self.call(ns,row.id,expand,recursive,!0,callback)}));return this},showRows:function(rowId,show){var ns=this,profile=ns.get(0),showNodes=xui(),hideNodes=xui(),prop=profile.properties;return(rowId=xui.isHash(rowId)?rowId.id:xui.isArr(rowId)?rowId:0===rowId?[0]:rowId?(rowId+"").split(prop.valueSeparator):null)||(rowId=(rowId=xui.get(ns.getActiveRow(),"id")||(prop.$UIvalue||prop.value)+"").split(prop.valueSeparator)),rowId&&rowId.length&&xui.arr.each(rowId,(function(r,row){(row=ns.getRowbyRowId(r))&&(!1===show?row.hidden||hideNodes.merge(ns.getSubNodes(["ROW1","ROW2"],row._serialId)):row.hidden&&showNodes.merge(ns.getSubNodes(["ROW1","ROW2"],row._serialId)),row.hidden=!1===show)})),showNodes.isEmpty()||showNodes.css("display",""),hideNodes.isEmpty()||hideNodes.css("display","none"),this},updateRow:function(rowId,options,dirtyMark,triggerEvent){var orow,ns=this,profile=ns.get(0),box=profile.box,prop=profile.properties;if(rowId||0===rowId||(rowId=xui.get(ns.getActiveRow(),"id")||((prop.$UIvalue||prop.value)+"").split(prop.valueSeparator)[0]),!(orow=ns.getRowbyRowId(rowId)))return ns;var ext,pdm=prop.dirtyMark,psdm=pdm&&prop.showDirtyMark,ishotrow=orow.id==box._temprowid,sc=xui.absObj.$specialChars;if(xui.isHash(options)||(options=xui.isArr(options)?{cells:options}:{value:options}),options=xui.filter(options,(function(o,i,r){return(r=!sc[i.charAt(0)])||((ext=ext||{})[i]=o),r})),!triggerEvent||!profile.beforeRowUpdated||!1!==profile.boxing().beforeRowUpdated(profile,orow,options,ishotrow,ext)){if(!xui.isEmpty(options)){if(orow){var t,tt,nid,rid=orow._serialId;if(xui.isSet(options.id)&&(options.id+=""),options.id&&options.id!==rowId){nid=options.id;var v,m2=profile.rowMap2;m2[nid]||(v=m2[rowId])&&(m2[nid]=v,delete m2[rowId],profile.rowMap[v].id=nid,xui.each(profile.colMap,(function(o){(o=o._cells)&&(o[nid]=o[rowId],delete o[rowId])})))}else options.id=rowId;if(xui.isEmpty(options))return ns;if("group"in options&&options.group!=orow.group||"cells"in options||"sub"in options&&(!0!==options.sub||orow.sub)&&(options.sub||!0!==orow.sub)){var id="__special",pid=orow._pid?profile.rowMap[orow._pid].id:null;if(orow.id=id,profile.rowMap2[id]=profile.rowMap2[nid||rowId],delete profile.rowMap2[nid||rowId],xui.each(profile.colMap,(function(o){(o=o._cells)&&delete o[nid||rowId]})),orow=xui.clone(orow,!0),xui.merge(orow,options,"all"),"sub"in options&&!options.sub&&delete orow.sub,ns.insertRows([orow],pid,id,!0),ns.removeRows([id]),"row"==profile.properties.activeMode){var arr=(""+(profile.properties.$UIvalue||"")).split(profile.properties.valueSeparator);arr.length&&-1!=xui.arr.indexOf(arr,rowId)&&(nid&&xui.arr.removeValue(arr,rowId),ns.setUIValue(arr.join(profile.properties.valueSeparator),!0,null,"sub"))}}else{if("sub"in options&&(t=box._getToggleNode(profile,rid),options.sub?(t.addClass("xui-uicmd-toggle"),orow._layer&&t.removeClass("xui-uicmd-empty")):(t.removeClass("xui-uicmd-toggle"),orow._layer&&t.addClass("xui-uicmd-empty"))),tt=ns.getSubNodes(["CELLS1","CELLS2"],rid),(t=profile.$px(options.height))&&profile.box._adjusteditorH(profile,tt.height(orow._rowHeight=profile.$forceu(t)),t),(t=options.rowStyle)&&tt.attr("style",tt.attr("style")+";"+t),(t=options.rowClass)&&tt.addClass(t),options.hasOwnProperty("disabled")){var cls="xui-uicell-disabled";options.disabled?tt.addClass(cls):tt.removeClass(cls)}if(options.hasOwnProperty("readonly")&&(cls="xui-ui-readonly",options.readonly?tt.addClass(cls):tt.removeClass(cls)),(t=options.firstCellStyle)&&(tt=ns.getSubNode("FCELL",rid)).first().attr("style",tt.attr("style")+";"+t),(t=options.firstCellClass)&&ns.getSubNode("FCELL",rid).first().addClass(t),options.hasOwnProperty("value")&&!xui.isSet(options.caption)&&(options.caption=options.value+""),options.hasOwnProperty("caption")&&(ns.getSubNode("FCELLCAPTION",rid).get(0).innerHTML=options.caption||""),options.hasOwnProperty("rowResizer")&&(t=!!options.rowResizer,ns.getSubNode("FHANDLER",rid).css("display",(options.rowResizer=t)?"block":"none")),options.hasOwnProperty("hidden")&&(options.hidden?!0!==orow.hidden&&ns.getSubNodes(["ROW1","ROW2"],rid).css("display","none"):!0===orow.hidden&&ns.getSubNodes(["ROW1","ROW2"],rid).css("display","")),xui.merge(orow,options,"all"),options.hasOwnProperty("value")){var node=profile.getSubNode("CELLA",rid);pdm&&!1!==dirtyMark?orow.value===orow._oValue?psdm&&node.removeClass("xui-ui-dirty"):psdm&&node.addClass("xui-ui-dirty"):orow._oValue=orow.value,orow._editor&&orow._editor.setValue(options.value,!0,"editorini")}}}else{var rst=ns.get(0).queryItems(ns.getRows(),(function(o){return"object"==typeof o?o.id===rowId:o==rowId}),!0,!0,!0);rst.length&&xui.merge(orow=rst[0][0],options,"all")}orow._dirty=!0}return triggerEvent&&profile.afterRowUpdated&&profile.boxing().afterRowUpdated(profile,orow,options,ishotrow,ext),ns}},insertMapRows:function(arr,pid,base,before,ignoreMixColumn,ensureHotRow){var ns=this,args=xui.toArr(arguments);xui.isHash(arr)&&(arr=[arr]);var i,j,hash,cols={},rowdata=[],cellsArr=[],l=arr.length;for(i=0;i<l;i++)if(xui.isHash(hash=arr[i]))for(var k in hash)"__row__id"==k?(rowdata[i]=rowdata[i]||{},rowdata[i].id=hash[k]):0==k.indexOf("__row__")?(rowdata[i]=rowdata[i]||{},rowdata[i][k]=hash[k]):(k in cols||(cols[k]=[]),cols[k][i]=hash[k]);var map={};for(var k in xui.arr.each(ns.getHeader(),(function(o,i){map[o.id]=i})),cols)if(k in map)for(j=map[k],i=0;i<l;i++)cellsArr[i]||(cellsArr[i]=[]),cellsArr[i][j]=cols[k][i];return rowdata.length&&xui.each(cellsArr,(function(cells,i){rowdata[i]&&(cellsArr[i]=rowdata[i],cellsArr[i].cells=cells)})),args[0]=cellsArr,ns.insertRows.apply(this,args)},insertRows:function(arr,pid,base,before,ignoreMixColumn,ensureHotRow){var rows,v,c=this.constructor,profile=this.get(0);if(xui.isHash(arr)&&(arr=[arr]),arr&&xui.isArr(arr)&&arr.length>0){var temp,tar,t,k,prop=profile.properties,row_m=profile.rowMap2,ro=prop.rowOptions,b=profile.rowMap;if(!0===pid&&((v=prop.$UIvalue||prop.value)&&(v=(v+"").split(prop.valueSeparator)),pid=v[0]),pid=row_m&&row_m[pid],!0===base&&((v=prop.$UIvalue||prop.value)&&(v=(v+"").split(prop.valueSeparator)),base=v[0]),(base=row_m&&row_m[base])&&(t=profile.rowMap[base])&&(pid=t._pid),arr=c._adjustRows(profile,arr,ignoreMixColumn),pid){if(!(k=b&&b[pid]))return;tar=xui.isArr(k.sub)?k.sub:k.sub=[]}else tar=xui.isArr(prop.rows)?prop.rows:prop.rows=[];if(profile.renderId&&(!xui.isSet(pid)||k._inited?(temp=[],rows=c._prepareItems(profile,arr,pid,temp),this._insertRowsToDom(profile,rows,pid,base,before,temp),xui.arr.each(arr,(function(o){xui.isFun(o.rowRenderer||ro.rowRenderer)&&(o.rowRenderer||ro.rowRenderer).call(null,profile,o)}))):xui.isSet(pid)&&!k.inited&&profile.box._getToggleNode(profile,pid).removeClass("xui-icon-placeholder xui-uicmd-none").addClass("xui-uicmd-toggle")),base){var index=xui.arr.subIndexOf(tar,"_serialId",base);xui.arr.insertAny(tar,arr,before?index:index+1)}else xui.arr.insertAny(tar,arr,before?0:-1);profile.renderId&&profile.box._asy(profile)}if(!1!==ensureHotRow&&profile.renderId&&profile.box.__ensurehotrow(profile,ensureHotRow),profile.$itemFilter){var hideRows=[];xui.arr.each(arr,(function(row){if(row.sub&&!row.hidden)if(!0!==profile.$itemFilter(row,"checkSub",profile)){for(var flag,i=0,l=row.sub.length;i<l;i++)if(!row.sub[i].hidden){flag=1;break}flag||hideRows.push(row.id)}else hideRows.push(row.id)})),hideRows.length&&this.showRows(hideRows,!1)}return rows},doFilter:xui.absList.prototype.doFilter,removeRows:function(ids,ensureHotRow){var self=this,profile=self.get(0);if(profile.rowMap2){var v,p=profile.properties,cell=profile.cellMap,nodes=[],count=0;return(ids=xui.isHash(ids)?[ids.id]:xui.isArr(ids)?ids:0===ids?[0]:ids?(ids+"").split(p.valueSeparator):null)||(ids=(ids=xui.get(self.getActiveRow(),"id")||(p.$UIvalue||p.value)+"").split(p.valueSeparator)),ids&&ids.length?(xui.arr.each(ids,(function(o,i){xui.isNumb(o)&&(o=p.rows[o]&&p.rows[o].id),ids[i]=""+o})),xui.arr.each(ids,(function(id){if(id=profile.rowMap2[id]){var row;if(count++,row=profile.rowMap[id]){var temp,tdids=row._cells,rowid=row.id;if(row.sub&&xui.isArr(row.sub)){var arr=[];xui.arr.each(row.sub,(function(o){arr.push(o.id)})),self.removeRows(arr)}xui.each(tdids,(function(o,i){delete cell[o]._col._cells[rowid],xui.breakO(cell[o]),delete cell[o],profile.reclaimSubId(o.slice(3),"cell")})),(temp=row._pid?(temp=profile.rowMap[row._pid])?temp.sub:null:profile.properties.rows)&&xui.isArr(temp)&&xui.filter(temp,(function(o){return o._serialId!=id})),delete profile.rowMap2[rowid],xui.breakO(profile.rowMap[id]),delete profile.rowMap[id],nodes.push(profile.getSubNode("ROW1",id).get(0)),nodes.push(profile.getSubNode("ROW2",id).get(0))}profile.reclaimSubId(id.slice(3),"row")}else{var f=function(rows){var index=xui.arr.subIndexOf(rows,"id",id);-1!==index&&(count++,xui.arr.removeFrom(rows,index)),xui.arr.each(rows,(function(row){row.sub&&f(row.sub)}))};f(p.rows)}})),count>0&&((v=p.$UIvalue)&&((v=(""+v).split(p.valueSeparator)).length>1?(xui.filter(v,(function(o){return-1==xui.arr.indexOf(ids,o)})),p.$UIvalue=v.join(p.valueSeparator)):-1!=xui.arr.indexOf(ids,p.$UIvalue)&&(p.$UIvalue=null)),xui(nodes).remove(),profile.$activeCell&&!xui.Dom.byId(profile.$activeCell)&&delete profile.$activeCell,profile.$activeRow&&!xui.Dom.byId(profile.$activeRow)&&delete profile.$activeRow,delete profile.$allrowscache1,delete profile.$allrowscache2,profile.box._asy(profile),profile.box._adjustBody(profile,"delrow")),!1!==ensureHotRow&&profile.renderId&&profile.box.__ensurehotrow(profile,ensureHotRow),profile._dirty=1,self):self}},insertCol:function(col,cells,pos){var cell,base,colResult,cellResult,profile=this.get(0),prop=profile.properties,box=profile.box,rows=prop.rows;if((-1===(pos=xui.isNumb(pos)?pos:-1)||prop.header.length<pos)&&(pos=prop.header.length),pos<0&&(pos=0),"infirstcell"==prop.treeMode&&0===pos)return!1;var leftRegion=pos<=prop.freezedColumn-1,arr=prop.grpCols;if(arr&&xui.isArr(arr)&&arr.length)for(var grp,j=0,m=arr.length;j<m;j++)(grp=arr[j]).from>pos?(grp.from++,grp.to++):pos>=grp.from&&pos<=grp.to&&grp.to++;if(profile.renderId){colResult=box._parepareCol(profile,col,prop.header),col=colResult[0],xui.arr.insertAny(prop.header,col,pos),(base=profile.getSubNode(leftRegion?"HCELLS1":"HCELLS2").children().get(pos-1))&&xui(base).addNext(profile._buildItems(leftRegion?"header1":"header2",[colResult[1]]));var co=profile.properties.colOptions;xui.isFun(col.colRenderer||co.colRenderer)&&(col.colRenderer||co.colRenderer).call(null,profile,col),prop.grpCols=box._adjustGrpColsData(profile,arr),box._adjustColsWidth(profile),box._adjustColsHeight(profile),box._adjustBody(profile,"addcol")}else xui.arr.insertAny(prop.header,col,pos);cells=xui.isArr(cells)?cells:[];var k=0,applaycell=function(rows){var temp=[];xui.arr.each(rows,(function(row,i){row.group?applaycell(row.sub):(cell=cells[k],(base=profile.getSubNode(leftRegion?"CELLS1":"CELLS2",row._serialId).children().get(pos-1))?(cellResult=box._prepareCell(profile,cell,row,col,temp),xui.arr.insertAny(row.cells,cellResult[0],pos),xui(base).addNext(profile._buildItems(leftRegion?"rows1.cells":"rows2.cells",[cellResult[1]]))):xui.arr.insertAny(row.cells,cell||{},pos)),k++})),temp.length&&(xui.arr.each(temp,(function(o){!box.getCellOption(profile,o,"editable")||"inline"!=box.getCellOption(profile,o,"editMode")&&"dropbutton"!=box.getCellOption(profile,o,"type")||box._editCell(profile,o)})),temp.length=0)};rows&&xui.isArr(rows)&&applaycell(rows),profile._dirty=1},removeCols:function(ids){var profile=this.get(0),box=profile.box,p=profile.properties,cell=profile.cellMap,SubID=xui.UI.$tag_subId,nodes=[],count=0;ids=xui.isArr(ids)?ids:(ids+"").split(p.valueSeparator),xui.arr.each(ids,(function(o,i){ids[i]=""+o})),ids&&ids.length>1&&ids.sort((function(x,y){var xx=xui.arr.indexOf(p.header,x);-1==xx&&(xx=xui.arr.subIndexOf(p.header,"id",x));var yy=xui.arr.indexOf(p.header,y);return-1==yy&&(yy=xui.arr.subIndexOf(p.header,"id",y)),xx>yy?1:xx===yy?0:-1}));var arr=p.grpCols;return arr&&xui.isArr(arr)&&arr.length&&(xui.arr.each(ids,(function(id){var pos=xui.arr.indexOf(p.header,id);if(-1==pos&&(pos=xui.arr.subIndexOf(p.header,"id",id)),-1!=pos)for(var grp,j=0,m=arr.length;j<m;j++)(grp=arr[j]).from>pos?(grp.from--,grp.to--):pos>=grp.from&&pos<=grp.to&&grp.to--}),null,!0),xui.filter(arr,(function(o){var r=o.to>=o.from;return!r&&profile.renderId&&(profile.getSubNode(["HCELL","HSCELL"],o[SubID]).remove(),delete profile.colMap[o[SubID]],delete profile.colMap2[o.id]),r}))),xui.arr.each(ids,(function(id){var index=xui.arr.indexOf(p.header,id);if(-1==index&&(index=xui.arr.subIndexOf(p.header,"id",id)),-1!=index){if(profile.colMap2&&(id=profile.colMap2[id])){var col;if(count++,col=profile.colMap[id]){var t,tdids=col._cells,colid=col.id;xui.each(tdids,(function(o,i){nodes.push(profile.getSubNode("CELL",o).get(0)),delete cell[o]._row._cells[colid],xui.breakO(cell[o]),delete cell[o],profile.reclaimSubId(o.slice(3),"cell")})),delete profile.colMap2[colid],xui.breakO(profile.colMap[id]),delete profile.colMap[id],(t=profile.getSubNode("HCELL",id).get(0))&&nodes.push(t),(t=profile.getSubNode("HSCELL",id).get(0))&&nodes.push(t)}profile.reclaimSubId(id.slice(3),"header")}var applaycell=function(rows){xui.arr.each(rows,(function(row){row.cells&&xui.arr.removeFrom(row.cells,index),row.sub&&applaycell(row.sub)}))};applaycell(p.rows),xui.arr.removeFrom(p.header,index)}}),null,!0),count>0&&(xui(nodes).remove(),profile.$activeCell&&!xui.Dom.byId(profile.$activeCell)&&delete profile.$activeCell,p.grpCols=box._adjustGrpColsData(profile,arr),box._adjustColsWidth(profile),box._adjustColsHeight(profile),box._adjustBody(profile,"delcol")),profile._dirty=1,this},removeAllRows:function(ensureHotRow){var profile=this.get(0),box=profile.box,prop=profile.properties;if(!prop.rows||prop.rows.length<=0)return this;for(var i in profile.cellMap)profile.reclaimSubId(i.slice(3),"cell");for(var i in profile.rowMap)profile.reclaimSubId(i.slice(3),"row");return xui.each(profile.colMap,(function(o){o._cells={}})),xui.breakO([profile.rowMap,profile.cellMap],3),profile.rowMap={},profile.cellMap={},profile.rowMap2={},delete profile.$activeCell,delete profile.$activeRow,profile.properties.rows.length=0,profile.renderId&&(0!=profile.$sl&&(profile.getSubNode("HEADER2").get(0).scrollLeft=profile.$sl=0),profile.getSubNodes(["SCROLL21","SCROLL22"]).scrollTop(0).scrollLeft(0),profile.getSubNodes(["ROWS21","ROWS22"]).empty()),delete profile.$allrowscache1,delete profile.$allrowscache2,profile.properties.$UIvalue=null,!1!==ensureHotRow&&profile.renderId&&profile.__hastmpRow&&box.__ensurehotrow(profile,ensureHotRow),box._adjustBody(profile,"delrow"),this},updateGridValue:function(){return this.each((function(profile){var prop=profile.properties;delete profile._dirty,xui.each(profile.rowMap,(function(v){v._oValue=v.value,"unit"in v&&(v._oUnit=v.unit),delete v._dirty})),xui.each(profile.cellMap,(function(v){v._oValue=v.value,"unit"in v&&(v._oUnit=v.unit),delete v._dirty})),prop.dirtyMark&&prop.showDirtyMark&&profile.getSubNode("CELLA",!0).removeClass("xui-ui-dirty")}))},updateRowValue:function(rowId){var profile=this.get(0),row=this.getRowbyRowId(rowId),arr=[],prop=profile.properties;xui.arr.each(row.cells,(function(o){(o._oValue!==o.value||"unit"in o&&o._oUnit!==o.unit)&&(o._oValue=o.value,"unit"in o&&(o._oUnit=o.unit),delete o._dirty,prop.dirtyMark&&arr.push(profile.getSubNode("CELLA",o._serialId).get(0)))})),row._oValue=row.value,delete row._dirty,prop.dirtyMark&&arr.push(profile.getSubNode("CELLA",row._serialId).get(0)),prop.dirtyMark&&prop.showDirtyMark&&xui(arr).removeClass("xui-ui-dirty")},updateColValue:function(colId){var profile=this.get(0),col=this.getHeaderByColId(colId),arr=[],prop=profile.properties;xui.arr.each(col.cells,(function(o){(o._oValue!==o.value||"unit"in o&&o._oUnit!==o.unit)&&(o._oValue=o.value,"unit"in o&&(o._oUnit=o.unit),delete o._dirty,prop.dirtyMark&&arr.push(profile.getSubNode("CELLA",o._serialId).get(0)))})),prop.dirtyMark&&prop.showDirtyMark&&xui(arr).removeClass("xui-ui-dirty")},updateCellValue:function(cell){var profile=this.get(0),prop=profile.properties;return"string"==typeof cell&&(cell=this.getCell(cell)),(cell._oValue!==cell.value||"unit"in cell&&cell._oUnit!==cell.unit)&&(cell._oValue=cell.value,"unit"in cell&&(cell._oUnit=cell.unit),delete cell._dirty,prop.dirtyMark&&profile.getSubNode("CELLA",cell._serialId).removeClass("xui-ui-dirty")),this},resetCellValue:function(cell,force){var profile=this.get(0);return profile.properties,"string"==typeof cell&&(cell=this.getCell(cell)),(force||cell._oValue!==cell.value||"unit"in cell&&cell._oUnit!==cell.unit)&&(cell.value=cell._oValue,"unit"in cell&&(cell.unit=cell._oUnit),delete cell._dirty,profile.box._renderCell(profile,cell,{},profile.getSubNode("CELLA",cell._serialId))),this},getActiveRow:function(type,splitMixColumn){var ar,profile=this.get(0);if("row"==profile.properties.activeMode&&(ar=profile.$activeRow))return ar=profile.rowMap[profile.getSubId(ar)],profile.box._getRow(profile,ar,type,splitMixColumn)},setActiveRow:function(rowId){var dr,row,profile=this.get(0);if("row"==profile.properties.activeMode&&(profile.box._activeRow(profile,!1),row=this.getRowbyRowId(rowId)))return(dr=profile.getSubNodes(["CELLS1","CELLS2"],row._serialId)).isEmpty()||(profile.box._activeRow(profile,dr.get(0).id),dr.scrollIntoView()),this},getRowMap:function(rowId,withRowVars){var t,prf=this.get(0),ins=prf.boxing(),p=prf.properties;xui.isHash(rowId)&&(rowId=rowId.id),xui.isSet(rowId)||!prf.renderId||prf.destroyed||("row"===p.activeMode?(t=ins.getActiveRow())&&(rowId=t.id):"cell"===p.activeMode&&(t=ins.getActiveCell())&&(rowId=t._row.id));var map=ins.getRowbyRowId(rowId,"map");return!1===withRowVars&&(map=xui.filter(map,(function(v,k){return 0!==k.indexOf("__row__")}))),map},setRowMap:function(rowId,hash,dirtyMark,triggerEvent){return xui.isHash(rowId)&&(rowId=rowId.id),this.each((function(prf){var t,ins=prf.boxing(),p=prf.properties;if(rowId||!prf.renderId||prf.destroyed||((p.activeMode="row")?(t=ins.getActiveRow())&&(rowId=t.id):(p.activeMode="cell")&&(t=ins.getActiveCell())&&(rowId=t._row.id)),rowId){var row=ins.getRowbyRowId(rowId),header=ins.getHeader("min");rowId=row.id;var cells=prf.box._adjustRows(prf,[hash])[0].cells;xui.arr.each(row.cells,(function(t,j){xui.isDefined(cells[j]&&cells[j].value)&&ins.updateCellByRowCol(rowId,header[j],cells[j],dirtyMark,triggerEvent)}))}p.rowMap=hash}))},getHeader:function(type){var v=this.get(0).properties.header;if(!xui.isArr(v))return[];if("data"==type)return xui.clone(v,!0);if("min"==type||"value"==type){var a=xui.clone(v,!0);return xui.arr.each(a,(function(o,i){a[i]="id"in o?o.id:o})),a}return v},getHeaderByColId:function(colId,type){var i,profile=this.get(0),v=profile.properties.header;return xui.isNumb(colId)&&(colId=xui.get(profile.properties.header,[colId,"id"])),-1==(i=xui.arr.subIndexOf(v,"id",colId))?null:"data"==type?xui.clone(v[i],!0):"min"!=type&&"value"!=type||!("id"in v[i])?v[i]:v[i].id},clearGrid:function(){return this.setHeader()},getHeaderByCell:function(cell,type){var v=cell._col;return v?"data"==type?xui.clone(v,!0):"min"!=type&&"value"!=type||!("id"in v)?v:v.id:null},updateHeader:function(colId,options){var isGroup,ns=this,profile=ns.get(0),prop=profile.properties,colh=ns.getHeaderByColId(colId);if(!colh){var grpCols=prop.grpCols;colh=grpCols[xui.arr.subIndexOf(grpCols,"id",colId)],isGroup=!0}if(colh){if("object"!=typeof options?options={caption:options+""}:xui.filter(options,!0),delete options.id,profile.renderId){var t,tt,nd,hid=colh._serialId;if(!isGroup){if(t=options.width){t=profile.$px(t);var n=[];(nd=ns.getSubNode("HCELL",hid).get(0))&&n.push(nd),(nd=ns.getSubNode("HSCELL",hid).get(0))&&n.push(nd),xui.each(colh._cells,(function(o){n.push(ns.getSubNode("CELL",o).get(0))})),profile.box._adjusteditorW(profile,xui(n).width(colh._colWidth=profile.$forceu(t)),t),ns.getSubNode("SCROLL22").onScroll(),ns.constructor._adjustColsWidth(ns.get(0)),ns.constructor._adjustBody(ns.get(0),"setcol")}options.hasOwnProperty("visibility")&&!options.hasOwnProperty("hidden")&&(options.hidden=!options.visibility),options.hasOwnProperty("hidden")&&(options.hidden?!0!==colh.hidden&&ns.showColumn(colId,!1):!0===colh.hidden&&ns.showColumn(colId,!0)),"type"in options&&delete colh.editorCacheKey}(t=options.headerStyle||options.colStyle)&&(tt=ns.getSubNodes(["HCELLA","HSCELLA"],hid)).attr("style",tt.attr("style")+";"+t),(t=options.headerClass)&&ns.getSubNodes(["HCELLA","HSCELLA"],hid).addClass(t),options.hasOwnProperty("caption")&&(ns.getSubNodes(["HCELLCAPTION","HSCELLCAPTION"],hid).get(0).innerHTML=options.caption),"colResizer"in options&&(t=!!options.colResizer,ns.getSubNode("HHANDLER",hid).css("display",(options.colResizer=t)?"block":"none"))}xui.merge(colh,options,"all"),"flexSize"in options&&profile.adjustSize()}},showColumn:function(colId,flag){var col,sid,nd,profile=this.get(0),map=profile.colMap2,cols=profile.colMap,n=[];if(col=cols[sid=map[colId]]){if(profile.beforeColShowHide&&!1===profile.boxing().beforeColShowHide(profile,colId,flag))return!1;(nd=profile.getSubNode("HCELL",sid).get(0))&&n.push(nd),(nd=profile.getSubNode("HSCELL",sid).get(0))&&n.push(nd),xui.each(col._cells,(function(id){n.push(profile.getSubNode("CELL",id).get(0))})),xui(n).css("display",(col.hidden=!1===flag)?"none":""),profile.afterColShowHide&&profile.boxing().afterColShowHide(profile,colId,flag)}return profile.box._adjustColsWidth(profile),profile.box._adjustBody(profile,"setcol"),!0},sortColumn:function(colId,desc,sortby){var prf=this.get(0),sId=prf.colMap2[colId],col=prf.colMap[sId];return sId&&col&&(xui.isBool(desc)&&(col._order=!desc),xui.isFun(sortby)&&(col.sortby=sortby),prf.getSubNode("HCELLA",sId).onClick()),this},getCell:function(cellId,type){var v,m,profile=this.get(0);return xui.each(profile.cellMap,(function(o){if(o.id&&o.id===(cellId.id||cellId))return cellId=o._serialId,!1})),(v=profile.cellMap[cellId])?"data"==type?xui.merge({rowId:v._row.id,colId:v._col.id},xui.clone(v,!0)):"min"==type||"value"==type?v.value:"map"==type?(m={})&&((m[v._col.id]=v.value)||1)&&m:v:null},getCellbyRowCol:function(rowId,colId,type){var v,m,profile=this.get(0);if(xui.isNumb(rowId)&&(rowId=xui.get(profile.properties.rows,[rowId,"id"])),xui.isNumb(colId)&&(colId=xui.get(profile.properties.header,[colId,"id"])),!(v=(v=xui.get(profile.rowMap,[profile.rowMap2[rowId],"_cells",colId]))&&profile.cellMap[v])){var col,row=this.getRowbyRowId(rowId),header=this.getHeader("min");row&&row.cells&&-1!=(col=xui.arr.indexOf(header,colId))&&(v=row.cells[col])}return v?"data"==type?xui.merge({rowId:rowId,colId:colId},xui.clone(v,!0)):"min"==type||"value"==type?"value"in v?v.value:v:"map"==type?(m={})&&((m[colId]=v.value)||1)&&m:v:null},getCells:function(rowId,colId,type){var map={};return xui.each(this.get(0).cellMap,(function(v){rowId&&rowId!=v._row.id||colId&&colId!=v._col.id||(map[v.id]="data"==type?xui.merge({rowId:v._row.id,colId:v._col.id},xui.clone(v,!0)):"min"!=type&&"value"!=type||!("value"in v)?v:v.value)})),map},getCells2:function(rowId,colId,type){var cell,value,o=this.get(0),prop=o.properties,header=prop.header,tid=o.box._temprowid,row=xui.isSet(rowId)?this.getRowbyRowId(rowId):null,col=xui.isSet(colId)?this.getHeaderByColId(colId):null,oneRow=row&&row.cells&&xui.isArr(row.cells),oneCol=xui.isSet(colId)&&col,rows=oneRow?[row]:xui.isArr(row)&&row[0]&&row[0].cells&&xui.isArr(row[0].cells)?row:prop.rows,l=header.length,h=rows.length,columns=[],index=oneCol?xui.arr.indexOf(header,col):-1,data=[];if(h){if(oneCol)columns.push(col);else for(var i=0;i<l;i++)columns.push(header[i].id);for(var j=0;j<h;j++)if(oneRow||rows[j].id!=tid)if(oneCol)value=null,!rows[j].group&&rows[j].cells&&(cell=rows[j].cells[index],value="data"==type?xui.merge({rowId:cell._row.id,colId:cell._col.id},xui.clone(cell,!0)):"min"!=type&&"value"!=type||!("value"in cell)?cell:cell.value),data.push(value);else{var arr=[];if(!rows[j].group&&rows[j].cells)for(i=0;i<l;i++)cell=rows[j].cells[i],value="data"==type?xui.merge({rowId:cell._row.id,colId:cell._col.id},xui.clone(cell,!0)):"min"!=type&&"value"!=type||!("value"in cell)?cell:cell.value,arr.push(value);data.push(arr)}}return oneRow?data[0]:data},updateCellByRowCol:function(rowId,colId,options,dirtyMark,triggerEvent,triggerFormula){var t,con=this.constructor;if(t=con._getCellId(this.get(0),rowId,colId))con._updCell(this.get(0),t,options,dirtyMark,triggerEvent,triggerFormula);else{var col,row=this.getRowbyRowId(rowId),header=this.getHeader("min");row&&row.cells&&-1!=(col=xui.arr.indexOf(header,colId))&&(xui.isHash(row.cells[col])||(row.cells[col]={value:row.cells[col]}),xui.merge(row.cells[col],options,"all"))}return this},getCellPos:function(cell,excelType){if(!cell||!cell._row||!cell._col)return null;var prf=this.get(0),col=xui.arr.indexOf(cell._row.cells,cell),row=xui.arr.indexOf(prf.properties.rows,cell._row);return-1==col||-1==row?null:excelType?xui.ExcelFormula.toCellId(col,row):{row:row,col:col}},updateCellByRowCol2:function(mixedId,options,dirtyMark,triggerEvent){var arr=-1!=mixedId.indexOf(":")?mixedId.split(":"):xui.ExcelFormula.toCoordinate(mixedId,-1,!0),row=parseInt(arr[0],10),col=parseInt(arr[1],10);return this.updateCellByRowCol(row,col,options,dirtyMark,triggerEvent)},updateCell:function(cellId,options,dirtyMark,triggerEvent,triggerFormula){var profile=this.get(0);return xui.each(profile.cellMap,(function(o){if(o.id&&o.id===cellId)return cellId=o._serialId,!1})),this.constructor._updCell(profile,cellId,options,dirtyMark,triggerEvent,triggerFormula),this},editCellbyRowCol:function(rowId,colId){var profile=this.get(0),con=profile.box;return con._editCell(profile,con._getCellId(profile,rowId,colId)),this},editCell:function(cell){return(cell=cell||this.get(0).getSubId(this.get(0).$activeCell+""))&&this.constructor._editCell(this.get(0),cell),this},editFirstCell:function(rowId){var editor,profile=this.get(0),getPro=function(key){return profile.box.getCellOption(profile,row,key)},row="string"==typeof rowId?profile.rowMap[profile.rowMap2[rowId]]:rowId;if(profile.properties.firstCellEditable&&row&&!getPro(profile)&&!getPro(profile)&&profile&&profile.renderId&&!profile.destroyed){var cellNode=profile.getSubNode("FCELLCAPTION",row._serialId);if(!cellNode.isEmpty()){var pp=cellNode.parent();if(profile.beforeIniEditor&&!1===(editor=profile.boxing().beforeIniEditor(profile,row,cellNode,pp,"row",row,null)))return;var size2=pp.cssSize(),baseNode=profile.getSubNode("BORDER"),borderW=baseNode.contentBox()?2:0,absPos=cellNode.offset(null,pp),absPos2=pp.offset(null,baseNode);if(absPos2.left>size2.width-8)return;(editor=profile.$cache_editor.firstCellEditor)&&editor["xui.UI"]&&!editor.isDestroyed()||(editor=new xui.UI.ComboInput({type:"input",zIndex:100}),profile.$cache_editor.firstCellEditor=editor),editor.setWidth(size2.width-absPos.left+borderW).setHeight(size2.height+borderW).setValue(row.value||row.value||""),profile.onBeginEdit&&profile.boxing().onBeginEdit(profile,row,editor,"row",row,null),editor.undo=function(){var editor=this,row=editor.get(0)&&editor.get(0).$row;editor.undo=null,pp.removeClass("editing"),profile.box&&row&&row._oValue!==row.value&&row.id!=profile.box._temprowid&&profile.onRowDirtied&&profile.boxing().onRowDirtied(profile,row),editor.get(0)&&editor.get(0).box&&(editor.getSubNode("INPUT").onBlur(!0),editor.getRoot().setBlurTrigger("tg_editor_blur:"+profile.$xid),profile.properties&&(editor.beforeUnitUpdated(null).afterUIValueSet(null).beforeNextFocus(null).onCancel(null).onFileDlgOpen(null),editor.setValue("",!0,"editorreset")),delete editor.get(0).$row,delete editor.get(0)._smartnav,delete editor.get(0).$editMode,editor.hide()),row&&delete row._editor,profile.$curEditor=null,profile.onEndEdit&&profile.boxing().onEndEdit(profile,row,editor,"row",row,null),editor.get(0)&&editor.destroy(!0),editor=null},editor.afterUIValueSet((function(prf,ov,nv,force,tag){var t,options={value:nv};prf.properties.hasOwnProperty("tagVar")&&!xui.isEmpty(t=prf.properties.tagVar)&&(options.tagVar=t),!1!==(profile.beforeEditApply&&profile.boxing().beforeEditApply(profile,row,options,editor,tag,"row",row,null))&&(profile.boxing().updateRow(row.id,{value:nv,caption:nv+""}),xui.tryF(editor.undo,[],editor))})).beforeNextFocus((function(prop,e){xui.tryF(editor.undo,[!0],editor);var hash=xui.Event.getEventPara(e);return"enter"==hash.key&&(hash.$key="right"),profile.getSubNode("CELLA",row._serialId).onKeydown(!0,hash),!1})).onCancel((function(){xui.tryF(editor.undo,[],editor)})),baseNode.append(editor),editor.reBoxing().show(absPos.left+absPos2.left-1+"px",absPos2.top-1+"px"),pp.addClass("editing"),editor.getRoot().setBlurTrigger("tg_editor_blur:"+profile.$xid,(function(){return xui.tryF(editor.undo,[],editor),!1})),editor.get(0).$row=row,editor.get(0)._smartnav=!0,row._editor=editor,profile.$curEditor=editor,editor.activate()}return this}},focusCellbyRowCol:function(rowId,colId){var profile=this.get(0),cellId=profile.box._getCellId(profile,rowId,colId),node=profile.getSubNode("CELLA",cellId);return node&&node.get(0)&&node.focus(!0),this},focusCell:function(cell){var cellId=cell._serialId;return this.get(0).getSubNode("CELLA",cellId).focus(!0),this},getActiveCell:function(type){var ar,m,v,profile=this.get(0);if("cell"==profile.properties.activeMode&&(ar=profile.$activeCell))return(v=profile.cellMap[profile.getSubId(ar)])?"data"==type?xui.merge({rowId:v._row.id,colId:v._col.id},xui.clone(v,!0)):"min"==type||"value"==type?"value"in v?v.value:v:"map"==type?(m={})&&((m[v._col.id]=v.value)||1)&&m:v:null},setActiveCell:function(rowId,colId){var dr,cell,profile=this.get(0);if("cell"==profile.properties.activeMode&&(profile.box._activeCell(profile,!1),cell="object"==typeof rowId?rowId:this.getCellbyRowCol(rowId,colId)))return(dr=profile.getSubNode("CELLA",cell._serialId)).isEmpty()||profile.box._activeCell(profile,dr.get(0).id),this},getDirtied:function(rowId,colId){var map={};return xui.each(this.get(0).cellMap,(function(v){!(v._oValue!==v.value||"unit"in v&&v._oUnit!==v.unit)||rowId&&rowId!=v._row.id||colId&&colId!=v._col.id||(map[v.id]={rowId:v._row.id,colId:v._col.id,value:v.value,_oValue:v._oValue},"unit"in v&&(map[v.id]._oUnit=v._oUnit))})),map},getSubNodeInGrid:function(key,rowId,colId){var t=xui.isSet(rowId)&&xui.isSet(colId)?this.getCellbyRowCol(rowId,colId):colId?this.getHeaderByColId(colId):rowId?this.getRowbyRowId(rowId):null;return this.getSubNode(key,t&&t._serialId||!0)},getInlineEditors:function(rowId,colId){var map={};return xui.each(this.getCells(rowId,colId),(function(cell,id){map[id]=cell._editor})),map},getEditor:function(){return xui.get(this.get(0),["$curEditor"])},updateEditor:function(value,caption,prop){var editor=this.getEditor();return editor&&(xui.isHash(prop)&&editor.setProperties(prop,!0),xui.isDefined(caption)&&editor.setCaption(caption,!0),xui.isDefined(value)&&editor.setUIValue(value,!0)),this},getEditCell:function(){return xui.get(this.get(0),["$cellInEditor"])},offEditor:function(refresh,ignoreInline){var editor,profile=this.get(0);if(profile&&((editor=profile.$curEditor)&&xui.tryF(editor.undo,[],editor),ignoreInline||xui.each(profile.cellMap,(function(cell){(editor=cell._editor)&&(editor.destroy(),delete cell._editor)})),refresh)){var getPro=profile.box.getCellOption;xui.each(profile.cellMap,(function(o){!getPro(profile,o,"editable")||"inline"!=getPro(profile,o,"editMode")&&"dropbutton"!=getPro(profile,o,"type")||profile.box._editCell(profile,o,null,!0)}))}},adjustEditor:function(adjustFun){var prf=this.get(0),borderW=this.getRoot().contentBox();if(prf&&prf.$curEditor){var editor=prf.$curEditor,cell=prf.$cellInEditor;if("function"==typeof adjustFun)adjustFun.apply(this,[editor,cell]);else if("xui.UI.ComboInput"==editor.KEY){var cellNode=prf.getSubNode("CELL",cell.id),absPos=cellNode.offset(null,prf.getSubNode("SCROLL22")),size=cellNode.cssSize();editor.setLeft(absPos.left-1).setTop(absPos.top-1).setWidth(size.width+borderW+1).setHeight(size.height+borderW).reLayout(!0)}}return this}},Before:function(key,parent_key,o){return"xui.UI.TreeGrid"==key&&(this.Behaviors.CELLS1=this.Behaviors.CELLS2,this.Behaviors.GCELLA=this.Behaviors.CELLA),arguments.callee.upper.apply(this,arguments)},Initialize:function(){this.addTemplateKeys(["ALT","PROGRESS"]),this.getCellPro=this.getCellOption;var p=this.prototype;p.getColumn=p.getHeader,p.updateColumn=p.updateHeader,p.getColByDom=p.getHeaderByDom,p.getColByColId=p.getHeaderByColId,p.getColByCell=p.getHeaderByCell},Static:{HasHtmlTableNode:1,DIRYMARKICON:"DIRTYMARK",Templates:{tagName:"div",style:"{_style}",className:"{_className}",BORDER:{tagName:"div",BOX:{tagName:"table",cellspacing:"0",cellpadding:"0",className:"xui-uibase",TBODY:{tagName:"tbody",TRHEADER:{tagName:"tr",className:"xuitgtr",TDHEADER1:{tagName:"td",className:"xuitgtd",HEADER1:{tagName:"div",className:"xuitgtd",style:"{showHeader}",HI1:{tagName:"div",HCELLS1:{tagName:"div",style:"{headerHeight}",FHCELL:{$order:0,style:"{rowHandlerDisplay};{_row0DfW};height:{_hcellheight};",className:"xui-uiborder-noradius xui-uibar xui-uiborder-outset {cellCls}",tabindex:"{_tabindex}",HCELLA:{style:"{firstCellStyle};",className:"xui-v-wrapper xui-showfocus {firstCellClass}",HHANDLER:{tagName:"div",style:"{colDDDisplay}"},FHANDLER:{tagName:"div",style:"{rowDDDisplay}"},HFMARK:{$order:1,className:"xuifont",$fonticon:"xui-uicmd-check",style:"{_rowMarkDisplay}"},LTAGCMDS:{$order:2,tagName:"span",className:"xui-ltag-cmds",style:"{_ltagDisplay}",text:"{ltagCmds}"},GRIDCAPTION:{$order:5,text:"{gridHandlerCaption}"},SORT:{className:"xuifont",$fonticon:"xui-icon-sort",style:"{sortDisplay}"}}},OTHERHCELLS:{$order:1,tagName:"text",text:"{header1}"}},GRPCELLBOX1:{tagName:"div",style:"{headerHeight};",GRPCELLS:{$order:3,tagName:"text",text:"{grpCols1}"}}}}},TDHEADER2:{tagName:"td",className:"xuitgtd",HEADER2:{$order:0,tagName:"div",style:"{showHeader}",HI2:{tagName:"div",HCELLS2:{tagName:"div",style:"{headerHeight};",OTHERHCELLS:{$order:1,tagName:"text",text:"{header2}"},LHCELL:{$order:2,className:"xui-v-wrapper",LHCELLINNER:{$order:1,text:"{headerTail}"},RTAGCMDS:{$order:1,tagName:"span",className:"xui-rtag-cmds",style:"{_rtagDisplay}",text:"{rtagCmds}"}}},GRPCELLBOX2:{tagName:"div",style:"{headerHeight};",GRPCELLS:{$order:3,tagName:"text",text:"{grpCols2}"}}}}}},TRLOCKED1:{tagName:"tr",className:"xuitgtr",TDBODY11:{tagName:"td",className:"xuitgtd",SCROLL11:{$order:1,tagName:"div",className:"",BODY11:{tagName:"div",ROWS11:{$order:1,tagName:"div",text:"{rows11}"}}}},TDBODY12:{tagName:"td",className:"xuitgtd",SCROLL12:{$order:1,tagName:"div",className:"{_rowfreezed}",BODY12:{tagName:"div",ROWS12:{$order:1,tagName:"div",text:"{rows12}"}}}}},TRBODY:{tagName:"tr",className:"xuitgtr",TDBODY21:{tagName:"td",className:"xuitgtd",SCROLL21:{$order:1,tagName:"div",className:"{_columnfreezed}",BODY21:{tagName:"div",ROWS21:{$order:1,tagName:"div",text:"{rows21}"}}}},TDBODY22:{tagName:"td",className:"xuitgtd",SCROLL22:{$order:1,tagName:"div",BODY22:{tagName:"div",ROWS22:{$order:1,tagName:"div",text:"{rows22}"}}}}},TRTAIL:{tagName:"tr",className:"xuitgtr",TDTAIL1:{tagName:"td",className:"xuitgtd"},TDTAIL2:{tagName:"td",className:"xuitgtd"}}}},COLLIST:{tagName:"div",COLLISTDROP:{className:"xuifont xui-special-icon",$fonticon:"xui-icon-triangle-down"}},ARROW:{className:"xuifont xui-special-icon",$fonticon:"xui-icon-bigup",text:"&nbsp;"}},DIRTYMARK:{},$submap:{header1:function(profile,template,v,tag,result,index){if(!(index>profile.properties.freezedColumn))return profile.colMap[v._serialId]._region=1,xui.UI.$doTemplate(profile,template,v,"header",result),"header"},header2:function(profile,template,v,tag,result,index){if(index>profile.properties.freezedColumn)return profile.colMap[v._serialId]._region=2,xui.UI.$doTemplate(profile,template,v,"header",result),"header"},header:{HCELL:{style:"width:{_cellWidth};height:{_hcellheight};{colDisplay};",className:"xui-uiborder-noradius xui-uibar xui-uiborder-outset {cellCls}",HCELLA:{className:"xui-v-wrapper xui-showfocus {headerClass}",style:"{headerStyle};{colStyle}",tabindex:"{_tabindex}",HCELLCAPTION:{$order:5,className:"xui-v-node",text:"{caption}"},SORT:{className:"xuifont",$fonticon:"xui-icon-sort",style:"{sortDisplay}"},HHANDLER:{$order:2,tagName:"div",style:"{colDDDisplay}"}}}},grpCols1:function(profile,template,v,tag,result,index){index=profile.properties.freezedColumn-1;var map=profile.colMap;if(!(v.from>index))return v.to>index?(map[v._serialId]._region=2,map[v._serialId]._shadow=1,tag="grpColsShadow",xui.UI.$doTemplate(profile,template,v,tag,result)):(map[v._serialId]._region=1,tag="grpCols",xui.UI.$doTemplate(profile,template,v,tag,result)),tag},grpCols2:function(profile,template,v,tag,result,index){if(index=profile.properties.freezedColumn-1,v.to>index)return profile.colMap[v._serialId]._region=2,xui.UI.$doTemplate(profile,template,v,"grpCols",result),"grpCols"},grpColsShadow:{HSCELL:{style:"position:absolute;width:{_cellWidth};height:{_hcellheight};top:{_hcelltop};left:{_hcellleft};",className:"xui-uiborder-noradius xui-uibar xui-uiborder-outset {cellCls}",HSCELLA:{className:"xui-v-wrapper xui-showfocus {headerClass}",style:"{headerStyle};{colStyle}",tabindex:"{_tabindex}",HSCELLCAPTION:{className:"xui-v-node",text:"{caption}"}}}},grpCols:{HCELL:{style:"position:absolute;width:{_cellWidth};height:{_hcellheight};top:{_hcelltop};left:{_hcellleft};",className:"xui-uiborder-noradius xui-uibar xui-uiborder-outset {cellCls}",HCELLA:{className:"xui-v-wrapper xui-showfocus {headerClass}",style:"{headerStyle};{colStyle}",tabindex:"{_tabindex}",HCELLCAPTION:{$order:5,className:"xui-v-node",text:"{caption}"},HHANDLER:{$order:2,tagName:"div",style:"{colDDDisplay}"}}}},rows11:function(profile,template,v,tag,result,index){return!profile._passFreezedRow&&!(index>profile.properties.freezedRow)&&(profile.rowMap[v._serialId]._region=1,void xui.UI.$doTemplate(profile,template,v,"row1",result,index,"rows1"))},rows12:function(profile,template,v,tag,result,index){return!profile._passFreezedRow&&!(index>profile.properties.freezedRow)&&(profile.rowMap[v._serialId]._region=1,void xui.UI.$doTemplate(profile,template,v,"row2",result,index,"rows2"))},rows21:function(profile,template,v,tag,result,index){!profile._passFreezedRow&&index<=profile.properties.freezedRow||(profile.rowMap[v._serialId]._region=2,xui.UI.$doTemplate(profile,template,v,"row1",result,index,"rows1"))},rows22:function(profile,template,v,tag,result,index){!profile._passFreezedRow&&index<=profile.properties.freezedRow||(profile._passFreezedRow=1,profile.rowMap[v._serialId]._region=2,xui.UI.$doTemplate(profile,template,v,"row2",result,index,"rows2"))},row1:{ROW1:{tagName:"div",style:"{rowDisplay}",CELLS1:{$order:2,tagName:"div",className:"xui-uirowbg xui-uiborder-b xui-uiborder-light {rowCls} {rowClass}",style:"{_rowHeight};{rowStyle}",CELLHANDLER:{tagName:"text",text:"{_handler_cell}"},GRPCELL2:{tagName:"text",text:"{_firstcell_grp}"},OTHERCELLS:{tagName:"text",$order:2,text:"{cells}"}},SUB1:{$order:3,tagName:"div"}}},row2:{ROW2:{tagName:"div",style:"{rowDisplay}",CELLS2:{$order:2,tagName:"div",className:"xui-uirowbg xui-uiborder-b xui-uiborder-light {rowCls} {rowClass}",style:"{_rowHeight};{rowStyle}",GRPCELL2:{tagName:"text",text:"{_firstcell_grp}"},OTHERCELLS:{tagName:"text",$order:2,text:"{cells}"},LCELL:{$order:3,className:"xui-v-wrapper",LCELLINNER:{$order:1,text:"{rowTail}"},RTAGCMDS:{$order:2,tagName:"span",className:"xui-rtag-cmds",text:"{rtagCmds}"}}},SUB2:{$order:3,tagName:"div"}}},"rows1._handler_cell":function(profile,template,v,tag,result,index){xui.UI.$doTemplate(profile,template,v,"infirstcell"==profile.properties.treeMode?"rows1._handler_cell2":"rows1._handler_cell1",result)},"rows1._handler_cell1":{FCELL:{$order:0,style:"{rowHandlerDisplay};{_row0DfW};",className:"xui-uiborder-r xui-uiborder-light {cellCls}",CELLA:{tabindex:"{_tabindex}",style:"{cellStyle}{firstCellStyle}",className:"xui-v-wrapper xui-showfocus {cellClass}{firstCellClass}",ROWLRULER:{$order:1,style:"{_treeMode};{_rulerW}"},MARK:{$order:2,className:"xuifont",$fonticon:"xui-uicmd-check",style:"{_rowMarkDisplay}"},ROWNUM:{$order:3,className:"xui-ui-readonly",style:"{_rowNumbDisplay}"},ROWTOGGLE:{$order:4,style:"{_treeMode};",className:"xuifont",$fonticon:"{_fi_togglemark}"},LTAGCMDS:{$order:5,tagName:"span",className:"xui-ltag-cmds",style:"{_ltagDisplay}",text:"{ltagCmds}"},FCELLCAPTION:{$order:6,className:"xui-v-node",text:"{caption}"},FHANDLER:{$order:0,tagName:"div",style:"{rowDDDisplay}"}}}},"rows1._handler_cell2":{FCELL:{$order:0,style:"{rowHandlerDisplay};{_row0DfW};",className:"xui-uiborder-r xui-uiborder-light {cellCls}",CELLA:{tabindex:"{_tabindex}",style:"{cellStyle}{firstCellStyle}",className:"xui-v-wrapper xui-showfocus {cellClass}{firstCellClass}",FHANDLER:{$order:6,tagName:"div",style:"{rowDDDisplay}"}}}},"rows1._firstcell_grp":function(profile,template,v,tag,result,index){"infirstcell"==profile.properties.treeMode&&profile.properties.freezedColumn&&xui.UI.$doTemplate(profile,template,v,"rows._firstcell_grp",result)},"rows2._firstcell_grp":function(profile,template,v,tag,result,index){"infirstcell"==profile.properties.treeMode&&(profile.properties.freezedColumn||xui.UI.$doTemplate(profile,template,v,"rows._firstcell_grp",result))},"rows._firstcell_grp":{GCELL:{$order:0,className:"{cellCls}",GCELLA:{tabindex:"{_tabindex}",style:"{cellStyle}{firstCellStyle}",className:"xui-v-wrapper xui-showfocus {cellClass}{firstCellClass}",ROWLRULER:{$order:1,$customId:1,style:"{_treeMode};{_rulerW}"},MARK:{$order:2,$customId:1,className:"xuifont",$fonticon:"xui-uicmd-check",style:"{_rowMarkDisplay}"},ROWNUM:{$order:3,$customId:1,className:"xui-ui-readonly",style:"{_rowNumbDisplay}"},ROWTOGGLE:{$order:4,$customId:1,style:"{_treeMode};",className:"xuifont",$fonticon:"{_fi_togglemark}"},LTAGCMDS:{$order:5,$customId:1,tagName:"span",style:"{_ltagDisplay}",text:"{ltagCmds}"},FCELLCAPTION:{$order:6,$customId:1,className:"xui-v-node",text:"{caption}"}}}},"rows1.cells":function(profile,template,v,tag,result,index){if(!(index>profile.properties.freezedColumn)){tag="rows.cells";var t=profile.box._tplMap2[v.type]||".input";return"infirstcell"==profile.properties.treeMode&&1==index&&".input"==t&&(t="._first_cell"),xui.UI.$doTemplate(profile,template,v,tag+t,result),tag}},"rows2.cells":function(profile,template,v,tag,result,index){if(!(index<=profile.properties.freezedColumn)){tag="rows.cells";var t=profile.box._tplMap2[v.type]||".input";return"infirstcell"==profile.properties.treeMode&&1==index&&".input"==t&&(t="._first_cell"),xui.UI.$doTemplate(profile,template,v,tag+t,result),tag}},"rows.cells._first_cell":{CELL:{style:"width:{_cellWidth};{cellDisplay};",className:"xui-uiborder-r xui-uiborder-light xui-treegrid-fcell {cellCls}",CELLA:{className:"xui-v-wrapper xui-showfocus {cellClass}",style:"{bgcolor};{cellStyle}",tabindex:"{_tabindex}",ROWLRULER:{$order:1,$customId:1,style:"{_treeMode};{_rulerW}"},MARK:{$order:2,$customId:1,className:"xuifont",$fonticon:"xui-uicmd-check",style:"{_rowMarkDisplay}"},ROWNUM:{$order:3,$customId:1,className:"xui-ui-readonly",style:"{_rowNumbDisplay}"},ROWTOGGLE:{$order:4,$customId:1,style:"{_treeMode};",className:"xuifont",$fonticon:"{_fi_togglemark}"},LTAGCMDS:{$order:5,$customId:1,tagName:"span",style:"{_ltagDisplay}",text:"{ltagCmds}"},CELLCAPTION:{$order:6,style:"{color}",className:"xui-v-node xui-treegrid-fcellcaption",text:"{_caption}"}}}},"rows.cells.input":{CELL:{style:"width:{_cellWidth};{cellDisplay};",className:"xui-uiborder-r xui-uiborder-light {cellCls}",CELLA:{className:"xui-v-wrapper xui-showfocus {cellClass}",style:"{bgcolor};{cellStyle}",tabindex:"{_tabindex}",CELLCAPTION:{className:"xui-v-node",style:"{color}",text:"{_caption}"}}}},"rows.cells.textarea":{CELL:{style:"width:{_cellWidth};{cellDisplay};",className:"xui-uiborder-r xui-uiborder-light {cellCls}",CELLA:{className:"xui-v-wrapper xui-showfocus xui-cls-wordwrap {cellClass}",style:"{bgcolor};{cellStyle}",tabindex:"{_tabindex}",CELLCAPTION:{className:"xui-v-node",style:"{color}",text:"{_caption}"}}}},"rows.cells.button":{CELL:{style:"width:{_cellWidth};{cellDisplay};",className:"xui-uiborder-r xui-uiborder-light {cellCls}",CELLA:{tagName:"button",className:"xui-node xui-showfocus xui-wrapper xui-ui-btn xui-uibar xui-uigradient xui-uiborder-radius xui-treegrid-tgbtn {cellClass}",style:"{cellStyle}",tabindex:"{_tabindex}",CELLCAPTION:{className:"xui-v-node",text:"{_caption}"}}}},"rows.cells.checkbox":{CELL:{style:"width:{_cellWidth};{cellDisplay}",className:"xui-uiborder-r xui-uiborder-light {cellCls}",CELLA:{className:"xui-v-wrapper xui-showfocus {cellClass}",style:"{cellStyle}",tabindex:"{_tabindex}",CHECKBOX:{className:"xuifont xui-uicmd-check",$fonticon:"{_fi_checkboxCls}"},CELLCAPTION:{className:"xui-v-node",text:"{_caption}"}}}},"rows.cells.progress":{CELL:{style:"width:{_cellWidth};{cellDisplay}",className:"xui-uiborder-r xui-uiborder-light {cellCls}",CELLA:{className:"xui-showfocus {cellClass}",style:"{cellStyle}",tabindex:"{_tabindex}",PROGRESS:{$order:2,tagName:"div",className:"xui-v-wrapper xui-uibar",style:"width:{progress};",CELLCAPTION:{className:"xui-v-node",text:"{_caption}"}}}}},"rows1._handler_cell1.ltagCmds":function(profile,template,v,tag,result){v.id!=profile.box._temprowid&&xui.UI.$doTemplate(profile,template,v,"rows.tagCmds"+(profile.box._tplMap[v.type]||".button"),result)},"rows._firstcell_grp.ltagCmds":function(profile,template,v,tag,result){xui.UI.$doTemplate(profile,template,v,"rows.tagCmds"+(profile.box._tplMap[v.type]||".button"),result)},"rows.cells._first_cell.ltagCmds":function(profile,template,v,tag,result){xui.UI.$doTemplate(profile,template,v,"rows.tagCmds"+(profile.box._tplMap[v.type]||".button"),result)},"rows2.rtagCmds":function(profile,template,v,tag,result){xui.UI.$doTemplate(profile,template,v,"rows.tagCmds"+(profile.box._tplMap[v.type]||".button"),result)},ltagCmds:function(profile,template,v,tag,result){xui.UI.$doTemplate(profile,template,v,"rows.tagCmds"+(profile.box._tplMap[v.type]||".button"),result)},rtagCmds:function(profile,template,v,tag,result){xui.UI.$doTemplate(profile,template,v,"rows.tagCmds"+(profile.box._tplMap[v.type]||".button"),result)},"rows.tagCmds.text":xui.UI.$getTagCmdsTpl("text"),"rows.tagCmds.button":xui.UI.$getTagCmdsTpl("button"),"rows.tagCmds.image":xui.UI.$getTagCmdsTpl("image")}},Appearances:{KEY:{display:"block",position:"absolute",overflow:"hidden"},"KEY .xuitgtd, KEY .xuitgth, KEY .xuitgtr":{border:"0!important",padding:"0!important",margin:"0!important",height:"auto!important",width:"auto!important"},"LTAGCMDS, RTAGCMDS":{padding:0,margin:0,"vertical-align":"middle"},"HFMARK, MARK":{"margin-right":".5em"},DIRTYMARK:{position:"absolute",width:"1em",height:"1em",left:"1px",top:"1px","z-index":10},BOX:{"border-collapse":"collapse",height:"100%",width:"100%"},"HEADER1, HEADER2":{"background-color":"#EDEDED",position:"relative",overflow:"hidden","text-align":"left"},"HI1, HI2":{position:"relative"},"GRPCELLBOX1, GRPCELLBOX2":{position:"absolute",overflow:"visible",left:0,top:0,width:0,height:0},"SCROLL11, SCROLL12, SCROLL21, SCROLL22":{position:"relative","text-align":"left"},"SCROLL11, SCROLL12, SCROLL21":{overflow:"hidden"},SCROLL22:{overflow:"auto"},ARROW:{position:"absolute","z-index":"20",left:0,top:0,display:"none",width:"auto",height:"auto","font-weight":"bold","text-align":"center","font-size":"2em"},"ARROW:before":{"margin-left":"-50%"},COLLIST:{position:"absolute","z-index":"10",left:0,top:0,cursor:"pointer",visibility:"hidden"},COLLISTDROP:{position:"absolute",left:0,bottom:0,cursor:"pointer"},"BODY11, BODY12, BODY21, BODY22":{overflow:"visible",position:"absolute",left:0,top:0},SORT:{position:"absolute",right:".25em",bottom:".25em"},HHANDLER:{position:"absolute",background:xui.browser.ie?"url("+xui.ini.img_bg+")":null,width:".5em",top:"0",right:"0",height:"100%",cursor:"e-resize"},"HCELLS1, HCELLS2, CELLS1, CELLS2":{"overflow-y":xui.browser.ie?"hidden":"",position:"relative",background:"transparent","white-space":"nowrap"},"HCELLS1, HCELLS2, GRPCELLBOX1, GRPCELLBOX2":{overflow:"visible"},"CELLS1, CELLS2":{overflow:"visible"},"CELLS1-group FCELL, CELLS2-group FCELL":{"border-right":0,"padding-right":"1px",overflow:"visible"},"CELLS1-group FCELLCAPTION, CELLS2-group FCELLCAPTION":{"font-weight":"bold"},"CELLS1-group FCELLCAPTION, CELLS1-group CELLA,  CELLS1-group GCELLA, CELLS1-group ROWNUM, CELLS2-group FCELLCAPTION, CELLS2-group CELLA, CELLS2-group GCELLA":{overflow:"visible"},"CELLS1-active, CELLS2-active, CELLA-active":{$order:5,"background-color":"#DDDDDD"},"CELLS1-hot, CELLS2-hot":{$order:6,"background-color":"#FFE97F"},"CELLS2-hot LTAGCMDS, CELLS2-hot RTAGCMDS":{$order:6,display:"none"},"CELLS1-checked, CELLS2-checked, CELLS1-checked .xui-node, CELLS2-checked .xui-node, CELLA-checked, CELLA-checked .xui-node":{$order:6,"background-color":"#ABABAB",color:"#fff"},"FCELL CELLA, GCELL GCELLA":{"text-align":"left"},"FHCELL HCELLA, HSCELLA":{"text-align":"center"},"CELLCAPTION,HCELLCAPTION,HSCELLCAPTION,SORT,HHANDLER":{"vertical-align":"middle"},"CELLCAPTION,HCELLCAPTION,HSCELLCAPTION,FCELLCAPTION,GRIDCAPTION":{"max-width":"100%","text-overflow":"ellipsis","white-space":"nowrap",overflow:"hidden","font-size":"1em"},"FCELL FCELLCAPTION, FHCELL GRIDCAPTION":{display:"inline"},"CELL-textarea CELLCAPTION":{$order:10,"white-space":"normal"},FHANDLER:{position:"absolute",height:".5em",left:"0",width:"100%",bottom:"0",cursor:"n-resize","z-index":10},"FCELLCAPTION, ROWNUM":{"vertical-align":"middle",overflow:"hidden"},"FHCELL, HCELL, HSCELL":{padding:0,"vertical-align":"bottom"},"ROW1, ROW2":{position:"relative",zoom:xui.browser.ie?1:null,width:xui.browser.ie?"100%":null},ROWNUM:{"padding-right":".5em"},"FCELL, CELL":{height:"100%","padding-left":"1px",position:"relative",overflow:xui.browser.ie6?"hidden":"","vertical-align":"top",display:xui.$inlineBlock},GCELL:{height:"100%",width:"100%","padding-left":"1px",position:"relative",overflow:xui.browser.ie6?"hidden":"","vertical-align":"top",display:xui.$inlineBlock},"LHCELL, LCELL":{height:"100%",position:"relative","vertical-align":"top"},"CELLS1-alt, CELLS2-alt":{$order:1,"background-color":"#EFF8FF"},"CELL-input":{},"CELL-number, CELL-spin, CELL-currency":{"text-align":"right"},"CELL-counter":{"text-align":"center"},"CELL-checkbox":{"text-align":"center"},"KEY-tgbtn":{$order:100,width:"100%",padding:0,"vertical-align":"text-bottom","line-height":"100%",height:"100%"},"CELLS1-hover, CELLS2-hover":{$order:4,"background-color":"#F6F6F6"},'CELLA-hover, CELLA-hover .xui-node[class*="xui-treegrid-"]':{$order:5,"background-color":"#C5C5C5 !important"},"FCELL CELLA, GCELL GCELLA, HCELLA, HSCELLA":{position:"relative","text-overflow":"ellipsis"},"HCELLA, HSCELLA":{$order:3,"text-align":"center","vertical-align":"middle","line-height":"inherit"},"HCELLA, HSCELLA, CELLA, GCELLA":{display:"block",overflow:"hidden","-moz-box-flex":"1","outline-offset":"-1px","-moz-outline-offset":xui.browser.gek&&xui.browser.ver<3?"-1px !important":null,height:"100%",width:xui.browser.ie?"100%":"","line-height":"inherit"},"FCELL.editing CELLA, CELL.editing CELLA":{"text-overflow":"unset!important"},"FCELL.editing CELLCAPTION, CELL.editing CELLCAPTION":{visibility:"hidden!important"},"CELLA-inline":{$order:5,display:xui.$inlineBlock,width:"auto","-moz-box-flex":0},PROGRESS:{border:"none",height:"100%","line-height":"1.83333em",overflow:"visible",opacity:.7,"*filter":"alpha(opacity=70)"},"PROGRESS CELLCAPTION":{overflow:"visible"},"CHECKBOX, MARK":{cursor:"pointer","vertical-align":"middle"},"SUB1, SUM22":{zoom:xui.browser.ie?1:null,height:0,position:"relative",overflow:"visible"},ROWTOGGLE:{padding:"0 .334em 0 0"}},_objectProp:{rowOptions:1,colOptions:1},Behaviors:{HoverEffected:{ROWTOGGLE:"ROWTOGGLE",GCELL:"GCELLA",CELL:"CELLA",HCELL:["HCELLA","HSCELLA"],HSCELL:["HCELLA","HSCELLA"],FHCELL:"HCELLA",FCELL:"CELLA",CMD:"CMD",SCROLL22:"SCROLL22",BODY11:"BODY11",BODY12:"BODY12",BODY21:"BODY22",BODY22:"BODY22",HEADER1:"HEADER1",HEADER2:"HEADER2"},ClickEffected:{ROWTOGGLE:"ROWTOGGLE",GCELL:"GCELLA",CELL:"CELLA",HCELL:["HCELLA","HSCELLA"],HSCELL:["HCELLA","HSCELLA"],CMD:"CMD"},DraggableKeys:["FCELL"],DroppableKeys:["SCROLL21","SCROLL22","CELLS1","CELLS2","FCELL"],HFMARK:{onClick:function(profile,e,src){if("multi"==profile.properties.selMode||"multibycheckbox"==profile.properties.selMode){var rows=[];return xui.each(profile.rowMap,(function(o){rows.push(o.id)})),profile._$checkAll?(delete profile._$checkAll,profile.boxing().setUIValue("",null,null,"checkbox"),xui.use(src).tagClass("-checked",!1),profile.boxing().onRowSelected(profile,"allrows",e,src,-1)):(profile._$checkAll=!0,xui.use(src).tagClass("-checked"),profile.boxing().setUIValue(rows.join(profile.properties.valueSeparator),null,null,"click"),profile.boxing().onRowSelected(profile,"allrows",e,src,1)),!1}}},TRLOCKED1:{onMouseover:function(profile,e,src){profile.box.$cancelHoverEditor(profile)}},TRTAIL:{onMouseover:function(profile,e,src){profile.box.$cancelHoverEditor(profile)}},TDBODY21:{onMouseover:function(profile,e,src){profile.box.$cancelHoverEditor(profile)}},TRHEADER:{onMouseover:function(profile,e,src){profile.box.$cancelHoverEditor(profile)}},SCROLL22:{onScroll:function(profile,e,src){var node=xui.use(src).get(0),l=node.scrollLeft||0,t=node.scrollTop||0;profile.$sl!=l&&profile.getSubNodes(["HEADER2","SCROLL12"]).scrollLeft(profile.$sl=l),profile.$st!=t&&(profile.getSubNode("SCROLL21").get(0).scrollTop=profile.$st=t,(t=profile.getSubNode("SCROLL21").get(0).scrollTop)&&t!=profile.$st&&(node.scrollTop=profile.$st=t))},onMousedown:function(profile,e,src){xui.Event.getSrc(e)==xui(src).get(0)&&profile.__hastmpRow&&profile.__needchecktmprow&&profile.box._checkNewLine(profile,"oninner")}},SCROLL21:{onScroll:function(profile,e,src){var t=xui.use(src).get(0).scrollTop||0;profile.$st!=t&&(profile.getSubNode("SCROLL22").get(0).scrollTop=profile.$st=t)},onMousedown:function(profile,e,src){xui.Event.getSrc(e)==xui(src).get(0)&&profile.__hastmpRow&&profile.__needchecktmprow&&profile.box._checkNewLine(profile,"oninner")}},HEADER2:{onScroll:function(profile,e,src){var l=xui.use(src).get(0).scrollLeft||0;profile.$sl!=l&&profile.getSubNodes(["SCROLL12","SCROLL22"]).scrollLeft(profile.$sl=l)}},SCROLL12:{onScroll:function(profile,e,src){var l=xui.use(src).get(0).scrollLeft||0;profile.$sl!=l&&profile.getSubNodes(["HEADER2","SCROLL22"]).scrollLeft(profile.$sl=l)}},HHANDLER:{beforeMousedown:function(profile,e,src){if("left"==xui.Event.getBtn(e)){var o,p=profile.properties,id=profile.getSubId(src),col=profile.colMap[id],minW=(o=col&&col._isgroup?profile.getSubNode("HHANDLER",profile.properties.header[col.to]._serialId):xui(src)).parent(2).width()-profile.$px(p._minColW),scroll=profile.getSubNode("SCROLL22"),maxW=scroll.offset().left+scroll.width()-xui.Event.getPos(e).left-4;if(p.disabled)return!1;if(col&&col.disabled)return!1;o.startDrag(e,{horizontalOnly:!0,dragType:"blank",dragDefer:2,maxLeftOffset:minW,maxRightOffset:maxW,targetReposition:!1}),xui.use(src).parent(2).onMouseout(!0,{$force:!0}).onMouseup(!0)}},onDragbegin:function(profile,e,src){xui.DragDrop.getProfile().proxyNode.css({height:profile.getRoot().height()+"px",width:"4px",backgroundColor:"#DDDDDD",cursor:"e-resize"})},onDrag:function(profile,e,src){var p=xui.DragDrop.getProfile(),b=0;(p.x<=p.restrictedLeft||p.x>=p.restrictedRight)&&(b=!0),b?profile._limited||(p.proxyNode.css("backgroundColor","#ff6600"),profile._limited=!0):profile._limited&&(p.proxyNode.css("backgroundColor","#DDDDDD"),profile._limited=0)},onDragstop:function(profile,e,src){profile.properties;var o=xui(src).parent(2),ks=profile.keys,col=profile.colMap[profile.getSubId(src)],oldw=o.width(),w=oldw+xui.DragDrop.getProfile().offset.x;if(col&&(col&&col._isgroup&&(col=profile.properties.header[col.to],o=profile.getSubNode("HCELL",col._serialId)),col.hasOwnProperty("maxWidth")&&(w=Math.min(profile.$px(col.maxWidth),w)),col.hasOwnProperty("minWidth")&&(w=Math.max(profile.$px(col.minWidth),w))),profile.beforeColResized&&!1===profile.boxing().beforeColResized(profile,col?col.id:null,w))profile._limited=0;else{if(emw=profile.$forceu(w),o.width(emw),col){if(col.flexSize){var emw=parseFloat(col.width),percent=w/profile._relAvailable,oldPercent=oldw/profile._relAvailable;col.width=(emw/oldPercent-emw)*percent/(1-percent)+profile.$picku(col.width)}else col.width=emw;col._colWidth=emw}var ids=[];if(profile.getKey(xui.use(src).parent(2).id())==ks.FHCELL)profile.box._setRowHanderW(profile,w);else{var t,cells=col._cells;xui.each(cells,(function(o){(t=profile.getSubNode(ks.CELL,o)).isEmpty()||ids.push(t.id())})),profile.box._adjusteditorW(profile,xui(ids).width(emw),w)}profile.afterColResized&&profile.boxing().afterColResized(profile,col?col.id:null,w),profile.getSubNode("SCROLL22").onScroll(),profile.box._adjustColsWidth(profile),profile.box._adjustBody(profile,"setcol"),profile._limited=0}},onClick:function(){return!1},onDblclick:function(profile,e,src){var p=profile.properties,o=xui.use(src).parent(2),id=profile.getSubId(src),col=profile.colMap[id];if(col&&col._isgroup&&(col=profile.properties.header[col.to],o=profile.getSubNode("HCELL",col._serialId)),!(col&&col.flexSize||profile.getRootNode().clientHeight<=0))if(profile.getKey(xui.use(src).parent(2).id())!=profile.keys.FHCELL){var n,w,emw,cells=col._cells,cls=profile.getClass("CELLA","-inline"),nodes=[],ws=[];if(xui.each(cells,(function(o){(n=profile.getSubNode("CELLA",o))._nodes.length&&(nodes.push(n.get(0)),ws.push(n.addClass(cls).width()))})),"infirstcell"==p.treeMode&&p.header[0]==col&&profile.getSubNode("GCELLA",!0).each((function(o){ws.push(xui(o).addClass(cls).width()),xui(o).removeClass(cls)})),ws.push(profile.$px(p._minColW)),(w=parseFloat(Math.max.apply(null,ws)))>profile.$px(p._maxColW)&&(w=profile.$px(p._maxColW)),!profile.beforeColResized||!1!==profile.boxing().beforeColResized(profile,col?col.id:null,w))return col&&(col.hasOwnProperty("maxWidth")&&(w=Math.min(profile.$px(col.maxWidth),w)),col.hasOwnProperty("minWidth")&&(w=Math.max(profile.$px(col.minWidth),w))),w+=2,emw=profile.$forceu(w),profile.box._adjusteditorW(profile,xui(nodes).parent().width(emw),w),o.width(col.width=col._colWidth=emw),xui(nodes).removeClass(cls),profile.afterColResized&&profile.boxing().afterColResized(profile,col.id,w),profile.box._adjustColsWidth(profile),profile.box._adjustBody(profile,"setcol"),!1}else profile.box._setRowHanderW(profile,!0)}},FHANDLER:{beforeMousedown:function(profile,e,src){if("left"==xui.Event.getBtn(e)){var p=profile.properties,row=profile.rowMap[profile.getSubId(src)],o=xui(src),minH=o.parent(3).height()-profile.$px(p._minRowH),scroll=profile.getSubNode("SCROLL21"),maxH=scroll.offset().top+scroll.height()-xui.Event.getPos(e).top-4;if(p.disabled||row&&row.disabled)return!1;o.startDrag(e,{verticalOnly:!0,dragType:"blank",dragDefer:2,maxTopOffset:minH,maxBottomOffset:maxH,targetReposition:!1}),xui.use(src).parent(2).onMouseout(!0,{$force:!0}).onMouseup(!0),row||profile.getSubNode("COLLIST").css("visibility","hidden")}},onDragbegin:function(profile,e,src){xui.DragDrop.getProfile().proxyNode.css({width:profile.getRoot().width()+"px",height:"4px",backgroundColor:"#DDDDDD",cursor:"n-resize"})},onDrag:function(profile,e,src){var p=xui.DragDrop.getProfile(),b=0;(p.y<=p.restrictedTop||p.y>=p.restrictedBottom)&&(b=!0),b?profile._limited||(p.proxyNode.css("backgroundColor","#ff6600"),profile._limited=!0):profile._limited&&(p.proxyNode.css("backgroundColor","#DDDDDD"),profile._limited=0)},onDragstop:function(profile,e,src){var subId=profile.getSubId(src),o=xui(src).parent(3),h=o.height()+xui.DragDrop.getProfile().offset.y,row=profile.rowMap[profile.getSubId(src)],prop=profile.properties;prop.header,prop.headerHeight,xui.browser.ie&&xui.browser.ver<=8&&h%2==1&&(h+=1),profile.beforeRowResized&&!1===profile.boxing().beforeRowResized(profile,row?row.id:null,h)||(profile.getKey(xui.use(src).parent(2).id())==profile.keys.FHCELL?(prop.headerHeight=profile.$forceu(h),profile.box._adjustColsHeight(profile),profile.adjustSize()):(row.height=profile.$forceu(h),profile.getSubNode("CELLS2",subId).height(row.height),o.height(row._rowHeight=row.height),profile.box._adjusteditorH(profile,o,row._rowHeight)),profile.afterRowResized&&profile.boxing().afterRowResized(profile,row?row.id:null,h),profile.box._adjustBody(profile,"setrow")),profile._limited=0},onDblclick:function(profile,e,src){var row,cells,prop=profile.properties,sid=profile.getSubId(src);if(!(profile.getRootNode().clientHeight<=0)){if(sid){row=profile.rowMap[sid];var h=(cells=profile.getSubNodes(["CELLS2","CELLS1"],sid)).height("auto").height();if(profile.beforeRowResized&&!1===profile.boxing().beforeRowResized(profile,row.id,h))return;cells.height(row.height=row._rowHeight=profile.$forceu(h)),profile.box._adjusteditorH(profile,cells,h)}else{if(h=(profile._headerLayers||1)*profile.$px(profile.box.$DataStruct.headerHeight),profile.beforeRowResized&&!1===profile.boxing().beforeRowResized(profile,null,h))return;profile.box._adjustColsHeight(profile,!0),prop.headerHeight=profile.$forceu(h,profile.$picku(prop.headerHeight)),profile.adjustSize()}return profile.afterRowResized&&profile.boxing().afterRowResized(profile,row?row.id:null,h),profile.box._adjustBody(profile,"setrow"),!1}},onClick:function(){return!1}},ROWTOGGLE:{onClick:function(profile,e,src){var cell,p=profile.properties,row=profile.rowMap[profile.getSubId(src)];if(row||(cell=profile.cellMap[profile.getSubId(src)])&&(row=cell._row),row){if(p.disabled||row.disabled)return!1;if(row.sub)return profile.box._setSub(profile,row,!row._checked),!1}},beforeMousedown:function(){return!1}},HSCELLA:{onClick:function(profile,e,src){profile.getSubNode("HCELLA",profile.getSubId(src)).onClick(!0)}},HCELLA:{onClick:function(profile,e,src){var p=profile.properties,id=profile.getSubId(src),col=profile.colMap[id];if(col){if(profile.onClickHeader&&profile.boxing().onClickHeader(profile,col,e,src),p.disabled||col.disabled)return!1;if(!(col.hasOwnProperty("colSortable")?col.colSortable:p.colSortable))return}else{if(profile.onClickGridHandler&&profile.boxing().onClickGridHandler(profile,e,src),p.disabled)return!1;if(!p.colSortable)return}if(col&&col._isgroup&&(col=profile.properties.header[col.from]),profile.beforeColSorted&&!1===profile.boxing().beforeColSorted(profile,col))return!1;var lastrow,lastrownode1,lastrownode2,order=(col?col._order:profile._order)||!1,type=(col?col.type:null)||"input",sortby=col?col.sortby:null,index=col?xui.arr.indexOf(p.header,col):-1,me=arguments.callee,fun=me.fun||(me.fun=function(profile,subNode,index,type,sortby,order,lastrownode1,lastrownode2){var rows,parent1,parent2,self=arguments.callee;subNode?(rows=subNode.sub,parent1=profile.getSubNode("SUB1",subNode._serialId).get(0),parent2=profile.getSubNode("SUB2",subNode._serialId).get(0)):(subNode={_inited:!0},rows=profile.properties.rows,parent1=profile.getSubNode("ROWS21").get(0),parent2=profile.getSubNode("ROWS22").get(0));var t,ff,sortf,a1=[],a2=[],a4=[],a11=[],a12=[],a31=[],a32=[];if(xui.arr.each(rows,(function(row){1!=row._region&&(row.sub&&row.sub.length>1&&self(profile,row,index,type,sortby,order,null),a1[a1.length]=-1==index?row.caption:(t=row.cells)?(t=t[index])?t.value:"":row[index],a4[a4.length]=-1==index?row:(t=row.cells)?t[index]:row[index],a2[a2.length]=a2.length)})),"function"!=typeof sortby){switch(type){case"number":case"spin":case"counter":case"currency":ff=function(n){return parseFloat(n)||0};break;case"datetime":case"date":ff=function(n){return xui.isDate(n)?n.getTime():xui.isFinite(n)?parseInt(n,10):0};break;default:ff=function(n){return n||""}}sortf=function(x,y){var xx=ff(a1[x]),yy=ff(a1[y]);return xx>yy?order?1:-1:xx===yy?x>y?-1:1:order?-1:1}}else sortf=function(x,y){return sortby.apply(profile,[x,y,a1,order,index,a4])};a2.sort(sortf);var b=subNode._inited,bak=xui.copy(rows);if(b&&(a11=parent1.childNodes,a12=parent2.childNodes),xui.arr.each(a2,(function(o,i){rows[i]=bak[o],b&&(a31[i]=a11[o],a32[i]=a12[o])})),b){for(var fragment1=document.createDocumentFragment(),fragment2=document.createDocumentFragment(),i=0;t=a31[i];i++)fragment1.appendChild(t);for(i=0;t=a32[i];i++)fragment2.appendChild(t);lastrownode1?(parent1.insertBefore(fragment1,lastrownode1),parent2.insertBefore(fragment2,lastrownode2)):(parent1.appendChild(fragment1),parent2.appendChild(fragment2))}});profile.__hastmpRow&&(lastrow=profile.properties.rows.pop(),lastrownode1=profile.getSubNode("ROWS21").get(0).lastChild,lastrownode2=profile.getSubNode("ROWS22").get(0).lastChild),fun(profile,null,index,type,sortby,order,lastrownode1,lastrownode2),profile.__hastmpRow&&profile.properties.rows.push(lastrow),profile.getSubNode("SORT",!0).css("display","none");var node=(col?profile.getSubNode("SORT",col._serialId):profile.getSubNode("SORT")).css("display","");node.tagClass("-checked",col?!(col._order=!col._order):!(profile._order=!profile._order)),profile.box._asy(profile),delete profile.$allrowscache1,delete profile.$allrowscache2,profile.afterColSorted&&profile.boxing().afterColSorted(profile,col)},beforeMousedown:function(profile,e,src){if("left"==xui.Event.getBtn(e)){var p=profile.properties;if(!p.disabled){var col=profile.colMap[profile.getSubId(src)];if(col&&!col._isgroup){if(p.disabled||col.disabled)return!1;if("infirstcell"==p.treeMode&&p.header[0]==col)return!1;if((col.hasOwnProperty("colMovable")?col.colMovable:p.colMovable)&&!1!==profile.boxing().beforeColDrag(profile,col.id)){var pos=xui.Event.getPos(e),o=xui(src);profile.getSubId(src),o.startDrag(e,{dragType:"icon",shadowFrom:o.parent(),dragCursor:"pointer",targetLeft:pos.left+12,targetTop:pos.top+12,targetReposition:!1,dragDefer:2,dragKey:profile.$xid+":col",dragData:o.parent().id(),tagVar:col._region})}}}}},onDragbegin:function(profile,e,src){xui(src).parent().onMouseout(!0,{$force:!0}),xui(src).onMouseup(!0)},beforeMouseover:function(profile,e,src){var p=profile.properties,id=profile.getSubId(src),col=profile.colMap[id];if(col&&!col._isgroup){if(p.disabled||col.disabled)return!1;var dp=xui.DragDrop.getProfile();if(dp.dragData&&dp.dragKey==profile.$xid+":col"&&dp.tagVar==col._region){var psrc=xui.use(src).parent().xid();if(!1!==profile.box._colDragCheck(profile,psrc)){xui.DragDrop.setDropElement(src).setDropFace(src,"move");var nn=xui.use(psrc).get(0),left=nn.offsetLeft+(2==col._region?profile._leftregionw:0),top=nn.offsetTop+nn.offsetHeight;profile.getSubNode("ARROW").left(left).top(top).css("display","block")}}}},beforeMouseout:function(profile,e,src){var p=profile.properties,id=profile.getSubId(src),col=profile.colMap[id];if(col){if(p.disabled||col.disabled)return!1;var dp=xui.DragDrop.getProfile();if(dp.dragData&&dp.dragKey==profile.$xid+":col"){var psrc=xui.use(src).parent().xid();xui.DragDrop.setDropElement(null).setDropFace(null,"none"),!1!==profile.box._colDragCheck(profile,psrc)&&profile.getSubNode("ARROW").css("display","none")}}},onDrop:function(profile,e,src){var p=profile.properties,box=profile.box,id=profile.getSubId(src),SubID=xui.UI.$tag_subId,col=profile.colMap[id];if(col){if(p.disabled||col.disabled)return!1;var psrc=xui.use(src).parent().xid();if(profile.getSubNode("ARROW").css("display","none"),!1!==box._colDragCheck(profile,psrc)){var data=xui.DragDrop.getProfile().dragData,fromId=data&&profile.getSubId(data),toId=profile.getSubId(psrc),map=profile.colMap,fromTh=map[fromId],toTh=map[toId];if(!1!==profile.boxing().beforeColMoved(profile,fromTh.id,toTh.id)){xui.DragDrop.setDropFace(psrc,"none");var fromIndex=xui.arr.subIndexOf(p.header,"_serialId",fromId),toIndex=xui.arr.subIndexOf(p.header,"_serialId",toId);if(fromIndex!==toIndex&&fromIndex!==toIndex-1){profile.getSubNode("HCELL",toId).addPrev(xui(xui.DragDrop.getProfile().dragData)),xui.each(toTh._cells,(function(o,i){profile.getSubNode("CELL",o).addPrev(profile.getSubNode("CELL",fromTh._cells[i]))}));var temp=p.header[fromIndex];xui.arr.insertAny(p.header,temp,toIndex),xui.arr.removeFrom(p.header,fromIndex+(fromIndex>toIndex?1:0));var allitems=profile.queryItems(p.rows,!0,!0);xui.arr.each(allitems,(function(o){(o=o.cells?o.cells:o)&&xui.isArr(o)&&(temp=o[fromIndex],xui.arr.removeFrom(o,fromIndex),xui.arr.insertAny(o,temp,toIndex))}));var arr=p.grpCols;if(arr&&xui.isArr(arr)&&arr.length){for(var j=0,m=arr.length;j<m;j++)(grp=arr[j]).from>toIndex?(grp.from++,grp.to++):toIndex>=grp.from&&toIndex<=grp.to&&grp.to++;var grp;for(j=0,m=arr.length;j<m;j++)(grp=arr[j]).from>fromIndex?(grp.from--,grp.to--):fromIndex>=grp.from&&fromIndex<=grp.to&&grp.to--;xui.filter(arr,(function(o){var r=o.to>=o.from;return!r&&profile.renderId&&(profile.getSubNodes(["HCELL","HSCELL"],o[SubID]).remove(),delete profile.colMap[o[SubID]],delete profile.colMap2[o.id]),r})),p.grpCols=box._adjustGrpColsData(profile,arr),box._adjustColsWidth(profile),box._adjustColsHeight(profile)}profile.boxing().afterColMoved(profile,fromTh.id,toTh.id),delete profile.$allrowscache1,delete profile.$allrowscache2}}}}},onMouseover:function(profile,e,src){var p=profile.properties,id=profile.getSubId(src),col=profile.colMap[id];if(col){if(p.disabled||col.disabled)return!1;if(!(col.hasOwnProperty("colHidable")?col.colHidable:p.colHidable))return;if(!(col.hasOwnProperty("colDroppable")?col.colDroppable:p.colDroppable))return}else{if(p.disabled)return!1;if(!p.colHidable)return}xui.resetRun(profile.$xid+":collist",null);var region={},pos=xui.use(src).parent().offset(null,profile.getSubNode("BOX")),size=xui.use(src).parent().cssSize();size.width<16||(region.height=profile.$forceu(size.height),region.left=profile.$forceu(pos.left),region.top=profile.$forceu(pos.top),profile.getSubNode("COLLIST").cssRegion(region).css("visibility","visible"))},onMouseout:function(profile,e,src){var p=profile.properties,id=profile.getSubId(src),col=profile.colMap[id];if(col){if(p.disabled||col.disabled)return!1;if(!(col.hasOwnProperty("colHidable")?col.colHidable:p.colHidable))return}else{if(p.disabled)return!1;if(!p.colHidable)return}xui.resetRun(profile.$xid+":collist",(function(){profile.box&&profile.getSubNode("COLLIST").css({visibility:"hidden",left:0+profile.$picku(),top:0+profile.$picku()})}))},onContextmenu:function(profile,e,src){if(profile.onContextmenu){var sid=profile.getSubId(src);return!1!==profile.boxing().onContextmenu(profile,e,src,sid?profile.colMap[sid]:null)}}},COLLIST:{onMouseover:function(profile,e,src){xui.resetRun(profile.$xid+":collist",null)},onMouseout:function(profile,e,src){xui.resetRun(profile.$xid+":collist",(function(){profile.box&&xui.use(src).css("visibility","hidden")}))},onClick:function(profile,e,src){var p=profile.properties;if(!profile.$col_pop){var items=[];xui.arr.each(profile.properties.header,(function(o){(o.hasOwnProperty("colHidable")?o.colHidable:p.colHidable)&&items.push({id:o.id,caption:o.caption,type:"checkbox",value:!0!==o.hidden})})),items.length&&(profile.$col_pop=new xui.UI.PopMenu({hideAfterClick:!1,items:items}).render(!0)).onMenuSelected((function(p,i,s){var b=1;xui.arr.each(p.properties.items,(function(o){if(!1!==o.value)return b=!1})),b?(p.getSubNodeByItemId("CHECKBOX",i.id).tagClass("-checked"),i.value=!0):profile.boxing().showColumn(i.id,i.value)}))}profile.$col_pop&&profile.$col_pop.popUp(src)}},CELLS2:{afterMouseover:function(profile,e,src){var p=profile.properties;if(!p.disabled&&!(!0===p.disableHoverEffect||p.disableHoverEffect&&/\bCELLS2\b/.test(p.disableHoverEffect||""))){var subid=profile.getSubId(src);if(profile.getSubNodes(["CELLS1","CELLS2"],subid).tagClass("-hover"),profile.onRowHover){var row=profile.rowMap[subid];profile.boxing().onRowHover(profile,row,!0,e,src)}}},afterMouseout:function(profile,e,src){var p=profile.properties;if(!p.disabled&&!(!0===p.disableHoverEffect||p.disableHoverEffect&&/\bCELLS2\b/.test(p.disableHoverEffect||""))){var subid=profile.getSubId(src);if(profile.getSubNodes(["CELLS1","CELLS2"],subid).tagClass("-hover",!1),profile.onRowHover){var row=profile.rowMap[subid];profile.boxing().onRowHover(profile,row,!1,e,src)}}},onDblclick:function(profile,e,src){for(var p=profile.properties,row=profile.rowMap[profile.getSubId(src)],nn=xui.Event.getSrc(e),eid=nn&&(nn.id||""),ks=profile.keys,ck=profile.getKey(eid);!ck;)nn=nn.offsetParent,ck=profile.getKey(eid=nn.id);return!row||p.disabled||row.disabled||eid&&xui.UIProfile.getFromDom(eid)!=profile||ck==ks.ROWTOGGLE||ck==ks.MARK||profile.onDblclickRow&&profile.boxing().onDblclickRow(profile,row,e,src),!1},onClick:function(profile,e,src){var p=profile.properties,subid=profile.getSubId(src),row=(profile.keys,profile.rowMap[subid]),eid=xui.Event.getSrc(e).id||"";return!p.disabled&&!row.disabled&&(!eid||xui.UIProfile.getFromDom(eid)==profile)&&void(profile.onClickRow&&profile.boxing().onClickRow(profile,row,e,src))}},CELL:{onMouseover:function(profile,e,src){if(0!=profile.box.$cancelHoverEditor(profile)){var box=profile.box,p=profile.properties,i=xui.use(src).id();if(!0!==p.disableHoverEffect&&(!p.disableHoverEffect||!/\bCELL\b/.test(p.disableHoverEffect||""))&&(i=i.split(":")[2])&&(i=profile.cellMap[i])&&!box.getCellOption(profile,i,"disabled")){var editMode=box.getCellOption(profile,i,"editMode");return box.getCellOption(profile,i,"editable")&&xui.str.startWith(editMode,"hover")&&("hoversharp"!=editMode||"file"!=box.getCellOption(profile,i,"type"))?(xui.resetRun(profile.key+":"+profile.$xid+":hovereditor",(function(subId){profile.destroyed||(subId=profile.getSubId(src))&&profile.box._editCell(profile,subId,!0)})),!1):void 0}}}},GCELL:{onMouseover:function(profile,e,src){profile.box.$cancelHoverEditor(profile)}},CELLA:{onDblclick:function(profile,e,src){var cell=profile.cellMap[profile.getSubId(src)];if(cell&&!profile.properties.disabled){var getPro=profile.box.getCellOption,type=getPro(profile,cell,"type"),disabled=getPro(profile,cell,"disabled"),editable=getPro(profile,cell,"editable");return!!(disabled||editable&&"button"!=type&&"label"!=type||(profile.boxing().onDblclickCell(profile,cell,e,src,cell._row,cell._col),"button"!=type))&&void 0}},afterMousedown:function(profile,e,src){xui.setNodeData(src,"_tmp_forcefocus")},onClick:function(profile,e,src){var id,p=profile.properties,box=profile.box,getPro=box.getCellOption,cell=profile.cellMap[profile.getSubId(src)];if(cell){if(profile.properties.disabled)return!1;var type=getPro(profile,cell,"type"),disabled=getPro(profile,cell,"disabled"),readonly=getPro(profile,cell,"readonly"),onClickCell=getPro(profile,cell,"onClickCell")||getPro(profile,cell,"event"),mode=p.activeMode,editable=getPro(profile,cell,"editable");if(!(disabled||editable&&"button"!=type&&"label"!=type)&&("function"==typeof onClickCell&&!1===onClickCell.call(profile._host||profile,profile,cell,e,src,cell._row,cell._col)||profile.onClickCell&&profile.boxing().onClickCell(profile,cell,e,src,cell._row,cell._col),"button"==type))return!1;if(!disabled&&!readonly&&"checkbox"==type&&editable){var v=cell.value;box._updCell(profile,cell,!v,p.dirtyMark,!0,!0),(e=xui.get(cell,["editorEvents","onChange"]))&&e(null,v,!v),profile.box._trycheckrowdirty(profile,cell),cell._row.id==profile.box._temprowid&&(profile.__needchecktmprow=!0,profile.box._sethotrowoutterblur(profile))}if(p.editable)"row"==p.activeMode&&(id=xui(src).parent(3).id(),box._sel(profile,"row",src,id,e));else if("cell"==mode){if(getPro(profile,cell,"disabled"))return!1;id=xui(src).parent().id(),box._sel(profile,"cell",src,id,e)}else if("row"==mode){if(p.disabled||cell._row.disabled)return!1;id=xui(src).parent(3).id(),box._sel(profile,"row",src,id,e)}}else{var row=profile.rowMap[profile.getSubId(src)];if(onClickCell=getPro(profile,row,"onClickCell")||getPro(profile,row,"event"),p.disabled||row.disabled)return!1;if(profile.keys.MARK)var clickMark=profile.getKey(xui.Event.getSrc(e).id||"")==profile.keys.MARK;clickMark||("function"==typeof onClickCell&&!1===onClickCell.call(profile._host||profile,profile,row,null,null,e,src)||profile.onClickRowHandler&&profile.boxing().onClickRowHandler(profile,row,e,src),row.group&&profile.box._getToggleNode(profile,row._serialId).onClick()),"row"==p.activeMode&&(id=xui(src).parent(3).id(),box._sel(profile,"row",src,id,e))}profile.box&&xui.use(src).get(0)&&(xui.getNodeData(src,"_tmp_forcefocus")||profile.box._focusEvent(profile,e,src))},onFocus:function(profile,e,src){xui.setNodeData(src,"_tmp_forcefocus",1),profile.box._focusEvent(profile,e,src)},onKeydown:function(profile,e,src){var keys=xui.Event.getKey(e),key=keys.key,cell=profile.cellMap[profile.getSubId(src)],type=profile.box.getCellOption(profile,cell,"type");if("enter"==key){if("button"==type||"label"==type||"checkbox"==type)return void xui(src).onClick();key="tab"}else if(" "==key&&("button"==type||"label"==type||"checkbox"==type))return void xui(src).onClick();if({tab:1,left:1,right:1,up:1,down:1}[key]){if(profile.beforeCellKeydown&&!1===profile.boxing().beforeCellKeydown(profile,cell,keys))return!1;var t,p=profile.properties,shift=keys.shiftKey,ctrl=keys.ctrlKey,cur=xui(src),row=cell?cell._row:profile.rowMap[profile.getSubId(src)],ishotrow=row&&row.id==profile.box._temprowid,body11=profile.getSubNode("SCROLL11"),body12=profile.getSubNode("SCROLL12"),body21=profile.getSubNode("SCROLL21"),body22=profile.getSubNode("SCROLL22"),keyid=new RegExp("^"+profile.box.$Keys.CELLA+":"+profile.serialId+":"),hasBody12=!!body12.offsetWidth(),hasBody21=!!body21.offsetWidth(),hasBody22=!!body22.offsetHeight(),first11=body11.nextFocus(!0,!0,!1,keyid),first12=body12.nextFocus(!0,!0,!1,keyid),first21=body21.nextFocus(!0,!0,!1,keyid),first22=body22.nextFocus(!0,!0,!1,keyid),last11=body11.nextFocus(!1,!0,!1,keyid),last12=body12.nextFocus(!1,!0,!1,keyid),last21=body21.nextFocus(!1,!0,!1,keyid),last22=body22.nextFocus(!1,!0,!1,keyid),first=hasBody12?hasBody21?first11:first12:hasBody21?first21:first22,last=body22?last22:body12?last12:body21?last21:last11,cellNode=cur.parent(),cellsid=cellNode.parent().id(),subId=profile.getSubId(cellsid),region=cell?cell._row._region+""+cell._col._region:row._region+"1",toLeft=function(inner){if(src!=first.xid()){var ok;if(!cellNode.get(0).previousSibling||!cellNode.get(0).previousSibling.clientWidth)switch(region){case"11":case"21":if(hasBody22)if(src==first21.xid())last12.focus(!0),ok=1;else{var prev=profile.getSubNode("ROW2",subId).prev();prev&&(prev.nextFocus(!1,!0,!0,keyid),ok=1)}break;case"12":case"22":hasBody21&&(profile.getSubNode("CELLS1",subId).last(2).focus(!0),ok=1)}return ok||cur.nextFocus(!1,!1,!0,keyid),!1}inner&&last.focus(!0)},toRight=function(inner){if(src!=last.xid()){var ok;if("11"==region||"21"==region?!cellNode.get(0).nextSibling:!(t=cellNode.get(0).nextSibling)||!t.clientWidth)switch(region){case"11":case"21":hasBody22&&(profile.getSubNode("CELLS2",subId).first(2).focus(!0),ok=1);break;case"12":case"22":if(hasBody21)if(src==last12.xid())first21.focus(!0),ok=1;else{var next=profile.getSubNode("ROW1",subId).next();next&&(next.nextFocus(!0,!0,!0,keyid),ok=1)}}return ok||cur.nextFocus(!0,!1,!0,keyid),!1}inner&&toDown()},verticalNav=function(up){for(var count=1,temp=cur.parent().get(0),max=temp.parentNode.childNodes.length;temp=temp.previousSibling;)count++;temp=cur.parent(2).get(0),profile.$allrowscache2||profile.box._cacheRows(profile);var index=xui.arr.indexOf("12"==region||"22"==region?profile.$allrowscache2:profile.$allrowscache1,temp),rowLen=profile.$allrowscache2.length,newLine=0;"up"==key?-1==--index&&(index=rowLen-1,0==--count&&(count=max)):++index==rowLen&&(newLine=1,index=0,++count==max+1&&(count=1));var node=xui(("12"==region||"22"==region?profile.$allrowscache2:profile.$allrowscache1)[index]).first(),node2=node;return count>1&&(node2=node2.next(count-1)),node2.isEmpty()&&(node2=node),node2&&!node2.isEmpty()&&(node2=node2.first()),node2.isEmpty()?null:[node2,newLine]},toDown=function(){var tnode;if(src!=last.xid()?(cur.get(0)!=last11.get(0)&&cur.get(0)!=last21.get(0)||(tnode=hasBody12?first12:first22),tnode||(tnode=(tnode=verticalNav())[0])):tnode=first,ishotrow){if(!cell&&!profile.rowMap[profile.getSubId(src)])return!1;var colId=xui.get(cell,["_col","id"]);if(profile.box._checkNewLine(profile,"keydown",colId)&&profile.__hastmpRow)return!1}tnode&&tnode.focus(!0)};switch(key){case"tab":if(shift){if(!1===toLeft(ishotrow))return!1}else if(!1===toRight(ishotrow))return!1;break;case"left":if(!1===toLeft(!0))return!1;break;case"right":if(!1===toRight(!0))return!1;break;case"up":return ctrl&&row&&!p.disabled&&!row.disabled&&(row.group||row.sub)?(profile.box._getToggleNode(profile,row._serialId).onClick(),!1):(function(){var tnode;if(src!=first.xid()?(cur.get(0)!=first12.get(0)&&cur.get(0)!=first22.get(0)||(tnode=hasBody21?last21:last11),tnode||(tnode=verticalNav()[0])):tnode=last,ishotrow){if(!cell&&!profile.rowMap[profile.getSubId(src)])return!1;var colId=xui.get(cell,["_col","id"]);if(profile.box._checkNewLine(profile,"keydown",colId)&&profile.__hastmpRow)return!1}tnode&&tnode.focus(!0)}(),!1);case"down":return ctrl&&row&&!p.disabled&&!row.disabled&&(row.group||row.sub)?(profile.box._getToggleNode(profile,row._serialId).onClick(),!1):(toDown(),!1)}}},onContextmenu:function(profile,e,src){if(profile.onContextmenu){var sid=profile.getSubId(src);return!1!==profile.boxing().onContextmenu(profile,e,src,sid?profile.cellMap[sid]||profile.rowMap[sid]:null)}}},CMD:{onFocus:function(profile,e,src){return!1},onClick:function(profile,e,src){var p=profile.properties,id=xui.use(src).id().split("_"),cmdkey=id[id.length-1];id.pop();var row=profile.rowMap[profile.getSubId(id.join("_"))];return p.disabled||row&&row.disabled||profile.onCmd&&profile.boxing().onCmd(profile,row,cmdkey,e,src),!1}}},DataModel:{directInput:!0,listKey:null,currencyTpl:"$ *",numberTpl:"",valueSeparator:";",activeRow:{hidden:!0,ini:null},activeCell:{hidden:!0,ini:null},rowMap:{hidden:!0,ini:null},selMode:{ini:"none",listbox:["single","none","multi","multibycheckbox"],action:function(value){this.getSubNodes(["HFMARK","MARK"],!0).css("display","multi"==value||"multibycheckbox"==value?"":"none")}},editMode:{ini:"focus",listbox:["focus","sharp","hover","hoversharp","inline"]},dock:"fill",togglePlaceholder:!1,isFormField:{hidden:!0,ini:!1},altRowsBg:{ini:!1,action:function(value){var j,o1,altCls=this.getClass("CELLS1","-alt"),nodes21=this.getSubNode("CELLS1",!0),nodes22=this.getSubNode("CELLS2",!0);nodes21.removeClass(altCls),nodes22.removeClass(altCls),value&&(j=0,nodes22.each((function(o2,i){o2.clientHeight&&(o2=xui([o2]),o1=xui([nodes21.get(i)]),j++%2==1?(o1.hasClass(altCls)||o1.addClass(altCls),o2.hasClass(altCls)||o2.addClass(altCls)):(o1.hasClass(altCls)&&o1.removeClass(altCls),o2.hasClass(altCls)&&o2.removeClass(altCls)))})))}},rowNumbered:{ini:!1,action:function(value){var row,temp,t,ns=this,f=ns.CF.getNumberedStr||function(a){return a},nodes=ns.getSubNode("ROWNUM",!0),i=0,map=ns.rowMap,ol=0,l=0,a1=[],a2=[],tag="";nodes.css("display",value?"":"none"),value?nodes.each((function(o){if((row=map[ns.getSubId(o.id)])&&row.id!=ns.box._temprowid){if((l=row._layer)>ol)a1.push(i),a2.push(tag),tag=tag+i+".",i=0;else if(l<ol)for(;l<ol--;)i=a1.pop(),tag=a2.pop();i++,ol=l,row._autoNumber=f(tag+i),temp=row.rowNumber||row._autoNumber,(t=o.firstChild)?t.nodeValue!=temp&&(t.nodeValue=temp):o.appendChild(document.createTextNode(temp))}})):nodes.text("")}},editable:!1,firstCellEditable:!1,$subMargin:"1.375em",iniFold:!0,animCollapse:!1,position:"absolute",width:"25em",height:"18em",_minColW:".5em",_maxColW:"25em",_minRowH:"1.83333em",gridHandlerCaption:{ini:"",action:function(v){v=(xui.isSet(v)?v:"")+"",this.getSubNode("GRIDCAPTION").html(xui.adjustRes(v,!0))}},rowHandlerWidth:{$spaceunit:1,ini:"5em",set:function(value){var o=this;o.renderId?o.box._setRowHanderW(o,value):o.properties.rowHandlerWidth=value}},showHeader:{ini:!0,action:function(value){this.getSubNodes(["HEADER1","HEADER2"]).css("display",value?"":"none")}},headerHeight:{$spaceunit:1,ini:"2em",action:function(v){this.properties,this.box._adjustColsHeight(this),this.adjustSize()}},rowHeight:{$spaceunit:1,ini:"2em",action:function(v){this.box._adjusteditorH(this,this.getSubNodes(["CELLS1","CELLS2"],!0).height(v),v)}},_colDfWidth:"8em",rowHandler:{ini:!0,action:function(value){this.getSubNode("FHCELL").css("display",value?"":"none"),this.getSubNode("FCELL",!0).css("display",value?"":"none"),this.box._adjustColsWidth(this),this.box._adjustBody(this,"rowhandler")}},rowResizer:{ini:!1,action:function(value){this.getSubNode("FHANDLER",!0).css("display",value?"":"none")}},colHidable:!1,colResizer:{ini:!0,action:function(value){this.getSubNode("HHANDLER",!0).css("display",value?"":"none")}},colSortable:{ini:!0,action:function(value){value||this.getSubNode("SORT",!0).css("display","none")}},colMovable:!1,header:{ini:{},set:function(value){var o=this;o.renderId?o.boxing()._refreshHeader(value):o.properties.header=xui.copy(value)}},uidColumn:"",grpCols:{ini:{},set:function(value){var o=this;o.properties.grpCols=xui.copy(value),o.renderId&&o.boxing()._refreshHeader(xui.clone(o.properties.header,!1,2))}},rows:{ini:{},set:function(value){var o=this;o.renderId?o.boxing().removeAllRows(!1).insertRows(value):o.properties.rows=xui.copy(value)}},rawData:{ini:[],set:function(value){if(value&&xui.isArr(value)&&value.length){var i,j,hash,cols={},header=[],rowdata=[],cellsArr=[],l=value.length,ins=this.boxing(),oheader=ins.getHeader("min");for(i=0;i<l;i++)if(xui.isHash(hash=value[i]))for(var k in hash)"__row__id"==k?(rowdata[i]=rowdata[i]||{},rowdata[i].id=hash[k]):0==k.indexOf("__row__")?(rowdata[i]=rowdata[i]||{},rowdata[i][k]=hash[k]):(k in cols||(cols[k]=[]),cols[k][i]=hash[k]);if(null==oheader||0==oheader.length){for(var k in cols)header.push(k);ins.setHeader(header)}else{var ex;for(var k in header=ins.getHeader("data"),cols)-1==xui.arr.indexOf(oheader,k)&&(header.push({id:k,caption:"["+k+"]"}),ex=1);ex&&ins.setHeader(header,!0)}header=ins.getHeader();var map={};for(var k in xui.arr.each(header,(function(o,i){map[o.id]=i})),cols)if(k in map)for(j=map[k],i=0;i<l;i++)cellsArr[i]||(cellsArr[i]=[]),cellsArr[i][j]=cols[k][i];rowdata.length&&xui.each(cellsArr,(function(cells,i){rowdata[i]&&(cellsArr[i]=rowdata[i],cellsArr[i].cells=cells)})),ins.setRows(cellsArr)}else this.boxing().removeAllRows()},get:function(row,splitMixColumn){var cell,key,keys,prop=this.properties,header=prop.header,tid=this.box._temprowid,one=row&&row.cells&&xui.isArr(row.cells),rows=one?[row]:xui.isArr(row)&&row[0]&&row[0].cells&&xui.isArr(row[0].cells)?row:prop.rows,l=header.length,h=rows.length,columns=[],data=[];if(h){for(var i=0;i<l;i++)columns.push(header[i].id);for(var j=0;j<h;j++)if((one||rows[j].id!=tid)&&!rows[j].group&&rows[j].cells){var hash={};for(i=0;i<l;i++)key=columns[i],cell=rows[j].cells[i],splitMixColumn&&-1!=key.indexOf(":")?(hash[(keys=key.split(":"))[0]]="value"in cell?cell.value:cell,hash[keys[1]]="caption"in cell?cell.caption:null):hash[key.split(":")[0]]="value"in cell?cell.value:cell;for(var i in hash.__row__id=rows[j].id,rows[j])0===i.indexOf("__row__")&&(hash[i]=rows[j][i]);data.push(hash)}}return one?data[0]:data}},dataset:{ini:{},get:function(){var ins=this.boxing();return{name:this.properties.gridHandlerCaption,dimensions:ins.getHeader("min"),source:ins.getRows("min")}},set:function(v){var ins=this.boxing(),prop=this.properties,dataset=xui.isFun(v.getDataset)?v.getDataset():v;(v=prop.tagVar.datasetAdapter)&&xui.isFun(v)&&(dataset=v.call(ins,dataset,this)),(v=ins.datasetAdapter)&&xui.isFun(v)&&(dataset=v.call(ins,dataset,this)),ins.beforeApplyDataset&&!1===ins.beforeApplyDataset(this,dataset)||("name"in dataset&&ins.setGridHandlerCaption(dataset.name),"dimensions"in dataset&&ins.setHeader(dataset.dimensions),"source"in dataset&&ins.setRows(dataset.source))}},tagCmds:{ini:[],action:function(){this.boxing().refresh()}},activeMode:{ini:"row",listbox:["row","cell","none"],action:function(value){"cell"!=value&&this.$activeCell&&(xui(this.$activeCell).tagClass("-active",!1),delete this.$activeCell),"row"!=value&&this.$activeRow&&(xui(this.$activeRow).tagClass("-active",!1),delete this.$activeRow)}},rowOptions:{ini:{},action:function(value){var ins=this.boxing(),rows=ins.getRows("data");ins.removeAllRows(),ins.insertRows(rows)}},colOptions:{ini:{},action:function(value){var ins=this.boxing(),rows=ins.getRows("data");ins.removeAllRows(),ins.insertRows(rows)}},treeMode:{ini:"inhandler",listbox:["none","inhandler","infirstcell"],action:function(value,ovalue){"inhandler"==ovalue&&"infirstcell"==value||"infirstcell"==ovalue&&"inhandler"==value?this.boxing().refresh():this.getSubNodes(["ROWLRULER","ROWTOGGLE"],!0).css("display",value?"":"none")}},freezedColumn:{ini:0,action:function(){this.boxing().refresh(),this.box._adjustColsWidth(this)}},freezedRow:{ini:0,action:function(){this.boxing().refresh()}},hotRowMode:{ini:"hidden",listbox:["hidden","before","after"],action:function(value){this.renderId&&("hidden"==value?this.boxing().removeHotRow():this.box.__ensurehotrow(this,null))}},excelCellId:{ini:"",action:function(){this.boxing().notifyExcel(!1)}},gridValueFormula:"",hotRowNumber:"[*]",hotRowCellCap:"(*)",hotRowRequired:"",noCtrlKey:!0},EventHandlers:{onBodyLayout:function(profile,trigger){},beforeApplyDataset:function(profile,dataset){},beforeCellKeydown:function(profile,cell,keys){},afterCellFocused:function(profile,cell,row){},beforeInitHotRow:function(profile){},onInitHotRow:function(profile,row){},beforeHotRowAdded:function(profile,cellMap,row,leaveGrid){},afterHotRowAdded:function(profile,row){},onGetContent:function(profile,row,callback){},onRowSelected:function(profile,row,e,src,type){},onCmd:function(profile,row,cmdkey,e,src){},beforeFold:function(profile,item){},beforeExpand:function(profile,item){},afterFold:function(profile,item){},afterExpand:function(profile,item){},beforeColDrag:function(profile,colId){},beforeColMoved:function(profile,colId,toId){},afterColMoved:function(profile,colId,toId){},beforeColSorted:function(profile,col){},afterColSorted:function(profile,col){},beforeColShowHide:function(profile,colId,flag){},afterColShowHide:function(profile,colId,flag){},beforeColResized:function(profile,colId,width){},afterColResized:function(profile,colId,width){},beforeRowResized:function(profile,rowId,height){},afterRowResized:function(profile,rowId,height){},beforePrepareRow:function(profile,row,pid){},beforePrepareCol:function(profile,col){},beforeRowActive:function(profile,row){},afterRowActive:function(profile,row){},beforeCellActive:function(profile,cell,row,col){},afterCellActive:function(profile,cell,row,col){},beforeCellUpdated:function(profile,cell,options,isHotRow,extOpt,row,col){},afterCellUpdated:function(profile,cell,options,isHotRow,extOpt,row,col){},beforeRowUpdated:function(profile,row,options,isHotRow){},afterRowUpdated:function(profile,row,options,isHotRow){},onRowDirtied:function(profile,row){},onRowHover:function(profile,row,hover,e,src){},onClickHeader:function(profile,col,e,src){},onClickRow:function(profile,row,e,src){},onClickRowHandler:function(profile,row,e,src){},onDblclickRow:function(profile,row,e,src){},onClickCell:function(profile,cell,e,src,row,col){},onDblclickCell:function(profile,cell,e,src,row,col){},onClickGridHandler:function(profile,e,src){},beforeIniEditor:function(profile,cell,cellNode,pNode,type,row,col){},onBeginEdit:function(profile,cell,editor,type,row,col){},beforeEditApply:function(profile,cell,options,editor,tag,type,row,col){},onEndEdit:function(profile,cell,editor,type,row,col){},onFileDlgOpen:function(profile,cell,editorPrf,src,row,col){},beforeComboPop:function(profile,cell,editorPrf,pos,e,src,row,col){},beforePopShow:function(profile,cell,editorPrf,popCtl,items,row,col){},afterPopShow:function(profile,cell,editorPrf,popCtl,row,col){},onCommand:function(profile,cell,editorPrf,src,type,row,col){},onEditorClick:function(profile,cell,editorPrf,type,src,row,col){},beforeUnitUpdated:function(profile,cell,editorPrf,type,row,col){},beforeApplyFormula:function(profile,cell,value,formula,row,col){},afterApplyFormulas:function(profile,dataArrs){},beforeGridValueCalculated:function(profile){},afterGridValueCalculated:function(profile,value){},onGetExcelCellValue:function(profile,excelCellId,dftValue){}},RenderTrigger:function(){var ns=this,box=ns.box,prop=ns.properties,ins=ns.boxing(),getPro=box.getCellOption;ns.destroyTrigger=function(){var ns=this,prop=ns.properties;xui.each(ns.cellMap,(function(cell){cell._editor&&cell._editor.destroy()})),xui.breakO([ns.colMap,ns.rowMap,ns.cellMap],3),prop.header.length=0,prop.rows.length=0,prop.grpCols.length=0},ns.$cache_editor={},prop.iniFold||ins._toggleRows(prop.rows,!0),xui.arr.each(prop.header,(function(o){xui.isFun(o.colRenderer||prop.colOptions.colRenderer)&&(o.colRenderer||prop.colOptions.colRenderer).call(null,ns,o)})),"infirstcell"==prop.treeMode&&ns.getSubNode("HCELLA",prop.header[0]._serialId).prepend(ns.getSubNode("LTAGCMDS")).prepend(ns.getSubNode("HFMARK")),xui.arr.each(prop.rows,(function(o){xui.isFun(o.rowRenderer||prop.rowOptions.rowRenderer)&&(o.rowRenderer||prop.rowOptions.rowRenderer).call(null,ns,o),!1===getPro(ns,o,"iniFold")&&ins._toggleRows([o],!0)})),ns.box.__ensurehotrow(ns,null),xui.each(ns.cellMap,(function(o){!getPro(ns,o,"editable")||"inline"!=getPro(ns,o,"editMode")&&"dropbutton"!=getPro(ns,o,"type")||box._editCell(ns,o)})),prop.excelCellId&&ns.boxing().calculateGridValue()},LayoutTrigger:function(){var ns=this,box=ns.box,prop=ns.properties;ns.boxing(),xui.isArr(prop.grpCols)&&(xui.arr.each(prop.grpCols,(function(o){xui.isFun(o.colRenderer||prop.colOptions.colRenderer)&&(o.colRenderer||prop.colOptions.colRenderer).call(null,ns,o)})),box._adjustColsHeight(ns)),ns.box._asy(ns),ns.box._adjustBody(ns,"render")},_tplMap:{text:".text",button:".button",image:".image"},_tplMap2:{textarea:".textarea",checkbox:".checkbox",button:".button",progress:".progress"},_focusEvent:function(profile,e,src){var row,ins=profile.boxing(),prop=profile.properties,cell=profile.cellMap[profile.getSubId(src)];profile.box._focuscell(profile,e,src),profile.afterCellFocused&&(row=cell?cell._row:profile.rowMap[profile.getSubId(src)],ins.afterCellFocused(profile,cell,row)),prop.editable&&"hidden"!=(prop.hotRowMode||"hidden")&&(row=(cell=profile.cellMap[profile.getSubId(src)])?cell._row:profile.rowMap[profile.getSubId(src)],profile.__hastmpRow&&profile.__needchecktmprow&&row.id!==profile.box._temprowid&&profile.box._checkNewLine(profile,"focuscell"))},__ensurehotrow:function(profile,focusPos){var prop=profile.properties;profile.box&&profile.renderId&&prop.editable&&"hidden"!=(prop.hotRowMode||"hidden")&&profile.box._addTempRow(profile,focusPos)},_temprowid:"_ r _temp_",isHotRow:function(row){return row&&(row.id||row)===this._temprowid},_addTempRow:function(profile,focusPos,pid,baseRow){var prop=profile.properties;if(prop.readonly||prop.disabled||!prop.editable||!prop.header||prop.header.length<=0)return!1;if(delete profile.__hastmpRow,profile.boxing().removeRows([this._temprowid],!1),profile.beforeInitHotRow&&!1===profile.boxing().beforeInitHotRow(profile))return!1;profile.__needchecktmprow=!0;var cell,required=profile.box._getRequiredCols(profile),cells=[],row={cells:cells},newcell={caption:prop.hotRowCellCap},ins=profile.boxing();xui.arr.each(prop.header,(function(col,i){cell=xui.isSet(col.defaultValue)?{value:col.defaultValue}:xui.isSet(col.tagVar&&col.tagVar.defaultValue)?{value:col.tagVar.defaultValue}:required.length&&-1!=xui.arr.indexOf(required,col.id)?newcell:{},cells.push(cell)})),profile.onInitHotRow&&(row=ins.onInitHotRow(profile,row)||row,xui.isArr(row)?row={cells:row}:xui.isHash(row)||(row={cells:[row]})),row.id=this._temprowid,row.rowNumber=prop.hotRowNumber,row.rowClass=profile.getClass("CELLS2","-hot"),ins.insertRows([row],pid||null,baseRow||null,"before"==prop.hotRowMode,!0,!1),profile.__hastmpRow=!0,focusPos&&ins.focusCellbyRowCol(row.id,focusPos)},_getRequiredCols:function(profile){var prop=profile.properties,required=(prop.hotRowRequired||"").split(prop.valueSeparator);return xui.each(profile.colMap,(function(o){o.required&&required.push(o.id)})),xui.filter(required,(function(v){return!!xui.str.trim(v)})),required.length||xui.arr.each(prop.header,(function(col){if(!col.hidden)return required.push(col.id),!1})),required},_checkNewLine:function(profile,trigger,colId){var prop=profile.properties;if(prop.editable&&(profile.box._sethotrowoutterblur(profile,!0),profile.__hastmpRow)){delete profile.__needchecktmprow;var t,ins=profile.boxing(),rowId=this._temprowid,tempRow=ins.getRowbyRowId(rowId,"map",!0),pid=ins.getRowbyRowId(rowId)._pid,hhot="hidden"==(prop.hotRowMode||"hidden");if(tempRow){delete tempRow.__row__id;var required=profile.box._getRequiredCols(profile);if(required.length){for(var cell,i=0,l=required.length;i<l;i++)if(-1!=xui.arr.subIndexOf(prop.header,"id",required[i])&&!(t=xui.isHash(cell=tempRow[required[i].split(":")[0]])?cell.value:cell)&&0!==t)return}else{var hasValue;for(var i in tempRow)if(tempRow[i]||0!==tempRow[i]){hasValue=1;break}if(!hasValue)return}var result=!!trigger,tempRowData=ins.getRowbyRowId(rowId,"data",!0);if(delete tempRowData.id,delete tempRowData.rowClass,delete tempRowData.rowNumber,xui.arr.each(tempRowData.cells,(function(cell){0==cell.id.indexOf("-c_")&&delete cell.id,cell.caption===prop.hotRowCellCap&&delete cell.caption})),profile.beforeHotRowAdded){var result2=ins.beforeHotRowAdded(profile,tempRow,tempRowData,!trigger);xui.isDefined(result2)&&(result=!0===result2||!1===result2?result2:null)}if(null===result)return hhot&&profile.box._sethotrowoutterblur(profile),!1;if(!1===result)return hhot&&(delete profile.__hastmpRow,ins.removeRows([rowId],!1)),!1;if(!0===result){var newRow=ins.insertRows(tempRowData,pid,rowId,!0,!0,!0);return delete profile.__hastmpRow,ins.removeRows([rowId],!1),(tempRow=newRow[0])._dirty=1,profile.afterHotRowAdded&&ins.afterHotRowAdded(profile,tempRow),hhot||profile.__hastmpRow||this._addTempRow(profile,colId,pid,tempRow.id),tempRow}return profile.__needchecktmprow=!0,xui.isHash(result)?ins.focusCell(result):ins.focusCell(ins.getCell(result)),profile.box._sethotrowoutterblur(profile),!1}}},_sethotrowoutterblur:function(profile,clear){var f=function(k){return profile.getSubNode(k).get(0)},k="__tmpRowBlurTrigger";profile.getSubNode("ROWS22").setBlurTrigger(profile.$domId+":ROWS22"),profile[k]&&(xui.clearTimeout(profile[k]),delete profile[k]),clear||profile.getSubNode("ROWS22").setBlurTrigger(profile.$domId+":ROWS22",(function(pos,e){profile[k]=xui.asyRun((function(){profile.box&&profile.box._checkNewLine(profile,"blur"),xui.clearTimeout(profile[k]),delete profile[k]}))}),xui([f("SCROLL11"),f("SCROLL12"),f("SCROLL21"),f("SCROLL22")]),null,!0)},_cacheRows:function(profile){var all1=profile.getSubNodes("CELLS1",!0).get(),all2=profile.getSubNodes("CELLS2",!0).get();xui.filter(all1,(function(o){return!!o.clientHeight})),xui.filter(all2,(function(o){return!!o.clientHeight})),profile.$allrowscache1=all1,profile.$allrowscache2=all2},_asy:function(profile){var prop=profile.properties,b=profile.boxing(),id=profile.$xid;prop.altRowsBg&&xui.resetRun(id+"1",(function(){profile.rowMap&&b.setAltRowsBg(!0,!0)})),prop.rowNumbered&&xui.resetRun(id+"2",(function(){profile.rowMap&&b.setRowNumbered(!0,!0)}))},_setRowHanderW:function(profile,flag){var n,w,prop=profile.properties,ww=profile._$subMargin||(profile._$subMargin=profile.$px(prop.$subMargin)),map=profile.rowMap,hcell=profile.getSubNode("FHCELL");if(xui.isFinite(flag)||profile.$isEm(flag)||profile.$isPx(flag))w=profile.$forceu(flag);else if(!0===flag){var t,ws=[];profile.getSubNode("FCELLCAPTION",!0).each((function(o){(t=o.parentNode).parentNode.offsetHeight>0&&"visible"!=xui.Dom.getStyle(t,"overflow")&&(n=map[profile.getSubId(o.id)])&&ws.push(xui([o]).width()+n._layer*ww)})),ws.push(profile.$px(prop._minColW)),w=profile.$forceu(Math.max.apply(null,ws)+2*ww)}else w=profile.$forceu(hcell.width());if(w){if(profile.$px(w)<profile.$px(prop._minColW)&&(w=profile.$em(prop._minColW)+"em"),profile.$px(w)<=0)return;prop.rowHandlerWidth!=w&&(hcell.width(prop.rowHandlerWidth=w),profile.getSubNode("FCELL",!0).width(w),profile.getSubNode("GCELL",!0).width(w),profile.box._adjustColsWidth(profile),profile.box._adjustBody(profile,"rowhandler"))}},_onStartDrag:function(profile,e,src){var row=profile.rowMap[profile.getSubId(src)];if(row&&row.id==profile.box._temprowid)return!1;var pos=xui.Event.getPos(e);return profile.$_ond=src,xui.use(src).startDrag(e,{dragSource:profile.$xid,dragType:"icon",shadowFrom:xui.use(src).parent()._get(0),targetLeft:pos.left+12,targetTop:pos.top+12,dragCursor:"pointer",dragDefer:2,dragKey:profile.box.getDragKey(profile,src),dragData:profile.box.getDragData(profile,e,src)}),!1},_onDropTest:function(profile,e,src,key,data,item){var t,fid=data&&data.domId,tid=src,fp=data&&data.profile;if(tid){var k=profile.getKey(tid),ks=profile.keys,row=profile.rowMap[profile.getSubId(tid)];if(k==ks.FCELL&&!row.sub)return!1;if(profile.properties.rowHandler){if(k==ks.CELLS2||k==ks.SCROLL22)return!1}else if(k==ks.CELLS1||k==ks.SCROLL21)return!1}if(fp&&fp.$xid==profile.$xid){if(fid&&profile.getSubId(fid)==profile.getSubId(tid))return!1;if(t=profile.$_ond,src=xui(src).get(0),xui.get(src,["parentNode","previousSibling"])==t)return!1;do{if(src==t)return src=t=null,!1}while(src&&(src=src.parentNode)&&src!==document&&src!==window);src=t=null}},_onDragstop:function(profile,e,src,key,data,item){delete profile.$_ond},_onDrop:function(profile,e,src,key,data,item){if(data.profile&&data.profile[profile.KEY]){var k=profile.getKey(src),po=data.profile,ps=data.domId,ks=profile.keys,t=xui.absObj.$specialChars,b=profile.boxing(),arr=xui.copy(b.getUIValue(!0)),orow=po.rowMap[po.getSubId(ps)],row=profile.rowMap[profile.getSubId(src)];return orow=xui.clone(orow,(function(o,i){return!t[(i+"").charAt(0)]})),po.boxing().removeRows([orow.id]),k==ks.SCROLL21||k==ks.SCROLL22?b.insertRows([orow],null,null,!1):k==ks.FCELL&&row.sub?b.insertRows([orow],row.id,null,!1):k!=ks.CELLS1&&k!=ks.CELLS2||b.insertRows([orow],row._pid,row.id,!0),arr&&arr.length&&-1!=xui.arr.indexOf(arr,orow.id)&&b.setUIValue(arr,!0,null,"drop"),data._new=orow,!1}},_beforeSerialized:function(profile){var o=arguments.callee.upper.call(this,profile),pp=profile.properties,map=xui.absObj.$specialChars,op=o.properties,us=xui.$us(profile),unit=2==us?"em":-2==us?"px":null;return op.header=xui.clone(pp.header,(function(o,i,d,h){return 2===d&&"width"===i&&o&&"auto"!=o?(h[i]=profile.$forceu(o,unit),!1):!map[(i+"").charAt(0)]&&o!=undefined})),op.grpCols=xui.clone(pp.grpCols,(function(o,i,d,h){return 2===d&&"width"===i&&o&&"auto"!=o?(h[i]=profile.$forceu(o,unit),!1):!map[(i+"").charAt(0)]&&o!=undefined})),op.rows=xui.clone(pp.rows,(function(o,i,d,h){return 2===d&&"height"===i&&o&&"auto"!=o?(h[i]=profile.$forceu(o,unit),!1):!map[((1===d?o.id:i)+"").charAt(0)]&&o!=undefined&&("id"!=i||"string"!=typeof o||"-"!=o.charAt(0))})),xui.isEmpty(op.header)&&delete op.header,xui.isEmpty(op.grpCols)&&delete op.grpCols,xui.isEmpty(op.rows)&&delete op.rows,delete op.activeRow,delete op.activeCell,delete op.rawData,delete op.dataset,o},_clsCache:{},_colDragCheck:function(profile,src){var p=profile.properties,dd=xui.DragDrop.getProfile(),key=dd.dragKey,data=dd.dragData,col=profile.colMap[profile.getSubId(src)];return!(!col||col._isgroup)&&("infirstcell"!=p.treeMode||p.header[0]!=col)&&!!(col.hasOwnProperty("colMovable")?col.colMovable:profile.properties.colMovable)&&!(!key||!data||key!=profile.$xid+":col")&&data!=xui.use(src).id()&&data!=xui.use(src).prev().id()&&void 0},_prepareData:function(profile){var data=arguments.callee.upper.call(this,profile),NONE="display:none",prop=profile.properties;return profile.rowMap2={},profile.rowMap={},profile.cellMap={},data.showHeader=prop.showHeader?"":NONE,data.colDDDisplay=prop.colResizer?"":NONE,data.rowDDDisplay=prop.rowResizer?"":NONE,data.rowHandlerDisplay=prop.rowHandler?"":NONE,data.sortDisplay=NONE,data._rowMarkDisplay="multi"==prop.selMode||"multibycheckbox"==prop.selMode?"":"display:none;",prop.header&&xui.isArr(prop.header)||(prop.header=[]),prop.grpCols&&xui.isArr(prop.grpCols)||(prop.grpCols=[]),prop.rows&&xui.isArr(prop.rows)||(prop.rows=[]),"none"==prop.hotRowMode&&(prop.hotRowMode="hidden"),"hidden"!=prop.hotRowMode&&"before"!=prop.hotRowMode&&(prop.hotRowMode="after"),prop.header=this._adjustHeader(prop.header),data.header=this._prepareHeader(profile,prop.header),data.header1=data.header2=data.header,prop.grpCols=this._adjustGrpColsData(profile,prop.grpCols),data.grpCols=this._prepareGrpCols(profile,prop.grpCols,data.header),data.grpCols1=data.grpCols2=data.grpCols,data._row0DfW=data.rowHandlerWidth?"width:"+profile.$forceu(data.rowHandlerWidth):"",profile.$isEm(prop.headerHeight)&&(data.headerHeight=profile.$forceu(profile.$px(prop.headerHeight,0,!0),"em")),profile.$isEm(prop.rowHeight)&&(data.rowHeight=profile.$forceu(profile.$px(prop.rowHeight,0,!0),"em")),profile.$isEm(prop.rowHandlerWidth)&&(data.headerHeight=profile.$forceu(profile.$px(prop.rowHandlerWidth,0,!0),"em")),arguments.callee.upper.call(this,profile),prop.rows=this._adjustRows(profile,prop.rows),data.rows11=data.rows12=data.rows21=data.rows22=this._prepareItems(profile,prop.rows),data.tagCmds=xui.clone(prop.colOptions.tagCmds||data.tagCmds),data.tagCmds&&this._prepareCmds(profile,data,(function(cmd){return!cmd.tag||!!cmd.tag.match(/\bheader\b/)||!cmd.tag.match(/\brow\b/)})),data._columnfreezed=prop.freezedColumn?"xui-ui-shadow-r xui-uiborder-r xui-uiborder-dark":"",data._rowfreezed=prop.freezedRow?"xui-ui-shadow-b xui-uiborder-b xui-uiborder-dark":"",data},_parepareCol:function(profile,col,cols,index){var iid,tt,oid,uicol,SubID=xui.UI.$tag_subId,prop=profile.properties,headerHeight=profile.$px(prop.headerHeight),borderH=profile.getRoot().contentBox()?2:0,NONE="display:none",ii=1;for(xui.isHash(col)?oid=col.id+"":col={id:oid=col+""},col._cells={},iid=profile.pickSubId("header"),col[SubID]="-h_"+iid,col.id=col.id||iid,"_"==col.id.charAt(0)&&!1!==col.hidden&&(col.hidden=!0);-1!=(tt=xui.arr.subIndexOf(cols,"id",col.id))&&tt!==index;)col.id=iid+ii++;profile.colMap[col[SubID]]=col;var _ww=profile.$px(col.width)||profile.$px(prop._colDfWidth);return"relWidth"in col&&(col.flexSize=col.relWidth,delete col.relWidth),col.flexSize||(col.hasOwnProperty("minWidth")&&(_ww=Math.max(_ww,profile.$px(col.minWidth))),col.hasOwnProperty("maxWidth")&&(_ww=Math.min(_ww,profile.$px(col.minWidth)))),col.width=col._cellWidth=col._colWidth=profile.$forceu(_ww),col._hcellheight=profile.$forceu(headerHeight-borderH),(uicol={sortDisplay:NONE,rowHandlerDisplay:prop.rowHandler?"":NONE})[SubID]=col[SubID],uicol._tabindex=prop.tabindex,uicol.colDDDisplay=("colResizer"in col?col.colResizer:prop.colResizer)?"":NONE,col.hasOwnProperty("visibility")&&!col.hasOwnProperty("hidden")&&(col.hidden=!col.visibility),uicol.colDisplay=!0===col.hidden?NONE:"",uicol.firstCellStyle=prop.colOptions.firstCellStyle||"",uicol.firstCellClass=prop.colOptions.firstCellClass||"",col.type||(col.type=prop.colOptions.type||"input"),"caption"in col&&xui.isDefined(col.caption)||(col.caption=oid),col._for="col",xui.UI.adjustData(profile,col,uicol,"sub"),profile.colMap2[col.id]=col[SubID],[col,uicol]},_prepareCell:function(profile,cell,row,col,temp,_row,index){var SubID=xui.UI.$tag_subId,prop=profile.properties,uicell={};return(cell=xui.isSet(cell)?xui.isHash(cell)?cell:{value:cell}:{})._row=row,cell._col=col,cell[SubID]="-c_"+profile.pickSubId("cell"),cell.id=cell.id||cell[SubID],cell._for="cell",this._adjustCell(profile,cell,uicell),profile.cellMap[uicell[SubID]]=cell,temp&&temp.push(cell),row._cells[col.id]=uicell[SubID],col._cells[row.id]=uicell[SubID],"infirstcell"==prop.treeMode&&0===index&&_row&&(uicell._treeMode=_row._treeMode,uicell._rulerW=_row._rulerW,uicell._fi_togglemark=_row._fi_togglemark,uicell._rowMarkDisplay=_row._rowMarkDisplay,uicell._rowNumbDisplay=_row._rowNumbDisplay,uicell._ltagDisplay=_row._ltagDisplay,uicell.ltagCmds=_row.ltagCmds,uicell[xui.UI.$tag_subId_c]=_row[xui.UI.$tag_subId]),[cell,uicell]},_prepareGrpCols:function(profile,arr,_header){var prop=profile.properties;if(prop.showHeader&&arr&&xui.isArr(arr)&&arr.length){for(var _grp,w,_left,_ww,grp,header=prop.header,headerHeight=profile.$px(prop.headerHeight),borderH=profile.getRoot().contentBox()?2:0,_ngrp=(xui.UI.$tag_subId,[]),h=headerHeight/(profile._headerLayers+1),flag=!1,j=0,m=arr.length;j<m;j++){_grp={},w=0,flag=!1,_left=0,grp=arr[j],xui.UI.adjustData(profile,grp,_grp,"sub");for(var k=0;k<=grp.to;k++)o=header[k],p=_header[k],_ww=profile.$px(p._colWidth),k===grp.from&&(flag=!0,_grp._hcellleft=profile.$forceu(_left)),_left+=_ww+borderH,flag&&!o.hidden&&(w+=_ww+borderH);_grp._colWidth=_grp._cellWidth=profile.$forceu(w-borderH),_grp._hcellheight=profile.$forceu(h-borderH),_grp._hcelltop=profile.$forceu(h*(grp._layer-1)),_grp._tabindex=prop.tabindex,_grp.colDDDisplay=("colResizer"in grp?grp.colResizer:prop.colResizer)?"":"display:none",_ngrp.push(_grp)}k=0;for(var o,p,n=header.length;k<n;k++)o=header[k],p=_header[k],o._grp&&o._grp.length&&(p._hcellheight=profile.$forceu(headerHeight-o._grp.length*h-borderH));return _ngrp}},_prepareHeader:function(profile,arr){var colResult,header=[];return profile.colMap2={},profile.colMap={},xui.arr.each(arr,(function(o,i){profile.beforePrepareCol&&!1===profile.boxing().beforePrepareCol(profile,o)||(colResult=profile.box._parepareCol(profile,o,arr,i),arr[i]=colResult[0],header.push(colResult[1]))})),header},_renderCell:function(profile,cell,uicell,node,options){var caption,getPro=profile.box.getCellOption,type=getPro(profile,cell,"type"),t1="",t2="",cellanode=node,capOut=uicell&&xui.isStr(uicell._caption)?uicell._caption:uicell&&xui.isStr(cell.caption)?uicell.caption:xui.isStr(cell.caption)?cell.caption:null,reg1=/</g,dcls="xui-uicell-disabled",rcls="xui-ui-readonly",ren=function(profile,cell,uicell,fun,o){return((o=cell.renderer||cell._renderer)?xui.UI._applyRenderer(profile,o,cell,uicell):uicell&&"string"==typeof uicell.caption?uicell.caption:"function"==typeof fun?fun(cell.value,profile,cell):xui.isSet(cell.value)?""+cell.value:"")||""},f7=function(v,profile,cell){if(v){var t=(v+="").indexOf("=");if(-1!=t)return cell.value=v.substr(0,t),v.substr(t+1)}return v},unit=function(caption,cell){return caption+(cell.unit?" "+cell.unit:"")};switch(node&&node.get(0)&&(node=node.last()),type){case"number":case"spin":case"counter":var v=parseFloat(cell.value);cell.value=v||0===v?v:null,caption=unit(xui.isSet(capOut)?capOut:ren(profile,cell,uicell,(function(v,profile,cell){return v||0===v?xui.formatNumeric(parseFloat(v),getPro(profile,cell,"precision"),getPro(profile,cell,"groupingSeparator"),getPro(profile,cell,"decimalSeparator"),getPro(profile,cell,"forceFillZero"),getPro(profile,cell,"trimTailZero")):""})),cell),(tpl=getPro(profile,cell,"numberTpl"))&&caption&&(caption=tpl.replace("*",caption)),node&&node.html(caption,!1);break;case"currency":var tpl;v=parseFloat((cell.value+"").replace(/[^\d.-]/g,"")),cell.value=v||0===v?v:null,caption=unit(xui.isSet(capOut)?capOut:ren(profile,cell,uicell,(function(v,profile,cell){if(v||0===v){var precision=getPro(profile,cell,"precision");return xui.formatNumeric(parseFloat(v),xui.isSet(precision)?precision:2,getPro(profile,cell,"groupingSeparator"),getPro(profile,cell,"decimalSeparator"),getPro(profile,cell,"forceFillZero"),getPro(profile,cell,"trimTailZero"))}return""})),cell),(tpl=getPro(profile,cell,"currencyTpl"))&&""!==caption&&(caption=tpl.replace("*",caption)),node&&node.html(caption,!1);break;case"date":cell.value=xui.isDate(cell.value)?cell.value:xui.isFinite(cell.value)?new Date(parseInt(cell.value,10)):xui.Date.parse(cell.value),caption=unit(xui.isSet(capOut)?capOut:ren(profile,cell,uicell,(function(v,profile,cell){return v?xui.Date.getText(v,getPro(profile,cell,"dateEditorTpl")||"ymd"):""})),cell),node&&node.html(caption,!1);break;case"datetime":cell.value=xui.isDate(cell.value)?cell.value:xui.isFinite(cell.value)?new Date(parseInt(cell.value,10)):xui.Date.parse(cell.value),caption=unit(xui.isSet(capOut)?capOut:ren(profile,cell,uicell,(function(v,profile,cell){return v?xui.Date.getText(v,getPro(profile,cell,"dateEditorTpl")||"ymdhn"):""})),cell),node&&node.html(caption,!1);break;case"input":cell.value=cell.value||"",caption=unit(xui.isSet(capOut)?capOut:ren(profile,cell,uicell),cell),node&&node.html(caption,!1);break;case"textarea":cell.value=cell.value||"",caption=unit(xui.isSet(capOut)?capOut:ren(profile,cell,uicell,(function(v){return v?(v+"").replace(reg1,"&lt;").replace(/\t/g,"    ").replace(/ /g,"&nbsp;").replace(/(\r\n|\n|\r)/g,"<br />"):""})),cell),node&&node.html(caption,!1);break;case"color":var c=xui.UI.ColorPicker._ensureValue(0,cell.value);cell.value=cell.value?("transparent"!==c?"#":"")+c:"",caption=unit(xui.isSet(capOut)?capOut:ren(profile,cell,uicell),cell),cell.value?(t1=xui.UI.ColorPicker.getTextColor(cell.value),node?(node.html(caption,!1),node.css("color",t1),node.parent().css("backgroundColor",cell.value)):(uicell.color="color:"+t1+";",uicell.bgcolor="background-color:"+cell.value+";")):node&&(node.html(caption,!1),node.css("color",""),node.parent().css("backgroundColor",""));break;case"checkbox":cell.value="0"!==cell.value&&!!cell.value,caption=xui.isSet(capOut)?capOut:ren(profile,cell,uicell,(function(v){return""})),node?profile.getSubNode("CHECKBOX",profile.getSubId(xui(node).id())).tagClass("-checked",cell.value):uicell._fi_checkboxCls=cell.value?"xuifont-checked xui-uicmd-check-checked":"";break;case"progress":cell.value=parseFloat(cell.value)||0,cell.value=Math.min(Math.max(cell.value,0),1),caption=unit(xui.isSet(capOut)?capOut:ren(profile,cell,uicell,(function(v){return v||0===v?(100*v).toFixed(2)+"%":""})),cell),node?(node.first().html(caption,!1),node.width(caption)):uicell.progress=caption;break;case"listbox":cell.value=cell.hasOwnProperty("value")?cell.value:"",caption=xui.adjustRes(unit(ren(profile,cell,uicell,(function(v,profile,cell){var t=getPro(profile,cell,"editorListItems");if(t||(t=getPro(profile,cell,"editorListKey"))&&(t=xui.UI.getCachedData("function"==typeof t?t():t)),("function"==typeof t?t=t():t)&&t.length)for(var i=0,l=t.length;i<l;i++)if(t[i].id===v)return t[i].caption||v;return f7(v,profile,cell)})),cell)),node&&node.html(null===caption||caption===undefined?cell.value:caption,!1);break;case"dropbox":case"cmdbox":cell.value=cell.hasOwnProperty("value")?cell.value:"",caption=xui.adjustRes(unit(xui.isSet(capOut)?capOut:ren(profile,cell,uicell,f7),cell)),node&&node.html(null===caption||caption===undefined?cell.value:caption,!1);break;default:cell.value=cell.hasOwnProperty("value")?cell.value:"",caption=xui.adjustRes(unit(xui.isSet(capOut)?capOut:ren(profile,cell,uicell),cell)),node&&node.html(null===caption||caption===undefined?cell.value:caption,!1)}"_renderer"in cell&&delete cell._renderer,cell._caption=cell._$tips=cell._$tmpcap=caption,t2=getPro(profile,cell,"disabled");var t3=getPro(profile,cell,"readonly");return uicell?(uicell.cellCls=profile.getClass("CELL","-"+type)+(t2?" "+dcls:"")+(t3?" "+rcls:""),uicell.type=type,uicell.value=cell.value,uicell._caption=caption,uicell.cellStyle=getPro(profile,cell,"cellStyle"),uicell.cellClass=getPro(profile,cell,"cellClass")):(t2?cellanode.parent().addClass(dcls):cellanode.parent().removeClass(dcls),t3?cellanode.parent().addClass(rcls):cellanode.parent().removeClass(rcls),(t2=options.cellStyle)&&cellanode.attr("style",cellanode.attr("style")+";"+t2),(t2=options.cellUnclass)&&cellanode.removeClass(t2),(t2=options.cellClass)&&cellanode.addClass(t2)),cell},_applyRendererEx:function(profile,prop,events,cell,adjustRenderer,t){cell&&((t=cell._col)&&(adjustRenderer(t,prop,events),adjustRenderer(t.tagVar,prop,events)),(t=cell._row)&&(adjustRenderer(t,prop,events),adjustRenderer(t.tagVar,prop,events)))},_prepareItems:function(profile,arr,pid,temparr){var temp,cells,t,row,v,cellResult,prop=profile.properties,_treemode=prop.treeMode,mm=profile._$subMargin||(profile._$subMargin=profile.$px(prop.$subMargin)),a=profile.rowMap2,b=profile.rowMap,_layer=pid&&b[pid]?b[pid]._layer+1:0,SubID=xui.UI.$tag_subId,ider=profile._id||(profile._id=new xui.id),rows=[],ro=prop.rowOptions,itemFilter=profile.$itemFilter,NONE="display:none";_treemode=!(!_treemode||"none"==_treemode),itemFilter&&itemFilter("begin","prepareItem",profile);for(var i=0,l=arr.length;i<l;i++){if(!(row=arr[i]).id||a[row.id]){for(;a[t=ider.next()];);row.id="-"+t}else row.id+="";if(!profile.beforePrepareRow||!1!==profile.boxing().beforePrepareRow(profile,row,pid,temparr)){temp="-r_"+profile.pickSubId("row"),row[SubID]=temp,b[temp]=row,row._for="row",row._pid=pid,row._cells={},row._layer=_layer,row._tabindex=prop.tabindex,row._rowMarkDisplay="multi"==prop.selMode||"multibycheckbox"==prop.selMode?"":NONE,row._treeMode=_treemode?"":NONE,row._rowNumbDisplay=prop.rowNumbered?"":NONE,(t={id:row.id}).rowCls="",row.disabled&&(t.rowCls+=" xui-uicell-disabled"),row.readonly&&(t.rowCls+=" xui-ui-readonly"),row.group&&(t.group=1,t.rowCls+=" "+profile.getClass("CELLS1","-group")+" xui-uiborder-r xui-uiborder-light"),itemFilter&&(row.hidden=!!itemFilter(row,"prepareItem",profile)),row.hidden&&(t.rowDisplay=NONE),t._row0DfW=prop.rowHandlerWidth?"width:"+profile.$forceu(prop.rowHandlerWidth):"",t._rulerW="width:"+(row.rulerWidth||profile.$forceu(4+_layer*mm)),t._rowHeight=profile.$forceu(row._rowHeight||row.height||prop.rowHeight,"em"),row._rowHeight=t._rowHeight,t._rowHeight="height:"+t._rowHeight,t.rowHandlerDisplay=prop.rowHandler?"":NONE,t.rowDDDisplay=("rowResizer"in row?row.rowResizer:prop.rowResizer)?"":NONE,t.firstCellStyle=row.firstCellStyle||ro.firstCellStyle||"",t.firstCellClass=row.firstCellClass||ro.firstCellClass||"",cells=t.cells=[],t[SubID]=temp,t._fi_togglemark=row.sub?"xui-uicmd-toggle"+(row._checked?" xuifont-checked xui-uicmd-toggle-checked":""):prop.togglePlaceholder?"xui-icon-placeholder":"xui-uicmd-none",a[row.id]=temp,!row.hasOwnProperty("caption")&&row.hasOwnProperty("value")&&(row.caption=""+row.value),row._oValue=row.value,row.caption&&!row.tips&&(row._$tips=row.caption),xui.UI.adjustData(profile,row,t,"sub"),t.tagCmds=xui.clone(t.tagCmds||ro.tagCmds||prop.tagCmds),t.tagCmds&&this._prepareCmds(profile,t,(function(cmd){return!cmd.tag||!!cmd.tag.match(/\brow\b/)||!cmd.tag.match(/\bheader\b/)})),row.group&&(row.cells=null),(v=row.cells)&&xui.arr.each(prop.header,(function(col,j){cellResult=profile.box._prepareCell(profile,v[j],row,col,temparr,t,j),v[j]=cellResult[0],cells.push(cellResult[1])}));var hash={};xui.merge(hash,t,(function(o,i){return xui.isNumb(o)||xui.isStr(o)||"ltagCmds"==i})),hash[xui.UI.$tag_subId_c]=t[xui.UI.$tag_subId],t._handler_cell=xui.clone(hash),"infirstcell"==prop.treeMode&&(row.group&&(t._firstcell_grp=xui.clone(hash)),t._rulerW=t._fi_togglemark="",t._treeMode=t.tMarkDisplay=t.tNumbDisplay=t._ltagDisplay=NONE,t.ltagCmds=null),rows.push(t)}}return itemFilter&&itemFilter("end","prepareItem",profile),rows},_adjustCell:function(profile,cell,uicell){var prop=profile.properties,col=cell._col,renderer=this.getCellOption(profile,cell,"cellRenderer")||prop.renderer,cellCapTpl=this.getCellOption(profile,cell,"cellCapTpl");cellCapTpl&&(cell._caption=cellCapTpl),xui.UI.adjustData(profile,cell,uicell,"sub"),renderer&&(cell._renderer=renderer),uicell._cellWidth||(uicell._cellWidth=col._colWidth),uicell._tabindex=prop.tabindex,uicell.cellDisplay=!0===col.hidden?"display:none;":"",this._renderCell(profile,cell,uicell),cell._oValue=cell.value,"unit"in cell&&(cell._oUnit=cell.unit)},_setSub:function(profile,item,flag,recursive,stopanim,cb){var id=profile.domId,ins=profile.boxing(),prop=profile.properties,itemId=profile.rowMap2[item.id],markNode=profile.box._getToggleNode(profile,itemId),subNs=profile.getSubNodes(["SUB1","SUB2"],itemId),subNs1=xui(subNs.get(0)),subNs2=xui(subNs.get(1));if(!xui.Thread.isAlive(profile.key+":"+profile.$xid))if(flag){if(!item._checked){if(ins.beforeExpand&&!1===ins.beforeExpand(profile,item))return;onend=function(empty,t){xui.browser.ie&&xui.browser.ver<=8?markNode.css({backgroundImage:"",backgroundRepeat:"",backgroundPositionX:"",backgroundPositionY:"",backgroundColor:"",backgroundAttachment:""}):markNode.removeClass("xui-icon-loading"),empty||(item._checked=!0,ins.afterExpand&&ins.afterExpand(profile,item)),subNs.css({display:"",height:"auto",overflow:""}),(prop.freezedRow||prop.rowHandler)&&!subNs1.height()&&(t=subNs2.height())&&subNs1.height(t),xui.resetRun(id,(function(cb){profile.box._asy(profile),delete profile.$allrowscache1,delete profile.$allrowscache2,profile.box._adjustBody(profile,"expandrow"),cb&&xui.tryF(cb,[profile,item],ins)}),0,[cb])};var t,sub=item.sub,callback=function(sub){!function(profile,item,id,markNode,subNs1,subNs2,subNs,sub){var b=profile.boxing(),p=profile.properties,empty=!1===sub;if(!empty&&!item._inited&&(delete item.sub,item._inited=!0,sub)){"string"==typeof sub?(subNs2.html(item.sub=sub,!1),subNs.addClass("xui-uiborder-r xui-uiborder-b xui-uiborder-light")):sub["xui.Template"]||sub["xui.UI"]?(subNs2.append(item.sub=sub.render(!0)),subNs.addClass("xui-uiborder-r xui-uiborder-b xui-uiborder-light")):xui.isArr(sub)&&(b.insertRows(sub,item.id),item.sub||(item.sub=sub));var s=0,arr=b.getUIValue(!0);arr&&arr.length&&(xui.arr.each(sub,(function(o){if(-1!=xui.arr.indexOf(arr,o.id||o))return s=1,!1})),s&&b._setCtrlValue(b.getUIValue()))}if(empty||markNode.tagClass("-checked"),stopanim)onend(empty);else if(subNs.css("height","0px").css("display",""),p.animCollapse){var h=0;subNs2.children().each((function(o){h+=o.offsetHeight})),subNs.css("overflow","hidden"),subNs.animate({height:[0,h]},null,(function(){onend(empty)}),200,null,"expoIn",profile.key+":"+profile.$xid).start()}else onend(empty)}(profile,item,0,markNode,0,subNs2,subNs,sub)};if("string"==(t=typeof sub)||"object"==t)callback(sub);else if(profile.onGetContent){xui.browser.ie&&xui.browser.ver<=8?markNode.css("background","url("+xui.ini.img_busy+") no-repeat"):markNode.addClass("xui-icon-loading");var r=profile.boxing().onGetContent(profile,item,callback);(r||!1===r)&&(!0===r&&(item._inited=!0),callback(r))}}recursive&&item.sub&&xui.arr.each(item.sub,(function(o){o.sub&&o.sub.length&&!o._checked&&profile.box._setSub(profile,o,flag,recursive,!0,cb)}))}else{if(item._checked){if(ins.beforeFold&&!1===ins.beforeFold(profile,item))return;var onend=function(){if(subNs.css({display:"none",height:0,overflow:""}),markNode.tagClass("-checked",!1),item._checked=!1,prop.dynDestory||item.dynDestory){for(var s=item.sub,arr=[],i=0,l=s.length;i<l;i++)arr.push(s[i].id);profile.boxing().removeRows(arr),item.sub=!0,delete item._inited}ins.afterFold&&ins.afterFold(profile,item),xui.resetRun(id,(function(cb){profile.box._asy(profile),delete profile.$allrowscache1,delete profile.$allrowscache2,profile.box._adjustBody(profile,"foldrow"),cb&&xui.tryF(cb,[profile,item],ins)}),0,[cb])};stopanim?onend():prop.animCollapse?(subNs.css("overflow","hidden"),subNs.animate({height:[subNs2.height(),0]},null,onend,200,null,"expoOut",profile.key+":"+profile.$xid).start()):onend()}recursive&&item.sub&&!prop.dynDestory&&!item.dynDestory&&xui.arr.each(item.sub,(function(o){o.sub&&o.sub.length&&profile.box._setSub(profile,o,flag,recursive,!0,cb)}))}},_getCellId:function(profile,rowId,colId){return xui.isNumb(rowId)&&(rowId=xui.get(profile.properties.rows,[rowId,"id"])),xui.isNumb(colId)&&(colId=xui.get(profile.properties.header,[colId,"id"])),xui.get(profile.rowMap,[profile.rowMap2[rowId],"_cells",colId])},_updCell:function(profile,cellId,options,dirtyMark,triggerEvent,triggerFormula){var cell,node,ishotrow,ext,box=profile.box,prop=profile.properties,pdm=prop.dirtyMark,psdm=pdm&&prop.showDirtyMark,sc=xui.absObj.$specialChars;if("string"==typeof cellId?cell=profile.cellMap[cellId]:cellId=(cell=cellId)._serialId,cell&&cell._row&&((ishotrow=cell._row.id==box._temprowid)&&cell.caption==prop.hotRowCellCap&&delete cell.caption,xui.isHash(options)||(options={value:options}),options=xui.filter(options,(function(o,i,r){return(r=!sc[i.charAt(0)])||((ext=ext||{})[i]=o),r})),!triggerEvent||!profile.beforeCellUpdated||!1!==profile.boxing().beforeCellUpdated(profile,cell,options,ishotrow,ext,cell._row,cell._col))){if(!xui.isEmpty(options)){if(delete cell._$tips,delete cell._$tmpcap,xui.merge(cell,options,"all"),node=profile.getSubNode("CELLA",cellId),"type"in options){var uicell={};box._adjustCell(profile,cell,uicell),node.parent().replace(profile._buildItems("rows2.cells",[uicell])),node=profile.getSubNode("CELLA",cellId)}else{var cellCapTpl=box.getCellOption(profile,cell,"cellCapTpl");cellCapTpl&&(cell.caption=xui.adjustRes(cellCapTpl,!0,!1,null,null,cell)),cell=box._renderCell(profile,cell,null,node,options)}var editor=cell._editor;"value"in options&&(pdm&&!1!==dirtyMark||(cell._oValue=cell.value),"unit"in cell?cell._oUnit=cell.unit:cell.value!==cell._oValue||"unit"in cell&&cell._oUnit!==cell.unit?psdm&&node.addClass("xui-ui-dirty"):psdm&&node.removeClass("xui-ui-dirty"),editor&&triggerEvent&&!options.ignoreEditor&&!profile._setFromEditor&&editor.setValue(cell.value,!0,"editorini"),!1!==triggerFormula&&xui.resetRun(profile.key+":"+profile.$xid+":"+cell.id,(function(){profile&&profile.box&&profile.boxing().triggerFormulas(cell,"updatecell")}))),"caption"in options&&editor&&editor.setCaption&&editor.setCaption(xui.isSet(options.caption)?options.caption:null,!0),cell._dirty=1}triggerEvent&&profile.afterCellUpdated&&profile.boxing().afterCellUpdated(profile,cell,options,ishotrow,ext,cell._row,cell._col)}},_ensureValue:function(profile,value){if("multi"==profile.properties.selMode||"multibycheckbox"==profile.properties.selMode){var arr=xui.isArr(value)?value:(value?""+value:"").split(profile.properties.valueSeparator);return xui.arr.removeValue(arr,this._temprowid),arr.sort(),arr.join(profile.properties.valueSeparator)}return value==this._temprowid?null:value},_sel:function(profile,type,src,id,e){var properties=profile.properties;if(properties.activeMode==type){var targetId=profile.getSubId(id),map="cell"==type?profile.cellMap:profile.rowMap,box=profile.boxing(),targetItem=map[targetId],ks=xui.Event.getKey(e),sid="cell"==type?targetItem._row.id+"|"+targetItem._col.id:targetItem.id;switch(properties.selMode){case"none":box.onRowSelected(profile,targetItem,e,src,0);break;case"multibycheckbox":if(profile.keys.MARK&&profile.getKey(xui.Event.getSrc(e).id||"")!=profile.keys.MARK){box.onRowSelected(profile,targetItem,e,src,0);break}case"multi":var value=box.getUIValue(),arr=value?(""+value).split(properties.valueSeparator):[],checktype=1;if(arr.length&&(ks.ctrlKey||ks.shiftKey||properties.noCtrlKey)){if(ks.shiftKey&&"row"==type){if(profile.$firstV._pid!=targetItem._pid)return!1;var items=properties.rows;if(targetItem._pid){var pitem=map[targetItem._pid];pitem&&(items=pitem.sub)}var i,i1=xui.arr.subIndexOf(items,"id",profile.$firstV.id),i2=xui.arr.subIndexOf(items,"id",targetItem.id);for(arr.length=0,i=Math.min(i1,i2);i<=Math.max(i1,i2);i++)arr.push(items[i].id)}else-1!=xui.arr.indexOf(arr,sid)?(xui.arr.removeValue(arr,sid),checktype=-1):arr.push(sid);arr.sort(),value=arr.join(properties.valueSeparator),box.getUIValue()!=value&&(box.setUIValue(value,null,null,"click"),box.get(0)&&box.getUIValue()==value&&box.onRowSelected(profile,targetItem,e,src,checktype));break}case"single":box.getUIValue()!=sid&&(profile.$firstV=targetItem,box.setUIValue(sid,null,null,"click"),box.get(0)&&box.getUIValue()==sid&&box.onRowSelected(profile,targetItem,e,src,1))}}},_activeCell:function(profile,id){if("cell"==profile.properties.activeMode&&profile.$activeCell!=id){var targetCell=null;if(profile.$activeCell&&(xui(profile.$activeCell).tagClass("-active",!1),delete profile.$activeCell),!1!==id){var targetId=profile.getSubId(id);if(targetCell=profile.cellMap[targetId],profile.beforeCellActive&&!1===profile.boxing().beforeCellActive(profile,targetCell,targetCell._row,targetCell._col))return;xui(profile.$activeCell=id).tagClass("-active")}profile.afterCellActive&&profile.boxing().afterCellActive(profile,targetCell,targetCell._row,targetCell._col)}},_activeRow:function(profile,id){if("row"==profile.properties.activeMode&&profile.$activeRow!=id){var subId,targetRow=null;if(profile.$activeRow&&(subId=profile.getSubId(profile.$activeRow),profile.getSubNodes(["CELLS1","CELLS2"],subId).tagClass("-active",!1),delete profile.$activeRow),!1!==id){var targetId=profile.getSubId(id);if(targetRow=profile.rowMap[targetId],profile.beforeRowActive&&!1===profile.boxing().beforeRowActive(profile,targetRow))return;subId=profile.getSubId(profile.$activeRow=id),profile.getSubNodes(["CELLS1","CELLS2"],subId).tagClass("-active")}profile.afterRowActive&&profile.boxing().afterRowActive(profile,targetRow)}},_getCellFormula:function(profile,cell,col,row){var t,p=profile.properties,f1=function(t,col){return(t=xui.isStr(t)?t:"="+t).replace(/(\B)(\?)([0-9]+\b)/g,"$1"+col+"$3").replace(/(\b)(_)([0-9]+\b)/g,"$1"+col+"$3")},f2=function(t,row){return(t=xui.isStr(t)?t:"="+t).replace(/(\b[A-Z]+)(\?)(\B)/g,"$1"+row+"$3").replace(/(\b[A-Z]+)(_)(\b)/g,"$1"+row+"$3")};return cell&&(t=cell.formula)?t:cell&&(t=cell._row)&&(t=t.formula)||(t=p.rowOptions)&&(t=t.formula)?f1(t,col):cell&&(t=cell._col)&&(t=t.formula)||(t=p.colOptions)&&(t=t.formula)?f2(t,row):null},getCellOption:function(profile,cell,key){var t=cell,p=profile.properties;return t&&t.hasOwnProperty(key)&&xui.isSet(t=t[key])||cell&&(t=cell._row)&&t.hasOwnProperty(key)&&xui.isSet(t=t[key])||(t=p.rowOptions)&&t.hasOwnProperty(key)&&xui.isSet(t=t[key])||cell&&(t=cell._col)&&t.hasOwnProperty(key)&&xui.isSet(t=t[key])||(t=p.colOptions)&&t.hasOwnProperty(key)&&xui.isSet(t=t[key])||(t=p)&&t.hasOwnProperty(key)&&xui.isSet(t=t[key])?t:null},_trycheckrowdirty:function(profile,cell){cell&&cell._row&&xui.resetRun(profile.key+":"+profile.$xid+":"+cell._row.id,(function(){if(profile.box){var lc=profile.$cellInEditor;if(cell._row&&(!lc||lc._row&&lc._row!=cell._row)){var dirty=!1;xui.arr.each(cell._row.cells,(function(v){if(v._oValue!==v.value||"unit"in v&&v._oUnit!==v.unit)return dirty=!0,!1})),dirty&&cell._row.id!=profile.box._temprowid&&profile.onRowDirtied&&profile.boxing().onRowDirtied(profile,cell._row)}}}),100)},_adjusteditorW:function(profile,nodes,width){nodes&&nodes.each((function(n,i){(i=n.id)&&(i=i.split(":")[2],(i=profile.cellMap[i])&&i._editor&&i._editor!==profile.$curEditor&&i._editor.setWidth(width-i._editor.getRoot().offsetLeft()))}))},_adjusteditorH:function(profile,nodes,height){nodes.each((function(n,i){if((i=n.id)&&(i=i.split(":")[2],i=profile.rowMap[i]))for(var j in i=i.cells)(j=i[j])._editor&&j._editor!==profile.$curEditor&&j._editor.setHeight(profile.$addpx(height,1,j._editor.getRootNode()))}))},_editCell:function(profile,cellId,byhover,inactive){var cell="string"==typeof cellId?profile.cellMap[cellId]:cellId;if(cell){cellId=cell._serialId;var box=profile.box,getPro=function(key,_cell){return box.getCellOption(profile,_cell||cell,key)};if(!getPro("disabled")&&!getPro("readonly")&&getPro("editable")){var editor,cap,grid=this,prop=profile.properties,cb=profile.getRoot().contentBox(),type=getPro("type")||"input",col=cell._col,row=(col.id,cell._row),ishotrow=row.id==profile.box._temprowid,editMode=getPro("editMode"),adjustEditorInput=getPro("adjustEditorInput"),inline="inline"==editMode||"dropbutton"==getPro("type"),baseNode=profile.getSubNode("SCROLL"+row._region+col._region),cellNode=profile.getSubNode("CELL",cellId),offX=0;if("infirstcell"==prop.treeMode&&0===profile.properties.header.indexOf(col)&&(cap=profile.getSubNode("CELLCAPTION",cellId))&&!cap.isEmpty()&&(offX=cap.offsetLeft()-(cb?1:0)),inline||((editor=profile.$curEditor)&&xui.tryF(editor.undo,[],editor),editor=null),inline&&cell._editor)inactive||cell._editor.activate();else if("checkbox"!=type&&"button"!=type){if((editor=getPro("customEditor"))&&"function"==typeof editor.iniEditor)editor.iniEditor(profile,cell,cellNode),inactive||xui.tryF(editor.activate,[],editor),profile.onBeginEdit&&profile.boxing().onBeginEdit(profile,cell,editor,"cell",cell._row,cell._col);else{if(profile.beforeIniEditor&&!1===(editor=profile.boxing().beforeIniEditor(profile,cell,cellNode,baseNode,"cell",cell._row,cell._col)))return;if("label"==type)return void(inactive||profile.getSubNode("CELLA",cellId).focus(!0));if(!editor||!editor["xui.UI"]){var oldProp,editorAutoPop=getPro("editorAutoPop"),editorCacheKey=getPro("editorCacheKey"),editorProperties=getPro("editorProperties"),editorCC=getPro("editorCC"),editorCS=getPro("editorCS"),editorEvents=getPro("editorEvents"),editorFormat=getPro("editorFormat"),editorMask=getPro("editorMask"),editorReadonly=getPro("editorReadonly"),editorHAlign=getPro("editorHAlign"),editorDropListWidth=getPro("editorDropListWidth"),editorDropListHeight=getPro("editorDropListHeight"),editorCommandBtn=getPro("editorCommandBtn"),beforeEditApply=getPro("beforeEditApply");if(inline||(editorCacheKey&&profile.$cache_editor[editorCacheKey]&&(editor=profile.$cache_editor[editorCacheKey]),!editor||editor.get(0)&&!editor.isDestroyed()||(editor=null)),!editor){var iniprop={dirtyMark:!1,cachePopWnd:!1,left:-1e3,top:-1e3,position:"absolute",visibility:"hidden",zIndex:100};inline&&xui.merge(iniprop,{left:offX,top:0,cachePopWnd:!0,width:Math.max(0,profile.$px(cell._col._colWidth)-offX+(cb?2:1)),height:profile.$px(cell._row._rowHeight)+(cb?1:0),visibility:"visible",zIndex:100},"all"),editor=new xui.UI.ComboInput(iniprop)}switch(type){case"number":case"spin":case"counter":case"currency":editor.setType(type),xui.each(xui.toArr("precision,increment,min,max,maxlength,currencyTpl,numberTpl,groupingSeparator,decimalSeparator,forceFillZero,trimTailZero,unit,units"),(function(key,u){var v=getPro(key);"currency"==type?"precision"!=key||v||(v=2):("precision"!=key||v||(v=0),"increment"!=key||v||(v=1)),xui.isSet(v)&&editor["set"+xui.str.initial(key)](v)}));break;case"progress":editor.setType("spin").setMax(1).setMin(0).setPrecision(4).setIncrement(.01);break;case"input":editor.setType("none");break;case"textarea":editor.setType("none").setMultiLines(!0).setCommandBtn("save").onCommand((function(p){p.boxing().hide()})),inline||xui.tryF(editor.setResizer,[!0],editor);break;case"date":case"datetime":var dateEditorTpl=getPro("dateEditorTpl");dateEditorTpl&&editor.setDateEditorTpl(dateEditorTpl);case"listbox":case"combobox":case"helpinput":case"time":case"color":case"getter":case"popbox":case"dropbutton":case"cmdbox":editor.setType(type),profile.box.getCellOption(profile,cell,"disabled")||(editor.beforeComboPop((function(editorprf,pos,e,src){var cell=editorprf.$cell,onClickCell=profile.box.getCellOption(profile,cell,"onClickCell");return"function"==typeof onClickCell?onClickCell.call(profile._host||profile,profile,cell,editorprf,pos,e,src):profile.boxing().beforeComboPop(profile,cell,editorprf,pos,e,src,cell._row,cell._col)})),profile.beforePopShow&&editor.beforePopShow((function(editorprf,popCtl,items){return editorEvents&&editorEvents.beforePopShow&&editorEvents.beforePopShow(editorprf,popCtl,items),profile.boxing().beforePopShow(profile,editorprf.$cell,editorprf,popCtl,items,editorprf.$cell._row,editorprf.$cell._col)})),profile.afterPopShow&&editor.afterPopShow((function(editorprf,popCtl){return profile.boxing().afterPopShow(profile,editorprf.$cell,editorprf,popCtl,editorprf.$cell._row,editorprf.$cell._col)})),"popbox"!=type&&"cmdbox"!=type&&"getter"!=type&&"dropbutton"!=type||profile.onEditorClick&&editor.onClick((function(prf,e,src,btn){return profile.boxing().onEditorClick(profile,prf.$cell,prf,btn,src,prf.$cell._row,prf.$cell._col)})));break;case"file":editor.setType(type)}if(profile.onCommand&&editor.onCommand((function(editorprf,node,type){return profile.boxing().onCommand(profile,editorprf.$cell,editorprf,node,type,editorprf.$cell._row,editorprf.$cell._col)})),cell._editor=editor,inline?cellNode.append(editor):baseNode.append(editor),cellNode.addClass("editing"),!inline&&editorCacheKey&&(profile.$cache_editor[editorCacheKey]=editor),editor.setInputReadonly&&editor.setInputReadonly(!!editorReadonly),editor.setDropListWidth&&editorDropListWidth&&editor.setDropListWidth(editorDropListWidth),editor.setDropListHeight&&editorDropListHeight&&editor.setDropListHeight(editorDropListHeight),editor.setHAlign&&editorHAlign&&editor.setHAlign(editorHAlign),editor.setCommandBtn&&editorCommandBtn&&editor.setCommandBtn(editorCommandBtn),editorFormat&&("function"==typeof editorFormat&&editor.beforeFormatCheck?editor.beforeFormatCheck(editorFormat):"string"==typeof editorFormat&&editor.setValueFormat&&editor.setValueFormat(editorFormat)),editorMask&&editor.setMask&&editor.setMask(editorMask),editorProperties){oldProp={};var h=profile.getProperties();xui.each(editorProperties,(function(o,i){oldProp=h[i]})),editor.setProperties(editorProperties)}switch(editorCC&&editor.setCustomClass(xui.clone(editorCC,2)),editorCS&&editor.setCustomStyle(xui.clone(editorCS,2)),editorEvents&&editor.setEvents(editorEvents),inline||editor.resetValue(),type){case"listbox":case"combobox":case"helpinput":(t=getPro("editorListItems"))?(editor.setListKey(null),editor.setItems("function"==typeof t?t():t)):(t=getPro("editorListKey"))&&(editor.setItems(null),editor.setListKey("function"==typeof t?t():t))}editor.setValue(xui.isSet(cell.$editorValue)?cell.$editorValue:cell.value,!0,"editorini"),delete cell.$editorValue,editor.setCaption&&(editorProperties&&"caption"in editorProperties&&xui.isDefined(editorProperties.caption)?editor.setCaption(editorProperties.caption,!0):"cmdbox"!=type&&"popbox"!=type&&"button"!=type&&"dropbutton"!=type||editor.setCaption(cell._caption||cell._$tmpcap||cell.caption||"",!0)),cell.$tag&&(editor.setCaption?editor.setCaption(cell.$tag):editor.setValue&&editor.setValue(cell.$tag,null,"editortag")),editor.get(0).$cell=cell,editor.get(0)._smartnav=!0;var cc,nc,g1=profile.boxing(),pos=g1.getCellPos(cell),_getcell=function(editorPrf){return pos?g1.getCellbyRowCol(pos.row,pos.col):editorPrf.$cell};if(editor[inline?"remove":"undo"]=function(refocus,inactive){var editor=this;if(editor.undo=null,profile.getSubNode("CELL",_getcell(editor.get(0))._serialId).removeClass("editing"),profile.box&&profile.box._trycheckrowdirty(profile,profile.$cellInEditor),inactive||(editor.get(0)&&editor.get(0).box&&(editor.getSubNode("INPUT").onBlur(!0),refocus&&xui.str.endWith(editMode,"sharp")&&(cell._ignorefocus=1,profile.boxing().focusCell(profile.$cellInEditor),xui.asyRun((function(){delete cell._ignorefocus})))),editor.getRoot().setBlurTrigger(profile.$xid+":editor"),profile.properties&&!profile.properties.directInput&&(editor.beforeUnitUpdated(null).afterUIValueSet(null).beforeNextFocus(null).onCancel(null).afterPopHide(null),editor.setValue("",!0,"editorreset")),editorFormat&&(editor.beforeFormatCheck&&editor.beforeFormatCheck(null),editor.setValueFormat&&editor.setValueFormat("")),editorMask&&editor.setMask&&editor.setMask(""),editor.setInputReadonly&&editor.setInputReadonly(!editorReadonly),editorDropListWidth&&editor.setDropListWidth&&editor.setDropListWidth(0),editorDropListHeight&&editor.setDropListHeight&&editor.setDropListHeight(0),oldProp&&(editor.setProperties(oldProp),oldProp=null),delete editor.get(0).$cell,delete editor.get(0)._smartnav,editor.hide(),xui.isFun(editor.collapse)&&editor.collapse()),editorEvents){var h={};xui.each(editorEvents,(function(o,i){h[i]=null})),editor.setEvents(h)}profile.$curEditor=null,profile.$cellInEditor=null,profile.onEndEdit&&profile.boxing().onEndEdit(profile,cell,editor,"cell",cell._row,cell._col),!editorCacheKey&&editor.get(0)&&editor.destroy(!0),cell._editor=editor=null},editor.beforeUnitUpdated((function(editorPrf,v){if(cc=_getcell(editorPrf),profile.beforeUnitUpdated&&!1===g1.beforeUnitUpdated(profile,cc,editorPrf,v,cc._row,cc._col))return!1;grid._updCell(profile,cc,{value:cc.value,unit:v},profile.properties.dirtyMark,!0,!0),(nc=_getcell(editorPrf))&&nc!==cc&&(editorPrf.$cell=nc,nc._editor=editor,inline||(profile.$cellInEditor=nc))})).afterUIValueSet((function(editorPrf,oV,nV,force,tag){if(cc=_getcell(editorPrf)){var caption,type=getPro("type",cc);switch(type){case"number":case"spin":case"counter":case"progress":nV=(nV=parseFloat(nV))||0===nV?nV:null;break;case"currency":nV=(nV=parseFloat((""+nV).replace(/[^\d.-]/g,"")))||0===nV?nV:null;break;case"cmdbox":case"button":case"dropbutton":case"popbox":case"combobox":case"listbox":case"helpinput":caption=editorPrf.boxing().getShowValue()}var options={value:nV};xui.isDefined(caption)&&(options.caption=caption),editorPrf.properties.hasOwnProperty("tagVar")&&!xui.isEmpty(editorPrf.properties.tagVar)&&(options.tagVar=editorPrf.properties.tagVar),!1!==(profile.beforeEditApply&&profile.boxing().beforeEditApply(profile,cc,options,editor,tag,"cell",cc._row,cc._col))&&(!1!==(beforeEditApply&&beforeEditApply(options,cc,profile,editor))&&(profile._setFromEditor=1,grid._updCell(profile,cc,options,profile.properties.dirtyMark,!0,!0),delete profile._setFromEditor),(nc=_getcell(editorPrf))&&nc!==cc&&(editorPrf.$cell=nc,nc._editor=editor,inline||(profile.$cellInEditor=nc)),xui.str.endWith(editMode,"sharp")&&"spin"!=type&&"counter"!=type&&xui.tryF(editor.undo,[!0],editor))}})).beforeNextFocus((function(editorPrf,e){editor.undo&&xui.tryF(editor.undo,[!0],editor);var hash=xui.Event.getEventPara(e);return"enter"==hash.key&&(hash.$key="right"),profile.getSubNode("CELLA",cell._serialId).onKeydown(!0,hash),!1})).onFileDlgOpen((function(editorPrf,src){profile.onFileDlgOpen&&profile.boxing().onFileDlgOpen(profile,cell,editorPrf,src,cell._row,cell._col)})),!inline){editor.onCancel((function(){editor&&xui.tryF(editor.undo,[],editor)})).afterPopHide((function(p,r,type){xui.str.endWith(editMode,"sharp")&&xui.tryF(editor.undo,["blur"!=type&&"call"!=type],editor)})).getRoot().setBlurTrigger(profile.$xid+":editor",(function(){return editor&&xui.tryF(editor.undo,[],editor),!1}));var t,absPos=cellNode.offset(null,baseNode),size=cellNode.cssSize(),w2=-1,mw=-1,mh=-1,h2=-1;if(offX&&offX>size.width-8)return;"textarea"==type&&(mw=200,mh=100),(t=editorProperties&&editorProperties.width)&&(w2=xui.CSS.$px(t)||0),"fill"==t&&(mw=Math.max(mw,baseNode.get(0).clientWidth)),(t=editorProperties&&editorProperties.height)&&(h2=xui.CSS.$px(t)||0),editor.setWidth(Math.max(mw,w2,size.width-offX+(cb?3:0))).setHeight(Math.max(mh,h2,size.height+(cb?2:0))).reLayout(!0,!0),-1!=mw||-1!=mh?editor.reBoxing().popToTop(cellNode,4,baseNode):editor.reBoxing().show(absPos.left+offX-(cb?1:0)+"px",absPos.top-(cb?1:0)+"px");var expand,noInputType="cmdbox"==type||"cmdbox"==type||"listbox"==type||"file"==type,insPopType=noInputType||"date"==type||"time"==type||"datetime"==type||"color"==type,inputReadonly=editor.getInputReadonly&&editor.getInputReadonly(),issharp=xui.str.endWith(editMode,"sharp")&&(editorAutoPop||inputReadonly||insPopType);if(inactive||xui.isFun(editor.expand)&&!1!==editorAutoPop&&(issharp||(xui.str.endWith(editMode,"sharp")||"focus"==editMode)&&(editorAutoPop||noInputType))&&(expand=1,editor.expand(cellNode,!1,null)),inline||editor.setVisibility(issharp?"hidden":"visible"),xui.str.startWith(editMode,"hover")&&byhover){var bfun=function(){editor&&editor.getRoot().onMouseout(null,"tg-hover-edit")},dfun=function(){};editor.onFocus(bfun).beforePopShow((function(editorprf,popCtl,items){var rst;return bfun(),editor.onBlur(null),editorEvents&&editorEvents.beforePopShow&&(rst=editorEvents.beforePopShow(editorprf,popCtl,items)),profile.beforePopShow&&(rst=profile.boxing().beforePopShow(profile,editorprf.$cell,editorprf,popCtl,items,editorprf.$cell._row,editorprf.$cell_col)),rst})).afterPopHide((function(){editor&&editor.getRoot().onMouseout((function(){editor&&xui.tryF(editor.undo,[],editor)}),"tg-hover-edit"),editor.onBlur(dfun)})).onBlur(dfun),inactive||expand||xui.tryF(editor&&editor.activate,[],editor)}else inactive||xui.asyRun((function(){if(profile.box){var target=editor;target.get(0)&&target.get(0).box&&(expand&&editor.getPopWnd&&(target=editor.getPopWnd()),target&&(xui.tryF(target&&target.activate,[],target),target.get(0)._stopmouseupcaret=1))}}))}adjustEditorInput&&adjustEditorInput(cell,editor,profile),profile.onBeginEdit&&profile.boxing().onBeginEdit(profile,cell,editor,"cell",cell._row,cell._col)}}inline||(profile.$curEditor=editor,profile.$cellInEditor=cell),editor.get(0).$editMode=editMode,ishotrow&&(profile.__needchecktmprow=!0,profile.box._sethotrowoutterblur(profile))}else inactive||profile.getSubNode("CELLA",cellId).focus(!0)}}},_adjustBody:function(profile,trigger,callback){profile.renderId&&!profile.destroyed&&(xui.resetRun(profile.$xid+"4",(function(){if(profile.renderId&&!profile.destroyed){var w2,prop=profile.properties,us=xui.$us(profile),adjustunit=function(v,emRate){return profile.$forceu(v,us>0?"em":"px",emRate)},size=profile.getSubNode("BORDER").cssSize(),_border=profile.getRoot().contentBox()?2:0,width=profile.$px(size.width),height=profile.$px(size.height),w1=prop.rowHandler?profile.$px(prop.rowHandlerWidth)+_border:0,h2=(profile.getSubNode("HEADER1"),profile.getSubNode("HEADER2")),b12=profile.getSubNode("BODY12"),b21=profile.getSubNode("BODY21"),s11=profile.getSubNode("SCROLL11"),s12=profile.getSubNode("SCROLL12"),s21=profile.getSubNode("SCROLL21"),s22=profile.getSubNode("SCROLL22"),rh=h2.height(),rr=b12.height();prop.freezedColumn&&xui.arr.each(prop.header,(function(col,i){if(i==prop.freezedColumn)return!1;col.hidden||(w1+=profile.$px(col.width)+_border)})),rr&&prop.freezedRow&&(rr-=1),w1&&prop.freezedColumn&&(w1-=1),w2=width-w1,profile._leftregionw=w1,h2.width(adjustunit(w2)),s22.width(adjustunit(w2)),xui.asyRun((function(){var b21e=b21.isEmpty(),s21e=s21.isEmpty(),b12e=b12.isEmpty(),s12e=s12.isEmpty(),fr=prop.freezedRow,pb=s21e?"":(s22.isScrollBarShowed("x")?xui.Dom.getScrollBarSize():0)+"px",st=s21e?0:s22.scrollTop(),sl=fr&&!s12e?s22.scrollLeft():0,pr=fr&&!b12e?(s22.isScrollBarShowed("y")?xui.Dom.getScrollBarSize():0)+"px":"";b21e||b21.css("padding-bottom",pb),fr&&!b12e&&b12.css("padding-right",pr),s21e||s21.scrollTop(st),fr&&!s12e&&s12.scrollLeft(sl)}),100),s11.height(rr?adjustunit(rr):0),s12.height(rr?adjustunit(rr):0),s21.height(adjustunit(height-rh-rr)),s22.height(adjustunit(height-rh-rr)),s11.css("display",rr&&profile._leftregionw?"":"none"),s12.css("display",rr?"":"none"),s21.css("display",profile._leftregionw?"":"none"),s22.css("overflow","hidden");var t,l,last,ww,bw,hiw,bodyw,overflowX=profile.box._adjustRelWith(profile),body=profile.getSubNode("ROWS22"),header=profile.getSubNode("HCELLS2"),scroll=(profile.properties.header,profile.getSubNode("SCROLL22"));if(profile.keys,body.get(0).clientHeight)if(header.get(0).clientHeight){if(t=header.get(0).childNodes)for(l=t.length;l;){if(t[l-1].clientHeight){last=t[l-1];break}--l}hiw=adjustunit(ww=last?last.offsetWidth+last.offsetLeft+100:0),bodyw=adjustunit(bw=ww)}else if(t=body.get(0).childNodes){for(l=t.length;l;){if(t[l-1].clientHeight){last=t[l-1];break}--l}if(last){var sid=profile.getSubId(last.id);if(t=(t=profile.getSubNode("CELLS2",sid)).get(0).childNodes)for(l=t.length;l;){if(t[l-1].clientHeight){last=t[l-1];break}--l}}}if(last)bodyw=adjustunit(bw=last.offsetLeft);else{var hd=(prop=profile.properties).header,w=(prop.rows,0);xui.arr.each(hd,(function(o){!0!==o.hidden&&(w+="_colWidth"in o?profile.$px(o._colWidth):profile.$px(o.width)+_border)})),bodyw=adjustunit(bw=w)}t=last=null,hiw&&header.parent().width(hiw),bodyw&&body.width(bodyw),scroll.css("overflow","auto"),bw>scroll.width()+_border&&(overflowX="auto"),scroll.css("overflowX",overflowX),scroll.onScroll(),profile.onBodyLayout&&profile.boxing().onBodyLayout(profile,trigger),callback&&callback()}})),"render"!=trigger&&"rowhandler"!=trigger&&"foldrow"!=trigger&&"expandrow"!=trigger&&"setcol"!=trigger&&"resize"!=trigger&&xui.resetRun(profile.key+":"+profile.$xid,(function(){profile&&profile.box&&profile.boxing().triggerFormulas(null,trigger)})))},_adjustHeader:function(arr){var a=xui.copy(arr);return xui.arr.each(a,(function(o,i){a[i]=xui.copy(o)})),a},_adjustGrpColsData:function(profile,arr){if(!xui.isArr(arr))return xui.copy(arr);var header=profile.properties.header,len=header.length,SubID=xui.UI.$tag_subId,a=xui.copy(arr,(function(o){return o.from=parseInt(o.from,10)||0,o.to=parseInt(o.to,10)||0,o.from<=len&&o.to<=len&&o.to>=o.from}));xui.arr.each(a,(function(o,i){a[i]=xui.isHash?xui.copy(o):{}})),xui.arr.stableSort(a,(function(x,y){return x.from>y.from?1:x.from==y.from?x.to>y.to?-1:x.to==y.to?0:1:-1}));for(var j=0,m=a.length;j<m;j++)(grp=a[j])[SubID]=grp[SubID]||"-g_"+profile.pickSubId("grpCol"),grp.id=grp.id||grp[SubID],grp.caption||(grp.caption=grp.id),grp._isgroup=1,delete grp._grp,profile.colMap[grp[SubID]]=grp,profile.colMap2[grp.id]=grp[SubID];xui.arr.each(a,(function(o,i){for(var j=0;j<i;j++)a[i].to>a[j].from&&a[i].from<a[j].to&&(a[i].to>a[j].to&&(a[i].to=a[j].to),(a[i]._grp||(a[i]._grp=[])).push(a[j].id))})),xui.arr.each(header,(function(o){delete o._grp}));var grp,o,layer=0;for(j=0,m=a.length;j<m;j++)for(var i=(grp=a[j]).from;i<=grp.to;i++)((o=header[i])._grp||(o._grp=[])).push(grp.id),grp._layer||(grp._layer=o._grp.length),layer=Math.max(layer,grp._layer);return profile._headerLayers=layer,a},_adjustRows:function(profile,arr,ignoreMixColumn){var a,m,key,keys,mixcol,h={},hvalue={},hcap={},p=profile.properties,uid=p.uidColumn,rheader=[];return uid=uid?xui.arr.subIndexOf(p.header,"id",uid):-1,xui.arr.each(p.header,(function(c,i){key=c.id||c,keys=null,ignoreMixColumn||-1==key.indexOf(":")||(keys=key.split(":")),keys&&keys[0]&&keys[1]?(hvalue[keys[0]]=hcap[keys[1]]=i,rheader.push(keys[0],keys[1]),mixcol=1):(h[key]=i,rheader.push(key))})),a=xui.isArr(arr)&&arr.length&&"object"!=typeof arr[0]?[arr]:xui.copy(arr),xui.arr.each(a,(function(o,i){if(xui.isArr(o)?a[i]={cells:xui.copy(o)}:a[i]=xui.copy(o),mixcol&&xui.isArr(a[i].cells)){for(var col,cells1=a[i].cells,cells2=[],j=0,l=rheader.length;j<l;j++)(col=rheader[j])in h?cells2.push(cells1[j]):col in hvalue&&cells2.push({value:cells1[j],caption:cells1[++j]});a[i].cells=cells2}var tt=!xui.isHash(a[i])||a[i].cells&&xui.isObj(a[i].cells)?a[i].cells&&xui.isHash(a[i].cells)?2:0:1;if(!o.group&&tt){var hash,cells=[];xui.each(1==tt?a[i]:a[i].cells,(function(v,i){i in h?cells[h[i]]=xui.isHash(v)?v:{value:v}:(i in hvalue&&((hash=cells[hvalue[i]]||{}).value=v,cells[hvalue[i]]=hash),i in hcap&&((hash=cells[hcap[i]]||{}).caption=v,cells[hcap[i]]=hash))})),a[i].cells=cells}xui.arr.each(m=a[i].cells,(function(o,i){xui.isDefined(o)&&(o&&xui.isHash(o)?m[i]=xui.copy(o):m[i]={value:o})})),!("id"in a[i])&&-1!=uid&&m[uid]&&m[uid].value&&(a[i].id=m[uid].value)})),a},_adjustColsWidth:function(profile){var prop=profile.properties,header=prop.header,arr=prop.grpCols,border=profile.getRoot().contentBox()?2:0;if(prop.showHeader&&arr&&xui.isArr(arr)&&arr.length)for(var _left,_l,_w,_ww,grp,n,flag=!1,_l2=0,j=0,m=arr.length;j<m;j++){_l=_w=0,flag=!1,grp=arr[j],_left=0;for(var o,k=0;k<=grp.to;k++)o=header[k],_ww=profile.$px(o._colWidth,null,!0),prop.freezedColumn&&prop.freezedColumn==k&&!_l2&&(_l2=_left),k===grp.from&&(flag=!0,_l=_left),_left+=_ww+border,flag&&!o.hidden&&(_w+=_ww+border);n=profile.getSubNode("HCELL",grp._serialId),_w>border?n.css({display:"",left:profile.$forceu(_l-(prop.freezedColumn?grp.to>prop.freezedColumn-1?_l2:prop.rowHandler?-(profile.$px(prop.rowHandlerWidth)+border):0:0)),width:profile.$forceu(_w-border)}):n.css({display:"none"}),prop.freezedColumn&&prop.rowHandler&&grp._shadow&&(n=profile.getSubNode("HSCELL",grp._serialId),_w>border?n.css({display:"",left:profile.$forceu(_l+(profile.$px(prop.rowHandlerWidth)+border)),width:profile.$forceu(_w-border)}):n.css({display:"none"}))}},_adjustColsHeight:function(profile,force){var tt,l,th,col,rh,upper,grpcolsh,h2,map=profile.colMap,map2=profile.colMap2,_layers=profile._headerLayers,headerh=profile.properties.headerHeight,h=profile.$px(headerh,0,!0),cacuH=profile.$px(profile.box.$DataModel.headerHeight.ini,0,!0)*(_layers+1),border=profile.getRoot().contentBox()?2:0;(force||h<cacuH)&&(h=cacuH),profile.getSubNodes(["HCELLS1","HCELLS2","GRPCELLBOX1","GRPCELLBOX2"]).height(profile.$px2em(h)+"em"),h2=profile.$px2em(h-border)+"em",profile.getSubNode("FHCELL").css({height:h2}),_layers?(th=h/(_layers+1),profile.getSubNode("HCELL",!0).each((function(o){if(col=profile.getSubId(o.id),col=map[col]){if(col&&col._isgroup){for(var i in upper=0,map)(tt=map[i])._isgroup&&tt._layer<col._layer&&tt.from<=col.to&&tt.to>=col.from&&(upper+=profile.$px(tt.height||th));xui(o).top(profile.$px2em(upper)+"em"),rh=profile.$px(col.height||th)}else if(col._grp&&(l=col._grp.length)){for(grpcolsh=0,i=0;i<l;i++)(tt=map2[col._grp[i]])&&(grpcolsh+=profile.$px(map[tt].height||th));rh=h-grpcolsh}else rh=h;xui(o).height(profile.$px2em(rh-border)+"em"),col&&col._isgroup&&col._shadow&&(o=profile.getSubNode("HSCELL",col._serialId),xui(o).top(profile.$px2em(upper)+"em"),xui(o).height(profile.$px2em(rh-border)+"em"))}}))):profile.getSubNode("HCELL",!0).css({height:h2})},_focuscell:function(profile,e,src){if(!profile.properties.disabled&&!profile.properties.readonly&&xui.use(src).get(0)&&!profile.$_ensureOnce){profile.$_ensureOnce=1,xui.asyRun((function(){profile.$_ensureOnce=0}));var id,p=profile.properties,box=profile.box,getPro=box.getCellOption,cell=profile.cellMap[profile.getSubId(src)],mode=p.activeMode;if(!cell||!cell._ignorefocus){if(cell){var edit=!1,type=getPro(profile,cell,"type");getPro(profile,cell,"editable")&&(getPro(profile,cell,"disabled")||getPro(profile,cell,"readonly")?edit=!1:(edit=!0,"inline"==getPro(profile,cell,"editMode")&&"label"!==type||"dropbutton"==type?cell._editor&&cell._editor.activate():(box._editCell(profile,cell._serialId),xui(src).tagClass("-active",!1),xui.asyRun((function(){profile.box&&xui.use(src).parent().onMouseout(!0,{$force:!0}).parent().onMouseout(!0,{$force:!0})}))))),edit?cell&&"cell"==mode&&box._activeCell(profile,!1):cell&&"cell"==mode&&(id=xui.use(src).id(),box._activeCell(profile,id))}else{var row=profile.rowMap[profile.getSubId(src)];getPro(profile,row,"editable")&&(getPro(profile,row,"disabled")||getPro(profile,row,"readonly")||profile.boxing().editFirstCell(row))}"row"==mode&&(id=xui.use(src).parent(2).id(),box._activeRow(profile,id))}}},_getToggleNode:function(profile,rowId){return profile.getSubNode("ROWTOGGLE",rowId)},_showTips:function(profile,node,pos){if(!profile.properties.disableTips){if(profile.onShowTips)return profile.boxing().onShowTips(profile,node,pos);if(xui.Tips){var item,sid,id,pid,ppid,ks=profile.keys;if(!profile.properties.disabled)return id=node.id,pid=xui.get(node,["parentNode","id"])||"",ppid=xui.get(node,["parentNode","parentNode","id"])||"",sid=profile.getSubId(id),0==id.indexOf(ks.FHCELL)||0==pid.indexOf(ks.FHCELL)||0==ppid.indexOf(ks.FHCELL)?item={tips:profile.properties.tips}:0==id.indexOf(ks.FCELL)||0==pid.indexOf(ks.FCELL)?item=profile.rowMap[sid]:0==id.indexOf(ks.HCELL)||0==id.indexOf(ks.HSCELL)||0==pid.indexOf(ks.HCELLA)?item=profile.colMap[sid]:0!=id.indexOf(ks.CELL)&&0!=pid.indexOf(ks.CELLA)||(item=profile.cellMap[sid]),!item||(xui.Tips.show(pos,xui.isSet(item.tips)?item.tips:item._$tips||item._caption||item.caption),!1)}}},_adjustRelWith:function(profile){profile.properties,profile.colMap;var _ww,t2=profile.getSubNode("SCROLL22"),bW=profile.getSubNode("BODY22").contentBox()?2:0,width=t2.width(),borderW=0,borderC=0;profile.getSubNodes("HCELL",!0).each((function(hc){if(hc.clientHeight)return borderW=hc.offsetWidth-profile.$px(hc.style.width),!1}));var overflowX,fixW=0,relWTotal=0,relWCol=[],relWCol2=[];xui.each(profile.colMap,(function(col){col.hidden||col._isgroup||1!=col._region&&(col.flexSize?(relWTotal+=profile.$px(col.width),relWCol.push(col),relWCol2.push(col)):fixW+=profile.$px(col.width),borderC++)}));var lcellw=profile.getSubNode("LHCELL").get(0).clientWidth||0;if(profile.getSubNodes("LCELL",!0).each((function(hc){hc.children.length&&(lcellw=Math.max(lcellw,hc.clientWidth))})),profile.__lcellW=lcellw,!relWCol.length)return overflowX="auto",void profile.box._adjustColsWidth(profile);for(overflowX="hidden",t2.scrollable("y")&&(width-=xui.Dom.getScrollBarSize()),width-=profile.__lcellW,profile._relWTotal=relWTotal,profile._relAvailable=width-(fixW+borderC*borderW);relWCol.length&&width!=fixW+borderC*borderW;){for(var t,fW=profile._relAvailable,fW1=0,l=relWCol.length,retry=0,i=l-1;i>=0;i--){var col=relWCol[i],w=0===i?fW-fW1:Math.round(fW*(profile.$px(col.width)/relWTotal));w<0&&(w=0),_ww=w,col.hasOwnProperty("minWidth")&&(t=profile.$px(col.minWidth))>w&&(fixW+=t,_ww=t,xui.arr.removeFrom(relWCol,i),retry++),col.hasOwnProperty("maxWidth")&&(t=profile.$px(col.maxWidth))<w&&(fixW+=t,_ww=t,xui.arr.removeFrom(relWCol,i),retry++),col._colWidth=profile.$forceu(_ww),fW1+=_ww}if(0===retry||retry===l)break}return profile.box._adjustColsWidth(profile),relWCol2.length&&xui.arr.each(relWCol2,(function(col){var n,nodes=[];xui.each(col._cells,(function(o){(n=profile.getSubNode("CELL",o))._nodes.length&&nodes.push(n.get(0))})),(n=profile.getSubNode("HCELL",col._serialId))._nodes.length&&nodes.push(n.get(0)),profile.box._adjusteditorW(profile,xui(nodes).width(col._colWidth),profile.$px(col._colWidth)+bW)})),overflowX},_getRow:function(profile,row,type,splitMixColumn){if(row){if("data"==type)return xui.clone(row,!0);if("min"==type||"value"==type){var a=[];return xui.each(row.cells||row,(function(cell,j){a[j]="value"in cell?cell.value:cell})),a}return"map"==type?profile.boxing().getRawData(row,splitMixColumn):row}},$cancelHoverEditor:function(profile){if(!profile.destroyed){var t,type=xui.get(profile,["$curEditor","_nodes",0,"$editMode"])||"";if(xui.str.startWith(type,"hover")){var editor=profile.$curEditor;if("hover"==type&&(t=editor.get(0))&&t.$poplink)return!1;xui.tryF(editor.undo,[],editor)}}},_onresize:function(profile,width,height){var w2,prop=profile.properties,f=function(k){return profile.getSubNode(k)},us=xui.$us(profile),adjustunit=function(v,emRate){return profile.$forceu(v,us>0?"em":"px",emRate)},borderW=profile.getRoot().contentBox()?2:0,w1=prop.rowHandler?profile.$px(prop.rowHandlerWidth)+borderW:0,border=f("BORDER"),h2=(f("HEADER1"),f("HEADER2")),b12=f("BODY12"),s11=(f("BODY21"),f("SCROLL11")),s12=f("SCROLL12"),s21=f("SCROLL21"),s22=f("SCROLL22"),rh=h2.height(),rr=b12.height();width=width?profile.$px(width,null,!0):width,height=height?profile.$px(height,null,!0):height,border.cssSize({width:width?adjustunit(width):null,height:height?adjustunit(height):null}),width&&(prop.freezedColumn&&xui.arr.each(prop.header,(function(col,i){if(i==prop.freezedColumn)return!1;col.hidden||(w1+=profile.$px(col.width)+borderW)})),rr&&prop.freezedRow&&(rr-=1),w1&&prop.freezedColumn&&(w1-=1),w2=width-w1,profile._leftregionw=w1,h2.width(adjustunit(w2))),height&&(s11.height(rr?adjustunit(rr):0),s12.height(rr?adjustunit(rr):0),s21.height(adjustunit(height-rh-rr)),s22.height(adjustunit(height-rh-rr)),s11.css("display",rr?"":"none"),s12.css("display",rr?"":"none")),width&&(s11.css("display",profile._leftregionw?"":"none"),s21.css("display",profile._leftregionw?"":"none")),profile.$forceRelayout&&(this._adjustColsWidth(profile),this._adjustColsHeight(profile)),this._adjustBody(profile,"resize")}}}),xui.Class("xui.UI.Dialog","xui.UI.Widget",{Instance:{showModal:function(parent,left,top,callback,ignoreEffects){this.show(parent,!0,left,top,callback,ignoreEffects)},show:function(parent,modal,left,top,callback,ignoreEffects){return parent=parent||xui("body"),this.each((function(profile){if(!profile.inShowing){var t,p=profile.properties,us=xui.$us(profile),ins=profile.boxing();switch(p.initPos){case"auto":xui.isHash(left)?(top=left.top,left=left.left):(top=top||0===top?top:profile.$px(p.top),left=left||0===left?left:profile.$px(p.left));break;case"center":if(xui.isHash(left))top=left.top+(left.height-profile.$px(p.height))/2,left=left.left+(left.width-profile.$px(p.width))/2;else{var pr=parent.get(0)==xui("body").get(0)?xui.win:parent["xui.UI"]?parent.getRoot():parent,scale=pr==xui.win&&xui.ini.$zoomScale||1;top=top||0===top?top:Math.max(0,(pr.height()/scale-profile.$px(p.height))/2+pr.scrollTop()/scale),left=left||0===left?left:Math.max(0,(pr.width()/scale-profile.$px(p.width))/2+pr.scrollLeft()/scale)}}left<0&&(left=0),top<0&&(top=0),"max"==p.status&&(left=top=0);var f1=function(){parent.append(ins);var box=profile.box,root=profile.getRoot(),adjustunit=function(v,emRate){return profile.$forceu(v,us>0?"em":"px",emRate)};(p.iframeAutoLoad||p.ajaxAutoLoad)&&xui.UI.Div._applyAutoLoad(profile),!modal&&!p.modal||profile.$inModal||box._modal(profile),ins.activate();var tt=profile._$rs_args,fun=function(){profile.onShow&&profile.boxing().onShow(profile),delete profile.inShowing,delete profile.$inThread,xui.tryF(callback),p&&p.activeAnim&&xui.asyRun((function(){profile&&!profile.destroyed&&ins.setActiveAnim(p.activeAnim,!0)}))};"min"==p.status?box._min(profile,"min",fun,!0):"max"==p.status?box._max(profile,"max",fun,ignoreEffects):(xui.UI.$doResize(profile,tt&&tt[1]||p.width,tt&&tt[2]||p.height),root.show(left||0===left?adjustunit(left):null,top||0===top?adjustunit(top):null,fun,null,ignoreEffects),box._refreshRegion(profile))};profile.inShowing=1,(t=p.fromRegion)?profile.$inThread=xui.Dom.animate({border:"solid 1px #555",background:"#888",opacity:.1},{left:[t.left,left],top:[t.top,top],width:[t.width,profile.$px(p.width)],height:[t.height,profile.$px(p.height)]},null,f1,300,0,"expoIn").start():f1()}}))},hide:function(ignoreEffects){return this.each((function(profile){var pro=profile.properties,box=profile.box;xui.$us(profile),profile.getRoot().hide((function(){if(!profile.inHiding){if(profile.inHiding=1,profile.$inModal&&box._unModal(profile),"max"==pro.status||"min"==pro.status){var os=pro.status;box._restore(profile),pro.status=os}var t=pro.fromRegion,f1=function(){delete profile.inHiding,delete profile.$inThread};t?profile.$inThread=xui.Dom.animate({border:"solid 1px #555",background:"#888",opacity:.1},{left:[profile.$px(pro.left),t.left],top:[profile.$px(pro.top),t.top],width:[profile.$px(pro.width),t.width],height:[profile.$px(pro.height),t.height]},null,f1,300,0,"expoOut").start():f1()}}),null,ignoreEffects)})),this},close:function(triggerEvent,ignoreEffects){return this.each((function(profile){if(!(!1!==triggerEvent&&profile.beforeClose&&!1===profile.boxing().beforeClose(profile)||profile.inClosing)){profile.inClosing=1;var pro=profile.properties,t=pro.fromRegion,fun=function(){profile.boxing().destroy(ignoreEffects),delete profile.inClosing,delete profile.$inThread};t?profile.$inThread=xui.Dom.animate({border:"solid 1px #555",background:"#888",opacity:.1},{left:[pro.left,t.left],top:[pro.top,t.top],width:[pro.width,t.width],height:[pro.height,t.height]},null,fun,300,0,"expoOut").start():fun()}}))},activate:function(flag){var ifocus,self=this,profile=this.get(0);profile.box._active(profile,flag),this.getChildren(null,!0).each((function(o){if(xui.get(o,["properties","defaultFocus"])){try{xui.asyRun((function(){o.boxing().activate()}))}catch(e){}return ifocus=1,!1}})),xui.asyRun((function(){if(!1!==flag&&!ifocus)try{profile.getSubNode("CAPTION").focus(!0)}catch(e){}self.onActivated&&self.onActivated(profile)}))},isPinned:function(){return!!xui.get(this.get(0),["properties","pinned"])}},Initialize:function(){var ns=this,t=ns.getTemplate();xui.merge(t.FRAME.BORDER,{tabindex:"{tabindex}",className:"xui-uiborder-outset xui-uiborder-box xui-uiborder-radius-big xui-uibar",TABSTOP1:{$order:-1},TBAR:{tagName:"div",className:"xui-uibar-top",TBARTDL:{className:"xui-uibar-tdl xui-uiborder-radius-big-tl",TBARTDLT:{className:"xui-uibar-tdlt"}},TBARTDM:{$order:1,className:"xui-uibar-tdm",TBARTDMT:{className:"xui-uibar-tdmt"}},TBARTDR:{$order:2,className:"xui-uibar-tdr xui-uiborder-radius-big-tr",TBARTDRT:{className:"xui-uibar-tdrt"}},BARCMDL:{$order:3,tagName:"div",className:"xui-uibar-cmdl",style:"{_align}",RULER:{className:"xui-ui-ruler"},LTAGCMDS:{tagName:"span",className:"xui-ltag-cmds",style:"{_ltagDisplay}",text:"{ltagCmds}"},ICON:{$order:2,className:"xuicon {imageClass}  {picClass}",style:"{backgroundImage}{backgroundPosition}{backgroundSize}{backgroundRepeat}{iconFontSize}{imageDisplay}{iconStyle}",text:"{iconFontCode}"},CAPTION:{tabindex:"{tabindex}",className:"xui-title-node",text:"{caption}",$order:3}},BARCMDR:{$order:4,tagName:"div",className:"xui-uibar-cmdr",RTAGCMDS:{$order:0,tagName:"span",className:"xui-rtag-cmds",style:"{_rtagDisplay}",text:"{rtagCmds}"},INFO:{className:"xuicon",$fonticon:"xui-uicmd-info",style:"{infoDisplay}",$order:2},OPT:{className:"xuicon",$fonticon:"xui-uicmd-opt",style:"{optDisplay}",$order:3},PIN:{$order:4,className:"xuicon",$fonticon:"xui-uicmd-pin",style:"{pinDisplay}"},LAND:{$order:5,className:"xuicon",$fonticon:"xui-uicmd-land",style:"{landDisplay}"},REFRESH:{className:"xuicon",$fonticon:"xui-uicmd-refresh",style:"{refreshDisplay}",$order:6},MIN:{$order:7,className:"xuicon",$fonticon:"xui-uicmd-min",style:"{minDisplay}"},RESTORE:{$order:8,className:"xuicon",$fonticon:"xui-uicmd-restore",style:"display:none;"},MAX:{$order:9,className:"xuicon",$fonticon:"xui-uicmd-max",style:"{maxDisplay}"},CLOSE:{$order:10,className:"xuicon",$fonticon:"xui-uicmd-close",style:"{closeDisplay}"}},TBARTDB:{$order:5,tagName:"div",className:"xui-uibar-tdb xui-uiborder-inset xui-uiborder-radius"}},MAIN:{$order:2,tagName:"div",className:"xui-uicon-main",MAINI:{tagName:"div",className:"xui-uicon-maini",PANEL:{tagName:"div",style:"{_panelstyle};{_overflow};",className:"xui-uicontainer",text:"{html}"+xui.UI.$childTag}}},BBAR:{$order:3,tagName:"div",className:"xui-uibar-bottom xui-uibar",BBARTDL:{$order:1,className:"xui-uibar-tdl xui-uiborder-radius-big-bl"},BBARTDM:{$order:2,className:"xui-uibar-tdm"},BBARTDR:{$order:3,className:"xui-uibar-tdr xui-uiborder-radius-big-br"}},TABSTOP2:{$order:9}},"all"),t.$submap=xui.UI.$getTagCmdsTpl(),ns.setTemplate(t),xui.alert=ns.alert,xui.confirm=ns.confirm,xui.pop=ns.pop,xui.prompt=ns.prompt},Static:{Appearances:{KEY:{overflow:"visible"},"LTAGCMDS, RTAGCMDS":{padding:0,margin:0,"vertical-align":"middle"},"TABSTOP1,TABSTOP2":{height:0,width:"16px",display:"inline",position:"absolute"},"TBART, BBART":{"border-spacing":0,"border-collapse":"separate"},MAINI:{"padding-top":".16667em"},PANEL:{position:"relative",overflow:"auto"},CAPTION:{display:"inline","vertical-align":xui.browser.ie6?"baseline":"middle"},BORDER:{position:"relative",outline:0}},Behaviors:{DroppableKeys:["PANEL"],PanelKeys:["PANEL"],DraggableKeys:["LAND"],NoDraggableKeys:["LAND","MIN","MAX","RESTORE","PIN","INFO","OPT","CLOSE","REFRESH","CMD"],HoverEffected:{LAND:"LAND",MIN:"MIN",MAX:"MAX",RESTORE:"RESTORE",PIN:"PIN",INFO:"INFO",OPT:"OPT",CLOSE:"CLOSE",REFRESH:"REFRESH",CMD:"CMD",ICON:"ICON"},ClickEffected:{LAND:"LAND",MIN:"MIN",MAX:"MAX",RESTORE:"RESTORE",PIN:"PIN",INFO:"INFO",OPT:"OPT",CLOSE:"CLOSE",REFRESH:"REFRESH",CMD:"CMD",ICON:"ICON"},onMousedown:function(profile,e){profile.$inModal||profile.box._active(profile)},afterKeydown:function(profile,e){var keys=xui.Event.getKey(e);if(9==(e.$key||e.keyCode||e.charCode)){if(xui.browser.ie){var id="xui::_specialforietab";xui.Dom.byId(id)||xui("body").append("<div style='display:none;position:absolute;' id="+id+"></div>"),xui.Dom.byId(id).innerHTML=xui.stamp()+""}var n1=profile.getSubNode("TABSTOP1").get(0),n2=profile.getSubNode("TABSTOP2").get(0),m=xui.Event.getSrc(e);keys.shiftKey?(m!==n1&&(n1.tabIndex=m.tabIndex),n2.removeAttribute("tabIndex")):(m!==n2&&(n2.tabIndex=m.tabIndex),n1.removeAttribute("tabIndex")),n1=n2=m=null}},onDragstop:function(profile){var p=profile.properties,root=(xui.$us(profile),profile.getRoot()),pos=root.cssPos(),l=null,t=null;profile.$px(p.left)!==pos.left&&(p.left=l=profile.$forceu(pos.left,null)),profile.$px(p.top)!==pos.top&&(p.top=t=profile.$forceu(pos.top,null)),root.cssPos({left:l,top:t}),!profile.onMove||null===l&&null===t||profile.boxing().onMove(profile,l,t,null,null)},TABSTOP1:{onFocus:function(profile,e,src){var t,o,tabindex=parseInt(xui.use(src).get(0).tabIndex||"1",10)-1,children=profile.getRoot().get(0).getElementsByTagName("*"),i=0;for(children.length;(o=children[i])&&!(1==o.nodeType&&o.tabIndex&&o.tabIndex<=tabindex&&(t||(t=o.tabIndex),o.tabIndex>t&&(t=o.tabIndex),t===tabindex));i++);o?(xui(o).focus(!0),xui.use(src).get(0).tabIndex=o.tabIndex):(o=profile.getRoot().nextFocus(!1,!0,!1),xui(o).focus(!0),xui.use(src).get(0).tabIndex=o.get(0).tabIndex),children=o=null}},TABSTOP2:{onFocus:function(profile,e,src){var t,o,tabindex=parseInt(xui.use(src).get(0).tabIndex||"1")+1,children=profile.getRoot().get(0).getElementsByTagName("*"),i=0;for(children.length;(o=children[i])&&!(1==o.nodeType&&o.tabIndex&&o.tabIndex>=tabindex&&(t||(t=o.tabIndex),o.tabIndex<t&&(t=o.tabIndex),t===tabindex));i++);o?(xui(o).focus(!0),xui.use(src).get(0).tabIndex=o.tabIndex):(o=profile.getRoot().nextFocus(!0,!0,!1),xui(o).focus(!0),xui.use(src).get(0).tabIndex=o.get(0).tabIndex),children=o=null}},TBAR:{beforeMousedown:function(profile,e,src){if(!profile.$inDesign&&"left"==xui.Event.getBtn(e)&&profile.getKey(xui.Event.getSrc(e).parentNode.id)!=profile.keys.BARCMDR){if("max"==profile.properties.status)return!1;if(profile.properties.movable&&!profile._locked){profile.box._active(profile);var root=profile.getRoot(),region=root.cssRegion(),pregion=root.parent().cssRegion(),dist=profile.getEmSize(),options=profile.properties.movingRegion?{dragDefer:2,maxLeftOffset:region.left,maxRightOffset:pregion.width-region.left-dist,maxTopOffset:region.top,maxBottomOffset:pregion.height-region.top-dist,magneticDistance:dist,xMagneticLines:[0,pregion.width-region.width],yMagneticLines:[0,pregion.height-region.height],targetOffsetParent:root.parent()}:{dragDefer:2};root.startDrag(e,options)}}},onDblclick:function(profile,e,src){profile.getKey(xui.Event.getSrc(e).parentNode.id)!=profile.keys.BARCMDR&&profile.properties.maxBtn&&("max"==profile.properties.status?profile.box._restore(profile):profile.box._max(profile))}},PIN:{onClick:function(profile,e,src){profile.keys.PIN;var t=profile.properties,ins=profile.boxing();profile.beforePin&&!1===profile.boxing().beforePin(profile,t.pinned)||(t.pinned=!t.pinned,profile.getSubNode("PIN").tagClass("-checked",t.pinned),profile._locked=t.pinned,t.resizer&&(t.pinned?profile.$resizer&&ins._unResizer():"min"!=t.status&&ins._resizer()))}},MIN:{onClick:function(profile,e,src){profile.box._min(profile,null,null,!0)}},MAX:{onClick:function(profile,e,src){profile.box._max(profile,null,null,!0)}},RESTORE:{onClick:function(profile,e,src){profile.box._restore(profile)}},LAND:{onClick:function(profile,e,src){profile.boxing().onLand(profile,e,src)}},PANEL:{onClick:function(profile,e,src){return!profile.properties.disabled&&(profile.onClickPanel?profile.boxing().onClickPanel(profile,e,src):void 0)}},INFO:{onClick:function(profile,e,src){profile.boxing().onShowInfo(profile,e,src)}},OPT:{onClick:function(profile,e,src){profile.boxing().onShowOptions(profile,e,src)}},REFRESH:{onClick:function(profile,e,src){profile.boxing().onRefresh(profile)}},CLOSE:{onClick:function(profile,e,src){profile.boxing().close()}},CMD:{onClick:function(profile,e,src){return profile.properties.disabled||profile.onCmd&&profile.boxing().onCmd(profile,xui.use(src).id().split("_")[1],e,src),!1}}},DataModel:{rotate:null,selectable:!0,tips:null,border:null,disabled:null,dock:"none",showEffects:"Classic",hideEffects:"",initPos:{ini:"center",listbox:["auto","center"]},iframeAutoLoad:{ini:"",action:function(){xui.UI.Div._applyAutoLoad(this)}},ajaxAutoLoad:{ini:"",action:function(){xui.UI.Div._applyAutoLoad(this)}},html:{html:1,action:function(v,ov,force){this.getSubNode("PANEL").html(xui.adjustRes(v,0,1),null,null,force)}},caption:{ini:undefined,action:function(v){v=(xui.isSet(v)?v:"")+"",this.getSubNode("CAPTION").html(xui.adjustRes(v,!0))}},image:{format:"image",action:function(v){xui.UI.$iconAction(this)}},imagePos:{action:function(value){this.getSubNode("ICON").css("backgroundPosition",value||"center")}},imageBgSize:{action:function(value){this.getSubNode("ICON").css("backgroundSize",value||"")}},imageClass:{ini:"",action:function(v,ov){xui.UI.$iconAction(this,"ICON",ov)}},iconFontCode:{action:function(v){xui.UI.$iconAction(this)}},shadow:!0,resizer:!0,movable:!0,movingRegion:!0,minBtn:{ini:!0,action:function(v){var o=this.getSubNode("MIN");v?o.setInlineBlock():o.css("display","none")}},maxBtn:{ini:!0,action:function(v){var o=this.getSubNode("MAX");v?o.setInlineBlock():o.css("display","none")}},restoreBtn:{ini:!0,action:function(v){var o=this.getSubNode("RESTORE");v?o.setInlineBlock():o.css("display","none")}},infoBtn:{ini:!1,action:function(v){this.getSubNode("INFO").css("display",v?"":"none")}},optBtn:{ini:!1,action:function(v){this.getSubNode("OPT").css("display",v?"":"none")}},closeBtn:{ini:!0,action:function(v){var o=this.getSubNode("CLOSE");v?o.setInlineBlock():o.css("display","none")}},refreshBtn:{ini:!1,action:function(v){this.getSubNode("REFRESH").css("display",v?"":"none")}},pinBtn:{ini:!1,action:function(v){var o=this.getSubNode("PIN");v?o.setInlineBlock():o.css("display","none")}},landBtn:{ini:!1,action:function(v){var o=this.getSubNode("LAND");v?o.setInlineBlock():o.css("display","none")}},width:{$spaceunit:1,ini:"25em"},height:{$spaceunit:1,ini:"25em"},minWidth:200,minHeight:100,position:"absolute",fromRegion:{hidden:!0,ini:null},modal:{ini:!1,action:function(v){this.box&&(v?this.box._modal(this):this.box._unModal(this))}},status:{ini:"normal",listbox:["normal","min","max"],action:function(v,o){var b=this.box;"min"==v?b._min(this,o,null,!0):"max"==v?b._max(this,o,null,!0):b._restore(this,o)}},hAlign:{ini:"left",listbox:["left","center","right"],action:function(v){this.getSubNode("BARCMDL").css("textAlign",v)}},tagCmds:{ini:[],action:function(){this.boxing().refresh()}},$hborder:1,$vborder:1},EventHandlers:{onIniPanelView:function(profile){},onShow:function(profile){},onActivated:function(profile){},beforePin:function(profile,value){},beforeStatusChanged:function(profile,newStatus,oldStatus){},afterStatusChanged:function(profile,newStatus,oldStatus){},onClickPanel:function(profile,e,src){},onLand:function(profile,e,src){},beforeClose:function(profile){},onShowInfo:function(profile,e,src){},onShowOptions:function(profile,e,src){},onRefresh:function(profile){},onCmd:function(profile,cmdkey,e,src){}},RenderTrigger:function(){this.destroyTrigger=function(){var s=this;s.$inModal&&s.box._unModal(s)}},LayoutTrigger:function(){if(this.properties.modal){var p=this.$modalDiv&&this.$modalDiv.parent(),b=this.box;p&&p.get(0)&&p.get(0)!==this.getRootNode()&&b._unModal(this),b._modal(this)}},_prepareData:function(profile){var data=arguments.callee.upper.call(this,profile),nodisplay="display:none";data.minDisplay=data.minBtn?"":nodisplay,data.maxDisplay=data.maxBtn?"":nodisplay,data.infoDisplay=data.infoBtn?"":nodisplay,data.optDisplay=data.optBtn?"":nodisplay,data.closeDisplay=data.closeBtn?"":nodisplay,data.pinDisplay=data.pinBtn?"":nodisplay,data.landDisplay=data.landBtn?"":nodisplay,data.refreshDisplay=data.refreshBtn?"":nodisplay,data._align="text-align:"+data.hAlign+";";var status=profile.properties.status;return"min"!=status&&"max"!=status||(profile.$noR=1),xui.isStr(data.overflow)&&(data._overflow=-1!=data.overflow.indexOf(":")?data.overflow:data.overflow?"overflow:"+data.overflow:""),xui.isEmpty(data.tagCmds)||this._prepareCmds(profile,data),data},_min:function(profile,status,effectcallback,ignoreEffects){var o=profile.getRoot(),box=profile.box,ins=(o.parent(),profile.boxing()),t=profile.properties,a=xui.Dom._getEffects(t.showEffects,1);if(profile.$inThread&&profile.$inThread.abort(),status||(status=t.status),!profile.beforeStatusChanged||!1!==profile.boxing().beforeStatusChanged(profile,"min",status)){"max"==status?box._unMax(profile):"normal"==status&&box._refreshRegion(profile),profile.getSubNodes(["PANEL","BBAR"]).css("display","none"),t.minBtn&&(t.restoreBtn&&profile.getSubNode("RESTORE").setInlineBlock(),profile.getSubNode("MIN").css("display","none")),t.resizer&&profile.$resizer&&ins._unResizer(),t.status="min";var h1=o.height(),h2=profile.getSubNode("BORDER").height(),h=profile.getSubNode("TBAR").height();o.cssSize({width:t.minWidth,height:h+h1-h2},!0),profile.afterStatusChanged&&profile.boxing().afterStatusChanged(profile,"min",status),a&&xui.browser.ie678&&xui.filter(a.params,(function(o,i){return!!xui.Dom._cssfake[i]})),o.show(null,null,effectcallback,null,ignoreEffects)}},_max:function(profile,status,effectcallback,ignoreEffects){var o=profile.getRoot(),box=profile.box,ins=profile.boxing(),t=(o.parent(),profile.properties),a=xui.Dom._getEffects(t.showEffects,1);status||(status=t.status),profile.$inThread&&profile.$inThread.abort(),profile.beforeStatusChanged&&!1===profile.boxing().beforeStatusChanged(profile,"max",status)||("min"==status?box._unMin(profile):"normal"==status&&box._refreshRegion(profile),t.pinBtn&&profile.getSubNode("PIN").css("display","none"),t.maxBtn&&(profile.getSubNode("MAX").css("display","none"),t.restoreBtn&&profile.getSubNode("RESTORE").setInlineBlock()),t.resizer&&profile.$resizer&&ins._unResizer(),t.status="max",ins.setDock("cover",!0),profile.afterStatusChanged&&profile.boxing().afterStatusChanged(profile,"max",status),a&&xui.browser.ie678&&xui.filter(a.params,(function(o,i){return!!xui.Dom._cssfake[i]})),o.show(null,null,effectcallback,null,ignoreEffects))},_restore:function(profile,status){profile.getRoot();var box=profile.box,t=profile.properties;status||(status=t.status),t.status="normal",profile.beforeStatusChanged&&!1===profile.boxing().beforeStatusChanged(profile,"normal",status)||("max"==status&&box._unMax(profile),"min"==status&&box._unMin(profile),profile.getSubNode("BORDER").ieRemedy(),profile.getSubNode("RESTORE").css("display","none"))},_unMax:function(profile){var t=profile.properties,ins=profile.boxing();profile.getSubNode("MAX").setInlineBlock(),t.pinBtn&&profile.getSubNode("PIN").setInlineBlock(),t.resizer&&!t.pinned&&ins._resizer(),ins.setDock("none"),profile.getRoot().cssSize({width:t.width,height:t.height}),profile.adjustSize(!0),profile.afterStatusChanged&&profile.boxing().afterStatusChanged(profile,"normal","max")},_unMin:function(profile){var t=profile.properties,ins=profile.boxing();profile.getSubNodes(["PANEL","BBAR"]).css("display","block"),profile.getSubNode("MIN").setInlineBlock(),t.resizer&&!t.pinned&&ins._resizer(),profile.getRoot().cssSize({width:t.width,height:t.height}),profile.adjustSize(!0),profile.afterStatusChanged&&profile.boxing().afterStatusChanged(profile,"normal","min")},_active:function(profile,flag){if(!profile.$inDesign&&(!1===flag||xui.$cache.unique.activeWndId!=profile.$xid)&&(this._deActive(),!1!==flag)){var o=xui(profile.domId),t1=o.topZindex(),t2=parseInt(o.css("zIndex"),0);o.css("zIndex",t1>t2?t1:t2),profile.getSubNode("TBAR").tagClass("-focus"),xui.$cache.unique.activeWndId=profile.$xid}},_deActive:function(){var profile;(profile=xui.UI._cache["$"+xui.$cache.unique.activeWndId])&&profile.getSubNode("TBAR").tagClass("-focus",!1),delete xui.$cache.unique.activeWndId},_modal:function(profile){var cover,s=profile.getRoot(),p=s.parent();if(!p.isEmpty()&&!profile.$inModal){(cover=profile.$modalDiv)&&cover.get(0)&&cover.get(0).parentNode||(cover=profile.$modalDiv=xui.create("<div class='xui-cover xui-custom xui-cover-modal' style='left:0;top:0;position:absolute;overflow:hidden;display:block;z-index:0;'></div>")).setSelectable(!1),p.append(cover),p.get(0)!==document.body&&p.get(0)!==document&&p.get(0)!==window||(p=xui.win),cover.css({display:"block",width:Math.max(p.width(),p.scrollWidth())+"px",height:Math.max(p.height(),p.scrollHeight())+"px"}).onMousedown((function(){return!!profile.$inDesign&&null})).topZindex(!0),profile.$inDesign&&cover.onClick((function(){s.onClick(!0)})),p.onSize((function(node){var w=(node=xui(node)).width()+"px",h=node.height()+"px";cover.css({width:w,height:h}),xui.asyRun((function(){var w=Math.max(node.width(),node.scrollWidth())+"px",h=Math.max(node.height(),node.scrollHeight())+"px";cover.css({width:w,height:h})}))}),"dialog:"+profile.serialId);var i=(parseInt(cover.css("zIndex"),10)||0)+1;s.css("zIndex",i),i>=xui.Dom.TOP_ZINDEX&&(xui.Dom.TOP_ZINDEX=i+1),profile.$inModal=!0,p.setBlurTrigger(profile.$xid+"_anti",!0,xui([cover.get(0),profile.getRootNode()]))}},_unModal:function(profile){if(profile.$inModal){var p=profile.$modalDiv.parent();p.get(0)!==document.body&&p.get(0)!==document&&p.get(0)!==window||(p=xui.win),p.onSize(null,"dialog:"+profile.serialId),profile.getRoot().css("zIndex",0),profile.$modalDiv.css("display","none");var node=profile.getSubNode("BORDER");node.isEmpty()||node.append(profile.$modalDiv),profile.$inModal=!1,p.setBlurTrigger(profile.$xid+"_anti")}},_refreshRegion:function(profile){if(profile.renderId){var prop=profile.properties,root=profile.getRoot(),us=xui.$us(profile),adjustunit=function(v,emRate){return profile.$forceu(v,us>0?"em":"px",emRate)},nr=root.cssRegion();return nr.left=adjustunit(nr.left),nr.top=adjustunit(nr.top),nr.width=adjustunit(nr.width),nr.height=adjustunit(nr.height),xui.merge(prop,nr,(function(o,i){return"auto"!=prop[i]}))}},_adjust:function(dialog,caption,content,dftTilte,left,top){caption=xui.adjustRes(caption||""),xui.isSet(content)&&""!==content||(content=caption,caption=dftTilte||"");var w,h,n2,node=dialog.$div.reBoxing(),ID="xui:temp:dialog",me=arguments.callee;xui.Dom.byId(ID)||(n2=me._cache=node.clone(!1),xui("body").append(n2),n2.css({overflow:"visible",position:"absolute",visibility:"visible",left:xui.Dom.HIDE_VALUE,top:xui.Dom.HIDE_VALUE}).id(ID,!0),n2.removeClass("xui-ui-hidden")),(n2=me._cache).width("auto").height("auto"),n2.html(content,!1);var size=n2.cssSize();size.width+=10,size.height+=10,node.html(content),size.width>500&&(size.width=500,n2.width(500),size.height=n2.offsetHeight()+10,n2.width("auto")),n2.html("",!1),size.height+=10,size.height>400&&(size.height=400),size.width<150&&(size.width=150),size.height<30&&(size.height=30),node.cssSize(size).css("overflow","auto").show();var fs=dialog.getRoot()._getEmSize();return w=size.width+2*fs,h=size.height+7.5*fs,dialog.setCaption(caption).setWidth(w).setHeight(h),{width:w,height:h}},alert:function(title,content,onClose,btnCap,left,top,parent,subId,noCache){var dialog,me=arguments.callee;if(noCache||!(dialog=me.dialog)||!dialog.get(0)||!dialog.get(0).renderId){var cmd=(dialog=new xui.UI.Dialog({overflow:"hidden",minBtn:!1,maxBtn:!1,pinBtn:!1,resizer:!1},{beforeClose:function(){if(xui.tryF(dialog._$onClose),dialog._$onClose=null,!noCache)return dialog.hide(),!1},onHotKeydown:function(p,k){"esc"==k.key&&dialog.close()}})).$cmd=new xui.UI.Div({height:"2.5em",dock:"bottom",zIndex:10},null,null,null,{KEY:"text-align:center;padding-top:.5em"}),btn=dialog.$btn=new xui.UI.SButton({position:"relative",tabindex:1},{onClick:function(){dialog.close()},onHotKeydown:function(p,k){"enter"==k.key&&dialog.close()}},null,null,{KEY:"margin:0 .5em"});cmd.append(btn);var div=dialog.$div=new xui.UI.Div({left:10,top:10});dialog.append(cmd).append(div).render(),noCache||(me.dialog=dialog)}return dialog._$onClose=onClose,dialog.$btn.setCaption("&nbsp;&nbsp;"+(btnCap||xui.wrapRes("$inline.ok"))+"&nbsp;&nbsp;"),xui.UI.Dialog._adjust(dialog,title,content,"Alert"),parent&&parent["xui.UI"]&&(parent=parent.getContainer(subId)),xui.isSet(parent)||(parent=xui("body")),dialog.show(parent,!0,left,top),xui.resetRun("dlg_focus:"+dialog.get(0).$xid,(function(){dialog.$btn.activate()})),dialog},confirm:function(title,caption,onYes,onNo,btnCapYes,btnCapNo,left,top,parent,subId,noCache){var dialog,me=arguments.callee;if(noCache||!(dialog=me.dialog)||!dialog.get(0)||!dialog.get(0).renderId){var cmd=(dialog=new xui.UI.Dialog({overflow:"hidden",minBtn:!1,maxBtn:!1,pinBtn:!1,resizer:!1},{beforeClose:function(){if(dialog._$_clicked?delete dialog._$_clicked:xui.tryF(dialog._$onNo,["close"]),dialog._$onYes=dialog._$onNo=null,!noCache)return dialog.hide(),!1},onHotKeydown:function(p,k){"esc"==k.key&&dialog.close()}})).$cmd=new xui.UI.Div({height:"2.5em",dock:"bottom",zIndex:10},null,null,null,{KEY:"text-align:center;padding-top:.5em"}),btn=dialog.$btn1=new xui.UI.SButton({tabindex:1,position:"relative"},{onClick:function(){xui.tryF(dialog._$onYes,["yes"]),dialog._$_clicked=1,dialog.close()}},null,null,{KEY:"margin:0 .5em"});cmd.append(btn),btn=dialog.$btn2=new xui.UI.SButton({tabindex:1,position:"relative"},{onClick:function(){xui.tryF(dialog._$onNo,["no"]),dialog._$_clicked=1,dialog.close()}},null,null,{KEY:"margin:0 .5em"}),cmd.append(btn);var div=dialog.$div=new xui.UI.Div({left:10,top:10});dialog.append(cmd).append(div).render(),noCache||(me.dialog=dialog)}return dialog._$onYes=onYes,dialog._$onNo=onNo,delete dialog._$_clicked,dialog.$btn1.setCaption("&nbsp;&nbsp;"+(btnCapYes||xui.wrapRes("$inline.yes"))+"&nbsp;&nbsp;"),dialog.$btn2.setCaption("&nbsp;&nbsp;"+(btnCapNo||xui.wrapRes("$inline.no"))+"&nbsp;&nbsp;"),xui.UI.Dialog._adjust(dialog,title,caption,"Confirm"),parent&&parent["xui.UI"]&&(parent=parent.getContainer(subId)),xui.isSet(parent)||(parent=xui("body")),dialog.show(parent,!0,left,top),xui.resetRun("dlg_focus:"+dialog.get(0).$xid,(function(){dialog.$btn2.activate()})),dialog},pop:function(title,content,btnCap,left,top,parent,subId){var dialog=new xui.UI.Dialog({overflow:"hidden",minBtn:!1,maxBtn:!1,pinBtn:!1,resizer:!1},{onHotKeydown:function(p,k){"esc"==k.key&&dialog.close()}}),cmd=dialog.$cmd=new xui.UI.Div({height:"2.5em",dock:"bottom",zIndex:10},null,null,null,{KEY:"text-align:center;padding-top:.5em"}).append(dialog.$btn=new xui.UI.SButton({caption:"&nbsp;&nbsp;"+(btnCap||"$inline.ok")+"&nbsp;&nbsp;",tabindex:1,position:"relative"},{onClick:function(){dialog.destroy()},onHotKeydown:function(p,k){"enter"==k.key&&dialog.close()}},null,null,{KEY:"margin:0 .5em"})),div=dialog.$div=new xui.UI.Div({left:10,top:10,width:"7em"}).setCustomStyle({KEY:"overflow:visible"});return dialog.append(cmd).append(div).render(),xui.UI.Dialog._adjust(dialog,title,content,"Message"),parent&&parent["xui.UI"]&&(parent=parent.getContainer(subId)),xui.isSet(parent)||(parent=xui("body")),dialog.show(parent,!1,left,top),xui.resetRun("dlg_focus:"+dialog.get(0).$xid,(function(){dialog.$btn.activate()})),dialog},prompt:function(title,caption,content,onYes,onNo,btnCapYes,btnCapNo,left,top,parent,subId,noCache){var dialog,me=arguments.callee;if(noCache||!(dialog=me.dialog)||!dialog.get(0)||!dialog.get(0).renderId){var con=(dialog=new xui.UI.Dialog({overflow:"hidden",minBtn:!1,maxBtn:!1,pinBtn:!1,left:left||200,top:top||200,width:"25em",height:"11em",conDockPadding:{left:".5em",right:".5em",top:0,bottom:0}},{beforeClose:function(){if(dialog._$_clickYes?delete dialog._$_clickYes:xui.tryF(dialog._$onNo,["no"]),dialog._$input.setValue("",!1,"prompt"),dialog._$onYes=dialog._$onNo=null,!noCache)return dialog.hide(),!1}}))._$caption=new xui.UI.Div({height:"1.5em",dock:"top"}),cmd=new xui.UI.Div({height:"2.5em",dock:"bottom",zIndex:10},null,null,null,{KEY:"text-align:center;padding-top:.5em"}).append(dialog.$btn1=new xui.UI.SButton({position:"relative",tabindex:1},{onClick:function(){!1!==xui.tryF(dialog._$onYes,[dialog._$input.getUIValue()])&&(dialog._$_clickYes=1,dialog.close())}},null,null,{KEY:"margin:0 .5em"}));cmd.append(dialog.$btn2=new xui.UI.SButton({tabindex:1,position:"relative"},{onClick:function(){dialog.close()}},null,null,{KEY:"margin:0 .5em"}));var inp=dialog._$input=new xui.UI.Input({dock:"fill",multiLines:!0});dialog.append(con).append(cmd).append(inp).render(),noCache||(me.dialog=dialog)}return dialog.setCaption(title||"Prompt"),dialog._$caption.setHtml(caption||""),dialog._$input.setValue(content||"",!0,"prompt"),dialog._$onYes=onYes,dialog._$onNo=onNo,delete dialog._$_clickYes,dialog.$btn1.setCaption("&nbsp;&nbsp;"+(btnCapYes||xui.wrapRes("$inline.ok"))+"&nbsp;&nbsp;"),dialog.$btn2.setCaption("&nbsp;&nbsp;"+(btnCapNo||xui.wrapRes("$inline.cancel"))+"&nbsp;&nbsp;"),parent&&parent["xui.UI"]&&(parent=parent.getContainer(subId)),xui.isSet(parent)||(parent=xui("body")),dialog.show(parent,!0,left,top),xui.resetRun("dlg_focus:"+dialog.get(0).$xid,(function(){dialog._$input.activate()})),dialog},_onresize:function(profile,width,height,force){width&&"min"==profile.properties.status&&(width=profile.properties.minWidth),profile.properties;var h1,h4,t,us=xui.$us(profile),adjustunit=function(v,emRate){return profile.$forceu(v,us>0?"em":"px",emRate)},size=arguments.callee.upper.apply(this,arguments),isize={},v0=profile.getSubNode("BORDER"),v1=profile.getSubNode("TBAR"),v2=profile.getSubNode("PANEL"),v4=profile.getSubNode("BBAR"),v5=profile.getSubNode("MAIN"),v6=profile.getSubNode("MAINI"),cb1=v0.contentBox(),cb2=v2.contentBox();width&&(width=profile.$px(width)),height&&(height=profile.$px(height)),size.left&&(size.left=profile.$px(size.left)),size.top&&(size.top=profile.$px(size.top)),size.width&&(size.width=profile.$px(size.width)),size.height&&(size.height=profile.$px(size.height)),height&&("auto"==height?isize.height=height:(h1=v1.offsetHeight(!0),h4=v4.offsetHeight(!0),(t=size.height-h1-h4)>0&&(isize.height=t))),height&&(isize.height=isize.height-xui.toFixedNumber(v6._paddingH(),2)-(cb1?0:v0._borderH())-(cb2?0:v2._borderH())),width&&(isize.width=size.width-(parseFloat(v6.css("paddingRight"))||0)-(parseFloat(v6.css("borderRightWidth"))||0)-(parseFloat(v5.css("paddingLeft"))||0)-(parseFloat(v5.css("borderLeftWidth"))||0)-(cb1?0:v0._borderW())-(cb2?0:v2._borderW())),width&&us>0&&(isize.width=adjustunit(isize.width)),height&&us>0&&(isize.height=adjustunit(isize.height)),v2.cssSize(isize,!0),width&&xui.UI._adjustConW(profile,v2,isize.width)}}}),xui.Class("xui.UI.FoldingList",["xui.UI.List"],{Instance:{fillContent:function(id,obj){var t,item,profile=this.get(0);return profile.renderId&&(item=profile.getItemByItemId(id))&&(t=profile.getSubNodeByItemId("BODYI",id).html(""),obj?(item._obj=obj,item._fill=!0,"string"==typeof obj?t.html(obj):t.append(obj.render(!0))):item._obj=item._fill=null),this},toggle:function(id){var profile=this.get(0);if(profile.renderId){var properties=profile.properties,items=properties.items,item=profile.getItemByItemId(id),subId=profile.getSubIdByItemId(id),node=profile.getSubNode("ITEM",subId),toggle=profile.getSubNode("TOGGLE",subId),nodenext=node.next();if(item._show){if(properties.activeLast&&items.length&&items[items.length-1].id==item.id)return!1;node.tagClass("-checked",!1),toggle.tagClass("-checked",!1),nodenext&&nodenext.tagClass("-prechecked",!1)}else if(node.tagClass("-checked"),toggle.tagClass("-checked"),nodenext&&nodenext.tagClass("-prechecked"),!item._fill){var callback=function(o){profile.boxing().fillContent(item.id,item._body=o)};if(profile.onGetContent){var r=profile.boxing().onGetContent(profile,item,callback);r&&callback(r)}else callback(profile.box._buildBody(profile,item))}item._show=!item._show}return this}},Initialize:function(){var t=this.getTemplate();t.ITEMS.className="{_bordertype}",t.$submap.items={ITEM:{tagName:"div",className:"xui-uiborder-flat xui-uiborder-radius {_checked} {_precheked} {itemClass} {disabled} {readonly}",style:"{itemStyle}",HEAD:{tagName:"div",className:"xui-uibar",HL:{tagName:"div"},HR:{tagName:"div"},TITLE:{tabindex:"{_tabindex}",TLEFT:{$order:0,tagName:"div",TOGGLE:{$order:0,className:"xuifont",$fonticon:"{_fi_tlg}"},LTAGCMDS:{$order:2,tagName:"span",style:"{_rtagDisplay}",text:"{ltagCmds}"},CAP1:{$order:1,className:"xui-title-node",text:"{title}"}},TRIGHT:{$order:1,tagName:"div",style:"{_capDisplay}",CAP2:{$order:0,text:"{caption}"},TAGCMDS:{$order:60,tagName:"span",style:"{_ltagDisplay}",text:"{rtagCmds}"}}}},BODY:{$order:1,tagName:"div",className:"xui-uibase",BODYI:{$order:0,tagName:"div",text:"{_body}"}},TAIL:{$order:4,tagName:"div",className:"xui-uibar",TL:{tagName:"div"},TR:{tagName:"div"}}}},this.setTemplate(t)},Static:{Appearances:{KEY:{padding:".25em"},ITEMS:{border:0,position:"relative",zoom:xui.browser.ie?1:null,"padding-top":".75em"},ITEM:{zoom:xui.browser.ie?1:null,"margin-top":"-7px",padding:0,position:"relative",overflow:"hidden","border-radius":"6px","box-shadow":"-1px -1px 2px #EDEDED"},"HEAD, BODY, BODYI, TAIL":{position:"relative"},BODY:{display:"none",zoom:xui.browser.ie?1:null,position:"relative",overflow:"auto"},BODYI:{padding:".25em .75em 0 .75em",position:"relative"},"BODY, BODYI":{},"ITEM-hover, ITEM-active, ITEM-checked":null,"ITEM-checked":{$order:2,"margin-bottom":"1em"},"ITEM-checked BODY":{$order:2,display:"block"},"HL, HR, TL, TR":{position:"absolute",width:".75em"},"HL, HR":{height:"2.5em"},"ITEM-prechecked HL":{$order:1},"ITEM-prechecked HR":{$order:1},"TL, TR":{height:"1.75em"},HL:{$order:1,top:0,left:0},HR:{$order:1,top:0,right:0},TL:{$order:1,bottom:0,left:0},TR:{$order:1,bottom:0,right:0},HEAD:{position:"relative",zoom:xui.browser.ie?1:null,overflow:"hidden"},TITLE:{$order:1,display:"block",position:"relative","white-space":"nowrap",overflow:"hidden",padding:".25em .5em"},TAIL:{position:"relative",height:".25em"},"CAP1, CAP2":{padding:".25em","vertical-align":"middle"},CAP1:{cursor:"pointer","white-space":"nowrap"},"ITEM-checked CAP1":{$order:2,"font-weight":"normal"},TLEFT:{position:"relative",left:".5em","white-space":"nowrap",overflow:"hidden"},TRIGHT:{position:"absolute",right:".5em",top:".25em","white-space":"nowrap",overflow:"hidden"}},Behaviors:{HoverEffected:{ITEM:"ITEM",HEAD:"HEAD",OPT:"OPT"},ClickEffected:{ITEM:null,HEAD:"HEAD"},ITEM:{onClick:null,onKeydown:null},HEAD:{onClick:function(profile,e,src){return profile.boxing().toggle(profile.getItemIdByDom(src)),!1}},OPT:{onMousedown:function(){return!1},onClick:function(profile,e,src){return profile.boxing().onShowOptions(profile,profile.getItemByDom(src),e,src),!1}}},DataModel:{lite:null,value:null,borderType:null,activeLast:!0},EventHandlers:{onGetContent:function(profile,item,onEnd){},onShowOptions:function(profile,item,e,src){}},RenderTrigger:function(){var item,pro=this.properties,items=pro.items;pro.activeLast&&items.length>0&&(item=items[items.length-1],this.boxing().fillContent(item.id,item._body))},_prepareItems:function(profile,arr,pid){if(arr.length&&(arr[0]._precheked=profile.getClass("ITEM","-prechecked"),profile.properties.activeLast)){var item=arr[arr.length-1];item._show=!0,item._fill=!0,item._body=profile.onGetContent?profile.boxing().onGetContent(profile,item,(function(o){profile.boxing().fillContent(item.id,item._body=o)})):profile.box._buildBody(profile,item)}return arguments.callee.upper.apply(this,arguments)},_prepareItem:function(profile,item){var p=profile.properties;item._tabindex=p.tabindex,item.caption?item.caption=item.caption.replace(/</g,"&lt;"):item._capDisplay="display:none",item._body=item._body||"Loading...",item._show?(item._checked=profile.getClass("ITEM","-checked"),item._fi_tlg="xuifont-checked xui-uicmd-toggle xui-uicmd-toggle-checked"):item._fi_tlg="xui-uicmd-toggle",this._prepareCmds(profile,item)},_buildBody:function(profile,item){return item.text?'<pre class="xui-node xui-node-div">'+item.text.replace(/</g,"&lt;")+"</pre>":""},_onresize:function(){}}}),xui.Class("xui.UI.FoldingTabs","xui.UI.Tabs",{Instance:{_setCtrlValue:function(value,init){this.each((function(profile){profile.domId;var box=profile.boxing(),uiv=init?"":box.getUIValue(),prop=profile.properties,fold=function(itemId,arr){var subId=profile.getSubIdByItemId(itemId),item=profile.getItemByItemId(itemId);if(subId){arr.push(subId);var itemnode=profile.getSubNode("BODY",subId);"none"!=itemnode.css("display")&&(item._scrollTop=itemnode.get(0).scrollTop||0,item._scrollTop&&(itemnode.get(0).scrollTop=0),itemnode.css("display","none"))}},expand=function(itemId,arr){var subId=profile.getSubIdByItemId(itemId),item=profile.getItemByItemId(itemId);if(subId){arr.push(subId);var itemnode=profile.getSubNode("BODY",subId);"none"==itemnode.css("display")&&(itemnode.css("display","block"),item._scrollTop&&(itemnode.get(0).scrollTop=item._scrollTop),profile.box._forLazyAppend(profile,item,itemId),profile.box._forIniPanelView(profile,item,itemId))}},arr1=[],arr2=[];"multi"==prop.selMode?(uiv=uiv?uiv.split(prop.valueSeparator):[],value=value?value.split(prop.valueSeparator):[],xui.arr.each(uiv,(function(key){-1==xui.arr.indexOf(value,key)&&fold(key,arr1)})),xui.arr.each(value,(function(key){-1==xui.arr.indexOf(uiv,key)&&expand(key,arr2)}))):(fold(uiv,arr1),expand(value,arr2)),arr1.length&&(profile.getSubNodes(["ITEM","TOGGLE"],arr1).tagClass("-checked",!1),profile.getSubNodes("ITEM",arr1).next().tagClass("-prechecked",!1)),arr2.length&&(profile.getSubNodes(["ITEM","TOGGLE"],arr2).tagClass("-checked"),profile.getSubNodes("ITEM",arr2).next().tagClass("-prechecked")),profile.adjustSize()}))},_afterInsertItems:null},Static:{Templates:{tagName:"div",style:"{_style};",BOX:{$order:0,tagName:"div",ITEMS:{tagName:"div",text:"{items}"}},$submap:{items:{ITEM:{tagName:"div",className:"xui-uiborder-flat xui-uiborder-radius {_checked} {_precheked} {itemClass} {disabled} {readonly}",style:"{_itemDisplay};{itemStyle};",HEAD:{tagName:"div",className:"xui-uibar  {_checked} {_precheked} ",HL:{tagName:"div"},HR:{tagName:"div"},TITLE:{tabindex:"{_tabindex}",TLEFT:{$order:0,tagName:"div",LTAGCMDS:{$order:0,tagName:"span",style:"{_ltagDisplay}",text:"{ltagCmds}"},TOGGLE:{$order:1,className:"xuifont {_tlgchecked}",$fonticon:"xui-uicmd-toggle"},ICON:{$order:2,className:"xuicon {imageClass}  {picClass}",style:"{backgroundImage}{backgroundPosition}{backgroundSize}{backgroundRepeat}{iconFontSize}{imageDisplay}{iconStyle}",text:"{iconFontCode}"},CAPTION:{$order:3,className:"xui-title-node",text:"{caption}"}},TRIGHT:{$order:1,tagName:"div",style:"{_capDisplay}",MESSAGE:{$order:0,text:"{message}"},CMDS:{$order:2,RTAGCMDS:{$order:0,tagName:"span",style:"{_rtagDisplay}",text:"{rtagCmds}"},OPT:{$order:1,className:"xuifont",$fonticon:"xui-uicmd-opt",style:"{_opt}"},POP:{className:"xuifont",$fonticon:"xui-uicmd-pop",style:"{popDisplay}",$order:1},CLOSE:{className:"xuifont",$fonticon:"xui-uicmd-close",style:"{closeDisplay}",$order:2}}}}},BODY:{$order:1,tagName:"div",className:"xui-uibase",BODYI:{tagName:"div",PANEL:{tagName:"div",style:"{_itemHeight};{_overflow};{_bginfo}",className:"xui-uibase xui-uicontainer",text:xui.UI.$childTag}}},TAIL:{$order:4,tagName:"div",className:"xui-uibar",TL:{tagName:"div"},TR:{tagName:"div"}}}},"items.ltagCmds":function(profile,template,v,tag,result){var me=arguments.callee,map=me._m||(me._m={text:".text",button:".button",image:".image"});xui.UI.$doTemplate(profile,template,v,"items.tagCmds"+(map[v.type]||".button"),result)},"items.rtagCmds":function(profile,template,v,tag,result){var me=arguments.callee,map=me._m||(me._m={text:".text",button:".button",image:".image"});xui.UI.$doTemplate(profile,template,v,"items.tagCmds"+(map[v.type]||".button"),result)},"items.tagCmds.text":xui.UI.$getTagCmdsTpl("text"),"items.tagCmds.button":xui.UI.$getTagCmdsTpl("button"),"items.tagCmds.image":xui.UI.$getTagCmdsTpl("image")}},Appearances:{KEY:{},BOX:{},"LTAGCMDS, RTAGCMDS":{padding:0,margin:0,"vertical-align":"middle"},ITEMS:{border:0,position:"relative",zoom:xui.browser.ie?1:null,padding:"11px 4px 4px 4px"},ITEM:{zoom:xui.browser.ie?1:null,"margin-top":"-7px",padding:0,position:"relative",overflow:"hidden","border-radius":"6px","box-shadow":"-1px -1px 2px #EDEDED"},"HEAD, BODY, BODYI, PANEL, TAIL":{position:"relative"},CMDS:{padding:".25em 0 0 .25em","vertical-align":"middle",position:"relative"},BODY:{display:"none",zoom:xui.browser.ie?1:null,position:"relative"},BODYI:{padding:"0 .25em"},PANEL:{overflow:"auto",padding:".25em"},"ITEM-hover":{},"ITEM-active, ITEM-checked":{},"ITEM-checked":{$order:2,"margin-bottom":"1em"},"ITEM-checked BODY":{$order:2,display:"block"},"HL, HR, TL, TR":{position:"absolute",width:".75em"},"HL, HR":{height:"2.5em"},"ITEM-prechecked HL":{$order:1},"ITEM-prechecked HR":{$order:1},"TL, TR":{height:"1.75em"},HL:{$order:1,top:0,left:0},HR:{$order:1,top:0,right:0},TL:{$order:1,bottom:0,left:0},TR:{$order:1,bottom:0,right:0},HEAD:{cursor:"pointer",position:"relative",zoom:xui.browser.ie?1:null,overflow:"hidden"},TITLE:{$order:1,display:"block",position:"relative","white-space":"nowrap",overflow:"hidden",padding:".25em .5em"},"BODY, BODYI":{overflow:"hidden"},TAIL:{height:".25em"},"CAPTION, MESSAGE":{padding:".25em","vertical-align":"middle"},MESSAGE:{"font-size":"1em"},CAPTION:{"white-space":"nowrap"},"ITEM-checked CAPTION":{$order:2,"font-weight":"bold"},TLEFT:{position:"relative",left:".5em",padding:"0 0 0 .5em","white-space":"nowrap",overflow:"hidden"},TRIGHT:{position:"absolute",right:".5em",top:".25em","white-space":"nowrap",overflow:"hidden"}},Behaviors:{DraggableKeys:["HEAD"],HoverEffected:{OPT:"OPT",CLOSE:"CLOSE",POP:"POP",ITEM:"HEAD"},ClickEffected:{OPT:"OPT",CLOSE:"CLOSE",POP:"POP",ITEM:"HEAD"},ITEM:{onClick:null},ITEMS:{onMousedown:null,onDrag:null,onDragstop:null},HEAD:{onClick:function(profile,e,src){if("left"==xui.Event.getBtn(e)){var prop=profile.properties,item=profile.getItemByDom(src),box=(profile.getSubId(src),profile.boxing());if(item){if(prop.disabled||item.disabled)return!1;if(prop.readonly||item.readonly)return!1;switch(profile.getSubNode("TITLE").focus(!0),prop.selMode){case"multi":var value=box.getUIValue(),arr=value?value.split(prop.valueSeparator):[],checktype=1;if(arr.length){-1!=xui.arr.indexOf(arr,item.id)?(xui.arr.removeValue(arr,item.id),checktype=-1):arr.push(item.id),arr.sort(),value=arr.join(prop.valueSeparator),box.getUIValue()!==value&&(box.setUIValue(value,null,null,"click"),box.get(0)&&box.getUIValue()==value&&box.onItemSelected(profile,item,e,src,checktype));break}case"single":box.getUIValue()!==item.id&&(box.setUIValue(item.id,null,null,"click"),box.get(0)&&box.getUIValue()==item.id&&box.onItemSelected(profile,item,e,src,1))}}}},onKeydown:function(profile,e,src){var keys=xui.Event.getKey(e),key=keys.key;if(keys.shiftKey," "==key||"enter"==key)return profile.getSubNode("HEAD",profile.getSubId(src)).onClick(),!1}}},DataModel:{$hborder:0,$vborder:0,noPanel:null,noHandler:null,HAlign:null,selMode:{ini:"single",listbox:["single","multi"]}},_prepareItems:function(profile,arr,pid){return arr.length&&(arr[0]._precheked=profile.getClass("ITEM","-prechecked")),arguments.callee.upper.apply(this,arguments)},_prepareItem:function(profile,item){var t,dpn="display:none",p=profile.properties;item.closeDisplay=item.closeBtn?"":dpn,item.popDisplay=item.popBtn?"":dpn,item._opt=item.optBtn?"":dpn,item._itemDisplay=item.hidden?dpn:"",item.height&&(item._itemHeight="height:"+profile.$forceu(item.height));var prop=profile.properties;item._tabindex=prop.tabindex,item.caption||(item._capDisplay=dpn),item._bginfo="",(t=item.panelBgClr||p.panelBgClr)&&(item._bginfo+="background-color:"+t+";"),(t=item.panelBgImg||p.panelBgImg)&&(item._bginfo+="background-image:url("+xui.adjustRes(t)+");"),(t=item.panelBgImgPos||p.panelBgImgPos)&&(item._bginfo+="background-position:"+t+";"),(t=item.panelBgImgRepeat||p.panelBgImgRepeat)&&(item._bginfo+="background-repeat:"+t+";"),(t=item.panelBgImgAttachment||p.panelBgImgAttachment)&&(item._bginfo+="background-attachment:"+t+";"),xui.isStr(item.overflow)?item._overflow=-1!=item.overflow.indexOf(":")?item.overflow:item.overflow?"overflow:"+item.overflow:"":xui.isStr(p.overflow)&&(item._overflow=-1!=p.overflow.indexOf(":")?p.overflow:p.overflow?"overflow:"+p.overflow:""),item._show&&(item._checked=profile.getClass("ITEM","-checked"),item._tlgchecked=profile.getClass("TOGGLE","-checked")),this._prepareCmds(profile,item)},_onresize:function(profile,width,height,force,key){force&&(profile._w=profile._h=null),width&&profile._w!=width&&(profile._w=width,profile.getSubNode("PANEL",!0).each((function(panel){if(panel.offsetWidth){xui(panel).width("auto");var w=xui(panel).width();profile.properties,xui.$us(profile)>0&&(w=profile.$px2em(w,panel)+"em"),xui(panel).width(w),xui.UI._adjustConW(profile,xui(panel),w)}})))},_adjustScroll:null}}),root=this,factory=function(){return function(modules){var installedModules={};function __webpack_require__(moduleId){if(installedModules[moduleId])return installedModules[moduleId].exports;var module=installedModules[moduleId]={exports:{},id:moduleId,loaded:!1};return modules[moduleId].call(module.exports,module,module.exports,__webpack_require__),module.loaded=!0,module.exports}return __webpack_require__.m=modules,__webpack_require__.c=installedModules,__webpack_require__.p="",__webpack_require__(0)}([function(module,exports,__webpack_require__){var __WEBPACK_AMD_DEFINE_ARRAY__,__WEBPACK_AMD_DEFINE_RESULT__;__WEBPACK_AMD_DEFINE_ARRAY__=[__webpack_require__(1),__webpack_require__(3),__webpack_require__(4)],(__WEBPACK_AMD_DEFINE_RESULT__=function(R){return R._in_xui=1,R}.apply(exports,__WEBPACK_AMD_DEFINE_ARRAY__))===undefined||(module.exports=__WEBPACK_AMD_DEFINE_RESULT__)},function(module,exports,__webpack_require__){var __WEBPACK_AMD_DEFINE_ARRAY__,__WEBPACK_AMD_DEFINE_RESULT__;__WEBPACK_AMD_DEFINE_ARRAY__=[__webpack_require__(2)],(__WEBPACK_AMD_DEFINE_RESULT__=function(eve){function R(first){if(R.is(first,"function"))return loaded?first():eve.on("raphael.DOMload",first);if(R.is(first,array))return R._engine.create[apply](R,first.splice(0,3+R.is(first[0],nu))).add(first);var args=Array.prototype.slice.call(arguments,0);if(R.is(args[args.length-1],"function")){var f=args.pop();return loaded?f.call(R._engine.create[apply](R,args)):eve.on("raphael.DOMload",(function(){f.call(R._engine.create[apply](R,args))}))}return R._engine.create[apply](R,arguments)}R.version="2.2.0",R.eve=eve;var loaded,paperproto,uuidRegEx,uuidReplacer,separator=/[, ]+/,elements={circle:1,rect:1,path:1,ellipse:1,text:1,image:1},formatrg=/\{(\d+)\}/g,has="hasOwnProperty",g={doc:document,win:window},oldRaphael={was:Object.prototype[has].call(g.win,"Raphael"),is:g.win.Raphael},Paper=function(){this.ca=this.customAttributes={}},apply="apply",supportsTouch="ontouchstart"in g.win||g.win.DocumentTouch&&g.doc instanceof g.win.DocumentTouch,E="",S=" ",Str=String,events="click dblclick mousedown mousemove mouseout mouseover mouseup touchstart touchmove touchend touchcancel contextmenu".split(S),touchMap={mousedown:"touchstart",mousemove:"touchmove",mouseup:"touchend"},lowerCase=Str.prototype.toLowerCase,math=Math,mmax=math.max,mmin=math.min,abs=math.abs,pow=math.pow,PI=math.PI,nu="number",array="array",objectToString=Object.prototype.toString,colourRegExp=(R._ISURL=/^url\(['"]?(.+?)['"]?\)$/i,/^\s*((#[a-f\d]{6})|(#[a-f\d]{3})|rgba?\(\s*([\d\.]+%?\s*,\s*[\d\.]+%?\s*,\s*[\d\.]+%?(?:\s*,\s*[\d\.]+%?)?)\s*\)|hsba?\(\s*([\d\.]+(?:deg|\xb0|%)?\s*,\s*[\d\.]+%?\s*,\s*[\d\.]+(?:%?\s*,\s*[\d\.]+)?)%?\s*\)|hsla?\(\s*([\d\.]+(?:deg|\xb0|%)?\s*,\s*[\d\.]+%?\s*,\s*[\d\.]+(?:%?\s*,\s*[\d\.]+)?)%?\s*\))\s*$/i),isnan={NaN:1,Infinity:1,"-Infinity":1},bezierrg=/^(?:cubic-)?bezier\(([^,]+),([^,]+),([^,]+),([^\)]+)\)/,round=math.round,toFloat=parseFloat,toInt=parseInt,upperCase=Str.prototype.toUpperCase,availableAttrs=R._availableAttrs={"arrow-end":"none","arrow-start":"none",blur:0,"clip-rect":"0 0 1e9 1e9",cursor:"default",cx:0,cy:0,fill:"#fff","fill-opacity":1,font:'10px "Arial"',"font-family":'"Arial"',"font-size":"10","font-style":"normal","font-weight":400,gradient:0,height:0,href:"http://raphaeljs.com/","letter-spacing":0,opacity:1,path:"M0,0",r:0,rx:0,ry:0,src:"",stroke:"#000","stroke-dasharray":"","stroke-dashoffset":0,"stroke-linecap":"butt","stroke-linejoin":"butt","stroke-miterlimit":0,"stroke-opacity":1,"stroke-width":1,target:"_blank","text-anchor":"middle",title:"Raphael",transform:"",width:0,x:0,y:0,class:""},availableAnimAttrs=R._availableAnimAttrs={blur:nu,"clip-rect":"csv",cx:nu,cy:nu,fill:"colour","fill-opacity":nu,"font-size":nu,height:nu,opacity:nu,path:"path",r:nu,rx:nu,ry:nu,stroke:"colour","stroke-opacity":nu,"stroke-width":nu,transform:"transform",width:nu,x:nu,y:nu},commaSpaces=/[\x09\x0a\x0b\x0c\x0d\x20\xa0\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028\u2029]*,[\x09\x0a\x0b\x0c\x0d\x20\xa0\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028\u2029]*/,hsrg={hs:1,rg:1},p2s=/,?([achlmqrstvxz]),?/gi,pathCommand=/([achlmrqstvz])[\x09\x0a\x0b\x0c\x0d\x20\xa0\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028\u2029,]*((-?\d*\.?\d*(?:e[\-+]?\d+)?[\x09\x0a\x0b\x0c\x0d\x20\xa0\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028\u2029]*,?[\x09\x0a\x0b\x0c\x0d\x20\xa0\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028\u2029]*)+)/gi,tCommand=/([rstm])[\x09\x0a\x0b\x0c\x0d\x20\xa0\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028\u2029,]*((-?\d*\.?\d*(?:e[\-+]?\d+)?[\x09\x0a\x0b\x0c\x0d\x20\xa0\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028\u2029]*,?[\x09\x0a\x0b\x0c\x0d\x20\xa0\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028\u2029]*)+)/gi,pathValues=/(-?\d*\.?\d*(?:e[\-+]?\d+)?)[\x09\x0a\x0b\x0c\x0d\x20\xa0\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028\u2029]*,?[\x09\x0a\x0b\x0c\x0d\x20\xa0\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028\u2029]*/gi,eldata=(R._radial_gradient=/^r(?:\(([^,]+?)[\x09\x0a\x0b\x0c\x0d\x20\xa0\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028\u2029]*,[\x09\x0a\x0b\x0c\x0d\x20\xa0\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028\u2029]*([^\)]+?)\))?/,{}),sortByNumber=function(a,b){return toFloat(a)-toFloat(b)},pipe=function(x){return x},rectPath=R._rectPath=function(x,y,w,h,r){return r?[["M",x+r,y],["l",w-2*r,0],["a",r,r,0,0,1,r,r],["l",0,h-2*r],["a",r,r,0,0,1,-r,r],["l",2*r-w,0],["a",r,r,0,0,1,-r,-r],["l",0,2*r-h],["a",r,r,0,0,1,r,-r],["z"]]:[["M",x,y],["l",w,0],["l",0,h],["l",-w,0],["z"]]},ellipsePath=function(x,y,rx,ry){return null==ry&&(ry=rx),[["M",x,y],["m",0,-ry],["a",rx,ry,0,1,1,0,2*ry],["a",rx,ry,0,1,1,0,-2*ry],["z"]]},getPath=R._getPath={path:function(el){return el.attr("path")},circle:function(el){var a=el.attrs;return ellipsePath(a.cx,a.cy,a.r)},ellipse:function(el){var a=el.attrs;return ellipsePath(a.cx,a.cy,a.rx,a.ry)},rect:function(el){var a=el.attrs;return rectPath(a.x,a.y,a.width,a.height,a.r)},image:function(el){var a=el.attrs;return rectPath(a.x,a.y,a.width,a.height)},text:function(el){var bbox=el._getBBox();return rectPath(bbox.x,bbox.y,bbox.width,bbox.height)},set:function(el){var bbox=el._getBBox();return rectPath(bbox.x,bbox.y,bbox.width,bbox.height)}},mapPath=R.mapPath=function(path,matrix){if(!matrix)return path;var x,y,i,j,ii,jj,pathi;for(i=0,ii=(path=path2curve(path)).length;i<ii;i++)for(j=1,jj=(pathi=path[i]).length;j<jj;j+=2)x=matrix.x(pathi[j],pathi[j+1]),y=matrix.y(pathi[j],pathi[j+1]),pathi[j]=x,pathi[j+1]=y;return path};if(R._g=g,R.type=g.win.SVGAngle||g.doc.implementation.hasFeature("http://www.w3.org/TR/SVG11/feature#BasicStructure","1.1")?"SVG":"VML","VML"==R.type){var b,d=g.doc.createElement("div");if(d.innerHTML='<v:shape adj="1"/>',(b=d.firstChild).style.behavior="url(#default#VML)",!b||"object"!=typeof b.adj)return R.type=E;d=null}function clone(obj){if("function"==typeof obj||Object(obj)!==obj)return obj;var res=new obj.constructor;for(var key in obj)obj[has](key)&&(res[key]=clone(obj[key]));return res}R.svg=!(R.vml="VML"==R.type),R._Paper=Paper,R.fn=paperproto=Paper.prototype=R.prototype,R._id=0,R.is=function(o,type){return"finite"==(type=lowerCase.call(type))?!isnan[has](+o):"array"==type?o instanceof Array:"null"==type&&null===o||type==typeof o&&null!==o||"object"==type&&o===Object(o)||"array"==type&&Array.isArray&&Array.isArray(o)||objectToString.call(o).slice(8,-1).toLowerCase()==type},R.angle=function(x1,y1,x2,y2,x3,y3){if(null==x3){var x=x1-x2,y=y1-y2;return x||y?(180+180*math.atan2(-y,-x)/PI+360)%360:0}return R.angle(x1,y1,x3,y3)-R.angle(x2,y2,x3,y3)},R.rad=function(deg){return deg%360*PI/180},R.deg=function(rad){return Math.round(180*rad/PI%360*1e3)/1e3},R.snapTo=function(values,value,tolerance){if(tolerance=R.is(tolerance,"finite")?tolerance:10,R.is(values,array)){for(var i=values.length;i--;)if(abs(values[i]-value)<=tolerance)return values[i]}else{var rem=value%(values=+values);if(rem<tolerance)return value-rem;if(rem>values-tolerance)return value-rem+values}return value},R.createUUID=(uuidRegEx=/[xy]/g,uuidReplacer=function(c){var r=16*math.random()|0;return("x"==c?r:3&r|8).toString(16)},function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(uuidRegEx,uuidReplacer).toUpperCase()}),R.setWindow=function(newwin){eve("raphael.setWindow",R,g.win,newwin),g.win=newwin,g.doc=g.win.document,R._engine.initWin&&R._engine.initWin(g.win)};var toHex=function(color){if(R.vml){var bod,trim=/^\s+|\s+$/g;try{var docum=new ActiveXObject("htmlfile");docum.write("<body>"),docum.close(),bod=docum.body}catch(e){bod=window.createPopup().document.body}var range=bod.createTextRange();toHex=cacher((function(color){try{bod.style.color=Str(color).replace(trim,E);var value=range.queryCommandValue("ForeColor");return"#"+("000000"+(value=(255&value)<<16|65280&value|(16711680&value)>>>16).toString(16)).slice(-6)}catch(e){return"none"}}))}else{var i=g.doc.createElement("i");i.title="Raphaël Colour Picker",i.style.display="none",g.doc.body.appendChild(i),toHex=cacher((function(color){return i.style.color=color,g.doc.defaultView.getComputedStyle(i,E).getPropertyValue("color")}))}return toHex(color)},hsbtoString=function(){return"hsb("+[this.h,this.s,this.b]+")"},hsltoString=function(){return"hsl("+[this.h,this.s,this.l]+")"},rgbtoString=function(){return this.hex},prepareRGB=function(r,g,b){if(null==g&&R.is(r,"object")&&"r"in r&&"g"in r&&"b"in r&&(b=r.b,g=r.g,r=r.r),null==g&&R.is(r,"string")){var clr=R.getRGB(r);r=clr.r,g=clr.g,b=clr.b}return(r>1||g>1||b>1)&&(r/=255,g/=255,b/=255),[r,g,b]},packageRGB=function(r,g,b,o){var rgb={r:r*=255,g:g*=255,b:b*=255,hex:R.rgb(r,g,b),toString:rgbtoString};return R.is(o,"finite")&&(rgb.opacity=o),rgb};function repush(array,item){for(var i=0,ii=array.length;i<ii;i++)if(array[i]===item)return array.push(array.splice(i,1)[0])}function cacher(f,scope,postprocessor){return function newf(){var arg=Array.prototype.slice.call(arguments,0),args=arg.join("␀"),cache=newf.cache=newf.cache||{},count=newf.count=newf.count||[];return cache[has](args)?(repush(count,args),postprocessor?postprocessor(cache[args]):cache[args]):(count.length>=1e3&&delete cache[count.shift()],count.push(args),cache[args]=f[apply](scope,arg),postprocessor?postprocessor(cache[args]):cache[args])}}function clrToString(){return this.hex}function catmullRom2bezier(crp,z){for(var d=[],i=0,iLen=crp.length;iLen-2*!z>i;i+=2){var p=[{x:+crp[i-2],y:+crp[i-1]},{x:+crp[i],y:+crp[i+1]},{x:+crp[i+2],y:+crp[i+3]},{x:+crp[i+4],y:+crp[i+5]}];z?i?iLen-4==i?p[3]={x:+crp[0],y:+crp[1]}:iLen-2==i&&(p[2]={x:+crp[0],y:+crp[1]},p[3]={x:+crp[2],y:+crp[3]}):p[0]={x:+crp[iLen-2],y:+crp[iLen-1]}:iLen-4==i?p[3]=p[2]:i||(p[0]={x:+crp[i],y:+crp[i+1]}),d.push(["C",(-p[0].x+6*p[1].x+p[2].x)/6,(-p[0].y+6*p[1].y+p[2].y)/6,(p[1].x+6*p[2].x-p[3].x)/6,(p[1].y+6*p[2].y-p[3].y)/6,p[2].x,p[2].y])}return d}R.color=function(clr){var rgb;return R.is(clr,"object")&&"h"in clr&&"s"in clr&&"b"in clr?(rgb=R.hsb2rgb(clr),clr.r=rgb.r,clr.g=rgb.g,clr.b=rgb.b,clr.hex=rgb.hex):R.is(clr,"object")&&"h"in clr&&"s"in clr&&"l"in clr?(rgb=R.hsl2rgb(clr),clr.r=rgb.r,clr.g=rgb.g,clr.b=rgb.b,clr.hex=rgb.hex):(R.is(clr,"string")&&(clr=R.getRGB(clr)),R.is(clr,"object")&&"r"in clr&&"g"in clr&&"b"in clr?(rgb=R.rgb2hsl(clr),clr.h=rgb.h,clr.s=rgb.s,clr.l=rgb.l,rgb=R.rgb2hsb(clr),clr.v=rgb.b):(clr={hex:"none"}).r=clr.g=clr.b=clr.h=clr.s=clr.v=clr.l=-1),clr.toString=rgbtoString,clr},R.hsb2rgb=function(h,s,v,o){var R,G,B,X,C;return this.is(h,"object")&&"h"in h&&"s"in h&&"b"in h&&(v=h.b,s=h.s,o=h.o,h=h.h),X=(C=v*s)*(1-abs((h=(h*=360)%360/60)%2-1)),R=G=B=v-C,packageRGB(R+=[C,X,0,0,X,C][h=~~h],G+=[X,C,C,X,0,0][h],B+=[0,0,X,C,C,X][h],o)},R.hsl2rgb=function(h,s,l,o){var R,G,B,X,C;return this.is(h,"object")&&"h"in h&&"s"in h&&"l"in h&&(l=h.l,s=h.s,h=h.h),(h>1||s>1||l>1)&&(h/=360,s/=100,l/=100),X=(C=2*s*(l<.5?l:1-l))*(1-abs((h=(h*=360)%360/60)%2-1)),R=G=B=l-C/2,packageRGB(R+=[C,X,0,0,X,C][h=~~h],G+=[X,C,C,X,0,0][h],B+=[0,0,X,C,C,X][h],o)},R.rgb2hsb=function(r,g,b){var V,C;return r=(b=prepareRGB(r,g,b))[0],g=b[1],b=b[2],{h:((0==(C=(V=mmax(r,g,b))-mmin(r,g,b))?null:V==r?(g-b)/C:V==g?(b-r)/C+2:(r-g)/C+4)+360)%6*60/360,s:0==C?0:C/V,b:V,toString:hsbtoString}},R.rgb2hsl=function(r,g,b){var L,M,m,C;return r=(b=prepareRGB(r,g,b))[0],g=b[1],b=b[2],L=((M=mmax(r,g,b))+(m=mmin(r,g,b)))/2,{h:((0==(C=M-m)?null:M==r?(g-b)/C:M==g?(b-r)/C+2:(r-g)/C+4)+360)%6*60/360,s:0==C?0:L<.5?C/(2*L):C/(2-2*L),l:L,toString:hsltoString}},R._path2string=function(){return this.join(",").replace(p2s,"$1")},R._preload=function(src,f){var img=g.doc.createElement("img");img.style.cssText="position:absolute;left:-9999em;top:-9999em",img.onload=function(){f.call(this),this.onload=null,g.doc.body.removeChild(this)},img.onerror=function(){g.doc.body.removeChild(this)},g.doc.body.appendChild(img),img.src=src},R.getRGB=cacher((function(colour){if(!colour||(colour=Str(colour)).indexOf("-")+1)return{r:-1,g:-1,b:-1,hex:"none",error:1,toString:clrToString};if("none"==colour)return{r:-1,g:-1,b:-1,hex:"none",toString:clrToString};!hsrg[has](colour.toLowerCase().substring(0,2))&&"#"!=colour.charAt()&&(colour=toHex(colour));var red,green,blue,opacity,t,values,rgb=colour.match(colourRegExp);return rgb?(rgb[2]&&(blue=toInt(rgb[2].substring(5),16),green=toInt(rgb[2].substring(3,5),16),red=toInt(rgb[2].substring(1,3),16)),rgb[3]&&(blue=toInt((t=rgb[3].charAt(3))+t,16),green=toInt((t=rgb[3].charAt(2))+t,16),red=toInt((t=rgb[3].charAt(1))+t,16)),rgb[4]&&(values=rgb[4].split(commaSpaces),red=toFloat(values[0]),"%"==values[0].slice(-1)&&(red*=2.55),green=toFloat(values[1]),"%"==values[1].slice(-1)&&(green*=2.55),blue=toFloat(values[2]),"%"==values[2].slice(-1)&&(blue*=2.55),"rgba"==rgb[1].toLowerCase().slice(0,4)&&(opacity=toFloat(values[3])),values[3]&&"%"==values[3].slice(-1)&&(opacity/=100)),rgb[5]?(values=rgb[5].split(commaSpaces),red=toFloat(values[0]),"%"==values[0].slice(-1)&&(red*=2.55),green=toFloat(values[1]),"%"==values[1].slice(-1)&&(green*=2.55),blue=toFloat(values[2]),"%"==values[2].slice(-1)&&(blue*=2.55),("deg"==values[0].slice(-3)||"°"==values[0].slice(-1))&&(red/=360),"hsba"==rgb[1].toLowerCase().slice(0,4)&&(opacity=toFloat(values[3])),values[3]&&"%"==values[3].slice(-1)&&(opacity/=100),R.hsb2rgb(red,green,blue,opacity)):rgb[6]?(values=rgb[6].split(commaSpaces),red=toFloat(values[0]),"%"==values[0].slice(-1)&&(red*=2.55),green=toFloat(values[1]),"%"==values[1].slice(-1)&&(green*=2.55),blue=toFloat(values[2]),"%"==values[2].slice(-1)&&(blue*=2.55),("deg"==values[0].slice(-3)||"°"==values[0].slice(-1))&&(red/=360),"hsla"==rgb[1].toLowerCase().slice(0,4)&&(opacity=toFloat(values[3])),values[3]&&"%"==values[3].slice(-1)&&(opacity/=100),R.hsl2rgb(red,green,blue,opacity)):((rgb={r:red,g:green,b:blue,toString:clrToString}).hex="#"+(16777216|blue|green<<8|red<<16).toString(16).slice(1),R.is(opacity,"finite")&&(rgb.opacity=opacity),rgb)):{r:-1,g:-1,b:-1,hex:"none",error:1,toString:clrToString}}),R),R.hsb=cacher((function(h,s,b){return R.hsb2rgb(h,s,b).hex})),R.hsl=cacher((function(h,s,l){return R.hsl2rgb(h,s,l).hex})),R.rgb=cacher((function(r,g,b){function round(x){return x+.5|0}return"#"+(16777216|round(b)|round(g)<<8|round(r)<<16).toString(16).slice(1)})),R.getColor=function(value){var start=this.getColor.start=this.getColor.start||{h:0,s:1,b:value||.75},rgb=this.hsb2rgb(start.h,start.s,start.b);return start.h+=.075,start.h>1&&(start.h=0,start.s-=.2,start.s<=0&&(this.getColor.start={h:0,s:1,b:start.b})),rgb.hex},R.getColor.reset=function(){delete this.start},R.parsePathString=function(pathString){if(!pathString)return null;var pth=paths(pathString);if(pth.arr)return pathClone(pth.arr);var paramCounts={a:7,c:6,h:1,l:2,m:2,r:4,q:4,s:4,t:2,v:1,z:0},data=[];return R.is(pathString,array)&&R.is(pathString[0],array)&&(data=pathClone(pathString)),data.length||Str(pathString).replace(pathCommand,(function(a,b,c){var params=[],name=b.toLowerCase();if(c.replace(pathValues,(function(a,b){b&&params.push(+b)})),"m"==name&&params.length>2&&(data.push([b].concat(params.splice(0,2))),name="l",b="m"==b?"l":"L"),"r"==name)data.push([b].concat(params));else for(;params.length>=paramCounts[name]&&(data.push([b].concat(params.splice(0,paramCounts[name]))),paramCounts[name]););})),data.toString=R._path2string,pth.arr=pathClone(data),data},R.parseTransformString=cacher((function(TString){if(!TString)return null;var data=[];return R.is(TString,array)&&R.is(TString[0],array)&&(data=pathClone(TString)),data.length||Str(TString).replace(tCommand,(function(a,b,c){var params=[];lowerCase.call(b),c.replace(pathValues,(function(a,b){b&&params.push(+b)})),data.push([b].concat(params))})),data.toString=R._path2string,data}));var paths=function(ps){var p=paths.ps=paths.ps||{};return p[ps]?p[ps].sleep=100:p[ps]={sleep:100},setTimeout((function(){for(var key in p)p[has](key)&&key!=ps&&(p[key].sleep--,!p[key].sleep&&delete p[key])})),p[ps]};function base3(t,p1,p2,p3,p4){return t*(t*(-3*p1+9*p2-9*p3+3*p4)+6*p1-12*p2+6*p3)-3*p1+3*p2}function bezlen(x1,y1,x2,y2,x3,y3,x4,y4,z){null==z&&(z=1);for(var z2=(z=z>1?1:z<0?0:z)/2,Tvalues=[-.1252,.1252,-.3678,.3678,-.5873,.5873,-.7699,.7699,-.9041,.9041,-.9816,.9816],Cvalues=[.2491,.2491,.2335,.2335,.2032,.2032,.1601,.1601,.1069,.1069,.0472,.0472],sum=0,i=0;i<12;i++){var ct=z2*Tvalues[i]+z2,xbase=base3(ct,x1,x2,x3,x4),ybase=base3(ct,y1,y2,y3,y4),comb=xbase*xbase+ybase*ybase;sum+=Cvalues[i]*math.sqrt(comb)}return z2*sum}function intersect(x1,y1,x2,y2,x3,y3,x4,y4){if(!(mmax(x1,x2)<mmin(x3,x4)||mmin(x1,x2)>mmax(x3,x4)||mmax(y1,y2)<mmin(y3,y4)||mmin(y1,y2)>mmax(y3,y4))){var denominator=(x1-x2)*(y3-y4)-(y1-y2)*(x3-x4);if(denominator){var px=((x1*y2-y1*x2)*(x3-x4)-(x1-x2)*(x3*y4-y3*x4))/denominator,py=((x1*y2-y1*x2)*(y3-y4)-(y1-y2)*(x3*y4-y3*x4))/denominator,px2=+px.toFixed(2),py2=+py.toFixed(2);if(!(px2<+mmin(x1,x2).toFixed(2)||px2>+mmax(x1,x2).toFixed(2)||px2<+mmin(x3,x4).toFixed(2)||px2>+mmax(x3,x4).toFixed(2)||py2<+mmin(y1,y2).toFixed(2)||py2>+mmax(y1,y2).toFixed(2)||py2<+mmin(y3,y4).toFixed(2)||py2>+mmax(y3,y4).toFixed(2)))return{x:px,y:py}}}}function interHelper(bez1,bez2,justCount){var bbox1=R.bezierBBox(bez1),bbox2=R.bezierBBox(bez2);if(!R.isBBoxIntersect(bbox1,bbox2))return justCount?0:[];for(var l1=bezlen.apply(0,bez1),l2=bezlen.apply(0,bez2),n1=mmax(~~(l1/5),1),n2=mmax(~~(l2/5),1),dots1=[],dots2=[],xy={},res=justCount?0:[],i=0;i<n1+1;i++){var p=R.findDotsAtSegment.apply(R,bez1.concat(i/n1));dots1.push({x:p.x,y:p.y,t:i/n1})}for(i=0;i<n2+1;i++)p=R.findDotsAtSegment.apply(R,bez2.concat(i/n2)),dots2.push({x:p.x,y:p.y,t:i/n2});for(i=0;i<n1;i++)for(var j=0;j<n2;j++){var di=dots1[i],di1=dots1[i+1],dj=dots2[j],dj1=dots2[j+1],ci=abs(di1.x-di.x)<.001?"y":"x",cj=abs(dj1.x-dj.x)<.001?"y":"x",is=intersect(di.x,di.y,di1.x,di1.y,dj.x,dj.y,dj1.x,dj1.y);if(is){if(xy[is.x.toFixed(4)]==is.y.toFixed(4))continue;xy[is.x.toFixed(4)]=is.y.toFixed(4);var t1=di.t+abs((is[ci]-di[ci])/(di1[ci]-di[ci]))*(di1.t-di.t),t2=dj.t+abs((is[cj]-dj[cj])/(dj1[cj]-dj[cj]))*(dj1.t-dj.t);t1>=0&&t1<=1.001&&t2>=0&&t2<=1.001&&(justCount?res++:res.push({x:is.x,y:is.y,t1:mmin(t1,1),t2:mmin(t2,1)}))}}return res}function interPathHelper(path1,path2,justCount){path1=R._path2curve(path1),path2=R._path2curve(path2);for(var x1,y1,x2,y2,x1m,y1m,x2m,y2m,bez1,bez2,res=justCount?0:[],i=0,ii=path1.length;i<ii;i++){var pi=path1[i];if("M"==pi[0])x1=x1m=pi[1],y1=y1m=pi[2];else{"C"==pi[0]?(bez1=[x1,y1].concat(pi.slice(1)),x1=bez1[6],y1=bez1[7]):(bez1=[x1,y1,x1,y1,x1m,y1m,x1m,y1m],x1=x1m,y1=y1m);for(var j=0,jj=path2.length;j<jj;j++){var pj=path2[j];if("M"==pj[0])x2=x2m=pj[1],y2=y2m=pj[2];else{"C"==pj[0]?(bez2=[x2,y2].concat(pj.slice(1)),x2=bez2[6],y2=bez2[7]):(bez2=[x2,y2,x2,y2,x2m,y2m,x2m,y2m],x2=x2m,y2=y2m);var intr=interHelper(bez1,bez2,justCount);if(justCount)res+=intr;else{for(var k=0,kk=intr.length;k<kk;k++)intr[k].segment1=i,intr[k].segment2=j,intr[k].bez1=bez1,intr[k].bez2=bez2;res=res.concat(intr)}}}}}return res}R.findDotsAtSegment=function(p1x,p1y,c1x,c1y,c2x,c2y,p2x,p2y,t){var t1=1-t,t13=pow(t1,3),t12=pow(t1,2),t2=t*t,t3=t2*t,x=t13*p1x+3*t12*t*c1x+3*t1*t*t*c2x+t3*p2x,y=t13*p1y+3*t12*t*c1y+3*t1*t*t*c2y+t3*p2y,mx=p1x+2*t*(c1x-p1x)+t2*(c2x-2*c1x+p1x),my=p1y+2*t*(c1y-p1y)+t2*(c2y-2*c1y+p1y),nx=c1x+2*t*(c2x-c1x)+t2*(p2x-2*c2x+c1x),ny=c1y+2*t*(c2y-c1y)+t2*(p2y-2*c2y+c1y),ax=t1*p1x+t*c1x,ay=t1*p1y+t*c1y,cx=t1*c2x+t*p2x,cy=t1*c2y+t*p2y,alpha=90-180*math.atan2(mx-nx,my-ny)/PI;return(mx>nx||my<ny)&&(alpha+=180),{x:x,y:y,m:{x:mx,y:my},n:{x:nx,y:ny},start:{x:ax,y:ay},end:{x:cx,y:cy},alpha:alpha}},R.bezierBBox=function(p1x,p1y,c1x,c1y,c2x,c2y,p2x,p2y){R.is(p1x,"array")||(p1x=[p1x,p1y,c1x,c1y,c2x,c2y,p2x,p2y]);var bbox=curveDim.apply(null,p1x);return{x:bbox.min.x,y:bbox.min.y,x2:bbox.max.x,y2:bbox.max.y,width:bbox.max.x-bbox.min.x,height:bbox.max.y-bbox.min.y}},R.isPointInsideBBox=function(bbox,x,y){return x>=bbox.x&&x<=bbox.x2&&y>=bbox.y&&y<=bbox.y2},R.isBBoxIntersect=function(bbox1,bbox2){var i=R.isPointInsideBBox;return i(bbox2,bbox1.x,bbox1.y)||i(bbox2,bbox1.x2,bbox1.y)||i(bbox2,bbox1.x,bbox1.y2)||i(bbox2,bbox1.x2,bbox1.y2)||i(bbox1,bbox2.x,bbox2.y)||i(bbox1,bbox2.x2,bbox2.y)||i(bbox1,bbox2.x,bbox2.y2)||i(bbox1,bbox2.x2,bbox2.y2)||(bbox1.x<bbox2.x2&&bbox1.x>bbox2.x||bbox2.x<bbox1.x2&&bbox2.x>bbox1.x)&&(bbox1.y<bbox2.y2&&bbox1.y>bbox2.y||bbox2.y<bbox1.y2&&bbox2.y>bbox1.y)},R.pathIntersection=function(path1,path2){return interPathHelper(path1,path2)},R.pathIntersectionNumber=function(path1,path2){return interPathHelper(path1,path2,1)},R.isPointInsidePath=function(path,x,y){var bbox=R.pathBBox(path);return R.isPointInsideBBox(bbox,x,y)&&interPathHelper(path,[["M",x,y],["H",bbox.x2+10]],1)%2==1},R._removedFactory=function(methodname){return function(){eve("raphael.log",null,"Raphaël: you are calling to method “"+methodname+"” of removed object",methodname)}};var pathDimensions=R.pathBBox=function(path){var pth=paths(path);if(pth.bbox)return clone(pth.bbox);if(!path)return{x:0,y:0,width:0,height:0,x2:0,y2:0};for(var p,x=0,y=0,X=[],Y=[],i=0,ii=(path=path2curve(path)).length;i<ii;i++)if("M"==(p=path[i])[0])x=p[1],y=p[2],X.push(x),Y.push(y);else{var dim=curveDim(x,y,p[1],p[2],p[3],p[4],p[5],p[6]);X=X.concat(dim.min.x,dim.max.x),Y=Y.concat(dim.min.y,dim.max.y),x=p[5],y=p[6]}var xmin=mmin[apply](0,X),ymin=mmin[apply](0,Y),xmax=mmax[apply](0,X),ymax=mmax[apply](0,Y),width=xmax-xmin,height=ymax-ymin,bb={x:xmin,y:ymin,x2:xmax,y2:ymax,width:width,height:height,cx:xmin+width/2,cy:ymin+height/2};return pth.bbox=clone(bb),bb},pathClone=function(pathArray){var res=clone(pathArray);return res.toString=R._path2string,res},pathToRelative=R._pathToRelative=function(pathArray){var pth=paths(pathArray);if(pth.rel)return pathClone(pth.rel);R.is(pathArray,array)&&R.is(pathArray&&pathArray[0],array)||(pathArray=R.parsePathString(pathArray));var res=[],x=0,y=0,mx=0,my=0,start=0;"M"==pathArray[0][0]&&(mx=x=pathArray[0][1],my=y=pathArray[0][2],start++,res.push(["M",x,y]));for(var i=start,ii=pathArray.length;i<ii;i++){var r=res[i]=[],pa=pathArray[i];if(pa[0]!=lowerCase.call(pa[0]))switch(r[0]=lowerCase.call(pa[0]),r[0]){case"a":r[1]=pa[1],r[2]=pa[2],r[3]=pa[3],r[4]=pa[4],r[5]=pa[5],r[6]=+(pa[6]-x).toFixed(3),r[7]=+(pa[7]-y).toFixed(3);break;case"v":r[1]=+(pa[1]-y).toFixed(3);break;case"m":mx=pa[1],my=pa[2];default:for(var j=1,jj=pa.length;j<jj;j++)r[j]=+(pa[j]-(j%2?x:y)).toFixed(3)}else{r=res[i]=[],"m"==pa[0]&&(mx=pa[1]+x,my=pa[2]+y);for(var k=0,kk=pa.length;k<kk;k++)res[i][k]=pa[k]}var len=res[i].length;switch(res[i][0]){case"z":x=mx,y=my;break;case"h":x+=+res[i][len-1];break;case"v":y+=+res[i][len-1];break;default:x+=+res[i][len-2],y+=+res[i][len-1]}}return res.toString=R._path2string,pth.rel=pathClone(res),res},pathToAbsolute=R._pathToAbsolute=function(pathArray){var pth=paths(pathArray);if(pth.abs)return pathClone(pth.abs);if(R.is(pathArray,array)&&R.is(pathArray&&pathArray[0],array)||(pathArray=R.parsePathString(pathArray)),!pathArray||!pathArray.length)return[["M",0,0]];var res=[],x=0,y=0,mx=0,my=0,start=0;"M"==pathArray[0][0]&&(mx=x=+pathArray[0][1],my=y=+pathArray[0][2],start++,res[0]=["M",x,y]);for(var r,pa,crz=3==pathArray.length&&"M"==pathArray[0][0]&&"R"==pathArray[1][0].toUpperCase()&&"Z"==pathArray[2][0].toUpperCase(),i=start,ii=pathArray.length;i<ii;i++){if(res.push(r=[]),(pa=pathArray[i])[0]!=upperCase.call(pa[0]))switch(r[0]=upperCase.call(pa[0]),r[0]){case"A":r[1]=pa[1],r[2]=pa[2],r[3]=pa[3],r[4]=pa[4],r[5]=pa[5],r[6]=+(pa[6]+x),r[7]=+(pa[7]+y);break;case"V":r[1]=+pa[1]+y;break;case"H":r[1]=+pa[1]+x;break;case"R":for(var dots=[x,y].concat(pa.slice(1)),j=2,jj=dots.length;j<jj;j++)dots[j]=+dots[j]+x,dots[++j]=+dots[j]+y;res.pop(),res=res.concat(catmullRom2bezier(dots,crz));break;case"M":mx=+pa[1]+x,my=+pa[2]+y;default:for(j=1,jj=pa.length;j<jj;j++)r[j]=+pa[j]+(j%2?x:y)}else if("R"==pa[0])dots=[x,y].concat(pa.slice(1)),res.pop(),res=res.concat(catmullRom2bezier(dots,crz)),r=["R"].concat(pa.slice(-2));else for(var k=0,kk=pa.length;k<kk;k++)r[k]=pa[k];switch(r[0]){case"Z":x=mx,y=my;break;case"H":x=r[1];break;case"V":y=r[1];break;case"M":mx=r[r.length-2],my=r[r.length-1];default:x=r[r.length-2],y=r[r.length-1]}}return res.toString=R._path2string,pth.abs=pathClone(res),res},l2c=function(x1,y1,x2,y2){return[x1,y1,x2,y2,x2,y2]},q2c=function(x1,y1,ax,ay,x2,y2){var _13=1/3,_23=2/3;return[_13*x1+_23*ax,_13*y1+_23*ay,_13*x2+_23*ax,_13*y2+_23*ay,x2,y2]},a2c=function(x1,y1,rx,ry,angle,large_arc_flag,sweep_flag,x2,y2,recursive){var xy,_120=120*PI/180,rad=PI/180*(+angle||0),res=[],rotate=cacher((function(x,y,rad){return{x:x*math.cos(rad)-y*math.sin(rad),y:x*math.sin(rad)+y*math.cos(rad)}}));if(recursive)f1=recursive[0],f2=recursive[1],cx=recursive[2],cy=recursive[3];else{x1=(xy=rotate(x1,y1,-rad)).x,y1=xy.y,x2=(xy=rotate(x2,y2,-rad)).x,y2=xy.y,math.cos(PI/180*angle),math.sin(PI/180*angle);var x=(x1-x2)/2,y=(y1-y2)/2,h=x*x/(rx*rx)+y*y/(ry*ry);h>1&&(rx*=h=math.sqrt(h),ry*=h);var rx2=rx*rx,ry2=ry*ry,k=(large_arc_flag==sweep_flag?-1:1)*math.sqrt(abs((rx2*ry2-rx2*y*y-ry2*x*x)/(rx2*y*y+ry2*x*x))),cx=k*rx*y/ry+(x1+x2)/2,cy=k*-ry*x/rx+(y1+y2)/2,f1=math.asin(((y1-cy)/ry).toFixed(9)),f2=math.asin(((y2-cy)/ry).toFixed(9));(f1=x1<cx?PI-f1:f1)<0&&(f1=2*PI+f1),(f2=x2<cx?PI-f2:f2)<0&&(f2=2*PI+f2),sweep_flag&&f1>f2&&(f1-=2*PI),!sweep_flag&&f2>f1&&(f2-=2*PI)}var df=f2-f1;if(abs(df)>_120){var f2old=f2,x2old=x2,y2old=y2;f2=f1+_120*(sweep_flag&&f2>f1?1:-1),x2=cx+rx*math.cos(f2),y2=cy+ry*math.sin(f2),res=a2c(x2,y2,rx,ry,angle,0,sweep_flag,x2old,y2old,[f2,f2old,cx,cy])}df=f2-f1;var c1=math.cos(f1),s1=math.sin(f1),c2=math.cos(f2),s2=math.sin(f2),t=math.tan(df/4),hx=4/3*rx*t,hy=4/3*ry*t,m1=[x1,y1],m2=[x1+hx*s1,y1-hy*c1],m3=[x2+hx*s2,y2-hy*c2],m4=[x2,y2];if(m2[0]=2*m1[0]-m2[0],m2[1]=2*m1[1]-m2[1],recursive)return[m2,m3,m4].concat(res);for(var newres=[],i=0,ii=(res=[m2,m3,m4].concat(res).join().split(",")).length;i<ii;i++)newres[i]=i%2?rotate(res[i-1],res[i],rad).y:rotate(res[i],res[i+1],rad).x;return newres},findDotAtSegment=function(p1x,p1y,c1x,c1y,c2x,c2y,p2x,p2y,t){var t1=1-t;return{x:pow(t1,3)*p1x+3*pow(t1,2)*t*c1x+3*t1*t*t*c2x+pow(t,3)*p2x,y:pow(t1,3)*p1y+3*pow(t1,2)*t*c1y+3*t1*t*t*c2y+pow(t,3)*p2y}},curveDim=cacher((function(p1x,p1y,c1x,c1y,c2x,c2y,p2x,p2y){var dot,a=c2x-2*c1x+p1x-(p2x-2*c2x+c1x),b=2*(c1x-p1x)-2*(c2x-c1x),c=p1x-c1x,t1=(-b+math.sqrt(b*b-4*a*c))/2/a,t2=(-b-math.sqrt(b*b-4*a*c))/2/a,y=[p1y,p2y],x=[p1x,p2x];return abs(t1)>"1e12"&&(t1=.5),abs(t2)>"1e12"&&(t2=.5),t1>0&&t1<1&&(dot=findDotAtSegment(p1x,p1y,c1x,c1y,c2x,c2y,p2x,p2y,t1),x.push(dot.x),y.push(dot.y)),t2>0&&t2<1&&(dot=findDotAtSegment(p1x,p1y,c1x,c1y,c2x,c2y,p2x,p2y,t2),x.push(dot.x),y.push(dot.y)),a=c2y-2*c1y+p1y-(p2y-2*c2y+c1y),c=p1y-c1y,t1=(-(b=2*(c1y-p1y)-2*(c2y-c1y))+math.sqrt(b*b-4*a*c))/2/a,t2=(-b-math.sqrt(b*b-4*a*c))/2/a,abs(t1)>"1e12"&&(t1=.5),abs(t2)>"1e12"&&(t2=.5),t1>0&&t1<1&&(dot=findDotAtSegment(p1x,p1y,c1x,c1y,c2x,c2y,p2x,p2y,t1),x.push(dot.x),y.push(dot.y)),t2>0&&t2<1&&(dot=findDotAtSegment(p1x,p1y,c1x,c1y,c2x,c2y,p2x,p2y,t2),x.push(dot.x),y.push(dot.y)),{min:{x:mmin[apply](0,x),y:mmin[apply](0,y)},max:{x:mmax[apply](0,x),y:mmax[apply](0,y)}}})),path2curve=R._path2curve=cacher((function(path,path2){var pth=!path2&&paths(path);if(!path2&&pth.curve)return pathClone(pth.curve);for(var p=pathToAbsolute(path),p2=path2&&pathToAbsolute(path2),attrs={x:0,y:0,bx:0,by:0,X:0,Y:0,qx:null,qy:null},attrs2={x:0,y:0,bx:0,by:0,X:0,Y:0,qx:null,qy:null},processPath=function(path,d,pcom){var nx,ny;if(!path)return["C",d.x,d.y,d.x,d.y,d.x,d.y];switch(!(path[0]in{T:1,Q:1})&&(d.qx=d.qy=null),path[0]){case"M":d.X=path[1],d.Y=path[2];break;case"A":path=["C"].concat(a2c[apply](0,[d.x,d.y].concat(path.slice(1))));break;case"S":"C"==pcom||"S"==pcom?(nx=2*d.x-d.bx,ny=2*d.y-d.by):(nx=d.x,ny=d.y),path=["C",nx,ny].concat(path.slice(1));break;case"T":"Q"==pcom||"T"==pcom?(d.qx=2*d.x-d.qx,d.qy=2*d.y-d.qy):(d.qx=d.x,d.qy=d.y),path=["C"].concat(q2c(d.x,d.y,d.qx,d.qy,path[1],path[2]));break;case"Q":d.qx=path[1],d.qy=path[2],path=["C"].concat(q2c(d.x,d.y,path[1],path[2],path[3],path[4]));break;case"L":path=["C"].concat(l2c(d.x,d.y,path[1],path[2]));break;case"H":path=["C"].concat(l2c(d.x,d.y,path[1],d.y));break;case"V":path=["C"].concat(l2c(d.x,d.y,d.x,path[1]));break;case"Z":path=["C"].concat(l2c(d.x,d.y,d.X,d.Y))}return path},fixArc=function(pp,i){if(pp[i].length>7){pp[i].shift();for(var pi=pp[i];pi.length;)pcoms1[i]="A",p2&&(pcoms2[i]="A"),pp.splice(i++,0,["C"].concat(pi.splice(0,6)));pp.splice(i,1),ii=mmax(p.length,p2&&p2.length||0)}},fixM=function(path1,path2,a1,a2,i){path1&&path2&&"M"==path1[i][0]&&"M"!=path2[i][0]&&(path2.splice(i,0,["M",a2.x,a2.y]),a1.bx=0,a1.by=0,a1.x=path1[i][1],a1.y=path1[i][2],ii=mmax(p.length,p2&&p2.length||0))},pcoms1=[],pcoms2=[],pfirst="",pcom="",i=0,ii=mmax(p.length,p2&&p2.length||0);i<ii;i++){p[i]&&(pfirst=p[i][0]),"C"!=pfirst&&(pcoms1[i]=pfirst,i&&(pcom=pcoms1[i-1])),p[i]=processPath(p[i],attrs,pcom),"A"!=pcoms1[i]&&"C"==pfirst&&(pcoms1[i]="C"),fixArc(p,i),p2&&(p2[i]&&(pfirst=p2[i][0]),"C"!=pfirst&&(pcoms2[i]=pfirst,i&&(pcom=pcoms2[i-1])),p2[i]=processPath(p2[i],attrs2,pcom),"A"!=pcoms2[i]&&"C"==pfirst&&(pcoms2[i]="C"),fixArc(p2,i)),fixM(p,p2,attrs,attrs2,i),fixM(p2,p,attrs2,attrs,i);var seg=p[i],seg2=p2&&p2[i],seglen=seg.length,seg2len=p2&&seg2.length;attrs.x=seg[seglen-2],attrs.y=seg[seglen-1],attrs.bx=toFloat(seg[seglen-4])||attrs.x,attrs.by=toFloat(seg[seglen-3])||attrs.y,attrs2.bx=p2&&(toFloat(seg2[seg2len-4])||attrs2.x),attrs2.by=p2&&(toFloat(seg2[seg2len-3])||attrs2.y),attrs2.x=p2&&seg2[seg2len-2],attrs2.y=p2&&seg2[seg2len-1]}return p2||(pth.curve=pathClone(p)),p2?[p,p2]:p}),null,pathClone),tear=(R._parseDots=cacher((function(gradient){for(var dots=[],i=0,ii=gradient.length;i<ii;i++){var dot={},par=gradient[i].match(/^([^:]*):?([\d\.]*)/);if(dot.color=R.getRGB(par[1]),dot.color.error)return null;dot.opacity=dot.color.opacity,dot.color=dot.color.hex,par[2]&&(dot.offset=par[2]+"%"),dots.push(dot)}for(i=1,ii=dots.length-1;i<ii;i++)if(!dots[i].offset){for(var start=toFloat(dots[i-1].offset||0),end=0,j=i+1;j<ii;j++)if(dots[j].offset){end=dots[j].offset;break}end||(end=100,j=ii);for(var d=((end=toFloat(end))-start)/(j-i+1);i<j;i++)start+=d,dots[i].offset=start+"%"}return dots})),R._tear=function(el,paper){el==paper.top&&(paper.top=el.prev),el==paper.bottom&&(paper.bottom=el.next),el.next&&(el.next.prev=el.prev),el.prev&&(el.prev.next=el.next)}),toMatrix=(R._tofront=function(el,paper){paper.top!==el&&(tear(el,paper),el.next=null,el.prev=paper.top,paper.top.next=el,paper.top=el)},R._toback=function(el,paper){paper.bottom!==el&&(tear(el,paper),el.next=paper.bottom,el.prev=null,paper.bottom.prev=el,paper.bottom=el)},R._insertafter=function(el,el2,paper){tear(el,paper),el2==paper.top&&(paper.top=el),el2.next&&(el2.next.prev=el),el.next=el2.next,el.prev=el2,el2.next=el},R._insertbefore=function(el,el2,paper){tear(el,paper),el2==paper.bottom&&(paper.bottom=el),el2.prev&&(el2.prev.next=el),el.prev=el2.prev,el2.prev=el,el.next=el2},R.toMatrix=function(path,transform){var bb=pathDimensions(path),el={_:{transform:E},getBBox:function(){return bb}};return extractTransform(el,transform),el.matrix}),extractTransform=(R.transformPath=function(path,transform){return mapPath(path,toMatrix(path,transform))},R._extractTransform=function(el,tstr){if(null==tstr)return el._.transform;tstr=Str(tstr).replace(/\.{3}|\u2026/g,el._.transform||E);var dx,dy,tdata=R.parseTransformString(tstr),deg=0,sx=1,sy=1,_=el._,m=new Matrix;if(_.transform=tdata||[],tdata)for(var i=0,ii=tdata.length;i<ii;i++){var x1,y1,x2,y2,bb,t=tdata[i],tlen=t.length,command=Str(t[0]).toLowerCase(),absolute=t[0]!=command,inver=absolute?m.invert():0;"t"==command&&3==tlen?absolute?(x1=inver.x(0,0),y1=inver.y(0,0),x2=inver.x(t[1],t[2]),y2=inver.y(t[1],t[2]),m.translate(x2-x1,y2-y1)):m.translate(t[1],t[2]):"r"==command?2==tlen?(bb=bb||el.getBBox(1),m.rotate(t[1],bb.x+bb.width/2,bb.y+bb.height/2),deg+=t[1]):4==tlen&&(absolute?(x2=inver.x(t[2],t[3]),y2=inver.y(t[2],t[3]),m.rotate(t[1],x2,y2)):m.rotate(t[1],t[2],t[3]),deg+=t[1]):"s"==command?2==tlen||3==tlen?(bb=bb||el.getBBox(1),m.scale(t[1],t[tlen-1],bb.x+bb.width/2,bb.y+bb.height/2),sx*=t[1],sy*=t[tlen-1]):5==tlen&&(absolute?(x2=inver.x(t[3],t[4]),y2=inver.y(t[3],t[4]),m.scale(t[1],t[2],x2,y2)):m.scale(t[1],t[2],t[3],t[4]),sx*=t[1],sy*=t[2]):"m"==command&&7==tlen&&m.add(t[1],t[2],t[3],t[4],t[5],t[6]),_.dirtyT=1,el.matrix=m}el.matrix=m,_.sx=sx,_.sy=sy,_.deg=deg,_.dx=dx=m.e,_.dy=dy=m.f,1==sx&&1==sy&&!deg&&_.bbox?(_.bbox.x+=+dx,_.bbox.y+=+dy):_.dirtyT=1}),getEmpty=function(item){var l=item[0];switch(l.toLowerCase()){case"t":return[l,0,0];case"m":return[l,1,0,0,1,0,0];case"r":return 4==item.length?[l,0,item[2],item[3]]:[l,0];case"s":return 5==item.length?[l,1,1,item[3],item[4]]:3==item.length?[l,1,1]:[l,1]}},equaliseTransform=R._equaliseTransform=function(t1,t2){t2=Str(t2).replace(/\.{3}|\u2026/g,t1),t1=R.parseTransformString(t1)||[],t2=R.parseTransformString(t2)||[];for(var j,jj,tt1,tt2,maxlength=mmax(t1.length,t2.length),from=[],to=[],i=0;i<maxlength;i++){if(tt1=t1[i]||getEmpty(t2[i]),tt2=t2[i]||getEmpty(tt1),tt1[0]!=tt2[0]||"r"==tt1[0].toLowerCase()&&(tt1[2]!=tt2[2]||tt1[3]!=tt2[3])||"s"==tt1[0].toLowerCase()&&(tt1[3]!=tt2[3]||tt1[4]!=tt2[4]))return;for(from[i]=[],to[i]=[],j=0,jj=mmax(tt1.length,tt2.length);j<jj;j++)j in tt1&&(from[i][j]=tt1[j]),j in tt2&&(to[i][j]=tt2[j])}return{from:from,to:to}};function Matrix(a,b,c,d,e,f){null!=a?(this.a=+a,this.b=+b,this.c=+c,this.d=+d,this.e=+e,this.f=+f):(this.a=1,this.b=0,this.c=0,this.d=1,this.e=0,this.f=0)}R._getContainer=function(x,y,w,h){var container;if(null!=(container=null!=h||R.is(x,"object")?x:g.doc.getElementById(x)))return container.tagName?null==y?{container:container,width:container.style.pixelWidth||container.offsetWidth,height:container.style.pixelHeight||container.offsetHeight}:{container:container,width:y,height:w}:{container:1,x:x,y:y,width:w,height:h}},R.pathToRelative=pathToRelative,R._engine={},R.path2curve=path2curve,R.matrix=function(a,b,c,d,e,f){return new Matrix(a,b,c,d,e,f)},function(matrixproto){function norm(a){return a[0]*a[0]+a[1]*a[1]}function normalize(a){var mag=math.sqrt(norm(a));a[0]&&(a[0]/=mag),a[1]&&(a[1]/=mag)}matrixproto.add=function(a,b,c,d,e,f){var x,y,z,res,out=[[],[],[]],m=[[this.a,this.c,this.e],[this.b,this.d,this.f],[0,0,1]],matrix=[[a,c,e],[b,d,f],[0,0,1]];for(a&&a instanceof Matrix&&(matrix=[[a.a,a.c,a.e],[a.b,a.d,a.f],[0,0,1]]),x=0;x<3;x++)for(y=0;y<3;y++){for(res=0,z=0;z<3;z++)res+=m[x][z]*matrix[z][y];out[x][y]=res}this.a=out[0][0],this.b=out[1][0],this.c=out[0][1],this.d=out[1][1],this.e=out[0][2],this.f=out[1][2]},matrixproto.invert=function(){var me=this,x=me.a*me.d-me.b*me.c;return new Matrix(me.d/x,-me.b/x,-me.c/x,me.a/x,(me.c*me.f-me.d*me.e)/x,(me.b*me.e-me.a*me.f)/x)},matrixproto.clone=function(){return new Matrix(this.a,this.b,this.c,this.d,this.e,this.f)},matrixproto.translate=function(x,y){this.add(1,0,0,1,x,y)},matrixproto.scale=function(x,y,cx,cy){null==y&&(y=x),(cx||cy)&&this.add(1,0,0,1,cx,cy),this.add(x,0,0,y,0,0),(cx||cy)&&this.add(1,0,0,1,-cx,-cy)},matrixproto.rotate=function(a,x,y){a=R.rad(a),x=x||0,y=y||0;var cos=+math.cos(a).toFixed(9),sin=+math.sin(a).toFixed(9);this.add(cos,sin,-sin,cos,x,y),this.add(1,0,0,1,-x,-y)},matrixproto.x=function(x,y){return x*this.a+y*this.c+this.e},matrixproto.y=function(x,y){return x*this.b+y*this.d+this.f},matrixproto.get=function(i){return+this[Str.fromCharCode(97+i)].toFixed(4)},matrixproto.toString=function(){return R.svg?"matrix("+[this.get(0),this.get(1),this.get(2),this.get(3),this.get(4),this.get(5)].join()+")":[this.get(0),this.get(2),this.get(1),this.get(3),0,0].join()},matrixproto.toFilter=function(){return"progid:DXImageTransform.Microsoft.Matrix(M11="+this.get(0)+", M12="+this.get(2)+", M21="+this.get(1)+", M22="+this.get(3)+", Dx="+this.get(4)+", Dy="+this.get(5)+", sizingmethod='auto expand')"},matrixproto.offset=function(){return[this.e.toFixed(4),this.f.toFixed(4)]},matrixproto.split=function(){var out={};out.dx=this.e,out.dy=this.f;var row=[[this.a,this.c],[this.b,this.d]];out.scalex=math.sqrt(norm(row[0])),normalize(row[0]),out.shear=row[0][0]*row[1][0]+row[0][1]*row[1][1],row[1]=[row[1][0]-row[0][0]*out.shear,row[1][1]-row[0][1]*out.shear],out.scaley=math.sqrt(norm(row[1])),normalize(row[1]),out.shear/=out.scaley;var sin=-row[0][1],cos=row[1][1];return cos<0?(out.rotate=R.deg(math.acos(cos)),sin<0&&(out.rotate=360-out.rotate)):out.rotate=R.deg(math.asin(sin)),out.isSimple=!(+out.shear.toFixed(9)||out.scalex.toFixed(9)!=out.scaley.toFixed(9)&&out.rotate),out.isSuperSimple=!+out.shear.toFixed(9)&&out.scalex.toFixed(9)==out.scaley.toFixed(9)&&!out.rotate,out.noRotation=!+out.shear.toFixed(9)&&!out.rotate,out},matrixproto.toTransformString=function(shorter){var s=shorter||this.split();return s.isSimple?(s.scalex=+s.scalex.toFixed(4),s.scaley=+s.scaley.toFixed(4),s.rotate=+s.rotate.toFixed(4),(s.dx||s.dy?"t"+[s.dx,s.dy]:E)+(1!=s.scalex||1!=s.scaley?"s"+[s.scalex,s.scaley,0,0]:E)+(s.rotate?"r"+[s.rotate,0,0]:E)):"m"+[this.get(0),this.get(1),this.get(2),this.get(3),this.get(4),this.get(5)]}}(Matrix.prototype);for(var preventDefault=function(){this.returnValue=!1},preventTouch=function(){return this.originalEvent.preventDefault()},stopPropagation=function(){this.cancelBubble=!0},stopTouch=function(){return this.originalEvent.stopPropagation()},getEventPosition=function(e){var scrollY=g.doc.documentElement.scrollTop||g.doc.body.scrollTop,scrollX=g.doc.documentElement.scrollLeft||g.doc.body.scrollLeft;return{x:e.clientX+scrollX,y:e.clientY+scrollY}},addEvent=g.doc.addEventListener?function(obj,type,fn,element){var f=function(e){var pos=getEventPosition(e);return fn.call(element,e,pos.x,pos.y)};if(obj.addEventListener(type,f,!1),supportsTouch&&touchMap[type]){var _f=function(e){for(var pos=getEventPosition(e),olde=e,i=0,ii=e.targetTouches&&e.targetTouches.length;i<ii;i++)if(e.targetTouches[i].target==obj){(e=e.targetTouches[i]).originalEvent=olde,e.preventDefault=preventTouch,e.stopPropagation=stopTouch;break}return fn.call(element,e,pos.x,pos.y)};obj.addEventListener(touchMap[type],_f,!1)}return function(){return obj.removeEventListener(type,f,!1),supportsTouch&&touchMap[type]&&obj.removeEventListener(touchMap[type],_f,!1),!0}}:g.doc.attachEvent?function(obj,type,fn,element){var f=function(e){e=e||g.win.event;var scrollY=g.doc.documentElement.scrollTop||g.doc.body.scrollTop,scrollX=g.doc.documentElement.scrollLeft||g.doc.body.scrollLeft,x=e.clientX+scrollX,y=e.clientY+scrollY;return e.preventDefault=e.preventDefault||preventDefault,e.stopPropagation=e.stopPropagation||stopPropagation,fn.call(element,e,x,y)};return obj.attachEvent("on"+type,f),function(){return obj.detachEvent("on"+type,f),!0}}:void 0,drag=[],dragMove=function(e){for(var dragi,x=e.clientX,y=e.clientY,scrollY=g.doc.documentElement.scrollTop||g.doc.body.scrollTop,scrollX=g.doc.documentElement.scrollLeft||g.doc.body.scrollLeft,j=drag.length;j--;){if(dragi=drag[j],supportsTouch&&e.touches){for(var touch,i=e.touches.length;i--;)if((touch=e.touches[i]).identifier==dragi.el._drag.id){x=touch.clientX,y=touch.clientY,(e.originalEvent?e.originalEvent:e).preventDefault();break}}else e.preventDefault();var o,node=dragi.el.node,next=node.nextSibling,parent=node.parentNode,display=node.style.display;g.win.opera&&parent.removeChild(node),node.style.display="none",o=dragi.el.paper.getElementByPoint(x,y),node.style.display=display,g.win.opera&&(next?parent.insertBefore(node,next):parent.appendChild(node)),o&&eve("raphael.drag.over."+dragi.el.id,dragi.el,o),x+=scrollX,y+=scrollY,eve("raphael.drag.move."+dragi.el.id,dragi.move_scope||dragi.el,x-dragi.el._drag.x,y-dragi.el._drag.y,x,y,e)}},dragUp=function(e){R.unmousemove(dragMove).unmouseup(dragUp);for(var dragi,i=drag.length;i--;)(dragi=drag[i]).el._drag={},eve("raphael.drag.end."+dragi.el.id,dragi.end_scope||dragi.start_scope||dragi.move_scope||dragi.el,e);drag=[]},elproto=R.el={},i=events.length;i--;)!function(eventName){R[eventName]=elproto[eventName]=function(fn,scope){return R.is(fn,"function")&&(this.events=this.events||[],this.events.push({name:eventName,f:fn,unbind:addEvent(this.shape||this.node||g.doc,eventName,fn,scope||this)})),this},R["un"+eventName]=elproto["un"+eventName]=function(fn){for(var events=this.events||[],l=events.length;l--;)events[l].name!=eventName||!R.is(fn,"undefined")&&events[l].f!=fn||(events[l].unbind(),events.splice(l,1),!events.length&&delete this.events);return this}}(events[i]);elproto.data=function(key,value){var data=eldata[this.id]=eldata[this.id]||{};if(0==arguments.length)return data;if(1==arguments.length){if(R.is(key,"object")){for(var i in key)key[has](i)&&this.data(i,key[i]);return this}return eve("raphael.data.get."+this.id,this,data[key],key),data[key]}return data[key]=value,eve("raphael.data.set."+this.id,this,value,key),this},elproto.removeData=function(key){return null==key?eldata[this.id]={}:eldata[this.id]&&delete eldata[this.id][key],this},elproto.getData=function(){return clone(eldata[this.id]||{})},elproto.hover=function(f_in,f_out,scope_in,scope_out){return this.mouseover(f_in,scope_in).mouseout(f_out,scope_out||scope_in)},elproto.unhover=function(f_in,f_out){return this.unmouseover(f_in).unmouseout(f_out)};var draggable=[];function x_y_w_h(){return this.x+S+this.y+S+this.width+" × "+this.height}elproto.drag=function(onmove,onstart,onend,move_scope,start_scope,end_scope){function start(e){if("which"in e?2!=e.which&&3!=e.which:4!=e.button&&2!=e.button){(e.originalEvent||e).preventDefault();var x=e.clientX,y=e.clientY,scrollY=g.doc.documentElement.scrollTop||g.doc.body.scrollTop,scrollX=g.doc.documentElement.scrollLeft||g.doc.body.scrollLeft;if(this._drag.id=e.identifier,supportsTouch&&e.touches)for(var touch,i=e.touches.length;i--;)if(touch=e.touches[i],this._drag.id=touch.identifier,touch.identifier==this._drag.id){x=touch.clientX,y=touch.clientY;break}this._drag.x=x+scrollX,this._drag.y=y+scrollY,!drag.length&&R.mousemove(dragMove).mouseup(dragUp),drag.push({el:this,move_scope:move_scope,start_scope:start_scope,end_scope:end_scope}),onstart&&eve.on("raphael.drag.start."+this.id,onstart),onmove&&eve.on("raphael.drag.move."+this.id,onmove),onend&&eve.on("raphael.drag.end."+this.id,onend),eve("raphael.drag.start."+this.id,start_scope||move_scope||this,e.clientX+scrollX,e.clientY+scrollY,e)}}return this._drag={},draggable.push({el:this,start:start}),this.mousedown(start),this},elproto.onDragOver=function(f){f?eve.on("raphael.drag.over."+this.id,f):eve.unbind("raphael.drag.over."+this.id)},elproto.undrag=function(){for(var i=draggable.length;i--;)draggable[i].el==this&&(this.unmousedown(draggable[i].start),draggable.splice(i,1),eve.unbind("raphael.drag.*."+this.id));!draggable.length&&R.unmousemove(dragMove).unmouseup(dragUp),drag=[]},paperproto.circle=function(x,y,r){var out=R._engine.circle(this,x||0,y||0,r||0);return this.__set__&&this.__set__.push(out),out},paperproto.rect=function(x,y,w,h,r){var out=R._engine.rect(this,x||0,y||0,w||0,h||0,r||0);return this.__set__&&this.__set__.push(out),out},paperproto.ellipse=function(x,y,rx,ry){var out=R._engine.ellipse(this,x||0,y||0,rx||0,ry||0);return this.__set__&&this.__set__.push(out),out},paperproto.path=function(pathString){pathString&&!R.is(pathString,"string")&&!R.is(pathString[0],array)&&(pathString+=E);var out=R._engine.path(R.format[apply](R,arguments),this);return this.__set__&&this.__set__.push(out),out},paperproto.image=function(src,x,y,w,h){var out=R._engine.image(this,src||"about:blank",x||0,y||0,w||0,h||0);return this.__set__&&this.__set__.push(out),out},paperproto.text=function(x,y,text){var out=R._engine.text(this,x||0,y||0,Str(text));return this.__set__&&this.__set__.push(out),out},paperproto.set=function(itemsArray){!R.is(itemsArray,"array")&&(itemsArray=Array.prototype.splice.call(arguments,0,arguments.length));var out=new Set(itemsArray);return this.__set__&&this.__set__.push(out),out.paper=this,out.type="set",out},paperproto.setStart=function(set){this.__set__=set||this.set()},paperproto.setFinish=function(set){var out=this.__set__;return delete this.__set__,out},paperproto.getSize=function(){var container=this.canvas.parentNode;return{width:container.offsetWidth,height:container.offsetHeight}},paperproto.setSize=function(width,height){return R._engine.setSize.call(this,width,height)},paperproto.setViewBox=function(x,y,w,h,fit){return R._engine.setViewBox.call(this,x,y,w,h,fit)},paperproto.top=paperproto.bottom=null,paperproto.raphael=R,paperproto.getElementByPoint=function(x,y){var elem,box,doc,body,docElem,clientTop,clientLeft,svg=this.canvas,target=g.doc.elementFromPoint(x,y);if(g.win.opera&&"svg"==target.tagName){var so=(box=(elem=svg).getBoundingClientRect(),doc=elem.ownerDocument,body=doc.body,docElem=doc.documentElement,clientTop=docElem.clientTop||body.clientTop||0,clientLeft=docElem.clientLeft||body.clientLeft||0,{y:box.top+(g.win.pageYOffset||docElem.scrollTop||body.scrollTop)-clientTop,x:box.left+(g.win.pageXOffset||docElem.scrollLeft||body.scrollLeft)-clientLeft}),sr=svg.createSVGRect();sr.x=x-so.x,sr.y=y-so.y,sr.width=sr.height=1;var hits=svg.getIntersectionList(sr,null);hits.length&&(target=hits[hits.length-1])}if(!target)return null;for(;target.parentNode&&target!=svg.parentNode&&!target.raphael;)target=target.parentNode;return target==this.canvas.parentNode&&(target=svg),target=target&&target.raphael?this.getById(target.raphaelid):null},paperproto.getElementsByBBox=function(bbox){var set=this.set();return this.forEach((function(el){R.isBBoxIntersect(el.getBBox(),bbox)&&set.push(el)})),set},paperproto.getById=function(id){for(var bot=this.bottom;bot;){if(bot.id==id)return bot;bot=bot.next}return null},paperproto.forEach=function(callback,thisArg){for(var bot=this.bottom;bot;){if(!1===callback.call(thisArg,bot))return this;bot=bot.next}return this},paperproto.getElementsByPoint=function(x,y){var set=this.set();return this.forEach((function(el){el.isPointInside(x,y)&&set.push(el)})),set},elproto.isPointInside=function(x,y){var rp=this.realPath=getPath[this.type](this);return this.attr("transform")&&this.attr("transform").length&&(rp=R.transformPath(rp,this.attr("transform"))),R.isPointInsidePath(rp,x,y)},elproto.getBBox=function(isWithoutTransform){if(this.removed)return{};var _=this._;return isWithoutTransform?(!_.dirty&&_.bboxwt||(this.realPath=getPath[this.type](this),_.bboxwt=pathDimensions(this.realPath),_.bboxwt.toString=x_y_w_h,_.dirty=0),_.bboxwt):((_.dirty||_.dirtyT||!_.bbox)&&(!_.dirty&&this.realPath||(_.bboxwt=0,this.realPath=getPath[this.type](this)),_.bbox=pathDimensions(mapPath(this.realPath,this.matrix)),_.bbox.toString=x_y_w_h,_.dirty=_.dirtyT=0),_.bbox)},elproto.clone=function(){if(this.removed)return null;var out=this.paper[this.type]().attr(this.attr());return this.__set__&&this.__set__.push(out),out},elproto.glow=function(glow){if("text"==this.type)return null;var s={width:((glow=glow||{}).width||10)+(+this.attr("stroke-width")||1),fill:glow.fill||!1,opacity:null==glow.opacity?.5:glow.opacity,offsetx:glow.offsetx||0,offsety:glow.offsety||0,color:glow.color||"#000"},c=s.width/2,r=this.paper,out=r.set(),path=this.realPath||getPath[this.type](this);path=this.matrix?mapPath(path,this.matrix):path;for(var i=1;i<c+1;i++)out.push(r.path(path).attr({stroke:s.color,fill:s.fill?s.color:"none","stroke-linejoin":"round","stroke-linecap":"round","stroke-width":+(s.width/c*i).toFixed(3),opacity:+(s.opacity/c).toFixed(3)}));return out.insertBefore(this).translate(s.offsetx,s.offsety)};var getPointAtSegmentLength=function(p1x,p1y,c1x,c1y,c2x,c2y,p2x,p2y,length){return null==length?bezlen(p1x,p1y,c1x,c1y,c2x,c2y,p2x,p2y):R.findDotsAtSegment(p1x,p1y,c1x,c1y,c2x,c2y,p2x,p2y,function(x1,y1,x2,y2,x3,y3,x4,y4,ll){if(!(ll<0||bezlen(x1,y1,x2,y2,x3,y3,x4,y4)<ll)){var l,step=.5,t2=1-step;for(l=bezlen(x1,y1,x2,y2,x3,y3,x4,y4,t2);abs(l-ll)>.01;)l=bezlen(x1,y1,x2,y2,x3,y3,x4,y4,t2+=(l<ll?1:-1)*(step/=2));return t2}}(p1x,p1y,c1x,c1y,c2x,c2y,p2x,p2y,length))},getLengthFactory=function(istotal,subpath){return function(path,length,onlystart){for(var x,y,p,l,point,sp="",subpaths={},len=0,i=0,ii=(path=path2curve(path)).length;i<ii;i++){if("M"==(p=path[i])[0])x=+p[1],y=+p[2];else{if(len+(l=getPointAtSegmentLength(x,y,p[1],p[2],p[3],p[4],p[5],p[6]))>length){if(subpath&&!subpaths.start){if(sp+=["C"+(point=getPointAtSegmentLength(x,y,p[1],p[2],p[3],p[4],p[5],p[6],length-len)).start.x,point.start.y,point.m.x,point.m.y,point.x,point.y],onlystart)return sp;subpaths.start=sp,sp=["M"+point.x,point.y+"C"+point.n.x,point.n.y,point.end.x,point.end.y,p[5],p[6]].join(),len+=l,x=+p[5],y=+p[6];continue}if(!istotal&&!subpath)return{x:(point=getPointAtSegmentLength(x,y,p[1],p[2],p[3],p[4],p[5],p[6],length-len)).x,y:point.y,alpha:point.alpha}}len+=l,x=+p[5],y=+p[6]}sp+=p.shift()+p}return subpaths.end=sp,(point=istotal?len:subpath?subpaths:R.findDotsAtSegment(x,y,p[0],p[1],p[2],p[3],p[4],p[5],1)).alpha&&(point={x:point.x,y:point.y,alpha:point.alpha}),point}},getTotalLength=getLengthFactory(1),getPointAtLength=getLengthFactory(),getSubpathsAtLength=getLengthFactory(0,1);R.getTotalLength=getTotalLength,R.getPointAtLength=getPointAtLength,R.getSubpath=function(path,from,to){if(this.getTotalLength(path)-to<1e-6)return getSubpathsAtLength(path,from).end;var a=getSubpathsAtLength(path,to,1);return from?getSubpathsAtLength(a,from).end:a},elproto.getTotalLength=function(){var path=this.getPath();if(path)return this.node.getTotalLength?this.node.getTotalLength():getTotalLength(path)},elproto.getPointAtLength=function(length){var path=this.getPath();if(path)return getPointAtLength(path,length)},elproto.getPath=function(){var path,getPath=R._getPath[this.type];if("text"!=this.type&&"set"!=this.type)return getPath&&(path=getPath(this)),path},elproto.getSubpath=function(from,to){var path=this.getPath();if(path)return R.getSubpath(path,from,to)};var ef=R.easing_formulas={linear:function(n){return n},"<":function(n){return pow(n,1.7)},">":function(n){return pow(n,.48)},"<>":function(n){var q=.48-n/1.04,Q=math.sqrt(.1734+q*q),x=Q-q,y=-Q-q,t=pow(abs(x),1/3)*(x<0?-1:1)+pow(abs(y),1/3)*(y<0?-1:1)+.5;return 3*(1-t)*t*t+t*t*t},backIn:function(n){var s=1.70158;return n*n*((s+1)*n-s)},backOut:function(n){var s=1.70158;return(n-=1)*n*((s+1)*n+s)+1},elastic:function(n){return n==!!n?n:pow(2,-10*n)*math.sin(2*PI*(n-.075)/.3)+1},bounce:function(n){var s=7.5625,p=2.75;return n<1/p?s*n*n:n<2/p?s*(n-=1.5/p)*n+.75:n<2.5/p?s*(n-=2.25/p)*n+.9375:s*(n-=2.625/p)*n+.984375}};ef.easeIn=ef["ease-in"]=ef["<"],ef.easeOut=ef["ease-out"]=ef[">"],ef.easeInOut=ef["ease-in-out"]=ef["<>"],ef["back-in"]=ef.backIn,ef["back-out"]=ef.backOut;var animationElements=[],requestAnimFrame=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(callback){setTimeout(callback,16)},animation=function(){for(var Now=+new Date,l=0;l<animationElements.length;l++){var e=animationElements[l];if(!e.el.removed&&!e.paused){var now,key,time=Now-e.start,ms=e.ms,easing=e.easing,from=e.from,diff=e.diff,to=e.to,that=(e.t,e.el),set={},init={};if(e.initstatus?(time=(e.initstatus*e.anim.top-e.prev)/(e.percent-e.prev)*ms,e.status=e.initstatus,delete e.initstatus,e.stop&&animationElements.splice(l--,1)):e.status=(e.prev+(e.percent-e.prev)*(time/ms))/e.anim.top,!(time<0))if(time<ms){var pos=easing(time/ms);for(var attr in from)if(from[has](attr)){switch(availableAnimAttrs[attr]){case nu:now=+from[attr]+pos*ms*diff[attr];break;case"colour":now="rgb("+[upto255(round(from[attr].r+pos*ms*diff[attr].r)),upto255(round(from[attr].g+pos*ms*diff[attr].g)),upto255(round(from[attr].b+pos*ms*diff[attr].b))].join(",")+")";break;case"path":now=[];for(var i=0,ii=from[attr].length;i<ii;i++){now[i]=[from[attr][i][0]];for(var j=1,jj=from[attr][i].length;j<jj;j++)now[i][j]=+from[attr][i][j]+pos*ms*diff[attr][i][j];now[i]=now[i].join(S)}now=now.join(S);break;case"transform":if(diff[attr].real)for(now=[],i=0,ii=from[attr].length;i<ii;i++)for(now[i]=[from[attr][i][0]],j=1,jj=from[attr][i].length;j<jj;j++)now[i][j]=from[attr][i][j]+pos*ms*diff[attr][i][j];else{var get=function(i){return+from[attr][i]+pos*ms*diff[attr][i]};now=[["m",get(0),get(1),get(2),get(3),get(4),get(5)]]}break;case"csv":if("clip-rect"==attr)for(now=[],i=4;i--;)now[i]=+from[attr][i]+pos*ms*diff[attr][i];break;default:var from2=[].concat(from[attr]);for(now=[],i=that.paper.customAttributes[attr].length;i--;)now[i]=+from2[i]+pos*ms*diff[attr][i]}set[attr]=now}that.attr(set),function(id,that,anim){setTimeout((function(){eve("raphael.anim.frame."+id,that,anim)}))}(that.id,that,e.anim)}else{if(function(f,el,a){setTimeout((function(){eve("raphael.anim.frame."+el.id,el,a),eve("raphael.anim.finish."+el.id,el,a),R.is(f,"function")&&f.call(el)}))}(e.callback,that,e.anim),that.attr(to),animationElements.splice(l--,1),e.repeat>1&&!e.next){for(key in to)to[has](key)&&(init[key]=e.totalOrigin[key]);e.el.attr(init),runAnimation(e.anim,e.el,e.anim.percents[0],null,e.totalOrigin,e.repeat-1)}e.next&&!e.stop&&runAnimation(e.anim,e.el,e.next,null,e.totalOrigin,e.repeat)}}}animationElements.length&&requestAnimFrame(animation)},upto255=function(color){return color>255?255:color<0?0:color};function CubicBezierAtTime(t,p1x,p1y,p2x,p2y,duration){var cx=3*p1x,bx=3*(p2x-p1x)-cx,ax=1-cx-bx,cy=3*p1y,by=3*(p2y-p1y)-cy,ay=1-cy-by;function sampleCurveX(t){return((ax*t+bx)*t+cx)*t}return function(x,epsilon){var t=function(x,epsilon){var t0,t1,t2,x2,d2,i;for(t2=x,i=0;i<8;i++){if(x2=sampleCurveX(t2)-x,abs(x2)<epsilon)return t2;if(abs(d2=(3*ax*t2+2*bx)*t2+cx)<1e-6)break;t2-=x2/d2}if(t1=1,(t2=x)<(t0=0))return t0;if(t2>t1)return t1;for(;t0<t1;){if(x2=sampleCurveX(t2),abs(x2-x)<epsilon)return t2;x>x2?t0=t2:t1=t2,t2=(t1-t0)/2+t0}return t2}(x,epsilon);return((ay*t+by)*t+cy)*t}(t,1/(200*duration))}function Animation(anim,ms){var percents=[],newAnim={};if(this.ms=ms,this.times=1,anim){for(var attr in anim)anim[has](attr)&&(newAnim[toFloat(attr)]=anim[attr],percents.push(toFloat(attr)));percents.sort(sortByNumber)}this.anim=newAnim,this.top=percents[percents.length-1],this.percents=percents}function runAnimation(anim,element,percent,status,totalOrigin,times){percent=toFloat(percent);var params,isInAnim,isInAnimSet,next,prev,timestamp,ms=anim.ms,from={},to={},diff={};if(status)for(var i=0,ii=animationElements.length;i<ii;i++){var e=animationElements[i];if(e.el.id==element.id&&e.anim==anim){e.percent!=percent?(animationElements.splice(i,1),isInAnimSet=1):isInAnim=e,element.attr(e.totalOrigin);break}}else status=+to;for(i=0,ii=anim.percents.length;i<ii;i++){if(anim.percents[i]==percent||anim.percents[i]>status*anim.top){percent=anim.percents[i],prev=anim.percents[i-1]||0,ms=ms/anim.top*(percent-prev),next=anim.percents[i+1],params=anim.anim[percent];break}status&&element.attr(anim.anim[anim.percents[i]])}if(params){if(isInAnim)isInAnim.initstatus=status,isInAnim.start=new Date-isInAnim.ms*status;else{for(var attr in params)if(params[has](attr)&&(availableAnimAttrs[has](attr)||element.paper.customAttributes[has](attr)))switch(from[attr]=element.attr(attr),null==from[attr]&&(from[attr]=availableAttrs[attr]),to[attr]=params[attr],availableAnimAttrs[attr]){case nu:diff[attr]=(to[attr]-from[attr])/ms;break;case"colour":from[attr]=R.getRGB(from[attr]);var toColour=R.getRGB(to[attr]);diff[attr]={r:(toColour.r-from[attr].r)/ms,g:(toColour.g-from[attr].g)/ms,b:(toColour.b-from[attr].b)/ms};break;case"path":var pathes=path2curve(from[attr],to[attr]),toPath=pathes[1];for(from[attr]=pathes[0],diff[attr]=[],i=0,ii=from[attr].length;i<ii;i++){diff[attr][i]=[0];for(var j=1,jj=from[attr][i].length;j<jj;j++)diff[attr][i][j]=(toPath[i][j]-from[attr][i][j])/ms}break;case"transform":var _=element._,eq=equaliseTransform(_[attr],to[attr]);if(eq)for(from[attr]=eq.from,to[attr]=eq.to,diff[attr]=[],diff[attr].real=!0,i=0,ii=from[attr].length;i<ii;i++)for(diff[attr][i]=[from[attr][i][0]],j=1,jj=from[attr][i].length;j<jj;j++)diff[attr][i][j]=(to[attr][i][j]-from[attr][i][j])/ms;else{var m=element.matrix||new Matrix,to2={_:{transform:_.transform},getBBox:function(){return element.getBBox(1)}};from[attr]=[m.a,m.b,m.c,m.d,m.e,m.f],extractTransform(to2,to[attr]),to[attr]=to2._.transform,diff[attr]=[(to2.matrix.a-m.a)/ms,(to2.matrix.b-m.b)/ms,(to2.matrix.c-m.c)/ms,(to2.matrix.d-m.d)/ms,(to2.matrix.e-m.e)/ms,(to2.matrix.f-m.f)/ms]}break;case"csv":var values=Str(params[attr]).split(separator),from2=Str(from[attr]).split(separator);if("clip-rect"==attr)for(from[attr]=from2,diff[attr]=[],i=from2.length;i--;)diff[attr][i]=(values[i]-from[attr][i])/ms;to[attr]=values;break;default:for(values=[].concat(params[attr]),from2=[].concat(from[attr]),diff[attr]=[],i=element.paper.customAttributes[attr].length;i--;)diff[attr][i]=((values[i]||0)-(from2[i]||0))/ms}var easing=params.easing,easyeasy=R.easing_formulas[easing];if(!easyeasy)if((easyeasy=Str(easing).match(bezierrg))&&5==easyeasy.length){var curve=easyeasy;easyeasy=function(t){return CubicBezierAtTime(t,+curve[1],+curve[2],+curve[3],+curve[4],ms)}}else easyeasy=pipe;if(e={anim:anim,percent:percent,timestamp:timestamp=params.start||anim.start||+new Date,start:timestamp+(anim.del||0),status:0,initstatus:status||0,stop:!1,ms:ms,easing:easyeasy,from:from,diff:diff,to:to,el:element,callback:params.callback,prev:prev,next:next,repeat:times||anim.times,origin:element.attr(),totalOrigin:totalOrigin},animationElements.push(e),status&&!isInAnim&&!isInAnimSet&&(e.stop=!0,e.start=new Date-ms*status,1==animationElements.length))return animation();isInAnimSet&&(e.start=new Date-e.ms*status),1==animationElements.length&&requestAnimFrame(animation)}eve("raphael.anim.start."+element.id,element,anim)}}function stopAnimation(paper){for(var i=0;i<animationElements.length;i++)animationElements[i].el.paper==paper&&animationElements.splice(i--,1)}elproto.animateWith=function(el,anim,params,ms,easing,callback){if(this.removed)return callback&&callback.call(this),this;var a=params instanceof Animation?params:R.animation(params,ms,easing,callback);runAnimation(a,this,a.percents[0],null,this.attr());for(var i=0,ii=animationElements.length;i<ii;i++)if(animationElements[i].anim==anim&&animationElements[i].el==el){animationElements[ii-1].start=animationElements[i].start;break}return this},elproto.onAnimation=function(f){return f?eve.on("raphael.anim.frame."+this.id,f):eve.unbind("raphael.anim.frame."+this.id),this},Animation.prototype.delay=function(delay){var a=new Animation(this.anim,this.ms);return a.times=this.times,a.del=+delay||0,a},Animation.prototype.repeat=function(times){var a=new Animation(this.anim,this.ms);return a.del=this.del,a.times=math.floor(mmax(times,0))||1,a},R.animation=function(params,ms,easing,callback){if(params instanceof Animation)return params;!R.is(easing,"function")&&easing||(callback=callback||easing||null,easing=null),params=Object(params),ms=+ms||0;var json,attr,p={};for(attr in params)params[has](attr)&&toFloat(attr)!=attr&&toFloat(attr)+"%"!=attr&&(json=!0,p[attr]=params[attr]);if(json)return easing&&(p.easing=easing),callback&&(p.callback=callback),new Animation({100:p},ms);if(callback){var lastKey=0;for(var i in params){var percent=toInt(i);params[has](i)&&percent>lastKey&&(lastKey=percent)}!params[lastKey+="%"].callback&&(params[lastKey].callback=callback)}return new Animation(params,ms)},elproto.animate=function(params,ms,easing,callback){if(this.removed)return callback&&callback.call(this),this;var anim=params instanceof Animation?params:R.animation(params,ms,easing,callback);return runAnimation(anim,this,anim.percents[0],null,this.attr()),this},elproto.setTime=function(anim,value){return anim&&null!=value&&this.status(anim,mmin(value,anim.ms)/anim.ms),this},elproto.status=function(anim,value){var len,e,out=[],i=0;if(null!=value)return runAnimation(anim,this,-1,mmin(value,1)),this;for(len=animationElements.length;i<len;i++)if((e=animationElements[i]).el.id==this.id&&(!anim||e.anim==anim)){if(anim)return e.status;out.push({anim:e.anim,status:e.status})}return anim?0:out},elproto.pause=function(anim){for(var i=0;i<animationElements.length;i++)animationElements[i].el.id!=this.id||anim&&animationElements[i].anim!=anim||!1!==eve("raphael.anim.pause."+this.id,this,animationElements[i].anim)&&(animationElements[i].paused=!0);return this},elproto.resume=function(anim){for(var i=0;i<animationElements.length;i++)if(animationElements[i].el.id==this.id&&(!anim||animationElements[i].anim==anim)){var e=animationElements[i];!1!==eve("raphael.anim.resume."+this.id,this,e.anim)&&(delete e.paused,this.status(e.anim,e.status))}return this},elproto.stop=function(anim){for(var i=0;i<animationElements.length;i++)animationElements[i].el.id!=this.id||anim&&animationElements[i].anim!=anim||!1!==eve("raphael.anim.stop."+this.id,this,animationElements[i].anim)&&animationElements.splice(i--,1);return this},eve.on("raphael.remove",stopAnimation),eve.on("raphael.clear",stopAnimation),elproto.toString=function(){return"Raphaël’s object"};var tokenRegex,objNotationRegex,doc,f,Set=function(items){if(this.items=[],this.length=0,this.type="set",items)for(var i=0,ii=items.length;i<ii;i++)!items[i]||items[i].constructor!=elproto.constructor&&items[i].constructor!=Set||(this[this.items.length]=this.items[this.items.length]=items[i],this.length++)},setproto=Set.prototype;for(var method in setproto.push=function(){for(var item,len,i=0,ii=arguments.length;i<ii;i++)!(item=arguments[i])||item.constructor!=elproto.constructor&&item.constructor!=Set||(this[len=this.items.length]=this.items[len]=item,this.length++);return this},setproto.pop=function(){return this.length&&delete this[this.length--],this.items.pop()},setproto.forEach=function(callback,thisArg){for(var i=0,ii=this.items.length;i<ii;i++)if(!1===callback.call(thisArg,this.items[i],i))return this;return this},elproto)elproto[has](method)&&(setproto[method]=function(methodname){return function(){var arg=arguments;return this.forEach((function(el){el[methodname][apply](el,arg)}))}}(method));return setproto.attr=function(name,value){if(name&&R.is(name,array)&&R.is(name[0],"object"))for(var j=0,jj=name.length;j<jj;j++)this.items[j].attr(name[j]);else for(var i=0,ii=this.items.length;i<ii;i++)this.items[i].attr(name,value);return this},setproto.clear=function(){for(;this.length;)this.pop()},setproto.splice=function(index,count,insertion){index=index<0?mmax(this.length+index,0):index,count=mmax(0,mmin(this.length-index,count));var i,tail=[],todel=[],args=[];for(i=2;i<arguments.length;i++)args.push(arguments[i]);for(i=0;i<count;i++)todel.push(this[index+i]);for(;i<this.length-index;i++)tail.push(this[index+i]);var arglen=args.length;for(i=0;i<arglen+tail.length;i++)this.items[index+i]=this[index+i]=i<arglen?args[i]:tail[i-arglen];for(i=this.items.length=this.length-=count-arglen;this[i];)delete this[i++];return new Set(todel)},setproto.exclude=function(el){for(var i=0,ii=this.length;i<ii;i++)if(this[i]==el)return this.splice(i,1),!0},setproto.animate=function(params,ms,easing,callback){(R.is(easing,"function")||!easing)&&(callback=easing||null);var item,collector,len=this.items.length,i=len,set=this;if(!len)return this;callback&&(collector=function(){!--len&&callback.call(set)}),easing=R.is(easing,"string")?easing:collector;var anim=R.animation(params,ms,easing,collector);for(item=this.items[--i].animate(anim);i--;)this.items[i]&&!this.items[i].removed&&this.items[i].animateWith(item,anim,anim),this.items[i]&&!this.items[i].removed||len--;return this},setproto.insertAfter=function(el){for(var i=this.items.length;i--;)this.items[i].insertAfter(el);return this},setproto.getBBox=function(){for(var x=[],y=[],x2=[],y2=[],i=this.items.length;i--;)if(!this.items[i].removed){var box=this.items[i].getBBox();x.push(box.x),y.push(box.y),x2.push(box.x+box.width),y2.push(box.y+box.height)}return{x:x=mmin[apply](0,x),y:y=mmin[apply](0,y),x2:x2=mmax[apply](0,x2),y2:y2=mmax[apply](0,y2),width:x2-x,height:y2-y}},setproto.clone=function(s){s=this.paper.set();for(var i=0,ii=this.items.length;i<ii;i++)s.push(this.items[i].clone());return s},setproto.toString=function(){return"Raphaël‘s set"},setproto.glow=function(glowConfig){var ret=this.paper.set();return this.forEach((function(shape,index){var g=shape.glow(glowConfig);null!=g&&g.forEach((function(shape2,index2){ret.push(shape2)}))})),ret},setproto.isPointInside=function(x,y){var isPointInside=!1;return this.forEach((function(el){if(el.isPointInside(x,y))return isPointInside=!0,!1})),isPointInside},R.registerFont=function(font){if(!font.face)return font;this.fonts=this.fonts||{};var fontcopy={w:font.w,face:{},glyphs:{}},family=font.face["font-family"];for(var prop in font.face)font.face[has](prop)&&(fontcopy.face[prop]=font.face[prop]);if(this.fonts[family]?this.fonts[family].push(fontcopy):this.fonts[family]=[fontcopy],!font.svg)for(var glyph in fontcopy.face["units-per-em"]=toInt(font.face["units-per-em"],10),font.glyphs)if(font.glyphs[has](glyph)){var path=font.glyphs[glyph];if(fontcopy.glyphs[glyph]={w:path.w,k:{},d:path.d&&"M"+path.d.replace(/[mlcxtrv]/g,(function(command){return{l:"L",c:"C",x:"z",t:"m",r:"l",v:"c"}[command]||"M"}))+"z"},path.k)for(var k in path.k)path[has](k)&&(fontcopy.glyphs[glyph].k[k]=path.k[k])}return font},paperproto.getFont=function(family,weight,style,stretch){if(stretch=stretch||"normal",style=style||"normal",weight=+weight||{normal:400,bold:700,lighter:300,bolder:800}[weight]||400,R.fonts){var thefont,font=R.fonts[family];if(!font){var name=new RegExp("(^|\\s)"+family.replace(/[^\w\d\s+!~.:_-]/g,E)+"(\\s|$)","i");for(var fontName in R.fonts)if(R.fonts[has](fontName)&&name.test(fontName)){font=R.fonts[fontName];break}}if(font)for(var i=0,ii=font.length;i<ii&&((thefont=font[i]).face["font-weight"]!=weight||thefont.face["font-style"]!=style&&thefont.face["font-style"]||thefont.face["font-stretch"]!=stretch);i++);return thefont}},paperproto.print=function(x,y,string,font,size,origin,letter_spacing,line_spacing){origin=origin||"middle",letter_spacing=mmax(mmin(letter_spacing||0,1),-1),line_spacing=mmax(mmin(line_spacing||1,3),1);var scale,letters=Str(string).split(E),shift=0,notfirst=0,path=E;if(R.is(font,"string")&&(font=this.getFont(font)),font){scale=(size||16)/font.face["units-per-em"];for(var bb=font.face.bbox.split(separator),top=+bb[0],lineHeight=bb[3]-bb[1],shifty=0,height=+bb[1]+("baseline"==origin?lineHeight+ +font.face.descent:lineHeight/2),i=0,ii=letters.length;i<ii;i++){if("\n"==letters[i])shift=0,curr=0,notfirst=0,shifty+=lineHeight*line_spacing;else{var prev=notfirst&&font.glyphs[letters[i-1]]||{},curr=font.glyphs[letters[i]];shift+=notfirst?(prev.w||font.w)+(prev.k&&prev.k[letters[i]]||0)+font.w*letter_spacing:0,notfirst=1}curr&&curr.d&&(path+=R.transformPath(curr.d,["t",shift*scale,shifty*scale,"s",scale,scale,top,height,"t",(x-top)/scale,(y-height)/scale]))}}return this.path(path).attr({fill:"#000",stroke:"none"})},paperproto.add=function(json){if(R.is(json,"array"))for(var j,res=this.set(),i=0,ii=json.length;i<ii;i++)j=json[i]||{},elements[has](j.type)&&res.push(this[j.type]().attr(j));return res},R.format=function(token,params){var args=R.is(params,array)?[0].concat(params):arguments;return token&&R.is(token,"string")&&args.length-1&&(token=token.replace(formatrg,(function(str,i){return null==args[++i]?E:args[i]}))),token||E},R.fullfill=(tokenRegex=/\{([^\}]+)\}/g,objNotationRegex=/(?:(?:^|\.)(.+?)(?=\[|\.|$|\()|\[('|")(.+?)\2\])(\(\))?/g,function(str,obj){return String(str).replace(tokenRegex,(function(all,key){return function(all,key,obj){var res=obj;return key.replace(objNotationRegex,(function(all,name,quote,quotedName,isFunc){name=name||quotedName,res&&(name in res&&(res=res[name]),"function"==typeof res&&isFunc&&(res=res()))})),res=(null==res||res==obj?all:res)+""}(all,key,obj)}))}),R.ninja=function(){if(oldRaphael.was)g.win.Raphael=oldRaphael.is;else{window.Raphael=undefined;try{delete window.Raphael}catch(e){}}return R},R.st=setproto,eve.on("raphael.DOMload",(function(){loaded=!0})),null==(doc=document).readyState&&doc.addEventListener&&(doc.addEventListener("DOMContentLoaded",f=function(){doc.removeEventListener("DOMContentLoaded",f,!1),doc.readyState="complete"},!1),doc.readyState="loading"),function isLoaded(){/in/.test(doc.readyState)?setTimeout(isLoaded,9):R.eve("raphael.DOMload")}(),R}.apply(exports,__WEBPACK_AMD_DEFINE_ARRAY__))===undefined||(module.exports=__WEBPACK_AMD_DEFINE_RESULT__)},function(module,exports,__webpack_require__){var __WEBPACK_AMD_DEFINE_RESULT__,current_event,stop,has,separator,fun,numsort,events,eve;has="hasOwnProperty",separator=/[\.\/]/,fun=function(){},numsort=function(a,b){return a-b},(eve=function(name,scope){name=String(name);var l,oldstop=stop,args=Array.prototype.slice.call(arguments,2),listeners=eve.listeners(name),z=0,indexed=[],queue={},out=[],ce=current_event;current_event=name,stop=0;for(var i=0,ii=listeners.length;i<ii;i++)"zIndex"in listeners[i]&&(indexed.push(listeners[i].zIndex),listeners[i].zIndex<0&&(queue[listeners[i].zIndex]=listeners[i]));for(indexed.sort(numsort);indexed[z]<0;)if(l=queue[indexed[z++]],out.push(l.apply(scope,args)),stop)return stop=oldstop,out;for(i=0;i<ii;i++)if("zIndex"in(l=listeners[i]))if(l.zIndex==indexed[z]){if(out.push(l.apply(scope,args)),stop)break;do{if((l=queue[indexed[++z]])&&out.push(l.apply(scope,args)),stop)break}while(l)}else queue[l.zIndex]=l;else if(out.push(l.apply(scope,args)),stop)break;return stop=oldstop,current_event=ce,out.length?out:null})._events=events={n:{}},eve.listeners=function(name){var item,items,k,i,ii,j,jj,nes,names=name.split(separator),e=events,es=[e],out=[];for(i=0,ii=names.length;i<ii;i++){for(nes=[],j=0,jj=es.length;j<jj;j++)for(items=[(e=es[j].n)[names[i]],e["*"]],k=2;k--;)(item=items[k])&&(nes.push(item),out=out.concat(item.f||[]));es=nes}return out},eve.on=function(name,f){if(name=String(name),"function"!=typeof f)return function(){};for(var names=name.split(separator),e=events,i=0,ii=names.length;i<ii;i++)e=(e=e.n).hasOwnProperty(names[i])&&e[names[i]]||(e[names[i]]={n:{}});for(e.f=e.f||[],i=0,ii=e.f.length;i<ii;i++)if(e.f[i]==f)return fun;return e.f.push(f),function(zIndex){+zIndex==+zIndex&&(f.zIndex=+zIndex)}},eve.f=function(event){var attrs=[].slice.call(arguments,1);return function(){eve.apply(null,[event,null].concat(attrs).concat([].slice.call(arguments,0)))}},eve.stop=function(){stop=1},eve.nt=function(subname){return subname?new RegExp("(?:\\.|\\/|^)"+subname+"(?:\\.|\\/|$)").test(current_event):current_event},eve.nts=function(){return current_event.split(separator)},eve.off=eve.unbind=function(name,f){if(name){var e,key,splice,i,ii,j,jj,names=name.split(separator),cur=[events];for(i=0,ii=names.length;i<ii;i++)for(j=0;j<cur.length;j+=splice.length-2){if(splice=[j,1],e=cur[j].n,"*"!=names[i])e[names[i]]&&splice.push(e[names[i]]);else for(key in e)e[has](key)&&splice.push(e[key]);cur.splice.apply(cur,splice)}for(i=0,ii=cur.length;i<ii;i++)for(e=cur[i];e.n;){if(f){if(e.f){for(j=0,jj=e.f.length;j<jj;j++)if(e.f[j]==f){e.f.splice(j,1);break}!e.f.length&&delete e.f}for(key in e.n)if(e.n[has](key)&&e.n[key].f){var funcs=e.n[key].f;for(j=0,jj=funcs.length;j<jj;j++)if(funcs[j]==f){funcs.splice(j,1);break}!funcs.length&&delete e.n[key].f}}else for(key in delete e.f,e.n)e.n[has](key)&&e.n[key].f&&delete e.n[key].f;e=e.n}}else eve._events=events={n:{}}},eve.once=function(name,f){var f2=function(){return eve.unbind(name,f2),f.apply(this,arguments)};return eve.on(name,f2)},eve.version="0.4.2",eve.toString=function(){return"You are running Eve 0.4.2"},void 0!==module&&module.exports?module.exports=eve:(__WEBPACK_AMD_DEFINE_RESULT__=function(){return eve}.apply(exports,[]))===undefined||(module.exports=__WEBPACK_AMD_DEFINE_RESULT__)},function(module,exports,__webpack_require__){var __WEBPACK_AMD_DEFINE_ARRAY__,__WEBPACK_AMD_DEFINE_RESULT__;__WEBPACK_AMD_DEFINE_ARRAY__=[__webpack_require__(1)],(__WEBPACK_AMD_DEFINE_RESULT__=function(R){if(!R||R.svg){var has="hasOwnProperty",Str=String,toFloat=parseFloat,toInt=parseInt,math=Math,mmax=math.max,abs=math.abs,pow=math.pow,separator=/[, ]+/,eve=R.eve,E="",S=" ",xlink="http://www.w3.org/1999/xlink",markers={block:"M5,0 0,2.5 5,5z",classic:"M5,0 0,2.5 5,5 3.5,3 3.5,2z",diamond:"M2.5,0 5,2.5 2.5,5 0,2.5z",open:"M6,1 1,3.5 6,6",oval:"M2.5,0A2.5,2.5,0,0,1,2.5,5 2.5,2.5,0,0,1,2.5,0z"},markerCounter={};R.toString=function(){return"Your browser supports SVG.\nYou are running Raphaël "+this.version};var $=function(el,attr){if(attr)for(var key in"string"==typeof el&&(el=$(el)),attr)attr[has](key)&&("xlink:"==key.substring(0,6)?el.setAttributeNS(xlink,key.substring(6),Str(attr[key])):el.setAttribute(key,Str(attr[key])));else(el=R._g.doc.createElementNS("http://www.w3.org/2000/svg",el)).style&&(el.style.webkitTapHighlightColor="rgba(0,0,0,0)");return el},addGradientFill=function(element,gradient){var type="linear",id=element.id+gradient,fx=.5,fy=.5,o=element.node,SVG=element.paper,s=o.style,el=R._g.doc.getElementById(id);if(!el){if(gradient=(gradient=Str(gradient).replace(R._radial_gradient,(function(all,_fx,_fy){if(type="radial",_fx&&_fy){fx=toFloat(_fx);var dir=2*((fy=toFloat(_fy))>.5)-1;pow(fx-.5,2)+pow(fy-.5,2)>.25&&(fy=math.sqrt(.25-pow(fx-.5,2))*dir+.5)&&.5!=fy&&(fy=fy.toFixed(5)-1e-5*dir)}return E}))).split(/\s*\-\s*/),"linear"==type){var angle=gradient.shift();if(angle=-toFloat(angle),isNaN(angle))return null;var vector=[0,0,math.cos(R.rad(angle)),math.sin(R.rad(angle))],max=1/(mmax(abs(vector[2]),abs(vector[3]))||1);vector[2]*=max,vector[3]*=max,vector[2]<0&&(vector[0]=-vector[2],vector[2]=0),vector[3]<0&&(vector[1]=-vector[3],vector[3]=0)}var dots=R._parseDots(gradient);if(!dots)return null;if(id=id.replace(/[\(\)\s,\xb0#]/g,"_"),element.gradient&&id!=element.gradient.id&&(SVG.defs.removeChild(element.gradient),delete element.gradient),!element.gradient){el=$(type+"Gradient",{id:id}),element.gradient=el,$(el,"radial"==type?{fx:fx,fy:fy}:{x1:vector[0],y1:vector[1],x2:vector[2],y2:vector[3],gradientTransform:element.matrix.invert()}),SVG.defs.appendChild(el);for(var i=0,ii=dots.length;i<ii;i++)el.appendChild($("stop",{offset:dots[i].offset?dots[i].offset:i?"100%":"0%","stop-color":dots[i].color||"#fff","stop-opacity":isFinite(dots[i].opacity)?dots[i].opacity:1}))}}return $(o,{fill:fillurl(id),opacity:1,"fill-opacity":1}),s.fill=E,s.opacity=1,s.fillOpacity=1,1},fillurl=function(id){if((mode=document.documentMode)&&(9===mode||10===mode))return"url('#"+id+"')";var mode,location=document.location;return"url('"+location.protocol+"//"+location.host+location.pathname+location.search+"#"+id+"')"},updatePosition=function(o){var bbox=o.getBBox(1);$(o.pattern,{patternTransform:o.matrix.invert()+" translate("+bbox.x+","+bbox.y+")"})},addArrow=function(o,value,isEnd){if("path"==o.type){for(var from,to,dx,refX,attr,values=Str(value).toLowerCase().split("-"),p=o.paper,se=isEnd?"end":"start",node=o.node,attrs=o.attrs,stroke=attrs["stroke-width"],i=values.length,type="classic",w=3,h=3,t=5;i--;)switch(values[i]){case"block":case"classic":case"oval":case"diamond":case"open":case"none":type=values[i];break;case"wide":h=5;break;case"narrow":h=2;break;case"long":w=5;break;case"short":w=2}if("open"==type?(w+=2,h+=2,t+=2,dx=1,refX=isEnd?4:1,attr={fill:"none",stroke:attrs.stroke}):(refX=dx=w/2,attr={fill:attrs.stroke,stroke:"none"}),o._.arrows?isEnd?(o._.arrows.endPath&&markerCounter[o._.arrows.endPath]--,o._.arrows.endMarker&&markerCounter[o._.arrows.endMarker]--):(o._.arrows.startPath&&markerCounter[o._.arrows.startPath]--,o._.arrows.startMarker&&markerCounter[o._.arrows.startMarker]--):o._.arrows={},"none"!=type){var pathId="raphael-marker-"+type,markerId="raphael-marker-"+se+type+w+h+"-obj"+o.id;R._g.doc.getElementById(pathId)?markerCounter[pathId]++:(p.defs.appendChild($($("path"),{"stroke-linecap":"round",d:markers[type],id:pathId})),markerCounter[pathId]=1);var use,marker=R._g.doc.getElementById(markerId);marker?(markerCounter[markerId]++,use=marker.getElementsByTagName("use")[0]):(marker=$($("marker"),{id:markerId,markerHeight:h,markerWidth:w,orient:"auto",refX:refX,refY:h/2}),use=$($("use"),{"xlink:href":"#"+pathId,transform:(isEnd?"rotate(180 "+w/2+" "+h/2+") ":E)+"scale("+w/t+","+h/t+")","stroke-width":(1/((w/t+h/t)/2)).toFixed(4)}),marker.appendChild(use),p.defs.appendChild(marker),markerCounter[markerId]=1),$(use,attr);var delta=dx*("diamond"!=type&&"oval"!=type);isEnd?(from=o._.arrows.startdx*stroke||0,to=R.getTotalLength(attrs.path)-delta*stroke):(from=delta*stroke,to=R.getTotalLength(attrs.path)-(o._.arrows.enddx*stroke||0)),(attr={})["marker-"+se]="url(#"+markerId+")",(to||from)&&(attr.d=R.getSubpath(attrs.path,from,to)),$(node,attr),o._.arrows[se+"Path"]=pathId,o._.arrows[se+"Marker"]=markerId,o._.arrows[se+"dx"]=delta,o._.arrows[se+"Type"]=type,o._.arrows[se+"String"]=value}else isEnd?(from=o._.arrows.startdx*stroke||0,to=R.getTotalLength(attrs.path)-from):(from=0,to=R.getTotalLength(attrs.path)-(o._.arrows.enddx*stroke||0)),o._.arrows[se+"Path"]&&$(node,{d:R.getSubpath(attrs.path,from,to)}),delete o._.arrows[se+"Path"],delete o._.arrows[se+"Marker"],delete o._.arrows[se+"dx"],delete o._.arrows[se+"Type"],delete o._.arrows[se+"String"];for(attr in markerCounter)if(markerCounter[has](attr)&&!markerCounter[attr]){var item=R._g.doc.getElementById(attr);item&&item.parentNode.removeChild(item)}}},dasharray={"-":[3,1],".":[1,1],"-.":[3,1,1,1],"-..":[3,1,1,1,1,1],". ":[1,3],"- ":[4,3],"--":[8,3],"- .":[4,3,1,3],"--.":[8,3,1,3],"--..":[8,3,1,3,1,3]},addDashes=function(o,value,params){if(value=Str(value).replace(/\s+/,""),value=dasharray[value]||R.svg&&!/[^\d,]/.test(value)&&value.split(/,/)){for(var width=o.attrs["stroke-width"]||"1",butt={round:width,square:width,butt:0}[o.attrs["stroke-linecap"]||params["stroke-linecap"]]||0,dashes=[],i=value.length;i--;)dashes[i]=value[i]*width+(i%2?1:-1)*butt;$(o.node,{"stroke-dasharray":dashes.join(",")})}else $(o.node,{"stroke-dasharray":"none"})},setFillAndStroke=function(o,params){var node=o.node,attrs=o.attrs,vis=node.style.visibility;for(var att in node.style.visibility="hidden",params)if(params[has](att)){if(!R._availableAttrs[has](att))continue;var value=params[att];switch(attrs[att]=value,att){case"blur":o.blur(value);break;case"title":var title=node.getElementsByTagName("title");if(title.length&&(title=title[0]))title.firstChild.nodeValue=value;else{title=$("title");var val=R._g.doc.createTextNode(value);title.appendChild(val),node.appendChild(title)}break;case"href":case"target":var pn=node.parentNode;if("a"!=pn.tagName.toLowerCase()){var hl=$("a");pn.insertBefore(hl,node),hl.appendChild(node),pn=hl}"target"==att?pn.setAttributeNS(xlink,"show","blank"==value?"new":value):pn.setAttributeNS(xlink,att,value);break;case"cursor":node.style.cursor=value;break;case"transform":o.transform(value);break;case"arrow-start":addArrow(o,value);break;case"arrow-end":addArrow(o,value,1);break;case"clip-rect":var rect=Str(value).split(separator);if(4==rect.length){o.clip&&o.clip.parentNode.parentNode.removeChild(o.clip.parentNode);var el=$("clipPath"),rc=$("rect");el.id=R.createUUID(),$(rc,{x:rect[0],y:rect[1],width:rect[2],height:rect[3]}),el.appendChild(rc),o.paper.defs.appendChild(el),$(node,{"clip-path":"url(#"+el.id+")"}),o.clip=rc}if(!value){var path=node.getAttribute("clip-path");if(path){var clip=R._g.doc.getElementById(path.replace(/(^url\(#|\)$)/g,E));clip&&clip.parentNode.removeChild(clip),$(node,{"clip-path":E}),delete o.clip}}break;case"path":"path"==o.type&&($(node,{d:value?attrs.path=R._pathToAbsolute(value):"M0,0"}),o._.dirty=1,o._.arrows&&("startString"in o._.arrows&&addArrow(o,o._.arrows.startString),"endString"in o._.arrows&&addArrow(o,o._.arrows.endString,1)));break;case"width":if(node.setAttribute(att,value),o._.dirty=1,!attrs.fx)break;att="x",value=attrs.x;case"x":attrs.fx&&(value=-attrs.x-(attrs.width||0));case"rx":if("rx"==att&&"rect"==o.type)break;case"cx":node.setAttribute(att,value),o.pattern&&updatePosition(o),o._.dirty=1;break;case"height":if(node.setAttribute(att,value),o._.dirty=1,!attrs.fy)break;att="y",value=attrs.y;case"y":attrs.fy&&(value=-attrs.y-(attrs.height||0));case"ry":if("ry"==att&&"rect"==o.type)break;case"cy":node.setAttribute(att,value),o.pattern&&updatePosition(o),o._.dirty=1;break;case"r":"rect"==o.type?$(node,{rx:value,ry:value}):node.setAttribute(att,value),o._.dirty=1;break;case"src":"image"==o.type&&node.setAttributeNS(xlink,"href",value);break;case"stroke-width":1==o._.sx&&1==o._.sy||(value/=mmax(abs(o._.sx),abs(o._.sy))||1),node.setAttribute(att,value),attrs["stroke-dasharray"]&&addDashes(o,attrs["stroke-dasharray"],params),o._.arrows&&("startString"in o._.arrows&&addArrow(o,o._.arrows.startString),"endString"in o._.arrows&&addArrow(o,o._.arrows.endString,1));break;case"stroke-dasharray":addDashes(o,value,params);break;case"stroke-dashoffset":R.svg&&node.setAttribute(att,value);break;case"fill":var isURL=Str(value).match(R._ISURL);if(isURL){el=$("pattern");var ig=$("image");el.id=R.createUUID(),$(el,{x:0,y:0,patternUnits:"userSpaceOnUse",height:1,width:1}),$(ig,{x:0,y:0,"xlink:href":isURL[1]}),el.appendChild(ig),function(el){R._preload(isURL[1],(function(){var w=this.offsetWidth,h=this.offsetHeight;$(el,{width:w,height:h}),$(ig,{width:w,height:h})}))}(el),o.paper.defs.appendChild(el),$(node,{fill:"url(#"+el.id+")"}),o.pattern=el,o.pattern&&updatePosition(o);break}var clr=R.getRGB(value);if(clr.error){if(("circle"==o.type||"ellipse"==o.type||"r"!=Str(value).charAt())&&addGradientFill(o,value)){if("opacity"in attrs||"fill-opacity"in attrs){var gradient=R._g.doc.getElementById(node.getAttribute("fill").replace(/^url\(#|\)$/g,E));if(gradient){var stops=gradient.getElementsByTagName("stop");$(stops[stops.length-1],{"stop-opacity":("opacity"in attrs?attrs.opacity:1)*("fill-opacity"in attrs?attrs["fill-opacity"]:1)})}}attrs.gradient=value,attrs.fill="none";break}}else delete params.gradient,delete attrs.gradient,!R.is(attrs.opacity,"undefined")&&R.is(params.opacity,"undefined")&&$(node,{opacity:attrs.opacity}),!R.is(attrs["fill-opacity"],"undefined")&&R.is(params["fill-opacity"],"undefined")&&$(node,{"fill-opacity":attrs["fill-opacity"]});clr[has]("opacity")&&$(node,{"fill-opacity":clr.opacity>1?clr.opacity/100:clr.opacity});case"stroke":clr=R.getRGB(value),node.setAttribute(att,clr.hex),"stroke"==att&&clr[has]("opacity")&&$(node,{"stroke-opacity":clr.opacity>1?clr.opacity/100:clr.opacity}),"stroke"==att&&o._.arrows&&("startString"in o._.arrows&&addArrow(o,o._.arrows.startString),"endString"in o._.arrows&&addArrow(o,o._.arrows.endString,1));break;case"gradient":("circle"==o.type||"ellipse"==o.type||"r"!=Str(value).charAt())&&addGradientFill(o,value);break;case"opacity":attrs.gradient&&!attrs[has]("stroke-opacity")&&$(node,{"stroke-opacity":value>1?value/100:value});case"fill-opacity":if(attrs.gradient){(gradient=R._g.doc.getElementById(node.getAttribute("fill").replace(/^url\(#|\)$/g,E)))&&(stops=gradient.getElementsByTagName("stop"),$(stops[stops.length-1],{"stop-opacity":value}));break}default:"font-size"==att&&(value=toInt(value,10)+"px");var cssrule=att.replace(/(\-.)/g,(function(w){return w.substring(1).toUpperCase()}));node.style[cssrule]=value,o._.dirty=1,node.setAttribute(att,value)}}tuneText(o,params),node.style.visibility=vis},tuneText=function(el,params){if("text"==el.type&&(params[has]("text")||params[has]("font")||params[has]("font-size")||params[has]("x")||params[has]("y"))){var a=el.attrs,node=el.node,fontSize=node.firstChild?toInt(R._g.doc.defaultView.getComputedStyle(node.firstChild,E).getPropertyValue("font-size"),10):10;if(params[has]("text")){for(a.text=params.text;node.firstChild;)node.removeChild(node.firstChild);for(var tspan,texts=Str(params.text).split("\n"),tspans=[],i=0,ii=texts.length;i<ii;i++)tspan=$("tspan"),i&&$(tspan,{dy:1.2*fontSize,x:a.x}),tspan.appendChild(R._g.doc.createTextNode(texts[i])),node.appendChild(tspan),tspans[i]=tspan}else for(i=0,ii=(tspans=node.getElementsByTagName("tspan")).length;i<ii;i++)i?$(tspans[i],{dy:1.2*fontSize,x:a.x}):$(tspans[0],{dy:0});$(node,{x:a.x,y:a.y}),el._.dirty=1;var bb=el._getBBox(),dif=a.y-(bb.y+bb.height/2);dif&&R.is(dif,"finite")&&$(tspans[0],{dy:dif})}},getRealNode=function(node){return node.parentNode&&"a"===node.parentNode.tagName.toLowerCase()?node.parentNode:node},Element=function(node,svg){this[0]=this.node=node,node.raphael=!0,this.id=("0000"+(Math.random()*Math.pow(36,5)<<0).toString(36)).slice(-5),node.raphaelid=this.id,this.matrix=R.matrix(),this.realPath=null,this.paper=svg,this.attrs=this.attrs||{},this._={transform:[],sx:1,sy:1,deg:0,dx:0,dy:0,dirty:1},!svg.bottom&&(svg.bottom=this),this.prev=svg.top,svg.top&&(svg.top.next=this),svg.top=this,this.next=null},elproto=R.el;Element.prototype=elproto,elproto.constructor=Element,R._engine.path=function(pathString,SVG){var el=$("path");SVG.canvas&&SVG.canvas.appendChild(el);var p=new Element(el,SVG);return p.type="path",setFillAndStroke(p,{fill:"none",stroke:"#000",path:pathString}),p},elproto.rotate=function(deg,cx,cy){if(this.removed)return this;if((deg=Str(deg).split(separator)).length-1&&(cx=toFloat(deg[1]),cy=toFloat(deg[2])),deg=toFloat(deg[0]),null==cy&&(cx=cy),null==cx||null==cy){var bbox=this.getBBox(1);cx=bbox.x+bbox.width/2,cy=bbox.y+bbox.height/2}return this.transform(this._.transform.concat([["r",deg,cx,cy]])),this},elproto.scale=function(sx,sy,cx,cy){if(this.removed)return this;if((sx=Str(sx).split(separator)).length-1&&(sy=toFloat(sx[1]),cx=toFloat(sx[2]),cy=toFloat(sx[3])),sx=toFloat(sx[0]),null==sy&&(sy=sx),null==cy&&(cx=cy),null==cx||null==cy)var bbox=this.getBBox(1);return cx=null==cx?bbox.x+bbox.width/2:cx,cy=null==cy?bbox.y+bbox.height/2:cy,this.transform(this._.transform.concat([["s",sx,sy,cx,cy]])),this},elproto.translate=function(dx,dy){return this.removed||((dx=Str(dx).split(separator)).length-1&&(dy=toFloat(dx[1])),dx=toFloat(dx[0])||0,dy=+dy||0,this.transform(this._.transform.concat([["t",dx,dy]]))),this},elproto.transform=function(tstr){var _=this._;if(null==tstr)return _.transform;if(R._extractTransform(this,tstr),this.clip&&$(this.clip,{transform:this.matrix.invert()}),this.pattern&&updatePosition(this),this.node&&$(this.node,{transform:this.matrix}),1!=_.sx||1!=_.sy){var sw=this.attrs[has]("stroke-width")?this.attrs["stroke-width"]:1;this.attr({"stroke-width":sw})}return this},elproto.hide=function(){return this.removed||(this.node.style.display="none"),this},elproto.show=function(){return this.removed||(this.node.style.display=""),this},elproto.remove=function(){var node=getRealNode(this.node);if(!this.removed&&node.parentNode){var paper=this.paper;for(var i in paper.__set__&&paper.__set__.exclude(this),eve.unbind("raphael.*.*."+this.id),this.gradient&&paper.defs.removeChild(this.gradient),R._tear(this,paper),node.parentNode.removeChild(node),this.removeData(),this)this[i]="function"==typeof this[i]?R._removedFactory(i):null;this.removed=!0}},elproto._getBBox=function(){if("none"==this.node.style.display){this.show();var hide=!0}var containerStyle,canvasHidden=!1;this.paper.canvas.parentElement?containerStyle=this.paper.canvas.parentElement.style:this.paper.canvas.parentNode&&(containerStyle=this.paper.canvas.parentNode.style),containerStyle&&"none"==containerStyle.display&&(canvasHidden=!0,containerStyle.display="");var bbox={};try{bbox=this.node.getBBox()}catch(e){bbox={x:this.node.clientLeft,y:this.node.clientTop,width:this.node.clientWidth,height:this.node.clientHeight}}finally{bbox=bbox||{},canvasHidden&&(containerStyle.display="none")}return hide&&this.hide(),bbox},elproto.attr=function(name,value){if(this.removed)return this;if(null==name){var res={};for(var a in this.attrs)this.attrs[has](a)&&(res[a]=this.attrs[a]);return res.gradient&&"none"==res.fill&&(res.fill=res.gradient)&&delete res.gradient,res.transform=this._.transform,res}if(null==value&&R.is(name,"string")){if("fill"==name&&"none"==this.attrs.fill&&this.attrs.gradient)return this.attrs.gradient;if("transform"==name)return this._.transform;for(var names=name.split(separator),out={},i=0,ii=names.length;i<ii;i++)(name=names[i])in this.attrs?out[name]=this.attrs[name]:R.is(this.paper.customAttributes[name],"function")?out[name]=this.paper.customAttributes[name].def:out[name]=R._availableAttrs[name];return ii-1?out:out[names[0]]}if(null==value&&R.is(name,"array")){for(out={},i=0,ii=name.length;i<ii;i++)out[name[i]]=this.attr(name[i]);return out}if(null!=value){var params={};params[name]=value}else null!=name&&R.is(name,"object")&&(params=name);for(var key in params)eve("raphael.attr."+key+"."+this.id,this,params[key]);for(key in this.paper.customAttributes)if(this.paper.customAttributes[has](key)&&params[has](key)&&R.is(this.paper.customAttributes[key],"function")){var par=this.paper.customAttributes[key].apply(this,[].concat(params[key]));for(var subkey in this.attrs[key]=params[key],par)par[has](subkey)&&(params[subkey]=par[subkey])}return setFillAndStroke(this,params),this},elproto.toFront=function(){if(this.removed)return this;var node=getRealNode(this.node);node.parentNode.appendChild(node);var svg=this.paper;return svg.top!=this&&R._tofront(this,svg),this},elproto.toBack=function(){if(this.removed)return this;var node=getRealNode(this.node),parentNode=node.parentNode;return parentNode.insertBefore(node,parentNode.firstChild),R._toback(this,this.paper),this.paper,this},elproto.insertAfter=function(element){if(this.removed||!element)return this;var node=getRealNode(this.node),afterNode=getRealNode(element.node||element[element.length-1].node);return afterNode.nextSibling?afterNode.parentNode.insertBefore(node,afterNode.nextSibling):afterNode.parentNode.appendChild(node),R._insertafter(this,element,this.paper),this},elproto.insertBefore=function(element){if(this.removed||!element)return this;var node=getRealNode(this.node),beforeNode=getRealNode(element.node||element[0].node);return beforeNode.parentNode.insertBefore(node,beforeNode),R._insertbefore(this,element,this.paper),this},elproto.blur=function(size){var t=this;if(0!=+size){var fltr=$("filter"),blur=$("feGaussianBlur");t.attrs.blur=size,fltr.id=R.createUUID(),$(blur,{stdDeviation:+size||1.5}),fltr.appendChild(blur),t.paper.defs.appendChild(fltr),t._blur=fltr,$(t.node,{filter:"url(#"+fltr.id+")"})}else t._blur&&(t._blur.parentNode.removeChild(t._blur),delete t._blur,delete t.attrs.blur),t.node.removeAttribute("filter");return t},R._engine.circle=function(svg,x,y,r){var el=$("circle");svg.canvas&&svg.canvas.appendChild(el);var res=new Element(el,svg);return res.attrs={cx:x,cy:y,r:r,fill:"none",stroke:"#000"},res.type="circle",$(el,res.attrs),res},R._engine.rect=function(svg,x,y,w,h,r){var el=$("rect");svg.canvas&&svg.canvas.appendChild(el);var res=new Element(el,svg);return res.attrs={x:x,y:y,width:w,height:h,rx:r||0,ry:r||0,fill:"none",stroke:"#000"},res.type="rect",$(el,res.attrs),res},R._engine.ellipse=function(svg,x,y,rx,ry){var el=$("ellipse");svg.canvas&&svg.canvas.appendChild(el);var res=new Element(el,svg);return res.attrs={cx:x,cy:y,rx:rx,ry:ry,fill:"none",stroke:"#000"},res.type="ellipse",$(el,res.attrs),res},R._engine.image=function(svg,src,x,y,w,h){var el=$("image");$(el,{x:x,y:y,width:w,height:h,preserveAspectRatio:"none"}),el.setAttributeNS(xlink,"href",src),svg.canvas&&svg.canvas.appendChild(el);var res=new Element(el,svg);return res.attrs={x:x,y:y,width:w,height:h,src:src},res.type="image",res},R._engine.text=function(svg,x,y,text){var el=$("text");svg.canvas&&svg.canvas.appendChild(el);var res=new Element(el,svg);return res.attrs={x:x,y:y,"text-anchor":"middle",text:text,"font-family":R._availableAttrs["font-family"],"font-size":R._availableAttrs["font-size"],stroke:"none",fill:"#000"},res.type="text",setFillAndStroke(res,res.attrs),res},R._engine.setSize=function(width,height){return this.width=width||this.width,this.height=height||this.height,this.canvas.setAttribute("width",this.width),this.canvas.setAttribute("height",this.height),this._viewBox&&this.setViewBox.apply(this,this._viewBox),this},R._engine.create=function(){var con=R._getContainer.apply(0,arguments),container=con&&con.container,x=con.x,y=con.y,width=con.width,height=con.height;if(!container)throw new Error("SVG container not found.");var isFloating,cnvs=$("svg"),css="overflow:hidden;";return x=x||0,y=y||0,$(cnvs,{height:height=height||342,version:1.1,width:width=width||512,xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink"}),1==container?(cnvs.style.cssText=css+"position:absolute;left:"+x+"px;top:"+y+"px",R._g.doc.body.appendChild(cnvs),isFloating=1):(cnvs.style.cssText=css+"position:relative",container.firstChild?container.insertBefore(cnvs,container.firstChild):container.appendChild(cnvs)),(container=new R._Paper).width=width,container.height=height,container.canvas=cnvs,container.clear(),container._left=container._top=0,isFloating&&(container.renderfix=function(){}),container.renderfix(),container},R._engine.setViewBox=function(x,y,w,h,fit){eve("raphael.setViewBox",this,this._viewBox,[x,y,w,h,fit]);var vb,sw,paperSize=this.getSize(),size=mmax(w/paperSize.width,h/paperSize.height),top=this.top,aspectRatio=fit?"xMidYMid meet":"xMinYMin";for(null==x?(this._vbSize&&(size=1),delete this._vbSize,vb="0 0 "+this.width+S+this.height):(this._vbSize=size,vb=x+S+y+S+w+S+h),$(this.canvas,{viewBox:vb,preserveAspectRatio:aspectRatio});size&&top;)sw="stroke-width"in top.attrs?top.attrs["stroke-width"]:1,top.attr({"stroke-width":sw}),top._.dirty=1,top._.dirtyT=1,top=top.prev;return this._viewBox=[x,y,w,h,!!fit],this},R.prototype.renderfix=function(){var pos,cnvs=this.canvas,s=cnvs.style;try{pos=cnvs.getScreenCTM()||cnvs.createSVGMatrix()}catch(e){pos=cnvs.createSVGMatrix()}var left=-pos.e%1,top=-pos.f%1;(left||top)&&(left&&(this._left=(this._left+left)%1,s.left=this._left+"px"),top&&(this._top=(this._top+top)%1,s.top=this._top+"px"))},R.prototype.clear=function(){R.eve("raphael.clear",this);for(var c=this.canvas;c.firstChild;)c.removeChild(c.firstChild);this.bottom=this.top=null,(this.desc=$("desc")).appendChild(R._g.doc.createTextNode("Created with Raphaël "+R.version)),c.appendChild(this.desc),c.appendChild(this.defs=$("defs"))},R.prototype.remove=function(){for(var i in eve("raphael.remove",this),this.canvas.parentNode&&this.canvas.parentNode.removeChild(this.canvas),this)this[i]="function"==typeof this[i]?R._removedFactory(i):null};var setproto=R.st;for(var method in elproto)elproto[has](method)&&!setproto[has](method)&&(setproto[method]=function(methodname){return function(){var arg=arguments;return this.forEach((function(el){el[methodname].apply(el,arg)}))}}(method))}}.apply(exports,__WEBPACK_AMD_DEFINE_ARRAY__))===undefined||(module.exports=__WEBPACK_AMD_DEFINE_RESULT__)},function(module,exports,__webpack_require__){var __WEBPACK_AMD_DEFINE_ARRAY__,__WEBPACK_AMD_DEFINE_RESULT__;__WEBPACK_AMD_DEFINE_ARRAY__=[__webpack_require__(1)],(__WEBPACK_AMD_DEFINE_RESULT__=function(R){if(!R||R.vml){var has="hasOwnProperty",Str=String,toFloat=parseFloat,math=Math,round=math.round,mmax=math.max,mmin=math.min,abs=math.abs,separator=/[, ]+/,eve=R.eve,S=" ",E="",map={M:"m",L:"l",C:"c",Z:"x",m:"t",l:"r",c:"v",z:"x"},bites=/([clmz]),?([^clmz]*)/gi,blurregexp=/ progid:\S+Blur\([^\)]+\)/g,val=/-?[^,\s-]+/g,cssDot="position:absolute;left:0;top:0;width:1px;height:1px;behavior:url(#default#VML)",zoom=21600,pathTypes={path:1,rect:1,image:1},ovalTypes={circle:1,ellipse:1},compensation=function(deg,dx,dy){var m=R.matrix();return m.rotate(-deg,.5,.5),{dx:m.x(dx,dy),dy:m.y(dx,dy)}},setCoords=function(p,sx,sy,dx,dy,deg){var _=p._,m=p.matrix,fillpos=_.fillpos,o=p.node,s=o.style,y=1,flip="",kx=zoom/sx,ky=zoom/sy;if(s.visibility="hidden",sx&&sy){if(o.coordsize=abs(kx)+S+abs(ky),s.rotation=deg*(sx*sy<0?-1:1),deg){var c=compensation(deg,dx,dy);dx=c.dx,dy=c.dy}if(sx<0&&(flip+="x"),sy<0&&(flip+=" y")&&(y=-1),s.flip=flip,o.coordorigin=dx*-kx+S+dy*-ky,fillpos||_.fillsize){var fill=o.getElementsByTagName("fill");fill=fill&&fill[0],o.removeChild(fill),fillpos&&(c=compensation(deg,m.x(fillpos[0],fillpos[1]),m.y(fillpos[0],fillpos[1])),fill.position=c.dx*y+S+c.dy*y),_.fillsize&&(fill.size=_.fillsize[0]*abs(sx)+S+_.fillsize[1]*abs(sy)),o.appendChild(fill)}s.visibility="visible"}};R.toString=function(){return"Your browser doesn’t support SVG. Falling down to VML.\nYou are running Raphaël "+this.version};var createNode,addArrow=function(o,value,isEnd){for(var values=Str(value).toLowerCase().split("-"),se=isEnd?"end":"start",i=values.length,type="classic",w="medium",h="medium";i--;)switch(values[i]){case"block":case"classic":case"oval":case"diamond":case"open":case"none":type=values[i];break;case"wide":case"narrow":h=values[i];break;case"long":case"short":w=values[i]}var stroke=o.node.getElementsByTagName("stroke")[0];stroke[se+"arrow"]=type,stroke[se+"arrowlength"]=w,stroke[se+"arrowwidth"]=h},setFillAndStroke=function(o,params){o.attrs=o.attrs||{};var node=o.node,a=o.attrs,s=node.style,newpath=pathTypes[o.type]&&(params.x!=a.x||params.y!=a.y||params.width!=a.width||params.height!=a.height||params.cx!=a.cx||params.cy!=a.cy||params.rx!=a.rx||params.ry!=a.ry||params.r!=a.r),isOval=ovalTypes[o.type]&&(a.cx!=params.cx||a.cy!=params.cy||a.r!=params.r||a.rx!=params.rx||a.ry!=params.ry),res=o;for(var par in params)params[has](par)&&(a[par]=params[par]);if(newpath&&(a.path=R._getPath[o.type](o),o._.dirty=1),params.href&&(node.href=params.href),params.title&&(node.title=params.title),params.target&&(node.target=params.target),params.cursor&&(s.cursor=params.cursor),"blur"in params&&o.blur(params.blur),(params.path&&"path"==o.type||newpath)&&(node.path=function(path){var total=/[ahqstv]/gi,command=R._pathToAbsolute;if(Str(path).match(total)&&(command=R._path2curve),total=/[clmz]/g,command==R._pathToAbsolute&&!Str(path).match(total)){var res=Str(path).replace(bites,(function(all,command,args){var vals=[],isMove="m"==command.toLowerCase(),res=map[command];return args.replace(val,(function(value){isMove&&2==vals.length&&(res+=vals+map["m"==command?"l":"L"],vals=[]),vals.push(round(value*zoom))})),res+vals}));return res}var p,r,pa=command(path);res=[];for(var i=0,ii=pa.length;i<ii;i++){p=pa[i],"z"==(r=pa[i][0].toLowerCase())&&(r="x");for(var j=1,jj=p.length;j<jj;j++)r+=round(p[j]*zoom)+(j!=jj-1?",":E);res.push(r)}return res.join(S)}(~Str(a.path).toLowerCase().indexOf("r")?R._pathToAbsolute(a.path):a.path),o._.dirty=1,"image"==o.type&&(o._.fillpos=[a.x,a.y],o._.fillsize=[a.width,a.height],setCoords(o,1,1,0,0,0))),"transform"in params&&o.transform(params.transform),isOval){var cx=+a.cx,cy=+a.cy,rx=+a.rx||+a.r||0,ry=+a.ry||+a.r||0;node.path=R.format("ar{0},{1},{2},{3},{4},{1},{4},{1}x",round((cx-rx)*zoom),round((cy-ry)*zoom),round((cx+rx)*zoom),round((cy+ry)*zoom),round(cx*zoom)),o._.dirty=1}if("clip-rect"in params){var rect=Str(params["clip-rect"]).split(separator);if(4==rect.length){rect[2]=+rect[2]+ +rect[0],rect[3]=+rect[3]+ +rect[1];var div=node.clipRect||R._g.doc.createElement("div"),dstyle=div.style;dstyle.clip=R.format("rect({1}px {2}px {3}px {0}px)",rect),node.clipRect||(dstyle.position="absolute",dstyle.top=0,dstyle.left=0,dstyle.width=o.paper.width+"px",dstyle.height=o.paper.height+"px",node.parentNode.insertBefore(div,node),div.appendChild(node),node.clipRect=div)}params["clip-rect"]||node.clipRect&&(node.clipRect.style.clip="auto")}if(o.textpath){var textpathStyle=o.textpath.style;params.font&&(textpathStyle.font=params.font),params["font-family"]&&(textpathStyle.fontFamily='"'+params["font-family"].split(",")[0].replace(/^['"]+|['"]+$/g,E)+'"'),params["font-size"]&&(textpathStyle.fontSize=params["font-size"]),params["font-weight"]&&(textpathStyle.fontWeight=params["font-weight"]),params["font-style"]&&(textpathStyle.fontStyle=params["font-style"])}if("arrow-start"in params&&addArrow(res,params["arrow-start"]),"arrow-end"in params&&addArrow(res,params["arrow-end"],1),null!=params.opacity||null!=params.fill||null!=params.src||null!=params.stroke||null!=params["stroke-width"]||null!=params["stroke-opacity"]||null!=params["fill-opacity"]||null!=params["stroke-dasharray"]||null!=params["stroke-miterlimit"]||null!=params["stroke-linejoin"]||null!=params["stroke-linecap"]){var fill=node.getElementsByTagName("fill");if(!(fill=fill&&fill[0])&&(fill=createNode("fill")),"image"==o.type&&params.src&&(fill.src=params.src),params.fill&&(fill.on=!0),null!=fill.on&&"none"!=params.fill&&null!==params.fill||(fill.on=!1),fill.on&&params.fill){var isURL=Str(params.fill).match(R._ISURL);if(isURL){fill.parentNode==node&&node.removeChild(fill),fill.rotate=!0,fill.src=isURL[1],fill.type="tile";var bbox=o.getBBox(1);fill.position=bbox.x+S+bbox.y,o._.fillpos=[bbox.x,bbox.y],R._preload(isURL[1],(function(){o._.fillsize=[this.offsetWidth,this.offsetHeight]}))}else fill.color=R.getRGB(params.fill).hex,fill.src=E,fill.type="solid",R.getRGB(params.fill).error&&(res.type in{circle:1,ellipse:1}||"r"!=Str(params.fill).charAt())&&addGradientFill(res,params.fill,fill)&&(a.fill="none",a.gradient=params.fill,fill.rotate=!1)}if("fill-opacity"in params||"opacity"in params){var opacity=((+a["fill-opacity"]+1||2)-1)*((+a.opacity+1||2)-1)*((+R.getRGB(params.fill).o+1||2)-1);opacity=mmin(mmax(opacity,0),1),fill.opacity=opacity,fill.src&&(fill.color="none")}node.appendChild(fill);var stroke=node.getElementsByTagName("stroke")&&node.getElementsByTagName("stroke")[0],newstroke=!1;!stroke&&(newstroke=stroke=createNode("stroke")),(params.stroke&&"none"!=params.stroke||params["stroke-width"]||null!=params["stroke-opacity"]||params["stroke-dasharray"]||params["stroke-miterlimit"]||params["stroke-linejoin"]||params["stroke-linecap"])&&(stroke.on=!0),("none"==params.stroke||null===params.stroke||null==stroke.on||0==params.stroke||0==params["stroke-width"])&&(stroke.on=!1);var strokeColor=R.getRGB(params.stroke);stroke.on&&params.stroke&&(stroke.color=strokeColor.hex),opacity=((+a["stroke-opacity"]+1||2)-1)*((+a.opacity+1||2)-1)*((+strokeColor.o+1||2)-1);var width=.75*(toFloat(params["stroke-width"])||1);if(opacity=mmin(mmax(opacity,0),1),null==params["stroke-width"]&&(width=a["stroke-width"]),params["stroke-width"]&&(stroke.weight=width),width&&width<1&&(opacity*=width)&&(stroke.weight=1),stroke.opacity=opacity,params["stroke-linejoin"]&&(stroke.joinstyle=params["stroke-linejoin"]||"miter"),stroke.miterlimit=params["stroke-miterlimit"]||8,params["stroke-linecap"]&&(stroke.endcap="butt"==params["stroke-linecap"]?"flat":"square"==params["stroke-linecap"]?"square":"round"),"stroke-dasharray"in params){var dasharray={"-":"shortdash",".":"shortdot","-.":"shortdashdot","-..":"shortdashdotdot",". ":"dot","- ":"dash","--":"longdash","- .":"dashdot","--.":"longdashdot","--..":"longdashdotdot"};stroke.dashstyle=dasharray[has](params["stroke-dasharray"])?dasharray[params["stroke-dasharray"]]:E}newstroke&&node.appendChild(stroke)}if("text"==res.type){res.paper.canvas.style.display=E;var span=res.paper.span,fontSize=a.font&&a.font.match(/\d+(?:\.\d*)?(?=px)/);s=span.style,a.font&&(s.font=a.font),a["font-family"]&&(s.fontFamily=a["font-family"]),a["font-weight"]&&(s.fontWeight=a["font-weight"]),a["font-style"]&&(s.fontStyle=a["font-style"]),fontSize=toFloat(a["font-size"]||fontSize&&fontSize[0])||10,s.fontSize=100*fontSize+"px",res.textpath.string&&(span.innerHTML=Str(res.textpath.string).replace(/</g,"&#60;").replace(/&/g,"&#38;").replace(/\n/g,"<br>"));var brect=span.getBoundingClientRect();res.W=a.w=(brect.right-brect.left)/100,res.H=a.h=(brect.bottom-brect.top)/100,res.X=a.x,res.Y=a.y+res.H/2,("x"in params||"y"in params)&&(res.path.v=R.format("m{0},{1}l{2},{1}",round(a.x*zoom),round(a.y*zoom),round(a.x*zoom)+1));for(var dirtyattrs=["x","y","text","font","font-family","font-weight","font-style","font-size"],d=0,dd=dirtyattrs.length;d<dd;d++)if(dirtyattrs[d]in params){res._.dirty=1;break}switch(a["text-anchor"]){case"start":res.textpath.style["v-text-align"]="left",res.bbx=res.W/2;break;case"end":res.textpath.style["v-text-align"]="right",res.bbx=-res.W/2;break;default:res.textpath.style["v-text-align"]="center",res.bbx=0}res.textpath.style["v-text-kern"]=!0}},addGradientFill=function(o,gradient,fill){o.attrs=o.attrs||{},o.attrs;var pow=Math.pow,type="linear",fxfy=".5 .5";if(o.attrs.gradient=gradient,gradient=(gradient=Str(gradient).replace(R._radial_gradient,(function(all,fx,fy){return type="radial",fx&&fy&&(fx=toFloat(fx),fy=toFloat(fy),pow(fx-.5,2)+pow(fy-.5,2)>.25&&(fy=math.sqrt(.25-pow(fx-.5,2))*(2*(fy>.5)-1)+.5),fxfy=fx+S+fy),E}))).split(/\s*\-\s*/),"linear"==type){var angle=gradient.shift();if(angle=-toFloat(angle),isNaN(angle))return null}var dots=R._parseDots(gradient);if(!dots)return null;if(o=o.shape||o.node,dots.length){o.removeChild(fill),fill.on=!0,fill.method="none",fill.color=dots[0].color,fill.color2=dots[dots.length-1].color;for(var clrs=[],i=0,ii=dots.length;i<ii;i++)dots[i].offset&&clrs.push(dots[i].offset+S+dots[i].color);fill.colors=clrs.length?clrs.join():"0% "+fill.color,"radial"==type?(fill.type="gradientTitle",fill.focus="100%",fill.focussize="0 0",fill.focusposition=fxfy,fill.angle=0):(fill.type="gradient",fill.angle=(270-angle)%360),o.appendChild(fill)}return 1},Element=function(node,vml){this[0]=this.node=node,node.raphael=!0,this.id=R._oid++,node.raphaelid=this.id,this.X=0,this.Y=0,this.attrs={},this.paper=vml,this.matrix=R.matrix(),this._={transform:[],sx:1,sy:1,dx:0,dy:0,deg:0,dirty:1,dirtyT:1},!vml.bottom&&(vml.bottom=this),this.prev=vml.top,vml.top&&(vml.top.next=this),vml.top=this,this.next=null},elproto=R.el;Element.prototype=elproto,elproto.constructor=Element,elproto.transform=function(tstr){if(null==tstr)return this._.transform;var oldt,vbs=this.paper._viewBoxShift,vbt=vbs?"s"+[vbs.scale,vbs.scale]+"-1-1t"+[vbs.dx,vbs.dy]:E;vbs&&(oldt=tstr=Str(tstr).replace(/\.{3}|\u2026/g,this._.transform||E)),R._extractTransform(this,vbt+tstr);var split,matrix=this.matrix.clone(),skew=this.skew,o=this.node,isGrad=~Str(this.attrs.fill).indexOf("-"),isPatt=!Str(this.attrs.fill).indexOf("url(");if(matrix.translate(1,1),isPatt||isGrad||"image"==this.type)if(skew.matrix="1 0 0 1",skew.offset="0 0",split=matrix.split(),isGrad&&split.noRotation||!split.isSimple){o.style.filter=matrix.toFilter();var bb=this.getBBox(),bbt=this.getBBox(1),dx=bb.x-bbt.x,dy=bb.y-bbt.y;o.coordorigin=dx*-zoom+S+dy*-zoom,setCoords(this,1,1,dx,dy,0)}else o.style.filter=E,setCoords(this,split.scalex,split.scaley,split.dx,split.dy,split.rotate);else o.style.filter=E,skew.matrix=Str(matrix),skew.offset=matrix.offset();return null!==oldt&&(this._.transform=oldt,R._extractTransform(this,oldt)),this},elproto.rotate=function(deg,cx,cy){if(this.removed)return this;if(null!=deg){if((deg=Str(deg).split(separator)).length-1&&(cx=toFloat(deg[1]),cy=toFloat(deg[2])),deg=toFloat(deg[0]),null==cy&&(cx=cy),null==cx||null==cy){var bbox=this.getBBox(1);cx=bbox.x+bbox.width/2,cy=bbox.y+bbox.height/2}return this._.dirtyT=1,this.transform(this._.transform.concat([["r",deg,cx,cy]])),this}},elproto.translate=function(dx,dy){return this.removed||((dx=Str(dx).split(separator)).length-1&&(dy=toFloat(dx[1])),dx=toFloat(dx[0])||0,dy=+dy||0,this._.bbox&&(this._.bbox.x+=dx,this._.bbox.y+=dy),this.transform(this._.transform.concat([["t",dx,dy]]))),this},elproto.scale=function(sx,sy,cx,cy){if(this.removed)return this;if((sx=Str(sx).split(separator)).length-1&&(sy=toFloat(sx[1]),cx=toFloat(sx[2]),cy=toFloat(sx[3]),isNaN(cx)&&(cx=null),isNaN(cy)&&(cy=null)),sx=toFloat(sx[0]),null==sy&&(sy=sx),null==cy&&(cx=cy),null==cx||null==cy)var bbox=this.getBBox(1);return cx=null==cx?bbox.x+bbox.width/2:cx,cy=null==cy?bbox.y+bbox.height/2:cy,this.transform(this._.transform.concat([["s",sx,sy,cx,cy]])),this._.dirtyT=1,this},elproto.hide=function(){return!this.removed&&(this.node.style.display="none"),this},elproto.show=function(){return!this.removed&&(this.node.style.display=E),this},elproto.auxGetBBox=R.el.getBBox,elproto.getBBox=function(){var b=this.auxGetBBox();if(this.paper&&this.paper._viewBoxShift){var c={},z=1/this.paper._viewBoxShift.scale;return c.x=b.x-this.paper._viewBoxShift.dx,c.x*=z,c.y=b.y-this.paper._viewBoxShift.dy,c.y*=z,c.width=b.width*z,c.height=b.height*z,c.x2=c.x+c.width,c.y2=c.y+c.height,c}return b},elproto._getBBox=function(){return this.removed?{}:{x:this.X+(this.bbx||0)-this.W/2,y:this.Y-this.H,width:this.W,height:this.H}},elproto.remove=function(){if(!this.removed&&this.node.parentNode){for(var i in this.paper.__set__&&this.paper.__set__.exclude(this),R.eve.unbind("raphael.*.*."+this.id),R._tear(this,this.paper),this.node.parentNode.removeChild(this.node),this.shape&&this.shape.parentNode.removeChild(this.shape),this)this[i]="function"==typeof this[i]?R._removedFactory(i):null;this.removed=!0}},elproto.attr=function(name,value){if(this.removed)return this;if(null==name){var res={};for(var a in this.attrs)this.attrs[has](a)&&(res[a]=this.attrs[a]);return res.gradient&&"none"==res.fill&&(res.fill=res.gradient)&&delete res.gradient,res.transform=this._.transform,res}if(null==value&&R.is(name,"string")){if("fill"==name&&"none"==this.attrs.fill&&this.attrs.gradient)return this.attrs.gradient;for(var names=name.split(separator),out={},i=0,ii=names.length;i<ii;i++)(name=names[i])in this.attrs?out[name]=this.attrs[name]:R.is(this.paper.customAttributes[name],"function")?out[name]=this.paper.customAttributes[name].def:out[name]=R._availableAttrs[name];return ii-1?out:out[names[0]]}if(this.attrs&&null==value&&R.is(name,"array")){for(out={},i=0,ii=name.length;i<ii;i++)out[name[i]]=this.attr(name[i]);return out}var params;for(var key in null!=value&&((params={})[name]=value),null==value&&R.is(name,"object")&&(params=name),params)eve("raphael.attr."+key+"."+this.id,this,params[key]);if(params){for(key in this.paper.customAttributes)if(this.paper.customAttributes[has](key)&&params[has](key)&&R.is(this.paper.customAttributes[key],"function")){var par=this.paper.customAttributes[key].apply(this,[].concat(params[key]));for(var subkey in this.attrs[key]=params[key],par)par[has](subkey)&&(params[subkey]=par[subkey])}params.text&&"text"==this.type&&(this.textpath.string=params.text),setFillAndStroke(this,params)}return this},elproto.toFront=function(){return!this.removed&&this.node.parentNode.appendChild(this.node),this.paper&&this.paper.top!=this&&R._tofront(this,this.paper),this},elproto.toBack=function(){return this.removed||this.node.parentNode.firstChild!=this.node&&(this.node.parentNode.insertBefore(this.node,this.node.parentNode.firstChild),R._toback(this,this.paper)),this},elproto.insertAfter=function(element){return this.removed||(element.constructor==R.st.constructor&&(element=element[element.length-1]),element.node.nextSibling?element.node.parentNode.insertBefore(this.node,element.node.nextSibling):element.node.parentNode.appendChild(this.node),R._insertafter(this,element,this.paper)),this},elproto.insertBefore=function(element){return this.removed||(element.constructor==R.st.constructor&&(element=element[0]),element.node.parentNode.insertBefore(this.node,element.node),R._insertbefore(this,element,this.paper)),this},elproto.blur=function(size){var s=this.node.runtimeStyle,f=s.filter;return f=f.replace(blurregexp,E),0!=+size?(this.attrs.blur=size,s.filter=f+S+" progid:DXImageTransform.Microsoft.Blur(pixelradius="+(+size||1.5)+")",s.margin=R.format("-{0}px 0 0 -{0}px",round(+size||1.5))):(s.filter=f,s.margin=0,delete this.attrs.blur),this},R._engine.path=function(pathString,vml){var el=createNode("shape");el.style.cssText=cssDot,el.coordsize=zoom+S+zoom,el.coordorigin=vml.coordorigin;var p=new Element(el,vml),attr={fill:"none",stroke:"#000"};pathString&&(attr.path=pathString),p.type="path",p.path=[],p.Path=E,setFillAndStroke(p,attr),vml.canvas&&vml.canvas.appendChild(el);var skew=createNode("skew");return skew.on=!0,el.appendChild(skew),p.skew=skew,p.transform(E),p},R._engine.rect=function(vml,x,y,w,h,r){var path=R._rectPath(x,y,w,h,r),res=vml.path(path),a=res.attrs;return res.X=a.x=x,res.Y=a.y=y,res.W=a.width=w,res.H=a.height=h,a.r=r,a.path=path,res.type="rect",res},R._engine.ellipse=function(vml,x,y,rx,ry){var res=vml.path();return res.attrs,res.X=x-rx,res.Y=y-ry,res.W=2*rx,res.H=2*ry,res.type="ellipse",setFillAndStroke(res,{cx:x,cy:y,rx:rx,ry:ry}),res},R._engine.circle=function(vml,x,y,r){var res=vml.path();return res.attrs,res.X=x-r,res.Y=y-r,res.W=res.H=2*r,res.type="circle",setFillAndStroke(res,{cx:x,cy:y,r:r}),res},R._engine.image=function(vml,src,x,y,w,h){var path=R._rectPath(x,y,w,h),res=vml.path(path).attr({stroke:"none"}),a=res.attrs,node=res.node,fill=node.getElementsByTagName("fill")[0];return a.src=src,res.X=a.x=x,res.Y=a.y=y,res.W=a.width=w,res.H=a.height=h,a.path=path,res.type="image",fill.parentNode==node&&node.removeChild(fill),fill.rotate=!0,fill.src=src,fill.type="tile",res._.fillpos=[x,y],res._.fillsize=[w,h],node.appendChild(fill),setCoords(res,1,1,0,0,0),res},R._engine.text=function(vml,x,y,text){var el=createNode("shape"),path=createNode("path"),o=createNode("textpath");x=x||0,y=y||0,text=text||"",path.v=R.format("m{0},{1}l{2},{1}",round(x*zoom),round(y*zoom),round(x*zoom)+1),path.textpathok=!0,o.string=Str(text),o.on=!0,el.style.cssText=cssDot,el.coordsize=zoom+S+zoom,el.coordorigin="0 0";var p=new Element(el,vml),attr={fill:"#000",stroke:"none",font:R._availableAttrs.font,text:text};p.shape=el,p.path=path,p.textpath=o,p.type="text",p.attrs.text=Str(text),p.attrs.x=x,p.attrs.y=y,p.attrs.w=1,p.attrs.h=1,setFillAndStroke(p,attr),el.appendChild(o),el.appendChild(path),vml.canvas.appendChild(el);var skew=createNode("skew");return skew.on=!0,el.appendChild(skew),p.skew=skew,p.transform(E),p},R._engine.setSize=function(width,height){var cs=this.canvas.style;return this.width=width,this.height=height,width==+width&&(width+="px"),height==+height&&(height+="px"),cs.width=width,cs.height=height,cs.clip="rect(0 "+width+" "+height+" 0)",this._viewBox&&R._engine.setViewBox.apply(this,this._viewBox),this},R._engine.setViewBox=function(x,y,w,h,fit){R.eve("raphael.setViewBox",this,this._viewBox,[x,y,w,h,fit]);var H,W,paperSize=this.getSize(),width=paperSize.width,height=paperSize.height;return fit&&(w*(H=height/h)<width&&(x-=(width-w*H)/2/H),h*(W=width/w)<height&&(y-=(height-h*W)/2/W)),this._viewBox=[x,y,w,h,!!fit],this._viewBoxShift={dx:-x,dy:-y,scale:paperSize},this.forEach((function(el){el.transform("...")})),this},R._engine.initWin=function(win){var doc=win.document;doc.styleSheets.length<31?doc.createStyleSheet().addRule(".rvml","behavior:url(#default#VML)"):doc.styleSheets[0].addRule(".rvml","behavior:url(#default#VML)");try{!doc.namespaces.rvml&&doc.namespaces.add("rvml","urn:schemas-microsoft-com:vml"),createNode=function(tagName){return doc.createElement("<rvml:"+tagName+' class="rvml">')}}catch(e){createNode=function(tagName){return doc.createElement("<"+tagName+' xmlns="urn:schemas-microsoft.com:vml" class="rvml">')}}},R._engine.initWin(R._g.win),R._engine.create=function(){var con=R._getContainer.apply(0,arguments),container=con.container,height=con.height,width=con.width,x=con.x,y=con.y;if(!container)throw new Error("VML container not found.");var res=new R._Paper,c=res.canvas=R._g.doc.createElement("div"),cs=c.style;return x=x||0,y=y||0,width=width||512,height=height||342,res.width=width,res.height=height,width==+width&&(width+="px"),height==+height&&(height+="px"),res.coordsize="21600000 21600000",res.coordorigin="0 0",res.span=R._g.doc.createElement("span"),res.span.style.cssText="position:absolute;left:-9999em;top:-9999em;padding:0;margin:0;line-height:1;",c.appendChild(res.span),cs.cssText=R.format("top:0;left:0;width:{0};height:{1};display:inline-block;position:relative;clip:rect(0 {0} {1} 0);overflow:hidden",width,height),1==container?(R._g.doc.body.appendChild(c),cs.left=x+"px",cs.top=y+"px",cs.position="absolute"):container.firstChild?container.insertBefore(c,container.firstChild):container.appendChild(c),res.renderfix=function(){},res},R.prototype.clear=function(){R.eve("raphael.clear",this),this.canvas.innerHTML=E,this.span=R._g.doc.createElement("span"),this.span.style.cssText="position:absolute;left:-9999em;top:-9999em;padding:0;margin:0;line-height:1;display:inline;",this.canvas.appendChild(this.span),this.bottom=this.top=null},R.prototype.remove=function(){for(var i in R.eve("raphael.remove",this),this.canvas.parentNode.removeChild(this.canvas),this)this[i]="function"==typeof this[i]?R._removedFactory(i):null;return!0};var setproto=R.st;for(var method in elproto)elproto[has](method)&&!setproto[has](method)&&(setproto[method]=function(methodname){return function(){var arg=arguments;return this.forEach((function(el){el[methodname].apply(el,arg)}))}}(method))}}.apply(exports,__WEBPACK_AMD_DEFINE_ARRAY__))===undefined||(module.exports=__WEBPACK_AMD_DEFINE_RESULT__)}])},"object"==typeof exports&&"object"==typeof module?module.exports=factory():"function"==typeof define&&define.amd?define("Raphael",[],factory):"object"==typeof exports?exports.Raphael=factory():root.Raphael=factory(),xui.Class("xui.svg","xui.UI",{Before:function(key,parent_key,o){return xui.absBox.$type[key.replace("xui.","")]=xui.absBox.$type[key]=key,!0},Initialize:function(){if("function"==typeof Raphael){Raphael._availableAttrs.href="",Raphael._availableAttrs.title="",Raphael.el.shadow=function(){var ns=this;if("text"==ns.type)return null;ns._.dirty=!0;var sw=ns.attr("stroke-width"),f=ns.attr("fill"),o=ns.attr("opacity"),fo=ns.attr("fill-opacity"),tr=ns.attr("transform"),r=ns.paper,out=r.set(),bbox=ns._getBBox(!1),rx=bbox.width?(bbox.width+sw-4-4)/bbox.width:0,ry=bbox.height?(bbox.height+sw-4-4)/bbox.height:0,path=ns.getPath();path="none"!==f&&0!==fo?Raphael.transformPath(path,"t"+sw/2+","+sw/2+"s"+rx+","+ry+","+(bbox.x+bbox.width+sw)+","+(bbox.y+bbox.height+sw)):Raphael.transformPath(path,"t2,2");for(var s,i=1;i<5;i++)(s=r.path(path).attr({stroke:"#666",fill:"none"==f?"none":"#555","fill-opacity":fo,"stroke-linejoin":"round","stroke-linecap":"round","stroke-width":2*i,opacity:(.2*(1-i/4)+.05)*o}))._decoration=1,out.push(s);return tr&&tr.length&&out.transform(tr),out.insertBefore(ns)};var r=function(){for(var a,m=arguments,g=m.length,b=0;b<g;b++)if((a=m[b])||!1===a||0===a)return a},u=function(){for(var a,m=arguments,g=m.length,b=0;b<g;b++)if(((a=m[b])||!1===a||0===a)&&!isNaN(a=Number(a)))return a},t=function(m){return"matrix("+[m.get(0),m.get(1),m.get(2),m.get(3),m.get(4),m.get(5)].join()+")"},h=/^matrix\(|\)$/g,M=/\,/g,e=/\n|<br\s*?\/?>/gi,k=/[^\d\.]/gi,V=/[\(\)\s,\xb0#]/g,ga=/group/gi,w=/&/g,Q=/"/g,K=/'/g,G=/</g,aa=/>/g,A=0,l=Math,D=parseFloat,q=l.max,j=l.abs,s=l.pow,fa=String,ea=/[, ]+/,U=[{reg:/xmlns\=\"http\:\/\/www.w3.org\/2000\/svg\"/gi,str:""},{reg:/^.*<svg /,str:'<svg xmlns:xlink="http://www.w3.org/1999/xlink" xmlns="http://www.w3.org/2000/svg" '},{reg:/\/svg>.*$/,str:"/svg>"},{reg:/\<desc[\s\>][^\<]*\<\/desc\>/,str:""},{reg:/zIndex="[^"]+"/g,str:""},{reg:/url\((\\?[\'\"])[^#]+#/g,str:"url($1#"},{reg:/ href=/g,str:" xlink:href="},{reg:/(id|class|width|height)=([^" >]+)/g,str:'$1="$2"'},{reg:/:(path|rect)/g,str:"$1"},{reg:/\<ima?ge? ([^\>]+?)[^\/]\>/gi,str:"<image $1 />"},{reg:/\<\/ima?ge?\>/g,str:""},{reg:/style="([^"]+)"/g,str:function(e){return e.toLowerCase()}}],W={blur:function(){},transform:function(){},src:function(e,d){d.attrSTR+=' xlink:href="'+d.attrs.src+'"'},path:function(e,d){var h=d.attrs.path;h=Raphael._pathToAbsolute(h||""),d.attrSTR+=' d="'+(h.toString&&h.toString()||"").replace(M," ")+'"'},gradient:function(e,d,h){var a,g,b=e.attrs.gradient,f="linear",c=.5,k=.5,r=g="",u="";if(!h[a=b.replace(V,"_")]){if(b=(b=fa(b).replace(Raphael._radial_gradient,(function(a,b,e){return f="radial",b&&e&&(c=D(b),a=2*((k=D(e))>.5)-1,s(c-.5,2)+s(k-.5,2)>.25&&(k=l.sqrt(.25-s(c-.5,2))*a+.5)&&.5!=k&&(k=k.toFixed(5)-1e-5*a)),""}))).split(/\s*\-\s*/),"linear"===f){if(g=b.shift(),g=-D(g),isNaN(g))return null;var w=[0,0,l.cos(Raphael.rad(g)),l.sin(Raphael.rad(g))];g=1/(q(j(w[2]),j(w[3]))||1),w[2]*=g,w[3]*=g,w[2]<0&&(w[0]=-w[2],w[2]=0),w[3]<0&&(w[1]=-w[3],w[3]=0)}if(!(b=Raphael._parseDots(b)))return null;for("radial"===f?(g='<radialGradient fx = "'+c+'" fy = "'+k+'" id = "'+a+'">',r="</radialGradient>"):(g='<linearGradient x1 = "'+w[0]+'" y1 = "'+w[1]+'" x2 = "'+w[2]+'" y2 = "'+w[3]+'" gradientTransform ="matrix('+e.matrix.invert()+')" id = "'+a+'">',r="</linearGradient>"),e=0,w=b.length;e<w;e++)u+='<stop offset="'+(b[e].offset?b[e].offset:e?"100%":"0%")+'" stop-color="'+(b[e].color||"#fff")+'" stop-opacity="'+(void 0===b[e].opacity?1:b[e].opacity)+'" />';h[a]=!0,h.str+=g+u+r}d.attrSTR+=" fill=\"url('#"+a+"')\""},fill:function(e,d){var f,h=d.attrs,b=h.fill;e.attrs.gradient||(f=(b=Raphael.color(b)).opacity,"text"===e.type?d.styleSTR+="fill:"+b+"; stroke-opacity:0; ":(d.attrSTR+=' fill="'+b+'"',h["fill-opacity"]||!f&&0!==f||(d.attrSTR+=' fill-opacity="'+f+'"')))},stroke:function(e,d){var b,f,h=d.attrs;f=(b=Raphael.color(h.stroke)).opacity,"text"===e.type||(d.attrSTR+=' stroke="'+b+'"',h["stroke-opacity"]||!f&&0!==f)||(d.attrSTR+=' stroke-opacity="'+f+'"')},"clip-rect":function(e,d,i){var f=(b=fa(d.attrs["clip-rect"])).split(ea),b=b.replace(V,"_")+"__"+A++;4===f.length&&(i[b]||(i[b]=!0,i.str+='<clipPath id="'+b+'"><rect x="'+f[0]+'" y="'+f[1]+'" width="'+f[2]+'" height="'+f[3]+'" transform="matrix('+t(e.matrix.invert()).replace(h,"")+')"/></clipPath>'),d.attrSTR+=' clip-path="url(#'+b+')"')},cursor:function(e,d){var h=d.attrs.cursor;h&&(d.styleSTR+="cursor:"+h+"; ")},font:function(e,d){d.styleSTR+="font:"+d.attrs.font.replace(/\"/gi," ")+"; "},"font-size":function(e,d){var h=r(d.attrs["font-size"],"10");h&&h.replace&&(h=h.replace(k,"")),d.styleSTR+="font-size:"+h+"px; "},"font-weight":function(e,d){d.styleSTR+="font-weight:"+d.attrs["font-weight"]+"; "},"font-family":function(e,d){d.styleSTR+="font-family:"+d.attrs["font-family"]+"; "},"line-height":function(){},"clip-path":function(){},visibility:function(){},"vertical-align":function(){},"text-anchor":function(e,d){var h=d.attrs["text-anchor"]||"middle";"text"===e.type&&(d.attrSTR+=' text-anchor="'+h+'"')},title:function(){},text:function(d,h){var g,b=(i=h.attrs).text,f=r(i["font-size"],i.font,"10"),a=r(i["line-height"]);f&&f.replace&&(f=f.replace(k,"")),f=u(f),a&&a.replace&&(a=a.replace(k,"")),a=u(a,f&&1.2*f),g=f?.85*f:.75*a,f=i.x;var c=r(i["vertical-align"],"middle").toLowerCase(),i=(b=fa(b).split(e)).length,l=0;for(c="top"===c?g:"bottom"===c?g-a*i:g-a*i*.5;l<i;l++)h.textSTR+="<tspan ",g=(b[l]||"").replace(w,"&amp;").replace(Q,"&quot;").replace(K,"&#39;").replace(G,"&lt;").replace(aa,"&gt;"),h.textSTR+=l?'dy="'+a+'" x="'+f+'" ':'dy="'+c+'"',h.textSTR+=">"+g+"</tspan>"}},X=function(e,i){var c,l,k="",b={attrSTR:"",styleSTR:"",textSTR:"",attrs:e.attr()},f="",a="",g="",j=b.attrs;if("none"!==e.node.style.display){for(c in j)"gradient"===c||void 0===Raphael._availableAttrs[c]&&!W[c]||(W[c]?W[c](e,b,i):b.attrSTR+=" "+c+'="'+j[c]+'"');for(l in e.attrs.gradient&&W.gradient(e,b,i),"rect"===e.type&&j.r&&(b.attrSTR+=' rx="'+j.r+'" ry="'+j.r+'"'),e.styles)b.styleSTR+=l+":"+e.styles[l]+"; ";"image"===e.type&&(b.attrSTR+=' preserveAspectRatio="none"'),e.bottom&&(a=X(e.bottom,i)),e.next&&(g=X(e.next,i)),(f=e.type).match(ga)&&(f="g"),k+="<"+f+' transform="matrix('+t(e.matrix).replace(h,"")+')" style="'+b.styleSTR+'"'+b.attrSTR+">"+b.textSTR+a+"</"+f+">"+g}else e.next&&(k+=X(e.next,i));return k};Raphael.fn.toSVG=function(includeImage){var d="",h={str:""},b=0,f=U.length,a="";if(Raphael.svg){if(this.canvas&&this.canvas.parentNode)for(d=this.canvas.parentNode.innerHTML;b<f;b+=1)h=U[b],d=d.replace(h.reg,h.str)}else d='<svg style="overflow: hidden; position: relative;" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="'+this.width+'" version="1.1" height="'+this.height+'">',this.bottom&&(a=X(this.bottom,h),d+="<defs>"+h.str+"</defs>"+a+"</svg>");return includeImage||(d=d.replace(/\<image [^\>]*\>/gi,"")),d}}var attr={"arrow-start":1,"arrow-end":1,"clip-rect":1,fill:1,"fill-opacity":1,title:1,cursor:1,transform:1,opacity:1,stroke:1,"stroke-dasharray":1,"stroke-linecap":1,"stroke-linejoin":1,"stroke-miterlimit":1,"stroke-opacity":1,"stroke-dashoffset":1,"stroke-width":1};this.$attr={circle:{cx:1,cy:1,r:1},ellipse:{cx:1,cy:1,rx:1,ry:1},rect:{x:1,y:1,r:1,width:1,height:1},text:{x:1,y:1,text:1,font:1,"font-family":1,"font-style":1,"font-size":1,"font-weight":1,"text-anchor":1,"letter-spacing":1},image:{src:1,x:1,y:1,width:1,height:1},path:{path:1}},xui.each(this.$attr,(function(o){xui.merge(o,attr)}));var o=this.$attr.text;delete o["arrow-start"],delete o["arrow-end"],delete o["stroke-dasharray"],delete o["stroke-linecap"],delete o["stroke-linejoin"],delete o["stroke-miterlimit"],delete o["stroke-opacity"],delete o["stroke-dashoffset"],delete o["stroke-width"],delete this.prototype.toHtml},Instance:{initialize:function(){if("function"!=typeof Raphael)throw new Error("Browser doesn't suppor SVG or VML, all diagram functions were disabled!")},getAttr:function(key){var prf=this.get(0);if(prf){var node,prop=prf.properties,dftAttr=Raphael._availableAttrs,attr=prf.box.ISCOMBO?prop.attr:{KEY:prop.attr};prf._elset&&prf._elset.forEach((function(el){var key1=el.type,tag=prf.getKey(el.node.id,!0);if((!key||key===tag)&&(node=el.node)&&"raphaelid"in node){var paper=prf.boxing().getPaper();if(paper&&(node=paper.getById(node.raphaelid))){var attf=node.attr();xui.filter(attf,(function(o,i){if("transform"==i&&xui.isArr(o)&&0===o.length&&(o=""),"transform"==i&&o&&(o=node.matrix.toTransformString()),"text"==key1){if("stroke"==i)return"none"!=o;if("fill"==i)return"#000"!=o;if("KEY"!=tag&&"hAlign"in prf.box.$DataModel&&("x"==i||"y"==i))return!1}return("KEY"==tag||"transform"!=i)&&o!=dftAttr[i]})),"src"in attf&&"src"in attr[tag]&&(attf.src=attr[tag].src),attr[tag]=attf}}}))}return attr=prf.box._adjustAttr(attr),prf.box.ISCOMBO?key?attr[key]:attr:attr.KEY},setAttr:function(key,attr,reset,notify){if(xui.isHash(key))attr=key;else{var h={};h[key]=attr,attr=h,key=key||"KEY"}return reset=!1!==reset,this.each((function(prf){var node,prop=prf.properties,dftAttr=Raphael._availableAttrs,oAttr=prf.box._adjustAttr(prop.attr),attr2=prf.box._adjustAttr(attr);if(reset&&xui.each(oAttr,(function(o,i){i in attr2||(attr2[i]={}),xui.each(o,(function(o1,i1){i1 in attr2[i]||(attr2[i][i1]=dftAttr[i1],"text"==(prf.box.$tagName[i]||i.split("_")[0].toLowerCase())&&("stroke"==i1&&(attr2[i][i1]="none"),"fill"==i1&&(attr2[i][i1]="#000")))})),"text"==(prf.box.$tagName[i]||i.split("_")[0].toLowerCase())&&"KEY"!=i&&"hAlign"in prf.box.$DataModel&&(delete attr2[i].x,delete attr2[i].y),"KEY"!=i&&delete attr2[i].transform})),prf._elset){prf._elset.forEach((function(el){el.type;var tag=prf.getKey(el.node.id,!0);if((xui.isHash(key)||key===tag)&&(node=el.node)&&"raphaelid"in node){var paper=prf.boxing().getPaper();if(paper&&(node=paper.getById(node.raphaelid))){var rattr=xui.copy(attr2[tag]);rattr&&("src"in rattr&&(rattr.src=xui.adjustRes(rattr.src)),node.attr(rattr))}}}));var ot=attr2.KEY,shapeChanged=ot&&("x"in ot||"y"in ot||"width"in ot||"height"in ot||"r"in ot||"rx"in ot||"ry"in ot||"path"in ot||"transform"in ot||"arrow-start"in ot||"arrow-end"in ot);if(ot){var ss=prf._elset;if(ss[1]&&"transform"in ot)for(var i=1,l=ss.length;i<l;i++)ss[i].attr("transform",ot.transform);!1!==notify&&prf.box._notify(prf,ot,shapeChanged)}}prf.box.ISCOMBO?(prop.attr=xui.merge(prop.attr,attr2,(function(o,i){if("object"!=typeof o)return!0;i in prop.attr?xui.merge(prop.attr[i],o,"all"):prop.attr[i]=xui.copy(o)})),xui.each(prop.attr,(function(o,i){xui.filter(o,(function(o1,i1){if("transform"==i1&&xui.isArr(dftAttr[i1])&&0===dftAttr[i1].length&&(dftAttr[i1]=""),"text"==(prf.box.$tagName[i]||i.split("_")[0].toLowerCase())){if("stroke"==i1)return"none"!=o1;if("fill"==i1)return"#000"!=o1;if("KEY"!=i&&"hAlign"in prf.box.$DataModel&&("x"==i1||"y"==i1))return!1}return("KEY"==i||"transform"!=i1)&&dftAttr[i1]!==o1}))}))):(xui.merge(prop.attr,attr2.KEY,"all"),xui.filter(prop.attr,(function(o1,i1){if("transform"==i1&&xui.isArr(dftAttr[i1])&&0===dftAttr[i1].length&&(dftAttr[i1]=""),"text"==(prf.box.$tagName.KEY||i.split("_")[0].toLowerCase())){if("stroke"==i1)return"none"!=o1;if("fill"==i1)return"#000"!=o1}return dftAttr[i1]!==o1})))}))},toFront:function(){return this.each((function(prf){prf._shadow&&prf._shadow.toFront(),prf._elset&&xui.arr.each(prf._elset.items,(function(el){el.toFront()}));var arr=xui.get(prf,["parent","children"]);if(arr&&arr.length){var o,index=xui.arr.subIndexOf(arr,"0",prf);-1!=index&&(o=arr[index],arr.splice(index,1),arr.push(o))}}))},toBack:function(){return this.each((function(prf){prf._elset&&xui.arr.each(prf._elset.items,(function(el){el.toBack()}),null,!0),prf._shadow&&prf._shadow.toBack();var arr=xui.get(prf,["parent","children"]);if(arr&&arr.length){var o,index=xui.arr.subIndexOf(arr,"0",prf);-1!=index&&(o=arr[index],arr.splice(index,1),arr.unshift(o))}}))},getAllNodes:function(){var prf=this.get(0),arr=[];return prf&&prf._elset&&(prf._elset.forEach((function(el){arr.push(el.node)})),prf._shadow&&prf._shadow.forEach((function(el){arr.push(el.node)}))),xui(arr)},getPaper:function(){var prf=this.get(0);return prf&&prf.parent&&prf.parent._paper},elemsAnimate:function(endpoints,ms,easing,callback){var prf=this.get(0);return prf&&prf._elset&&prf._elset.animate(endpoints,ms,easing,callback),this},getElemSet:function(){var prf=this.get(0);prf&&prf._elset},getLeft:function(){return this._getBBox("x")},setLeft:function(value){return this._setBBox("x",value)},getTop:function(){return this._getBBox("y")},setTop:function(value){return this._setBBox("y",value)},getWidth:function(){return this._getBBox("width")},getHeight:function(){return this._getBBox("height")},setWidth:function(value){return this._setBBox("width",parseFloat(value))},setHeight:function(value){return this._setBBox("height",parseFloat(value))},_getBBox:function(key,withTransform){var el,bbox,prf=this.get(0);if((el=prf._elset)&&el.length){el[0]._.dirty=1,bbox={},xui.merge(bbox,el[0]._getBBox(!1!==withTransform),"all",!0);for(var t,i=1,l=el.length;i<l;i++)"text"==el[i].type&&"hAlign"in prf.box.$DataModel||(el[i]._.dirty=1,t=el[i]._getBBox(!1!==withTransform),bbox.x=Math.min(t.x,bbox.x),bbox.y=Math.min(t.y,bbox.y),bbox.x2=Math.max("x2"in t?t.x2:t.x+t.width,"x2"in bbox?bbox.x2:bbox.x+bbox.width),bbox.y2=Math.max("y2"in t?t.y2:t.y+t.height,"y2"in bbox?bbox.y2:bbox.y+bbox.height));return"x2"in bbox&&(bbox.width=bbox.x2-bbox.x),"y2"in bbox&&(bbox.height=bbox.y2-bbox.y),delete bbox.x2,delete bbox.y2,key?bbox[key]:bbox}},_setBBox:function(key,value){},_getConnectAnchors:function(){var rst,prf=this.get(0);if(prf){if(xui.get(prf._pathCached,["_connAnchors"]))return xui.get(prf._pathCached,["_connAnchors"]);var ss=prf._elset;if(ss&&ss[0]){ss[0]._.dirty=1;var matrix,tf=Raphael.parseTransformString(ss[0].transform());tf&&tf.length&&(matrix=ss[0].matrix);var bbox=ss[0]._getBBox(!0),r1=180,r2=270,r3=0,r4=90,x1=bbox.x,y1=bbox.y+bbox.height/2,x2=bbox.x+bbox.width/2,y2=bbox.y,x3=bbox.x+bbox.width,y3=bbox.y+bbox.height/2,x4=bbox.x+bbox.width/2,y4=bbox.y+bbox.height;if(matrix){var xx1=x1,xx2=x2,xx3=x3,xx4=x4,yy1=y1,yy2=y2,yy3=y3,yy4=y4;x1=matrix.x(xx1,yy1),y1=matrix.y(xx1,yy1),x2=matrix.x(xx2,yy2),y2=matrix.y(xx2,yy2),x3=matrix.x(xx3,yy3),y3=matrix.y(xx3,yy3);var xc=(x1+x2+x3+(x4=matrix.x(xx4,yy4)))/4,yc=(y1+y2+y3+(y4=matrix.y(xx4,yy4)))/4;r1=Raphael.angle(x1,y1,xc,yc),r2=Raphael.angle(x2,y2,xc,yc),r3=Raphael.angle(x3,y3,xc,yc),r4=Raphael.angle(x4,y4,xc,yc)}return rst={left:{x:x1,y:y1,alpha:r1,solid:1},top:{x:x2,y:y2,alpha:r2,solid:1},right:{x:x3,y:y3,alpha:r3,solid:1},bottom:{x:x4,y:y4,alpha:r4,solid:1}},prf._pathCached&&xui.set(prf._pathCached,["_connAnchors"],rst),rst}}},_getConnectPath:function(){var ss,prf=this.get(0);if(xui.get(prf._pathCached,["_connPath"]))return xui.get(prf._pathCached,["_connPath"]);if(prf&&(ss=prf._elset)&&ss[0]){var matrix,tf=Raphael.parseTransformString(ss[0].transform());tf&&tf.length&&(matrix=ss[0].matrix);var path=ss[0].getPath();return matrix&&(path=Raphael.mapPath(path,matrix)),prf._pathCached&&xui.set(prf._pathCached,["_connPath"],path),path}},_getConnectPoint:function(anchor){if(anchor){var rst,prf=this.get(0);if(xui.get(prf._pathCached,["_connPoint",anchor]))return xui.get(prf._pathCached,["_connPoint",anchor]);if(/^[1-9][0-9]*:((1([.][0]+)?)|(0\.[0-9]+))$/.test(anchor)){var arr=anchor.split(":");if(arr[0]=+arr[0],arr[1]=+arr[1],arr[0]>=1&&arr[1]>=0&&arr[1]<=1){prf=this.get(0);var cp=this._getConnectPath();if(cp){var cur,prev,cv=Raphael.path2curve(cp);(cur=cv[arr[0]])&&(prev=cv[arr[0]-1])&&(rst=Raphael.findDotsAtSegment(prev[prev.length-2],prev[prev.length-1],cur[1],cur[2],cur[3],cur[4],cur[5],cur[6],arr[1]))}}}else{var hash=this._getConnectAnchors();rst=hash&&hash[anchor]}return prf._pathCached&&xui.set(prf._pathCached,["_connPoint",anchor],rst),rst}},_removeHandler:function(){return this.each((function(prf){var el,tt,hh;if(tt=prf._pathHandler){if(hh=tt.handlers)for(var o,t,i=0,ii=hh.length;i<ii;i++)for(var j in o=hh[i])(t=o[j])&&"function"==typeof t.remove&&t.remove(),o[i]=null;el=tt.el,delete tt.el,delete prf._pathHandler}delete prf._ddstartFun,delete prf._ddendFun,el&&el._shape&&(el._shape.remove(),delete el._shape)}))},_addHandler:function(callback,type){return type=type||"adv",this._removeHandler(),this.each((function(prf){if(prf._elset&&prf._elset[0]){var absPos,magneticPos,magneticOffPos,r=prf.boxing().getPaper(),isCombo=prf.box.ISCOMBO,el=prf._elset[0],isConnector=prf.box._CONNECTOR,connType=prf.properties.type,dotAttr1={fill:"#fff",stroke:"#000",r:5},dotAttr2={fill:"#fff",stroke:"#000",r:4},dotAttr3={fill:"#fff",stroke:"#000",r:3},dotAttr4={fill:"#fff",stroke:"#000",r:4},dotAttr6={fill:"#bf5600",stroke:"#bf5600",r:5,"fill-opacity":.5},lineAttr={stroke:"#0000FF","stroke-dasharray":". "},handlers={rect:function(el){var attr=el.attr(),handler={};return handler.dot=createDDElem(r.circle(attr.x+attr.width/2,attr.y+attr.height/2).attr(dotAttr1).attr("cursor","move"),el,(function(x,y,ax,ay){var nshape,pos=moveFun(this,x,y,ax,ay);return attr.x+=pos.rx,attr.y+=pos.ry,nshape={x:attr.x,y:attr.y},el.attr(nshape),el._shape&&el._shape.attr(nshape),xui.tryF(el.onShapeChanged,[nshape]),moveFun(handler.dot1,x,y,ax,ay),moveFun(handler.dot2,x,y,ax,ay),moveFun(handler.dot3,x,y,ax,ay),{dx:pos.dx,dy:pos.dy}}),"main"),handler.dot1=createDDElem(r.circle(attr.x,attr.y).attr(dotAttr2).attr("cursor","nw-resize"),el,(function(x,y,ax,ay){var nshape,x2=el.attr("x")+el.attr("width"),y2=el.attr("y")+el.attr("height"),pos=moveFun(this,x,y,ax,ay,null,x2,null,y2);attr.x=pos.cx,attr.y=pos.cy,attr.height=y2-pos.cy,attr.width=x2-pos.cx,nshape={x:attr.x,y:attr.y,width:attr.width,height:attr.height},el.attr(nshape),el._shape&&el._shape.attr(nshape),xui.tryF(el.onShapeChanged,[nshape]),handler.dot.attr({cx:attr.x+attr.width/2,cy:attr.y+attr.height/2});var m=Math.min(el.attr("width"),el.attr("height"));return el.attr("r")>m&&(el.attr("r",attr.r=m),el._shape&&el._shape.attr("r",m),xui.tryF(el.onShapeChanged,[{r:m}])),handler.dot3.attr({cx:el.attr("x")+el.attr("width")-el.attr("r"),cy:el.attr("y")}),{dx:pos.dx,dy:pos.dy}}),"w"),handler.dot2=createDDElem(r.circle(attr.x+attr.width,attr.y+attr.height).attr(dotAttr2).attr("cursor","se-resize"),el,(function(x,y,ax,ay){var nshape,pos=moveFun(this,x,y,ax,ay,attr.x,null,attr.y,null);attr.width=pos.cx-attr.x,attr.height=pos.cy-attr.y,nshape={width:attr.width,height:attr.height},el.attr(nshape),el._shape&&el._shape.attr(nshape),xui.tryF(el.onShapeChanged,[nshape]),handler.dot.attr({cx:attr.x+attr.width/2,cy:attr.y+attr.height/2});var m=Math.min(el.attr("width"),el.attr("height"));return el.attr("r")>m&&(el.attr("r",attr.r=m),el._shape&&el._shape.attr("r",m),xui.tryF(el.onShapeChanged,[{r:m}])),handler.dot3.attr({cx:el.attr("x")+el.attr("width")-el.attr("r"),cy:el.attr("y")}),{dx:pos.dx,dy:pos.dy}}),"h"),handler.dot3=createDDElem(r.circle(attr.x+attr.width-(attr.r||0),attr.y).attr(dotAttr3).attr("cursor","e-resize"),el,(function(x,y,ax,ay){var nshape,attr=el.attr(),pos=moveFun(this,x,y,ax,ay,attr.x+attr.width-Math.max(attr.width,attr.height)/2,attr.x+attr.width,attr.y,attr.y);return nshape={r:attr.width-(pos.cx-attr.x)},el.attr(nshape),el._shape&&el._shape.attr(nshape),xui.tryF(el.onShapeChanged,[nshape]),{dx:pos.dx,dy:pos.dy}}),"r"),{el:el,handlers:[handler]}},circle:function(el){var attr=el.attr(),handler={};return handler.dot=createDDElem(r.circle(attr.cx,attr.cy).attr(dotAttr1).attr("cursor","move"),el,(function(x,y){var rtn=moveFun(this,x,y),pos={cx:rtn.cx,cy:rtn.cy};attr.cx=pos.cx,attr.cy=pos.cy,el.attr(pos),el._shape&&el._shape.attr(pos),xui.tryF(el.onShapeChanged,[pos]),pos.cx+=el.attr("r"),handler.dotr.attr(pos)}),"main"),handler.dotr=createDDElem(r.circle(attr.cx+attr.r,attr.cy).attr(dotAttr2).attr("cursor","e-resize"),el,(function(x,y,ax,ay){var nshape,attr=el.attr(),pos=moveFun(this,x,y,ax,ay,attr.cx,null,attr.cy,attr.cy);return attr.r=pos.cx-attr.cx,nshape={r:attr.r},el.attr(nshape),el._shape&&el._shape.attr(nshape),xui.tryF(el.onShapeChanged,[nshape]),{dx:pos.dx,dy:pos.dy}}),"r"),{el:el,handlers:[handler]}},ellipse:function(el){var attr=el.attr(),handler={};return handler.dot=createDDElem(r.circle(attr.cx,attr.cy).attr(dotAttr1).attr("cursor","move"),el,(function(x,y){var rtn=moveFun(this,x,y),pos={cx:rtn.cx,cy:rtn.cy};attr.cx=pos.cx,attr.cy=pos.cy,el.attr(pos),el._shape&&el._shape.attr(pos),xui.tryF(el.onShapeChanged,[pos]),handler.dotrx.attr({cx:pos.cx+el.attr("rx"),cy:pos.cy}),handler.dotry.attr({cy:pos.cy-el.attr("ry"),cx:pos.cx})}),"main"),handler.dotrx=createDDElem(r.circle(attr.cx+attr.rx,attr.cy).attr(dotAttr2).attr("cursor","w-resize"),el,(function(x,y,ax,ay){var nshape,attr=el.attr(),pos=moveFun(this,x,y,ax,ay,attr.cx,null,attr.cy,attr.cy);return attr.rx=pos.cx-attr.cx,nshape={rx:attr.rx},el.attr(nshape),el._shape&&el._shape.attr(nshape),xui.tryF(el.onShapeChanged,[nshape]),{dx:pos.dx,dy:pos.dy}}),"rx"),handler.dotry=createDDElem(r.circle(attr.cx,attr.cy-attr.ry).attr(dotAttr2).attr("cursor","n-resize"),el,(function(x,y,ax,ay){var nshape,attr=el.attr(),pos=moveFun(this,x,y,ax,ay,attr.cx,attr.cx,null,attr.cy);return attr.ry=attr.cy-pos.cy,nshape={ry:attr.ry},el.attr(nshape),el._shape&&el._shape.attr(nshape),xui.tryF(el.onShapeChanged,[nshape]),{dx:pos.dx,dy:pos.dy}}),"ry"),{el:el,handlers:[handler]}},path:function(el){var x,y,ox,oy,ax,ay,bx,by,zx,zy,manualPathModify,l,handler,paths=el.getPath(),addSegmentJunctionDD=function(r,el,x,y,index,type3,conType,prf){var circle=r.circle(x,y);return"from"==conType||"to"==conType?circle.attr(dotAttr4):circle.attr(dotAttr1).attr("cursor","move"),createDDElem(circle,el,(function(x,y,ax,ay,beForced,mx,my,ix,iy,event,callback){var anchorPos,paper=el.paper,ox=this.attr("cx"),oy=this.attr("cy"),X=xui.isSet(ix)?ix:ox+x,Y=xui.isSet(iy)?iy:oy+y;if(xui.isSet(ix)&&(x=X-ox),xui.isSet(iy)&&(y=Y-oy),"from"==conType||"to"==conType){var d=el.node.ownerDocument||document;this.hide(),prf._elset.hide(),el._shape.hide(),xui.arr.each(handlers,(function(o,i){(i=o.dot)&&i.hide(),(i=o.dot1)&&i.hide(),(i=o.dot2)&&i.hide(),(i=o.dot3)&&i.hide(),(i=o.dotPrev)&&i.hide(),(i=o.dotNext)&&i.hide(),(i=o.linePrev)&&i.hide(),(i=o.lineNext)&&i.hide()}));var esrc=d.elementFromPoint(mx,my);if(this.show(),prf._elset.show(),el._shape.show(),xui.arr.each(handlers,(function(o,i){(i=o.dot)&&i.show(),(i=o.dot1)&&i.show(),(i=o.dot2)&&i.show(),(i=o.dot3)&&i.show(),(i=o.dotPrev)&&i.show(),(i=o.dotNext)&&i.show(),(i=o.linePrev)&&i.show(),(i=o.lineNext)&&i.show()})),esrc._rootNode&&(esrc=esrc._rootNode),!esrc)return;if(esrc&&esrc.raphael){var o=paper.getById(esrc.raphaelid);o&&o._attached&&(esrc=o._attached)}for(;esrc&&(!esrc.id||esrc.id==xui.$localeDomId||"tspan"==esrc.tagName)&&esrc!==paper.canvas.parentNode&&esrc.parentNode!==d;)esrc=esrc.parentNode;if(!esrc)return;var magneticObj,anchorKey,targetNode,anchors,anchorPath,centerPoint,anchorShadow=paper._anchorShadow;if(esrc!==paper.canvas){var tobj=xui.UIProfile.getFromDom(esrc.id);if(tobj&&tobj.parent&&tobj.parent._paper==paper)if(tobj.box["xui.svg"]){if(targetNode=tobj.getRootNode(),!tobj.box._CONNECTOR){var anchorBBox;anchors=tobj.boxing()._getConnectAnchors(),(anchorPath=tobj.boxing()._getConnectPath())&&((anchorBBox=xui.get(tobj._pathCached,["_connBBox"]))||(anchorBBox=Raphael.pathBBox(anchorPath),xui.set(tobj._pathCached,["_connBBox"],anchorBBox)),centerPoint={x:anchorBBox.x+anchorBBox.width/2,y:anchorBBox.y+anchorBBox.height/2}),magneticObj=tobj.alias}}else tobj.box["xui.UI"]}if(!anchorShadow||(anchors||anchorPath)&&anchorShadow._attached===targetNode||(anchorShadow.remove(),anchorShadow.clear(),anchorShadow=null,delete paper._anchorShadow,this.show()),anchors||anchorPath){if(!anchorShadow){(anchorShadow=paper.set())._attached=targetNode;var circle=paper.circle(-100,-100);for(var i in circle._attached=targetNode,circle.hide(),anchorShadow.push(circle),anchors)o=anchors[i],(circle=paper.circle(o.x,o.y))._attached=targetNode,circle._anchorKey=i,anchorShadow.push(circle);anchorShadow.attr(dotAttr6),paper._anchorShadow=anchorShadow}var minDis=null;for(var i in anchors)(distance=Math.pow(Math.pow(Math.abs(ix-anchors[i].x),2)+Math.pow(Math.abs(iy-anchors[i].y),2),.5))<=16&&(null===minDis||minDis>distance)&&(minDis=distance,anchorPos=anchors[i],anchorKey=i);if(!anchorPos&&anchorPath){var v=16,path="M,"+X+","+Y+"m,0,-16a,16,16,0,1,1,0,32a,16,16,0,1,1,0,-32z",cross=(Raphael.getTotalLength(path),Raphael.pathIntersection(anchorPath,path));if(cross.length>=2){var x0=(cross[0].x+cross[1].x)/2,y0=(cross[0].y+cross[1].y)/2,angle=Raphael.angle(x0,y0,X,Y);Math.abs(x0-centerPoint.x)+Math.abs(y0-centerPoint.y)<Math.abs(X-centerPoint.x)+Math.abs(Y-centerPoint.y)&&(angle+=180);var rad=Raphael.rad(angle),x1=X-v*Math.cos(rad),x2=X+v*Math.cos(rad),y1=Y-v*Math.sin(rad),y2=Y+v*Math.sin(rad);if(1===(cross=Raphael.pathIntersection(anchorPath,"M"+x1+","+y1+",L"+x2+","+y2)).length){var b=cross[0].bez1,ppath="M"+b[0]+","+b[1]+"C"+b[2]+","+b[3]+","+b[4]+","+b[5]+","+b[6]+","+b[7];Raphael.getPointAtLength(ppath,cross[0].t1*Raphael.getTotalLength(ppath)),anchorKey=cross[0].segment1+":"+cross[0].t1,anchorPos={x:cross[0].x,y:cross[0].y,alpha:angle,_path:!0}}}}anchorPos&&(magneticPos?magneticPos.x==anchorPos.x&&magneticPos.y==anchorPos.y?(x=y=0,ax=magneticOffPos.x,ay=magneticOffPos.y):(x=anchorPos.x-magneticPos.x,y=anchorPos.y-magneticPos.y,ax=magneticOffPos.x+x,ay=magneticOffPos.y+y,magneticPos={x:anchorPos.x,y:anchorPos.y},magneticOffPos={x:ax,y:ay},anchorPos._path?(anchorShadow[0].attr({cx:anchorPos.x,cy:anchorPos.y}),anchorShadow[0].show()):anchorShadow[0].hide()):(x+=anchorPos.x-ix,y+=anchorPos.y-iy,ax+=anchorPos.x-ix,ay+=anchorPos.y-iy,magneticPos={x:anchorPos.x,y:anchorPos.y},magneticOffPos={x:ax,y:ay},anchorPos._path?(anchorShadow[0].attr({cx:anchorPos.x,cy:anchorPos.y}),anchorShadow[0].show()):anchorShadow[0].hide()),X=anchorPos.x,Y=anchorPos.y,pos={dx:ax,dy:ay})}!anchorPos&&magneticPos&&(x=ix-magneticPos.x,y=iy-magneticPos.y,ax=magneticOffPos.x+x,ay=magneticOffPos.y+y,magneticPos=magneticOffPos=null,anchorShadow&&anchorShadow[0].hide()),prf.properties["from"==conType?"fromObj":"toObj"]=magneticObj||"",prf.properties["from"==conType?"fromPoint":"toPoint"]=anchorKey||""}var pathModified,pos={cx:X,cy:Y};if(beForced||!1!==xui.tryF(manualPathModify,[index,paths,X,Y,this,pos])){i=this._handlerIndex;var data2,p,l=paths[i].length,data=handlers[i];beForced||("V"==type3?(handlers.length-1==i+1&&"H"==handlers[i+1].type?(delete pos.cy,y=ay=0):paths[i][l-1]=Y,0!=i-1&&(data2=handlers[i-1])?"H"==data2.type?(paths[i-1][1]=X,(d=data2.dot)&&d.update(x,0,ax,0,!0,mx,my)):"V"==data2.type?delete pos.cx:"L"==data2.type?(paths[i-1][paths[i-1].length-2]=X,(d=data2.dot)&&d.update(x,0,ax,0,!0,mx,my)):delete pos.cx:delete pos.cx):"H"==type3?(handlers.length-1==i+1&&"V"==handlers[i+1].type?(delete pos.cx,x=ax=0):paths[i][l-1]=X,0!=i-1&&(data2=handlers[i-1])?"H"==data2.type?delete pos.cy:"V"==data2.type?(paths[i-1][1]=Y,(d=data2.dot)&&d.update(0,y,ax,ay,!0,mx,my)):"L"==data2.type?(paths[i-1][paths[i-1].length-1]=Y,(d=data2.dot)&&d.update(0,y,ax,ay,!0,mx,my)):delete pos.cy:delete pos.cy):(paths[i][l-2]=X,paths[i][l-1]=Y),(data2=handlers[i+1])&&(d=data2.dot)&&("V"==data2.type?d.update(x,0,ax,0,!0,mx,my):"H"==data2.type&&d.update(0,y,0,ay,!0,mx,my))),this.attr(pos),(p=data.linePrevPath)&&(p[0][1]=X,p[0][2]=Y),(p=data.lineNextPath)&&(p[0][1]=X,p[0][2]=Y),(d=data.dotPrev)&&(d.update(X-ox,Y-oy,ax,ay,!0),pathModified=!0),(d=data.dotNext)&&(d.update(X-ox,Y-oy,ax,ay,!0),pathModified=!0)}if(!pathModified){var nshape={path:paths};el.attr(nshape),el._shape&&el._shape.attr(nshape),xui.tryF(el.onShapeChanged,[nshape])}if(("from"==conType||"to"==conType)&&"bezier"==connType&&anchorPos&&(X!==ox||Y!==oy)){var dot="from"==conType?handlers[0].dotNext:handlers[paths.length-1].dotPrev;if(dot){x0=dot.attr("cx"),y0=dot.attr("cy");var distance=Math.pow(Math.pow(Math.abs(X-x0),2)+Math.pow(Math.abs(Y-y0),2),.5);rad=Raphael.rad(anchorPos.alpha),x1=X+distance*Math.cos(rad),y1=Y+distance*Math.sin(rad),dot.update(x1-x0,y1-y0,null,null,!0)}}if(pos)return pos}),"main",index)},addBezierAnchor2DD=function(r,el,x,y,index,conType,prf){return createDDElem(r.circle(x,y).attr(dotAttr3),el,(function(x,y){var nshape,X=this.attr("cx")+x,Y=this.attr("cy")+y;this.attr({cx:X,cy:Y});var p,d,i=this._handlerIndex,data=handlers[i];(p=data.lineNextPath)&&(p[1][1]=X,p[1][2]=Y),(d=data.lineNext)&&d.attr({path:p}),paths[i+1][1]=X,paths[i+1][2]=Y,nshape={path:paths},el.attr(nshape),el._shape&&el._shape.attr(nshape),xui.tryF(el.onShapeChanged,[nshape])}),"path2",index)},addBezierAnchor1DD=function(r,el,x,y,index,conType,prf){return createDDElem(r.circle(x,y).attr(dotAttr3),el,(function(x,y){var nshape,X=this.attr("cx")+x,Y=this.attr("cy")+y;this.attr({cx:X,cy:Y});var p,d,i=this._handlerIndex,data=handlers[i];(p=data.linePrevPath)&&(p[1][1]=X,p[1][2]=Y),(d=data.linePrev)&&d.attr({path:p}),paths[i][paths[i].length-4]=X,paths[i][paths[i].length-3]=Y,nshape={path:paths},el.attr(nshape),el._shape&&el._shape.attr(nshape),xui.tryF(el.onShapeChanged,[nshape])}),"path1",index)},type1=1,type2=1,type3=0,handlers=[];xui.isStr(paths)&&(paths=Raphael.parsePathString(paths)),isConnector&&"flowchart"==connType&&(prf._ddstartFun=function(prf,index,dot){0!==index&&index!==prf._pathHandler.handlers.length-1||xui.arr.each(prf._pathHandler.handlers,(function(o,i){0!==i&&i!==prf._pathHandler.handlers.length-1&&o.dot.attr({opacity:0,r:0})}))},prf._ddendFun=function(prf,index,dot){0!==index&&index!==prf._pathHandler.handlers.length-1||prf.boxing()._addHandler(callback)},manualPathModify=function(index,paths,X,Y,dot,pos){if(0===index||index===prf._pathHandler.handlers.length-1){dot.attr(pos);var np=prf.box._redrawBrokenLine(prf,0===index?"start":"end",X,Y);return paths.length=0,xui.arr.each(np,(function(p){paths.push(p)})),!1}});for(var i=0,ii=paths.length;i<ii;i++){var conType;switch(isConnector&&(conType=0===i?"from":i===ii-1?"to":null),handlers.push(handler={dot:0,dotPrev:0,dotNext:0,linePrev:0,lineNext:0,linePrevPath:0,lineNextPath:0,type:paths[i][0]}),l=paths[i].length,type3=0,paths[i][0]){case"M":x=zx=ox=paths[i][l-2],y=zy=oy=paths[i][l-1],type1=0,type2=1;break;case"L":type1=type2=1,zx=ox=paths[i][l-2],zy=oy=paths[i][l-1];break;case"H":type1=type2=1,zy=oy=y,zx=ox=paths[i][1],type3="H";break;case"V":type1=type2=1,zx=ox=x,zy=oy=paths[i][1],type3="V";break;case"C":type1=type2=2,ax=paths[i][l-6],ay=paths[i][l-5],bx=paths[i][l-4],by=paths[i][l-3],ox=zx=paths[i][l-2],oy=zy=paths[i][l-1];break;case"Q":type1=2,type2=1,ax=paths[i][l-4],ay=paths[i][l-3],ox=zx=paths[i][l-2],oy=zy=paths[i][l-1];break;case"S":type1=1,type2=2,bx=paths[i][l-4],by=paths[i][l-3],ox=zx=paths[i][l-2],oy=zy=paths[i][l-1];break;case"T":type1=type2=1,ox=zx=paths[i][l-2],oy=zy=paths[i][l-1];break;case"A":type1=type2=0,ox=zx=paths[i][l-2],oy=zy=paths[i][l-1];continue;default:continue}switch(type1){case 0:case 1:break;case 2:"adv"==type&&(handlers[i-1].lineNextPath=[["M",x,y],["L",ax,ay]],handlers[i-1].lineNext=r.path(handlers[i-1].lineNextPath).attr(lineAttr),handlers[i-1].dotNext=addBezierAnchor2DD(r,el,ax,ay,i-1))}switch(type2){case 1:handlers[i].dot=addSegmentJunctionDD(r,el,zx,zy,i,type3,conType,prf),isConnector&&"flowchart"==connType&&3===ii&&1===i&&handlers[i].dot.attr({opacity:0,r:0});break;case 2:handlers[i].dot=addSegmentJunctionDD(r,el,zx,zy,i,null,conType,prf),"adv"==type&&(handlers[i].linePrevPath=[["M",zx,zy],["L",bx,by]],handlers[i].linePrev=r.path(handlers[i].linePrevPath).attr(lineAttr),handlers[i].dotPrev=addBezierAnchor1DD(r,el,bx,by,i))}ox!=undefined&&(x=ox),oy!=undefined&&(y=oy)}for(i=0,ii=paths.length;i<ii;i++)(handler=handlers[i]).dot&&handler.dot.toFront();return{el:el,handlers:handlers}}},move=function(dx,dy,mx,my,event){var rtn=this.update(dx-(this.dx||0),dy-(this.dy||0),dx,dy,!1,mx,my,mx-absPos.left,my-absPos.top,event);this.dx=rtn&&rtn.dx||dx,this.dy=rtn&&rtn.dy||dy,callback&&callback(this,event,"drag",this._attached)},start=function(mx,my,event){callback&&callback(this,event,"beforedragstart",this._attached),this.toFront(),this.dx=this.dy=0,magneticPos=magneticOffPos=null,absPos=xui(this.paper.canvas.parentNode).offset(null);var t,cursor=this.attr("cursor");this._oldCursor=(t=r.canvas.style).cursor||"",t.cursor=cursor,(t=this._attached)&&(t._oldCursor=t.attr("cursor")||"",t.attr("cursor",cursor),t._opath=t.getPath(),t._obbox=Raphael.pathBBox(t._opath),prf._ddstartFun&&xui.tryF(prf._ddstartFun,[prf,this._handlerIndex,this])),callback&&callback(this,event,"dragstart",this._attached)},end=function(event){callback&&callback(this,event,"beforedragend",this._attached),absPos=null,magneticPos=magneticOffPos=null;var t,paper=this.paper;if(r.canvas.style.cursor=this._oldCursor,delete this._oldCursor,t=this._attached){t.attr("cursor",t._oldCursor),delete t._oldCursor,delete t._obbox,delete t._opath;var attr=t.attr();isCombo?(xui.merge(prf.properties.attr.KEY,attr,"all"),attr=prf.properties.attr.KEY):(xui.merge(prf.properties.attr,attr,"all"),attr=prf.properties.attr),attr.path&&(attr.path=t.getPath().join("")),prf.box._notify(prf,{path:1},!0),prf._ddendFun&&xui.tryF(prf._ddendFun,[prf,this._handlerIndex,this])}(t=paper._anchorShadow)&&(t.remove(),t.clear(),delete paper._anchorShadow),callback&&callback(this,event,"dragend",this._attached)},createDDElem=function(obj,el,update,key,index){return obj._handlerIndex=index||0,obj._attached=el,update&&(obj.drag(move,start,end),obj.update=update,obj.dblclick((function(event){callback&&callback(this,event,"dblclick",el,key,index)})),obj.click((function(event){callback&&callback(this,event,"click",el,key,index),xui.Event.stopBubble(event),xui.Event.stopDefault(event)})),obj.contextmenu((function(event){callback&&callback(this,event,"contextmenu",el,key,index)}))),obj.toFront(),obj},moveFun=function(el,x,y,ax,ay,limitX1,limitX2,limitY1,limitY2){switch(el.type){case"path":for(var l,paths=el.getPath(),i=0,ii=paths.length;i<ii;i++)switch(l=paths[i].length,paths[i][0]){case"M":case"L":paths[i][1]+=x,paths[i][2]+=y;break;case"H":paths[i][1]+=x;break;case"V":paths[i][1]+=y;break;case"C":paths[i][1]+=x,paths[i][2]+=y,paths[i][3]+=x,paths[i][4]+=y,paths[i][5]+=x,paths[i][6]+=y;break;case"Q":case"S":paths[i][1]+=x,paths[i][2]+=y,paths[i][3]+=x,paths[i][4]+=y;break;case"T":paths[i][1]+=x,paths[i][2]+=y;break;case"A":paths[i][l-2]+=x,paths[i][l-1]+=y;continue;default:continue}nshape={path:paths},el.attr(nshape),el._shape&&el._shape.attr(nshape),xui.tryF(el.onShapeChanged,[nshape]);break;case"circle":var rst,X=el.attr("cx")+x,Y=el.attr("cy")+y,lx=0,ly=0;return(0===limitX1||limitX1)&&X<limitX1+1&&(lx=X-(limitX1+1),X=limitX1+1),(0===limitX2||limitX2)&&X>limitX2&&(lx=X-limitX2,X=limitX2),(0===limitY1||limitY1)&&Y<limitY1+1&&(ly=Y-(limitY1+1),Y=limitY1+1),(0===limitY2||limitY2)&&Y>limitY2&&(ly=Y-limitY2,Y=limitY2),rst={cx:X,cy:Y,rx:x,ry:y},el.attr(rst),el._shape&&el._shape.attr(rst),xui.tryF(el.onShapeChanged,[rst]),rst.dx=ax-lx,rst.dy=ay-ly,rst;case"ellipse":var nshape={cx:X=el.attr("cx")+x,cy:Y=el.attr("cy")+y};el.attr(nshape),el._shape&&el._shape.attr(nshape),xui.tryF(el.onShapeChanged,[nshape]);break;case"rect":nshape={x:X=el.attr("x")+x,y:Y=el.attr("y")+y},el.attr(nshape),el._shape&&el._shape.attr(nshape),xui.tryF(el.onShapeChanged,[nshape]);break;case"text":nshape={x:X=el.attr("x")+x,y:Y=el.attr("y")+y},el.attr(nshape),el._shape&&el._shape.attr(nshape),xui.tryF(el.onShapeChanged,[nshape])}};handlers[el.type]&&(prf._pathHandler=handlers[el.type](el),(el=el._shape=el.clone()).attr({"arrow-start":"none","arrow-end":"none"}),el.transform("").attr("text"==el.type?{opacity:.8}:{stroke:"#ccc","stroke-dasharray":"- ",opacity:.8}).toBack())}}))}},Static:{$abstract:!0,_objectProp:{attr:1},DataModel:{selectable:null,defaultFocus:null,renderer:null,position:null,tabindex:{hidden:!0},zIndex:{hidden:!0},disableClickEffect:null,disableHoverEffect:null,disableTips:null,disabled:null,left:null,top:null,right:null,bottom:null,width:null,height:null,svgTag:{ini:""},attr:{ini:{}},shadow:{ini:!1,action:function(v){v&&!this._shadow?this._shadow=this._elset[0].shadow():this._shadow&&(this._shadow.remove(),this._shadow.clear(),delete this._shadow)}},animDraw:{ini:"",combobox:["2s linear","2s ease","2s ease-in","2s ease-out","2s ease-in-out"],action:function(v){if(v&&Raphael.svg&&!this.box.$noShape){var prf=this,e=prf._elset[0],elm=e&&e.node;if(elm){var length=elm.getTotalLength(),style=elm.style,trans=function(v){style.transition=style[xui.browser.cssTag2+"Transition"]=v},bak1=style.strokeDasharray||"",bak2=style.strokeDashoffset||"";trans("none"),style.strokeDasharray=length+","+length,style.strokeDashoffset=length,elm.getBoundingClientRect(),trans("stroke-dashoffset "+v),style.strokeDashoffset=0,prf._flowthread&&xui.Thread.abort(prf._flowthread),xui.setTimeout((function(t){!prf.destroyed&&e&&elm&&(trans("none"),style.strokeDasharray=bak1,style.strokeDashoffset=bak2,(t=prf.properties.offsetFlow)&&prf.boxing().setOffsetFlow(t,!0))}),1e3*parseInt(v,10))}}}},offsetFlow:{ini:"",combobox:["none","2x","4x","8x","-2x","-4x","-8x"],action:function(v){if(Raphael.svg&&!this.box.$noShape){var arr,prf=this,elm=prf._elset[0],sum=0;if(prf._flowthread&&xui.Thread.abort(prf._flowthread),v){if(!(arr=xui(elm.node).attr("stroke-dasharray")))return;for(var i=0,l=(arr=arr.replace(/\s+/,"").split(",")).length;i<l;i++)sum+=parseInt(arr[i],10);if(sum>0){sum*=2;var offset=0,speed=parseInt(v,10);speed&&(prf._flowthread=xui.Thread.repeat((function(){if(prf.destroyed||!elm||!elm.attr)return!1;elm.attr("stroke-dashoffset",offset=(offset+speed)%sum)}),100).id)}}}}}},Behaviors:{HotKeyAllowed:!1,HoverEffected:{KEY:"KEY"},ClickEffected:{KEY:"KEY"},onClick:function(profile,e,src){return!profile.$inDesign&&!profile.properties.disabled&&(profile.onClick?profile.boxing().onClick(profile,e,src):void 0)},onDblclick:function(profile,e,src){return!profile.$inDesign&&!profile.properties.disabled&&(profile.onDblClick?profile.boxing().onDblClick(profile,e,src):void 0)},onContextmenu:function(profile,e,src){if(profile.onContextmenu)return!1!==profile.boxing().onContextmenu(profile,e,src)}},EventHandlers:{onClick:function(profile,e,src){},onDblClick:function(profile,e,src){},onContextmenu:function(profile,e,src){},onHotKeydown:null,onHotKeypress:null,onHotKeyup:null},_beforeSerialized:function(profile){var o=arguments.callee.upper.call(this,profile),prop=o.properties;return prop.attr=xui.clone(prop.attr,!0),xui.filter(prop.attr,(function(o,i){return!("transform"==i&&(!o||o.length<1))&&"href"!=i&&"target"!=i&&void("path"==i&&xui.isArr(prop.attr.path)&&(prop.attr.path=o.join("")))})),o},RenderTrigger:function(){var prf=this;(prf.$beforeDestroy=prf.$beforeDestroy||{}).svgClear=function(){prf._flowthread&&xui.Thread.abort(prf._flowthread),prf._elset&&(prf._elset.forEach((function(el){el&&delete el._rootNode})),prf._elset.remove(),prf._elset.clear(),delete prf._elset),prf._shadow&&(prf._shadow.remove(),prf._shadow.clear(),delete prf._shadow)},prf.box._initAttr2UI(prf),xui.setTimeout((function(){if(!prf.destroyed){var t,v,prop=prf.properties,ins=prf.boxing(),alln=ins.getAllNodes();(t=prop.animDraw)?ins.setAnimDraw(t,!0):(t=prop.offsetFlow)&&ins.setOffsetFlow(t,!0),(v=prop.visibility)&&alln.css("visibility",v),(v=prop.display)&&alln.css("display",v),(v=prop.className)&&alln.addClass(v)}}))},_RenderSVG:function(prf){prf._pathCached={};var p=prf.parent;if(p&&p._paper&&p._canvas){prf._elset=this._draw(p._paper,prf,prf.properties);for(var i=1,l=prf._elset.length;i<l;i++)prf._elset._rootNode=prf._elset[0]}},_adjustAttr:function(attr){var ns=this,attr2={},attr3=xui.svg.$attr;return xui.each(attr,(function(o,i){/^[A-Z_]+(_[0-9]+)?$/.test(i)&&xui.isHash(o)&&(-1!=i.indexOf("_")||i in ns.$tagName)?(attr2[i]=attr2[i]||{},xui.each(o,(function(o1,i1){attr3[ns.$tagName[i]||i.split("_")[0].toLowerCase()][i1]&&(attr2[i][i1]=o1)}))):attr3[ns.$tagName.KEY][i]&&(attr2.KEY=attr2.KEY||{},attr2.KEY[i]=o)})),attr2},_initAttr2UI:function(prf){var attr=this._adjustAttr(prf.properties.attr);prf._elset&&prf.boxing().setAttr(attr),prf.properties.shadow&&prf.boxing().setShadow(!0,!0)},$adjustBB:function(key,value){var bb="object"==typeof key?key:{},keys="left,top,right,bottom,x,y,x2,y2,width,height".split(",");return"string"==typeof key&&(bb[key]=value),xui.filter(bb,(function(v,k){return-1!=xui.arr.indexOf(keys,k)&&"auto"!==v&&""!==v&&(xui.isNumb(v)?void 0:(bb[k]=parseFloat(v)||0,!1))})),"left"in bb&&(bb.x=bb.left,delete bb.left),"top"in bb&&(bb.y=bb.top,delete bb.top),"right"in bb&&(bb.x2=bb.right,delete bb.right),"bottom"in bb&&(bb.y2=bb.bottom,delete bb.bottom),"x"in bb&&"width"in bb&&delete bb.x2,"y"in bb&&"height"in bb&&delete bb.y2,"x2"in bb&&("width"in bb?bb.x=bb.x2-bb.width:bb.width=bb.x2-bb.x,delete bb.x2),"y2"in bb&&("height"in bb?bb.y=bb.y2-bb.height:bb.height=bb.y2-bb.y,delete bb.y2),bb},$transform:function(opath,trans){xui.isStr(opath)||(opath=opath.join("")),opath=/[mlhvcsqtaz]/.test(opath)?Raphael._pathToAbsolute(opath):Raphael.parsePathString(opath);for(var ll,t,npath=Raphael.transformPath(opath,trans),rotate=/[r]/.test(trans),i=0,l=npath.length;i<l;i++)if(npath[i][0]!=opath[i][0])switch(ll=npath[i].length,t=opath[i][0]){case"M":break;case"L":npath[i]=[t,npath[i][ll-2],npath[i][ll-1]];break;case"H":npath[i]=rotate?["L",npath[i][ll-2],npath[i][ll-1]]:[t,npath[i][ll-2]];break;case"V":npath[i]=rotate?["L",npath[i][ll-2],npath[i][ll-1]]:[t,npath[i][ll-1]];break;case"C":break;case"Q":npath[i]=[t,npath[i][ll-6],npath[i][ll-5],npath[i][ll-2],npath[i][ll-1]];break;case"S":npath[i]=[t,npath[i][ll-4],npath[i][ll-3],npath[i][ll-2],npath[i][ll-1]];break;case"T":npath[i]=[t,npath[i][ll-2],npath[i][ll-1]];break;case"A":break;case"Z":npath[i]=[t];break;default:continue}return npath.join("")},$setBB:function(prf,type,bbox,attr,el,notify){var h={},copy=function(o){var a={};for(var i in o)a[i]=o[i];return a};switch(type){case"circle":xui.isNumb(bbox.width)&&(h.r=bbox.width/2),xui.isNumb(bbox.height)&&(bbox.height/2>=attr.r&&(!xui.isSet(h.r)||h.r>=attr.r)?h.r=xui.isSet(h.r)?Math.max(h.r,bbox.height/2):bbox.height/2:h.r=xui.isSet(h.r)?Math.min(h.r,bbox.height/2):bbox.height/2),h.cx=xui.isNumb(bbox.x)?bbox.x+(xui.isSet(h.r)?h.r:attr.r):attr.cx+(xui.isSet(h.r)?h.r-attr.r:0),h.cy=xui.isNumb(bbox.y)?bbox.y+(xui.isSet(h.r)?h.r:attr.r):attr.cy+(xui.isSet(h.r)?h.r-attr.r:0);break;case"ellipse":xui.isNumb(bbox.width)&&(h.rx=bbox.width/2),xui.isNumb(bbox.height)&&(h.ry=bbox.height/2),h.cx=xui.isNumb(bbox.x)?bbox.x+(xui.isSet(h.rx)?h.rx:attr.rx):attr.cx+(xui.isSet(h.rx)?h.rx-attr.rx:0),h.cy=xui.isNumb(bbox.y)?bbox.y+(xui.isSet(h.ry)?h.ry:attr.ry):attr.cy+(xui.isSet(h.ry)?h.ry-attr.ry:0);break;case"rect":case"image":xui.isNumb(bbox.x)&&(h.x=bbox.x),xui.isNumb(bbox.y)&&(h.y=bbox.y),xui.isNumb(bbox.width)&&(h.width=bbox.width),xui.isNumb(bbox.height)&&(h.height=bbox.height);break;case"text":var textAnchor;if(el)el._.dirty=1,obbox=copy(el._getBBox(!0)),textAnchor=el.attr("text-anchor");else{var div=xui.Dom.getEmptyDiv();obbox=copy((t=(r=Raphael(div.get(0).id,1,1)).text(0,0,attr.text))._getBBox(!0)),textAnchor=t.attr("text-anchor"),t.remove(),r.remove(),div.empty()}xui.isNumb(bbox.x)&&(obbox.x=bbox.x),xui.isNumb(bbox.y)&&(obbox.y=bbox.y);var ha=attr.hAlign||"center",va=attr.vAlign||"middle",offsetx=obbox?"start"==textAnchor?-obbox.width/2:"middle"==textAnchor?0:obbox.width/2:0;xui.isNumb(bbox.x)&&("center"==ha?xui.isNumb(bbox.width)?h.x=bbox.x+bbox.width/2:h.x=bbox.x+(obbox?obbox.width/2:0):"left"==ha?h.x=bbox.x+(obbox?obbox.width/2:0):"outterleft"==ha?h.x=bbox.x-(obbox?obbox.width/2:0):"right"==ha?xui.isNumb(bbox.width)&&(h.x=bbox.x+bbox.width-(obbox?obbox.width/2:0)):"outterright"==ha?xui.isNumb(bbox.width)&&(h.x=bbox.x+bbox.width+(obbox?obbox.width/2:0)):xui.isNumb(bbox.width)?h.x=bbox.x+bbox.width*parseFloat(ha)/100:h.x=bbox.x+(obbox?obbox.width*parseFloat(ha)/100:0),h.x+=offsetx),xui.isNumb(bbox.y)&&("middle"==va?xui.isNumb(bbox.height)?h.y=bbox.y+bbox.height/2:h.y=bbox.y+(obbox?obbox.height/2:0):"top"==va?h.y=bbox.y+(obbox?obbox.height/2:0):"outtertop"==va?h.y=bbox.y-(obbox?obbox.height/2:0):"bottom"==va?xui.isNumb(bbox.height)&&(h.y=bbox.y+bbox.height-(obbox?obbox.height/2:0)):"outterbottom"==va?xui.isNumb(bbox.height)&&(h.y=bbox.y+bbox.height+(obbox?obbox.height/2:0)):xui.isNumb(bbox.height)?h.y=bbox.y+bbox.height*parseFloat(va)/100:h.y=bbox.y+(obbox?obbox.height*parseFloat(va)/100:0));break;case"path":var obbox,r,t;if(el)el._.dirty=1,obbox=copy(el._getBBox(!0));else div=xui.Dom.getEmptyDiv(),(t=(r=Raphael(div.get(0).id,1,1)).path("")).attr(attr),obbox=copy(t._getBBox(!0)),t.remove(),r.remove(),div.empty();var obbox2=copy(obbox);if(xui.isNumb(bbox.x)&&(h.x=bbox.x),xui.isNumb(bbox.y)&&(h.y=bbox.y),xui.isNumb(bbox.width)&&(h.width=bbox.width),xui.isNumb(bbox.height)&&(h.height=bbox.height),"x"in h&&obbox.x!==h.x||"y"in h&&obbox.y!==h.y){var x=0,y=0;"x"in h&&(x=h.x-obbox.x,obbox.x=h.x),"y"in h&&(y=h.y-obbox.y,obbox.y=h.y);for(var paths=Raphael.parsePathString(attr.path),i=0,ii=paths.length;i<ii;i++)switch(l=paths[i].length,paths[i][0]){case"M":case"L":paths[i][1]+=x,paths[i][2]+=y;break;case"H":paths[i][1]+=x;break;case"V":paths[i][1]+=y;break;case"C":paths[i][1]+=x,paths[i][2]+=y,paths[i][3]+=x,paths[i][4]+=y,paths[i][5]+=x,paths[i][6]+=y;break;case"Q":case"S":paths[i][1]+=x,paths[i][2]+=y,paths[i][3]+=x,paths[i][4]+=y;break;case"T":paths[i][1]+=x,paths[i][2]+=y;break;case"A":paths[i][l-2]+=x,paths[i][l-1]+=y;continue;default:continue}h.path=paths.join("")}if("width"in h&&obbox.width!==h.width||"height"in h&&obbox.height!==h.height){var ww="width"in h?h.width:null,hh="height"in h?h.height:null,opath=h.path||attr.path,npath=xui.svg.$transform(opath,"s"+(xui.isSet(ww)&&ww!==obbox2.width?0===obbox2.width?ww>=0?1.1:.9:ww/obbox2.width:"1")+","+(xui.isSet(hh)&&hh!==obbox2.height?0===obbox2.height?hh>=0?1.1:.9:hh/obbox2.height:"1")+","+obbox.x+","+obbox.y);h.path=npath}}var attr2=xui.svg.$attr[type];if(xui.filter(h,(function(o,i){if(!xui.isSet(o)||!(i in attr2))return!1;attr[i]=o})),el&&!xui.isEmpty(h)){var withTransform,ts=Raphael.parseTransformString(el.transform());if(ts&&ts.length){withTransform=1,el.transform("");for(var rot,ir=-1,it=-1,l=(i=0,ts.length);i<l;i++)"r"==ts[i][0]?(ir=i,rot=ts[i][1]):"t"==ts[i][0]&&(it=i);if(-1!=it&&-1!=ir){el.rotate(rot);var ts2=Raphael.parseTransformString(el.transform());el.transform(""),ts[it][1]-=ts2[0][1],ts[it][2]-=ts2[0][2],ts[it][1]||ts[it][2]||xui.arr.removeFrom(ts,it)}}el.attr(h),withTransform&&el.transform("r"+rot),!1!==notify&&prf.box._notify(prf,{bBox:1},!0)}},_syncAttr:function(prf,options,shapeChanged){prf._pathCached={}},_notify:function(prf,options,shapeChanged){prf.box._syncAttr&&prf.box._syncAttr(prf,options,shapeChanged),shapeChanged&&!prf.box._CONNECTOR&&prf.box._syncConnectors&&prf.box._syncConnectors(prf),shapeChanged&&prf._shadow&&prf.boxing().setShadow(!1).setShadow(!0)},_draw:function(){},_syncConnectors:function(prf){if("xui.UI.SVGPaper"===prf.parent.key){var children=xui.get(prf,["parent","children"]),alias=prf.alias;children&&children.length&&xui.arr.each(children,(function(o,i){!o[0].destroyed&&prf.renderCompleted&&o[0].renderCompleted&&"xui.svg.connector"===o[0].key&&(alias===xui.get(o[0],["properties","fromObj"])&&o[0].box._reconnect(o[0],prf),alias===xui.get(o[0],["properties","toObj"])&&o[0].box._reconnect(o[0],null,prf))}))}},_syncAlias:function(prf,oa,na){var children=xui.get(prf,["parent","children"]);children&&children.length&&xui.arr.each(children,(function(o,i){"xui.svg.connector"===o[0].key&&(oa===xui.get(o[0],["properties","fromObj"])&&xui.set(o[0],["properties","fromObj"],na),oa===xui.get(o[0],["properties","toObj"])&&xui.set(o[0],["properties","toObj"],na))}))}}}),xui.Class("xui.svg.circle","xui.svg",{Instance:{_setBBox:function(key,value){var bb=xui.svg.$adjustBB(key,value);return this.each((function(prf){xui.svg.$setBB(prf,"circle",bb,prf.properties.attr,prf._elset&&prf._elset[0])}))}},Static:{DataModel:{attr:{ini:{cx:0,cy:0,r:20}}},Templates:{tagName:"circle"},_draw:function(paper,prf,prop){prop=prop.attr;var el=paper.circle(prop.cx,prop.cy,prop.r);return el.node.id=prf.box.KEY+":"+prf.serialId+":",paper.set().push(el)}}}),xui.Class("xui.svg.ellipse","xui.svg",{Instance:{_setBBox:function(key,value){var bb=xui.svg.$adjustBB(key,value);return this.each((function(prf){xui.svg.$setBB(prf,"ellipse",bb,prf.properties.attr,prf._elset&&prf._elset[0])}))}},Static:{DataModel:{attr:{ini:{cx:0,cy:0,rx:20,ry:40}}},Templates:{tagName:"ellipse"},_draw:function(paper,prf,prop){prop=prop.attr;var el=paper.ellipse(prop.cx,prop.cy,prop.rx,prop.ry);return el.node.id=prf.box.KEY+":"+prf.serialId+":",paper.set().push(el)}}}),xui.Class("xui.svg.rect","xui.svg",{Instance:{_setBBox:function(key,value){var bb=xui.svg.$adjustBB(key,value);return this.each((function(prf){xui.svg.$setBB(prf,"rect",bb,prf.properties.attr,prf._elset&&prf._elset[0])}))}},Static:{DataModel:{attr:{ini:{x:0,y:0,r:0,width:40,height:40}}},Templates:{tagName:"rect"},_draw:function(paper,prf,prop){prop=prop.attr;var el=paper.rect(prop.x,prop.y,prop.width,prop.height,prop.r);return el.node.id=prf.box.KEY+":"+prf.serialId+":",paper.set().push(el)}}}),xui.Class("xui.svg.image","xui.svg",{Instance:{_setBBox:function(key,value){var bb=xui.svg.$adjustBB(key,value);return this.each((function(prf){xui.svg.$setBB(prf,"image",bb,prf.properties.attr,prf._elset&&prf._elset[0])}))}},Static:{$noShape:1,IMGNODE:1,DataModel:{attr:{ini:{src:"",x:0,y:0,width:20,height:20}}},Templates:{tagName:"image"},_draw:function(paper,prf,prop){prop=prop.attr;var el=paper.image(xui.adjustRes(prop.src),prop.x,prop.y,prop.width,prop.height);return el.node.id=prf.box.KEY+":"+prf.serialId+":",paper.set().push(el)}}}),xui.Class("xui.svg.text","xui.svg",{Instance:{_setBBox:function(key,value){var bb=xui.svg.$adjustBB(key,value);return this.each((function(prf){xui.svg.$setBB(prf,"text",bb,prf.properties.attr,prf._elset&&prf._elset[0])}))}},Static:{$noShape:1,DataModel:{attr:{ini:{x:0,y:0,text:"text"}},text:{ini:undefined,hidden:!0,set:function(value){this.boxing().setAttr("KEY",{text:this.properties.text=value||""},!1)}}},Templates:{tagName:"text"},_draw:function(paper,prf,prop){prop=prop.attr;var el=paper.text(prop.x,prop.y,prop.text);return xui.isSet(prop.text)&&el.attr("text",prop.text),el.node.id=prf.box.KEY+":"+prf.serialId+":",paper.set().push(el)}}}),xui.Class("xui.svg.path","xui.svg",{Instance:{getPath:function(){var prf=this.get(0),prop=prf.properties;return prf._elset&&prf._elset[0]&&(prop.path=prf._elset[0].attr("path").join("")),prop.path},_getConnectAnchors:function(){},_setBBox:function(key,value){var bb=xui.svg.$adjustBB(key,value);return this.each((function(prf){xui.svg.$setBB(prf,"path",bb,prf.properties.attr,prf._elset&&prf._elset[0])}))}},Static:{$abstract:!0,_draw:function(paper,prf,prop){prop=prop.attr;var el=paper.path(prop.path);return el.node.id=prf.box.KEY+":"+prf.serialId+":",paper.set().push(el)},DataModel:{attr:{ini:{path:""}}},Templates:{tagName:"path"}}}),xui.Class("xui.svg.absComb","xui.svg",{Instance:{_setBBox:function(key,value,notify){var bb=xui.svg.$adjustBB(key,value);return this.each((function(prf){var prop=prf.properties,ss=prf._elset;if(xui.svg.$setBB(prf,prf.box._type,bb,prop.attr.KEY,ss&&ss[0]),prf.renderId&&ss&&ss[0]&&prop.attr.TEXT&&prop.attr.TEXT.text){var attr=xui.copy(prop.attr.TEXT||{}),att2=ss[0]._getBBox(!0);attr.hAlign=prop.hAlign,attr.vAlign=prop.vAlign,"x"in bb||(bb.x=att2.x),"y"in bb||(bb.y=att2.y),"width"in bb||(bb.width=att2.width),"height"in bb||(bb.height=att2.height),xui.svg.$setBB(prf,"text",bb,attr,ss&&ss[1],notify)}}))},_adjustText:function(){return this.each((function(prf){var prop=prf.properties,ss=prf._elset;if(prf.renderId&&ss&&ss[0]&&prop.attr.TEXT&&prop.attr.TEXT.text){var attr=xui.copy(prop.attr.TEXT||{}),att2=ss[0]._getBBox(!0);attr.hAlign=prop.hAlign,attr.vAlign=prop.vAlign,xui.svg.$setBB(prf,"text",att2,attr,ss[1],!1)}}))},setAttr:function(key,value,reset,notify){var h;return xui.isHash(key)?h=key:(h={})[key]=value,arguments.callee.upper.call(this,key,value,reset,notify),this.each((function(prf){prf._elset&&(h=h.TEXT)&&h["text-anchor"]&&prf.boxing()._adjustText()}))}},Static:{$abstract:!0,ISCOMBO:1,_beforeSerialized:function(profile){var o=arguments.callee.upper.call(this,profile),prop=o.properties;return prop.attr=xui.clone(prop.attr,!0),xui.filter(prop.attr.KEY,(function(o,i){return!("transform"==i&&(!o||o.length<1))&&"href"!=i&&"target"!=i&&void("path"==i&&xui.isArr(prop.attr.KEY.path)&&(prop.attr.KEY.path=o.join("")))})),prop.attr.TEXT&&xui.filter(prop.attr.TEXT,(function(o,i){return"transform"!=i&&"x"!=i&&"y"!=i&&"href"!=i&&"target"!=i&&void 0})),delete prop.text,o},DataModel:{attr:{ini:{KEY:{},TEXT:{}}},hAlign:{ini:"center",combobox:["left","25%","center","75%","right","outterleft","outterright"],action:function(){this.boxing()._adjustText()}},vAlign:{ini:"middle",combobox:["top","25%","middle","75%","bottom","outtertop","outterbottom"],action:function(){this.boxing()._adjustText()}},text:{ini:undefined,hidden:!0,get:function(){var att=this.boxing().getAttr("TEXT");return att&&att.text},set:function(value){this.boxing().setAttr("TEXT",{text:value||""},!1)}},shadow:!0},Behaviors:{onClick:function(profile,e,src){return!profile.$inDesign&&!profile.properties.disabled&&(profile.onClick?profile.boxing().onClick(profile,e,src):void 0)},onDblclick:function(profile,e,src){return!profile.$inDesign&&!profile.properties.disabled&&(profile.onDblClick?profile.boxing().onDblClick(profile,e,src):void 0)},onContextmenu:function(profile,e,src){if(profile.onContextmenu)return!1!==profile.boxing().onContextmenu(profile,e,src)},TEXT:{onClick:function(profile,e,src){return!profile.$inDesign&&!profile.properties.disabled&&(profile.onTextClick&&(rtn=profile.boxing().onTextClick(profile,e,src)),!1!==rtn&&profile.onClick?profile.boxing().onClick(profile,e,src):void 0);var rtn},onDblclick:function(profile,e,src){return!profile.$inDesign&&!profile.properties.disabled&&(profile.onDblClick?profile.boxing().onDblClick(profile,e,src):void 0)},onContextmenu:function(profile,e,src){if(profile.onContextmenu)return!1!==profile.boxing().onContextmenu(profile,e,src)}}},EventHandlers:{onTextClick:function(profile,e,src){}},_initAttr2UI:function(prf){arguments.callee.upper.call(this,prf),prf.boxing()._adjustText();var ss=prf._elset;if(ss&&ss[1])for(var tf=ss[0].attr("transform"),i=1,l=ss.length;i<l;i++)ss[i].attr("transform",tf)},_syncAttr:function(prf,options,shapeChanged){var upper=arguments.callee.upper,args=xui.toArr(arguments);upper.apply(this,args),upper=null,shapeChanged&&prf.boxing()._adjustText()},_draw:function(paper,prf,prop){var s=paper.set(),attr=prop.attr.KEY,att2=prop.attr.TEXT,el=this._drawRoot(paper,attr);return el.node.id=prf.box.KEY+":"+prf.serialId+":",s.push(el),(el=paper.text(attr.x,attr.y,att2.text)).node.id=prf.box.KEY+"-TEXT:"+prf.serialId+":",s.push(el),s}}}),xui.Class("xui.svg.rectComb","xui.svg.absComb",{Static:{_type:"rect",Templates:{tagName:"rect",TEXT:{tagName:"text",svg:1}},_drawRoot:function(paper,attr){return paper.rect(attr.x,attr.y,attr.width,attr.height)}}}),xui.Class("xui.svg.circleComb","xui.svg.absComb",{Static:{_type:"circle",Templates:{tagName:"circle",TEXT:{tagName:"text",svg:1}},_drawRoot:function(paper,attr){return paper.circle(attr.cx,attr.cy,attr.r)}}}),xui.Class("xui.svg.ellipseComb","xui.svg.absComb",{Static:{_type:"ellipse",Templates:{tagName:"ellipse",TEXT:{tagName:"text",svg:1}},_drawRoot:function(paper,attr){return paper.ellipse(attr.cx,attr.cy,attr.rx,attr.ry)}}}),xui.Class("xui.svg.pathComb","xui.svg.absComb",{Static:{_type:"path",Templates:{tagName:"path",TEXT:{tagName:"text",svg:1}},_drawRoot:function(paper,attr){return paper.path(attr.path)}}}),xui.Class("xui.svg.imageComb","xui.svg.absComb",{Static:{IMGNODE:1,$noShape:1,_type:"image",Templates:{tagName:"image",TEXT:{tagName:"text",svg:1}},_drawRoot:function(paper,attr){return paper.image(attr.src,attr.x,attr.y,attr.width,attr.height)}}}),xui.Class("xui.svg.connector","xui.svg.absComb",{Instance:{_getConnectAnchors:null,_getConnectPath:null,_getConnectPoint:null,toFront:function(){return this.each((function(prf){(prf=prf._elset)&&(prf[1].toFront(),prf[0].toFront());var arr=xui.get(prf,["parent","children"]);if(arr&&arr.length){var o,index=xui.arr.subIndexOf(arr,"0",prf);-1!=index&&(o=arr[index],arr.splice(index,1),arr.push(o))}}))},toBack:function(){return this.each((function(prf){(prf=prf._elset)&&(prf[0].toBack(),prf[1].toBack());var arr=xui.get(prf,["parent","children"]);if(arr&&arr.length){var o,index=xui.arr.subIndexOf(arr,"0",prf);-1!=index&&(o=arr[index],arr.splice(index,1),arr.unshift(o))}}))}},Static:{_CONNECTOR:!0,_beforeSerialized:function(profile){var o=arguments.callee.upper.call(this,profile),prop=o.properties;return prop.attr.BG&&(delete prop.attr.BG.path,delete prop.attr.BG["arrow-start"],delete prop.attr.BG["arrow-end"]),o},DataModel:{hAlign:null,vAlign:null,shadow:null,bgLine:{ini:!0,action:function(v){this._bg&&(v?this._bg.show():this._bg.hide())}},attr:{ini:{KEY:{path:""}}},type:{ini:"straight",listbox:["straight","bezier","flowchart"],action:function(v,ov){this.renderId&&(this.properties.type=ov)}},fromObj:"",fromPoint:{ini:"",combobox:["left","top","right","bottom"]},toObj:"",toPoint:{ini:"",combobox:["left","top","right","bottom"]}},_type:"path",Templates:{tagName:"path",BG:{tagName:"path",svg:1}},_draw:function(paper,prf,prop){var obj1,obj2,s=paper.set(),attr=prop.attr.KEY;return(obj2=paper.path(attr.path)).node.id=prf.box.KEY+":"+prf.serialId+":",obj2.onShapeChanged=function(attr){attr.path&&obj1.attr({path:attr.path},null,!1)},s.push(obj2),obj1=paper.path(attr.path),prf.properties.bgLine||obj1.hide(),obj1.node.id=prf.box.KEY+"-BG:"+prf.serialId+":",s.push(obj1),obj1.insertBefore(obj2),prf._bg=obj1,(prf.$beforeDestroy=prf.$beforeDestroy||{}).unbind=function(){obj2.onShapeChanged=null,obj2=null},s},_syncAttr:function(prf,options,shapeChanged){var upper=arguments.callee.upper,args=xui.toArr(arguments);if(upper.apply(this,args),upper=null,prf._pathCached={},prf._bg){var a,k,ns=this,prop=prf.properties,t=prf._elset[0],h={};((k="path")in options||"bBox"in options)&&(h[k]=t.attr(k)),(k="arrow-start")in options&&("none"!=(a=(a=t.attr(k)).split("-"))[0]?h[k]=a[0]+"-narrow-short":h[k]="none"),(k="arrow-end")in options&&("none"!=(a=(a=t.attr(k)).split("-"))[0]?h[k]=a[0]+"-narrow-short":h[k]="none"),prf._bg.attr(h,null,!1),"bBox"in options&&prf.parent&&(prop.fromObj&&prop.fromPoint&&xui.arr.each(prf.parent.children,(function(o){if(o[0].alias==prop.fromObj)return ns._reconnect(prf,o[0]),!1})),prop.toObj&&prop.toPoint&&xui.arr.each(prf.parent.children,(function(o){if(o[0].alias==prop.toObj)return ns._reconnect(prf,null,o[0]),!1})))}},_reconnect:function(prf,fromPrf,toPrf){if(!prf.destroyed){var cp,prop=prf.properties,type=prop.type,path=Raphael.parsePathString(prop.attr.KEY.path),conn=prf.boxing();if(fromPrf&&prop.fromObj&&prop.fromPoint&&(cp=fromPrf.boxing()._getConnectPoint(prop.fromPoint))){switch(type){case"flowchart":(np=this._redrawBrokenLine(prf))&&(path.length=0,xui.arr.each(np,(function(p){path.push(p)})));break;case"straight":path[0][1]=cp.x,path[0][2]=cp.y;break;case"bezier":var ox=cp.x-path[0][1],oy=cp.y-path[0][2];path[0][1]=cp.x,path[0][2]=cp.y,path[1][1]+=ox,path[1][2]+=oy}conn.setAttr("KEY",{path:path},!1)}if(toPrf&&prop.toObj&&prop.toPoint&&(cp=toPrf.boxing()._getConnectPoint(prop.toPoint))){var l=path.length-1;switch("Z"==(path[l][0]||"").toUpperCase()&&l--,type){case"flowchart":var np;(np=this._redrawBrokenLine(prf))&&(path.length=0,xui.arr.each(np,(function(p){path.push(p)})));break;case"straight":path[l][1]=cp.x,path[l][2]=cp.y;break;case"bezier":ox=cp.x-path[l][5],oy=cp.y-path[l][6],path[l][5]=cp.x,path[l][6]=cp.y,path[l][3]+=ox,path[l][4]+=oy}conn.setAttr("KEY",{path:path},!1)}}},_redrawBrokenLine:function(prf,inputPoint,x,y){var startPoints,endPoints,ins,sPath,ePath,sBox,eBox,sPoint,ePoint,angle,sCenter,eCenter,sdir,edir,t,offsetx=30,offsety=30,prop=prf.properties,attr=prop.attr.KEY,opath=Raphael.parsePathString(attr.path),startConn=prop.fromObj&&prop.fromPoint,endConn=prop.toObj&&prop.toPoint,startPath=[],endPath=[],startPathLen=[],endPathLen=[];if(startConn&&(ins=null,xui.arr.each(prf.parent.children,(function(p){if(p[0].alias==prop.fromObj)return ins=p[0].boxing(),(sPoint=ins._getConnectPoint(prop.fromPoint))&&(sPath=ins._getConnectPath(),(sBox=xui.get(p[0]._pathCached,["_connBBox"]))||(sBox=Raphael.pathBBox(sPath),xui.set(p[0]._pathCached,["_connBBox"],sBox)),angle=sPoint.solid?sPoint.alpha:sPoint.alpha-90,sCenter={x:sBox.x+sBox.width/2,y:sBox.y+sBox.height/2},"down"==(sdir=angle>45&&angle<=135?"down":angle>135&&angle<=225?"left":angle>225&&angle<=315?"up":"right")&&sPoint.y<sCenter.y&&(sdir="up"),"right"==sdir&&sPoint.x<sCenter.x&&(sdir="left")),!1}))),endConn&&(ins=null,xui.arr.each(prf.parent.children,(function(p){if(p[0].alias==prop.toObj)return ins=p[0].boxing(),(ePoint=ins._getConnectPoint(prop.toPoint))&&(ePath=ins._getConnectPath(),(eBox=xui.get(p[0]._pathCached,["_connBBox"]))||(eBox=Raphael.pathBBox(ePath),xui.set(p[0]._pathCached,["_connBBox"],eBox)),angle=ePoint.solid?ePoint.alpha:ePoint.alpha-90,eCenter={x:eBox.x+eBox.width/2,y:eBox.y+eBox.height/2},"down"==(edir=angle>45&&angle<=135?"down":angle>135&&angle<=225?"left":angle>225&&angle<=315?"up":"right")&&ePoint.y<eCenter.y&&(edir="up"),"right"==edir&&ePoint.x<eCenter.x&&(edir="left")),!1}))),sPoint&&ePoint&&(("left"==sdir&&"right"==edir&&ePoint.x>=sPoint.x||"right"==sdir&&"left"==edir&&ePoint.x<=sPoint.x)&&(offsetx=Math.min(offsetx,Math.abs(ePoint.x-sPoint.x)/2)),("down"==sdir&&"up"==edir&&ePoint.y>=sPoint.y||"up"==sdir&&"down"==edir&&ePoint.y<=sPoint.y)&&(offsety=Math.min(offsety,Math.abs(ePoint.y-sPoint.y)/2))),sPoint)switch(sdir){case"down":startPoints=[{x:sPoint.x,y:t=sPoint.y+offsety},{x:sBox.x-30,y:t},{x:sBox.x+30+sBox.width,y:t}],startPath=[[["M",sPoint.x,sPoint.y],["V",startPoints[0].y]],[["M",sPoint.x,sPoint.y],["V",startPoints[0].y],["H",startPoints[1].x]],[["M",sPoint.x,sPoint.y],["V",startPoints[0].y],["H",startPoints[2].x]]],startPathLen=[offsety,offsety+Math.abs(startPoints[1].x-startPoints[0].x),offsety+Math.abs(startPoints[2].x-startPoints[0].x)];break;case"left":startPoints=[{x:t=sPoint.x-offsetx,y:sPoint.y},{x:t,y:sBox.y-30},{x:t,y:sBox.y+30+sBox.height}],startPath=[[["M",sPoint.x,sPoint.y],["H",startPoints[0].x]],[["M",sPoint.x,sPoint.y],["H",startPoints[0].x],["V",startPoints[1].y]],[["M",sPoint.x,sPoint.y],["H",startPoints[0].x],["V",startPoints[2].y]]],startPathLen=[offsetx,offsetx+Math.abs(startPoints[1].y-startPoints[0].y),offsetx+Math.abs(startPoints[2].y-startPoints[0].y)];break;case"up":startPoints=[{x:sPoint.x,y:t=sPoint.y-offsety},{x:sBox.x-30,y:t},{x:sBox.x+30+sBox.width,y:t}],startPath=[[["M",sPoint.x,sPoint.y],["V",startPoints[0].y]],[["M",sPoint.x,sPoint.y],["V",startPoints[0].y],["H",startPoints[1].x]],[["M",sPoint.x,sPoint.y],["V",startPoints[0].y],["H",startPoints[2].x]]],startPathLen=[offsety,offsety+Math.abs(startPoints[1].x-startPoints[0].x),offsety+Math.abs(startPoints[2].x-startPoints[0].x)];break;case"right":startPoints=[{x:t=sPoint.x+offsetx,y:sPoint.y},{x:t,y:sBox.y-30},{x:t,y:sBox.y+30+sBox.height}],startPath=[[["M",sPoint.x,sPoint.y],["H",startPoints[0].x]],[["M",sPoint.x,sPoint.y],["H",startPoints[0].x],["V",startPoints[1].y]],[["M",sPoint.x,sPoint.y],["H",startPoints[0].x],["V",startPoints[2].y]]],startPathLen=[offsetx,offsetx+Math.abs(startPoints[1].y-startPoints[0].y),offsetx+Math.abs(startPoints[2].y-startPoints[0].y)]}else startPoints="start"==inputPoint?[{x:x,y:y}]:[{x:opath[0][1],y:opath[0][2]}],startPath=[[["M",startPoints[0].x,startPoints[0].y]]],startPathLen=[0];if(ePoint)switch(edir){case"down":endPoints=[{x:ePoint.x,y:t=ePoint.y+offsety},{x:eBox.x-30,y:t},{x:eBox.x+30+eBox.width,y:t}],endPath=[[["V",ePoint.y]],[["H",ePoint.x],["V",ePoint.y]],[["H",ePoint.x],["V",ePoint.y]]],endPathLen=[offsety,offsety+Math.abs(endPoints[1].x-endPoints[0].x),offsety+Math.abs(endPoints[2].x-endPoints[0].x)];break;case"left":endPoints=[{x:t=ePoint.x-offsetx,y:ePoint.y},{x:t,y:eBox.y-30},{x:t,y:eBox.y+30+eBox.height}],endPath=[[["H",ePoint.x]],[["V",ePoint.y],["H",ePoint.x]],[["V",ePoint.y],["H",ePoint.x]]],endPathLen=[offsetx,offsetx+Math.abs(endPoints[1].y-endPoints[0].y),offsetx+Math.abs(endPoints[2].y-endPoints[0].y)];break;case"up":endPoints=[{x:ePoint.x,y:t=ePoint.y-offsety},{x:eBox.x-30,y:t},{x:eBox.x+30+eBox.width,y:t}],endPath=[[["V",ePoint.y]],[["H",ePoint.x],["V",ePoint.y]],[["H",ePoint.x],["V",ePoint.y]]],endPathLen=[offsety,offsety+Math.abs(endPoints[1].x-endPoints[0].x),offsety+Math.abs(endPoints[2].x-endPoints[0].x)];break;case"right":endPoints=[{x:t=ePoint.x+offsetx,y:ePoint.y},{x:t,y:eBox.y-30},{x:t,y:eBox.y+30+eBox.height}],endPath=[[["H",ePoint.x]],[["V",ePoint.y],["H",ePoint.x]],[["V",ePoint.y],["H",ePoint.x]]],endPathLen=[offsetx,offsetx+Math.abs(endPoints[1].y-endPoints[0].y),offsetx+Math.abs(endPoints[2].y-endPoints[0].y)]}else{if("end"==inputPoint)endPoints=[{x:x,y:y}];else{var p={x:opath[0][1],y:opath[0][2]};xui.arr.each(opath,(function(o){"H"==o[0]?p.x=o[1]:p.y=o[1]})),endPoints=[p]}endPath=[],endPathLen=[0]}var path,inter,paths=[];return xui.arr.each(startPoints,(function(sp,i){xui.arr.each(endPoints,(function(ep,j){for(var k=0;k<=1;k++)path=xui.clone(startPath[i],!0),0===k?(ep.x!==sp.x&&path.push(["H",ep.x]),ep.y!==sp.y&&path.push(["V",ep.y])):(ep.y!==sp.y&&path.push(["V",ep.y]),ep.x!==sp.x&&path.push(["H",ep.x])),endPath[j]&&endPath[j].length&&xui.arr.insertAny(path,endPath[j]),paths.push({path:path,len:path.length,len2:(startPathLen[i]||0)+(endPathLen[j]||0)+Math.abs(ep.x-sp.x)+Math.abs(ep.y-sp.y)})}))})),xui.filter(paths,(function(o){for(var xdir,ydir,preType,ox=o.path[0][1],oy=o.path[0][2],i=1,l=o.path.length;i<l;i++){if(preType==o.path[i][0]){if("H"==preType){if(o.path[i][1]>ox===xdir){o.path.splice(i-1,1),o.len--,l--,i--;continue}return!1}if(o.path[i][1]>oy===ydir){o.path.splice(i-1,1),o.len--,l--,i--;continue}return!1}"H"==o.path[i][0]?(xdir=o.path[i][1]>ox,ox=o.path[i][1]):(ydir=o.path[i][1]>oy,oy=o.path[i][1]),preType=o.path[i][0]}})),xui.arr.each(paths,(function(o){var cx,cy;inter=0,(sBox||eBox)&&(cx=o.path[0][1],cy=o.path[0][2],xui.arr.each(o.path,(function(p,i){0!==i&&("H"==p[0]?(sBox&&cy>=sBox.y&&cy<=sBox.y2&&Math.max(cx,p[1])>Math.min(sBox.x,sBox.x2)&&Math.min(cx,p[1])<Math.max(sBox.x,sBox.x2)&&inter++,eBox&&cy>=eBox.y&&cy<=eBox.y2&&Math.max(cx,p[1])>Math.min(eBox.x,eBox.x2)&&Math.min(cx,p[1])<Math.max(eBox.x,eBox.x2)&&inter++,cx=p[1]):(sBox&&cx>=sBox.x&&cx<=sBox.x2&&Math.max(cy,p[1])>Math.min(sBox.y,sBox.y2)&&Math.min(cy,p[1])<Math.max(sBox.y,sBox.y2)&&inter++,eBox&&cx>=eBox.x&&cx<=eBox.x2&&Math.max(cy,p[1])>Math.min(eBox.y,eBox.y2)&&Math.min(cy,p[1])<Math.max(eBox.y,eBox.y2)&&inter++,cy=p[1]))}))),o.inter=inter})),xui.arr.stableSort(paths,(function(x,y){return x.inter>y.inter?1:x.inter<y.inter?-1:x.len>y.len?1:x.len<y.len?-1:x.len2>y.len2?1:x.len2==y.len2?0:-1})),prf.boxing().setAttr("KEY",{path:paths[0].path},!1),paths[0].path}}}),xui.Class("xui.svg.group","xui.svg.absComb",{Instance:{_adjustText:function(){return this},_setBBox:function(key,value,notify){var bb=xui.svg.$adjustBB(key,value);return this.each((function(prf){var prop=prf.properties,ss=prf._elset,attrs=prop.attr;if(prf.renderId&&ss&&ss[0]){var bbo=prf.boxing()._getBBox();ss.forEach((function(el){var attr=attrs[prf.getKey(el.node.id,!0)],bbn={};"text"==el.type?(bbn={x:attr.x,y:attr.y},"x"in bb&&(bbn.x+=bb.x-bbo.x),"y"in bb&&(bbn.y+=bb.y-bbo.y),attr.x=bbn.x,attr.y=bbn.y,el.attr(bbn)):(xui.merge(bbn,el._getBBox(!0),"all",!0),"x"in bb&&(bbn.x+=bb.x-bbo.x),"y"in bb&&(bbn.y+=bb.y-bbo.y),"width"in bb&&(bbn.width+=bb.width-bbo.width),"height"in bb&&(bbn.height+=bb.height-bbo.height),xui.svg.$setBB(prf,el.type,bbn,attr,el,notify))}))}else prf._init_bbox||(prf._init_bbox={}),xui.merge(prf._init_bbox,bb,"all",!0)}))}},Static:{ISCOMBO:1,_beforeSerialized:function(profile){var o=arguments.callee.upper.call(this,profile),prop=o.properties,attrs=prop.attr=xui.clone(prop.attr,!0);return xui.filter(attrs.KEY,(function(o,i){return!("transform"==i&&(!o||o.length<1))&&"href"!=i&&"target"!=i&&void("path"==i&&xui.isArr(prop.attr.KEY.path)&&(prop.attr.KEY.path=o.join("")))})),xui.each(attrs,(function(attr,key){"KEY"!=key&&(xui.filter(attr,(function(o,i){if("transform"==i)return!1})),"path"==key.split("_")[0]&&xui.each(attr,(function(o,i){"path"==i&&xui.isArr(o)&&(attr.path=o.join(""))})))})),o},_type:"path",Templates:{tagName:"path"},DataModel:{attr:{ini:{KEY:{}}},hAlign:null,vAlign:null,shadow:!1},RenderTrigger:function(){var bb;(bb=this._init_bbox)&&(this.boxing()._setBBox(bb),delete this._init_bbox)},_draw:function(paper,prf,prop){var s=paper.set(),attrs=prop.attr,rootattr=attrs.KEY||{path:""},el=paper.path(rootattr.path||"");return el._isGroupFirst=1,el.node.id=prf.box.KEY+":"+prf.serialId+":",s.push(el),xui.each(attrs,(function(attr,key){if("KEY"!=key){var type=key.split("_")[0].toLowerCase();switch(type){case"rect":el=paper.rect(attr.x,attr.y,attr.width,attr.height);break;case"circle":el=paper.circle(attr.cx,attr.cy,attr.r);break;case"ellipse":el=paper.ellipse(attr.cx,attr.cy,attr.rx,attr.ry);break;case"image":el=paper.image(attr.src,attr.x,attr.y,attr.width,attr.height);break;case"path":el=paper.path(attr.path);break;case"text":el=paper.text(attr.x,attr.y,attr.text);break;default:return}var src=xui(this.node).xid();"text"==type?el.click((function(e){return!prf.$inDesign&&!prf.properties.disabled&&(prf.onTextClick&&(rtn=prf.boxing().onTextClick(prf,e,src)),!1!==rtn&&prf.onClick?prf.boxing().onClick(prf,e,src):void 0);var rtn})):el.click((function(e){return!prf.$inDesign&&!prf.properties.disabled&&(prf.onClick?prf.boxing().onClick(prf,e,src):void 0)})),el.dblclick((function(e){return!prf.$inDesign&&!prf.properties.disabled&&(prf.onDblClick?prf.boxing().onDblClick(prf,e,src):void 0)})),el.contextmenu((function(e){if(prf.onContextmenu)return!1!==prf.boxing().onContextmenu(prf,e,src)})),el.node.id=prf.box.KEY+"-"+key+":"+prf.serialId+":",s.push(el)}})),s}}}),xui.Class("xui.UI.SVGPaper","xui.UI.Div",{Initialize:function(){this.addTemplateKeys(["SVG"])},Instance:{append:function(target,pre,base){(xui.isHash(target)||xui.isStr(target))&&(target=xui.create(target)),target["xui.UIProfile"]&&(target=target.boxing());var isSvg,rendersvg,ns=this,f=arguments.callee.upper;return target.each((function(prf){(isSvg=!!prf.box["xui.svg"])&&prf.renderId&&(prf.clearCache(),prf.$beforeDestroy.svgClear(),delete prf.renderId,delete prf.rendered,rendersvg=1),f.call(ns,prf,null,pre,base,isSvg,ns.get(0)&&xui(ns.get(0)._canvas)),rendersvg&&prf.box._initAttr2UI(prf)})),this},getPaper:function(){return xui.get(this.get(0),["_paper"])},getSVGString:function(){var paper=xui.get(this.get(0),["_paper"]);return paper?paper.toSVG():""}},Static:{DataModel:{iframeAutoLoad:null,html:null,width:{$spaceunit:1,ini:"32em"},height:{$spaceunit:1,ini:"25em"},scaleChildren:{ini:!1},overflow:{ini:undefined},graphicZIndex:{ini:0,action:function(v){this.getSubNode("SVG").css("zIndex",v)}}},RenderTrigger:function(){var profile=this,root=profile.getRootNode(),prop=profile.properties,w=xui.CSS.$px(prop.width,root,!0),h=xui.CSS.$px(prop.height,root,!0);(profile.$beforeDestroy=profile.$beforeDestroy||{}).svgClear=function(){profile._paper&&(profile._paper.clear(),profile._paper.remove())},profile._paper=Raphael(profile.$domId,w,h),profile._canvas=profile._paper.canvas,profile._canvas.id=profile.box.KEY+"-SVG:"+profile.serialId+":";var s=profile._canvas.style;s.position="absolute",s.left=0,s.top=0,s.zIndex=prop.graphicZIndex;var a=[];xui.arr.each(profile.children,(function(o){o[0].box["xui.svg"]&&a.push(o[0])})),a.length&&(profile.boxing().append(xui.svg.pack(a)),Raphael.svg||xui.setTimeout((function(){profile&&!profile.destroyed&&profile.boxing().append(xui.svg.pack(a))}))),profile._paper&&xui.setTimeout((function(){if(profile&&!profile.destroyed){var size=profile._paper.getSize();profile.$designerRoot?profile._frame=profile._paper.rect(0,0,1,1,0).attr({"stroke-width":"0px"}):profile.$inDesign&&(profile._frame=profile._paper.rect(0,0,size.width,size.height,8).attr({"stroke-dasharray":". ",stroke:"#666"})),profile._frame&&(profile._frame._decoration=1)}}))},_onresize:function(profile,width,height){var ow,oh,paper=profile._paper,scaleChildren=profile.properties.scaleChildren;if(xui.$us(profile),width=width?profile.$px(width,null,!0):width,height=height?profile.$px(height,null,!0):height,scaleChildren&&(ow=profile.$px(paper.width,null,!0),oh=profile.$px(paper.height,null,!0)),paper){var pw=profile.$px(paper.width,null,!0),ph=profile.$px(paper.height,null,!0);if(width&&pw!=width||height&&ph!=height){var args={},node=profile.getSubNode("SVG");paper.setSize(width,height),profile.$inDesign&&profile._frame&&((width||0===width)&&profile._frame.attr("width",width),(height||0===height)&&profile._frame.attr("height",height)),width||0===width||(width=pw),args.width=width,(height||0===height)&&(height=ph),args.height=height,!xui.isEmpty(args)&&xui.Dom.$hasEventHandler(node.get(0),"onsize")&&node.onSize(!0,args),scaleChildren&&paper.forEach((function(elem){var xuiElem,wr=width/ow,hr=height/oh,fun=function(elem,key){var xuiElem=xui.UIProfile.getFromDom(elem.node.id);if(xuiElem){var hash,attr=elem.attr();switch(elem.type){case"circle":hash={cx:attr.cx*wr,cy:attr.cy*hr,r:attr.r*(wr+hr)/2};break;case"ellipse":hash={cx:attr.cx*wr,cy:attr.cy*hr,rx:attr.rx*wr,ry:attr.ry*hr};break;case"rect":case"image":hash={x:attr.x*wr,y:attr.y*hr,width:attr.width*wr,height:attr.height*hr};break;case"text":hash={x:attr.x*wr,y:attr.y*hr};break;case"path":hash={path:Raphael.transformPath(xui.isArr(attr.path)?attr.path.join(""):attr.path,"s"+wr+","+hr+",0,0")}}hash&&xuiElem.boxing().setAttr(key||"KEY",hash,!1,!0)}};profile._frame!==elem&&elem.node.$xid&&elem.node.id&&!/^[^:]+-/.test(elem.node.id)&&(elem._isGroupFirst?(xuiElem=xui.UIProfile.getFromDom(elem.node.id))&&xuiElem._elset.forEach((function(o){fun(o,xuiElem.getKey(o.node.id,!0))})):fun(elem))}))}}}}}),xui.Class("xui.UI.FusionChartsXT","xui.UI",{Initialize:function(){window.JSON||(window.JSON={parse:function(a){return xui.unserialize(a)},stringify:function(a){return xui.stringify(a)}})},Instance:{initialize:function(){},refreshChart:function(dataFormat){return this.each((function(prf){prf&&prf.box&&(prf.boxing().busy(!1,""),prf.renderId)&&xui.resetRun("xui.UI.FusionChartsXT:"+prf.$xid,(function(){if(prf&&prf.box){var prop=prf.properties;prf._chartId&&(t=window.FusionCharts(prf._chartId))&&(t.dispose(),prf.getSubNode("BOX").html("",!1));var flag,fc=new window.FusionCharts(prop.chartType,prf._chartId,prf.$isEm(prop.width)?prf.$em2px(prop.width):prop.width,prf.$isEm(prop.height)?prf.$em2px(prop.height):prop.height);switch(dataFormat){case"XMLUrl":(xml=xui.getFileSync(prop.XMLUrl))&&fc.setXMLData(xml);break;case"JSONUrl":(json=xui.getFileSync(prop.JSONUrl))&&fc.setJSONData(json);break;case"XMLData":fc.setXMLData(prop.XMLData);break;default:var xml;if(prop.XMLUrl)(xml=xui.getFileSync(prop.XMLUrl))&&fc.setXMLData(xml);else if(prop.JSONUrl){var json;(json=xui.getFileSync(prop.JSONUrl))&&fc.setJSONData(json)}else prop.XMLData?fc.setXMLData(prop.XMLData):xui.isEmpty(prop.JSONData)||(flag=1,fc.setJSONData(prf.box._prepareFCData(prf,prop.JSONData)))}flag||fc.setJSONData(prf.box._prepareFCData(prf,fc.getJSONData())),fc.setTransparent(!0),fc.render(prf.getSubNode("BOX").id());var t=window.FusionCharts(prf._chartId),f1=function(a,argsMap){prf.onDataClick&&prf.boxing().onDataClick(prf,argsMap)};prf._f1&&t.removeEventListener("dataplotClick",prf._f1),prf._f2&&t.removeEventListener("dataLabelClick",prf._f2),prf._f3&&t.removeEventListener("annotationClick",prf._f3),t.addEventListener("dataplotClick",prf._f1=f1),t.addEventListener("dataLabelClick",prf._f2=f1),t.addEventListener("annotationClick",prf._f3=f1),prf.boxing().free()}}),200)}))},setTransparent:function(isTransparent){return this.each((function(prf){var t;xui.set(prf.properties,["JSONData","chart","bgalpha"],isTransparent?"0,0":""),prf.renderId&&prf._chartId&&(t=window.FusionCharts(prf._chartId))&&t.setTransparent(isTransparent)}))},getChartAttribute:function(key){var prf=this.get(0);return xui.isStr(key)?xui.get(prf.properties,["JSONData","chart",key]):xui.get(prf.properties,["JSONData","chart"])},setChartAttribute:function(key,value){var h={};return xui.isStr(key)?h[key]=value:h=key,this.each((function(prf){var t;if(prf.renderId&&prf._chartId&&(t=window.FusionCharts(prf._chartId)))t.setChartAttribute(h),xui.set(prf.properties,["JSONData","chart"],t.getChartAttribute());else{var opt=xui.get(prf.properties,["JSONData","chart"]);opt&&xui.merge(opt,h,"all")}}))},getFCObject:function(){var prf=this.get(0);return prf.renderId&&prf._chartId&&window.FusionCharts(prf._chartId)},getSVGString:function(){var prf=this.get(0),o=prf.renderId&&prf._chartId&&window.FusionCharts(prf._chartId);return o?o.getSVGString():null},fillData:function(data,index,isLineset){return this.each((function(prf){var JSONData=prf.properties.JSONData;data=xui.clone(data),xui.isArr(data)&&xui.isArr(data[0])?isLineset?JSONData.lineset=data:"dataset"in JSONData?JSONData.dataset=data:JSONData.data=data[0]:isLineset?"lineset"in JSONData&&xui.set(JSONData,["lineset",index||0,"data"],data):"dataset"in JSONData?xui.set(JSONData,["dataset",index||0,"data"],data):JSONData.data=data})),this.refreshChart()},updateData:function(index,value){return this.each((function(prf){var t;prf.renderId&&prf._chartId&&(t=window.FusionCharts(prf._chartId))&&t.setData&&t.setData(index,value)}))},updateDataById:function(key,value){return this.each((function(prf){var t;prf.renderId&&prf._chartId&&(t=window.FusionCharts(prf._chartId))&&t.setDataForId&&t.setDataForId(key,value)}))},callFC:function(funName,params){var fc;if((fc=this.getFCObject())&&xui.isFun(fc[funName]))return fc[funName].apply(fc,params||[])},configure:function(options){var t,prf=this.get(0);prf.renderId&&prf._chartId&&(t=window.FusionCharts(prf._chartId))&&t.configure(options)},setTheme:function(theme){return"string"==typeof theme&&theme||(theme=null),this.each((function(o){theme!=o.theme&&(null===theme?delete o.theme:o.theme=theme)})),this.setChartAttribute("theme",theme)}},Static:{_objectProp:{JSONData:1,configure:1,plotData:1,feedData:1},Appearances:{KEY:{overflow:"hidden"},BOX:{position:"absolute",left:0,top:0,"z-index":1},COVER:{position:"absolute",left:"-1px",top:"-1px",width:0,height:0,"z-index":4}},Templates:{tagName:"div",className:"{_className}",style:"{_style}",BOX:{tagName:"div"},COVER:{tagName:"div",style:"background-image:url("+xui.ini.img_bg+");"}},Behaviors:{HotKeyAllowed:!1},DataModel:{tabindex:null,defaultFocus:null,disableClickEffect:null,disableHoverEffect:null,disableTips:null,disabled:null,renderer:null,selectable:null,tips:null,width:{$spaceunit:1,ini:"30em"},height:{$spaceunit:1,ini:"25em"},chartCDN:"https://cdn.fusioncharts.com/fusioncharts/latest/fusioncharts.js",chartType:{ini:"Column2D",listbox:["Column2D","Column3D","Line","Area2D","Bar2D","Bar3D","Pie2D","Pie3D","Doughnut2D","Doughnut3D","Pareto2D","Pareto3D","MSColumn2D","MSColumn3D","MSLine","MSBar2D","MSBar3D","MSArea","Marimekko","ZoomLine","StackedColumn3D","StackedColumn2D","StackedBar2D","StackedBar3D","StackedArea2D","MSStackedColumn2D","MSCombi3D","MSCombi2D","MSColumnLine3D","StackedColumn2DLine","StackedColumn3DLine","MSCombiDY2D","MSColumn3DLineDY","StackedColumn3DLineDY","MSStackedColumn2DLineDY","Scatter","Bubble","ScrollColumn2D","ScrollLine2D","ScrollArea2D","ScrollStackedColumn2D","ScrollCombi2D","ScrollCombiDY2D","Funnel","RealTimeLine","RealTimeArea","RealTimeColumn","RealTimeLineDY","RealTimeStackedArea","RealTimeStackedColumn","HLinearGauge","Cylinder","HLED","VLED","Thermometer","AngularGauge","Pyramid ","Radar"],action:function(){this.renderId&&this.boxing().refreshChart()}},JSONData:{ini:{},get:function(){var fc,prop=this.properties;return xui.isEmpty(prop.JSONData)?(fc=this.boxing().getFCObject())?this.box._cleanData(this,fc.getJSONData()):void 0:prop.JSONData},set:function(data){var prop=this.properties;xui.isStr(data)&&(data=xui.unserialize(data)),data&&(prop.XMLData=prop.XMLUrl=prop.JSONUrl="",prop.JSONData=xui.clone(data),this.renderId&&this.boxing().refreshChart("JSONData"))}},XMLUrl:{ini:"",set:function(url){var prop=this.properties;prop.XMLUrl=url,prop.JSONUrl=prop.XMLData="",prop.JSONData={},this.renderId&&this.boxing().refreshChart("XMLUrl")}},XMLData:{ini:"",get:function(force){var fc,prop=this.properties;return prop.XMLData?prop.XMLData:(fc=this.boxing().getFCObject())?fc.getXMLData():void 0},set:function(url){var prop=this.properties;prop.XMLData=url,prop.XMLUrl=prop.JSONUrl="",prop.JSONData={},this.renderId&&this.boxing().refreshChart("XMLData")}},JSONUrl:{ini:"",set:function(url){var prop=this.properties;prop.JSONUrl=url,prop.XMLUrl=prop.XMLData="",prop.JSONData={},this.renderId&&this.boxing().refreshChart("JSONUrl")}},plotData:{ini:{},get:function(data){return(data=this.properties.JSONData).dataset||data.data||{}},set:function(data){var JSONData=this.properties.JSONData;"dataset"in JSONData||xui.isArr(data)&&xui.isArr(data[0])?JSONData.dataset=xui.clone(data):JSONData.data=xui.clone(data);var bak=JSONData.chart.animation;return JSONData.chart.animation="0",this.boxing().refreshChart(),bak?JSONData.chart.animation=bak:delete JSONData.chart.animation,this}},feedData:{ini:"",set:function(data){var t;this.renderId&&this._chartId&&(t=window.FusionCharts(this._chartId))&&t.feedData&&(xui.isFinite(data)&&(data="value="+data),t.feedData(data||""))}}},_cleanData:function(prf,data){var hoder="Javascript:void(0)";return data.dataset?xui.arr.each(data.dataset,(function(o,i){xui.arr.each(o.dataset,(function(v,j){xui.arr.each(v.data,(function(w,k){w.link==hoder&&delete w.link}))})),xui.arr.each(o.data,(function(v,j){v.link==hoder&&delete v.link}))})):data.data&&xui.arr.each(data.data,(function(o,i){o.link==hoder&&delete o.link,o.labelLink==hoder&&delete o.labelLink})),data.categories&&xui.arr.each(data.categories,(function(o,i){xui.arr.each(o.category,(function(v,j){v.link==hoder&&delete v.link}))})),data},_prepareFCData:function(prf,data){prf.$xid,data=xui.clone(data);var hoder="Javascript:void(0)";return data.dataset?xui.arr.each(data.dataset,(function(o,i){xui.arr.each(o.dataset,(function(v,j){xui.arr.each(v.data,(function(w,k){w.link||(w.link=hoder)}))})),xui.arr.each(o.data,(function(v,j){v.link||(v.link=hoder)}))})):data.data&&xui.arr.each(data.data,(function(o,i){o.link||(o.link=hoder),o.labelLink||(o.labelLink=hoder)})),data.categories&&xui.arr.each(data.categories,(function(o,i){xui.arr.each(o.category,(function(v,j){v.link||(v.link=hoder)}))})),data},RenderTrigger:function(){var prf=this,prop=prf.properties,fun=function(){prf&&prf.box&&(prf._chartId="FC_"+prf.properties.chartType+"_"+prf.$xid,xui.isEmpty(prf.properties.configure)||prf.boxing().setConfigure(prf.properties.configure,!0),prf.theme&&prf.boxing().setTheme(prf.theme),prf.boxing().refreshChart(),(prf.$beforeDestroy=prf.$beforeDestroy||{}).unsubscribe=function(){var t;this._chartId&&(t=window.FusionCharts(this._chartId))&&(t.removeEventListener("dataplotClick",prf._f1),t.removeEventListener("dataLabelClick",prf._f2),t.removeEventListener("annotationClick",prf._f3),prf._f1=prf._f2=prf._f3=null,t.dispose())})};window.FusionCharts?fun():(prf.boxing().busy(!1,"Loading charts ..."),xui.include("FusionCharts",prop.chartCDN,(function(){prf&&prf.box&&(prf.boxing().free(),fun())}),null,!1,{cache:!0}))},EventHandlers:{onFusionChartsEvent:function(profile,eventObject,argumentsObject){},onDataClick:function(profile,argsMap){},onLabelClick:function(profile,argsMap){},onAnnotationClick:function(profile,argsMap){},onShowTips:null},_onresize:function(prf,width,height){var t,size=prf.getSubNode("BOX").cssSize(),prop=prf.properties,us=xui.$us(prf),adjustunit=function(v,emRate){return prf.$forceu(v,us>0?"em":"px",emRate)},ww=(prf.getRoot(),width?prf.$px(width):width),hh=height?prf.$px(height):height;(width&&!xui.compareNumber(size.width,ww,6)||height&&!xui.compareNumber(size.height,hh,6))&&(width&&(prop.width=adjustunit(ww)),height&&(prop.height=adjustunit(hh)),size={width:width?prop.width:null,height:height?prop.height:null},prf.getSubNode("BOX").cssSize(size,!0),(prf.$inDesign||prop.cover)&&prf.getSubNode("COVER").cssSize(size,!0),prf.renderId&&prf._chartId&&(t=window.FusionCharts(prf._chartId))&&t.resizeTo(ww||void 0,hh||void 0))}}}),xui.Class("xui.UI.ECharts","xui.UI",{Initialize:function(){for(var dataModals={},i=0;i<9;i++)dataModals["dataValue"+(i+1)]={ini:"",dynamic:!0,get:function(index){return function(v){var echarts=this.boxing().getECharts();if(!echarts)return"";var option=echarts.getOption();if(!option.series)return"[x]";for(var hasData,arr=[],i=0,l=option.series.length;i<l;i++){var data=option.series[i].data;if(!data)return"";index<data.length?(data=data&&data[index],arr.push(xui.isSet(data)?xui.isHash(data)?data.value:data:""),hasData=1):arr.push("")}return hasData?arr.join(":"):""}}(i),set:function(index){return function(v,force){var echarts=this.boxing().getECharts();if(echarts){var updated,option=echarts.getOption();if(option.series){var s,d,updater=this.properties.optionUpdater;updater.series||(updater.series=option.series);for(var arr=(v+"").split(":"),i=0,l=arr.length;i<l;i++)i>=updater.series.length&&(updater.series[i]={type:updater.series[0]&&updater.series[0].type||"line",data:[]}),s=updater.series[i],""!==arr[i]&&(s.data||(s.data=[]),d=s.data,v=parseFloat(arr[i])||0,(force||v!==(xui.isHash(d[index])?d[index].value:d[index]))&&(xui.isHash(d[index])?d[index].value=v:d[index]=v,updated=1));updated&&this.boxing().setOptionUpdater(updater,!0)}}}}(i)},dataModals["realTimeData"+(i+1)]={ini:"",dynamic:!0,get:function(index){return function(v){var echarts=this.boxing().getECharts();if(!echarts)return"";var option=echarts.getOption();if(!option.series||!option.xAxis)return"[x]";var values=option.series[index]&&option.series[index].data,dataI=values&&values[values.length-1];return xui.isSet(dataI)?xui.isHash(dataI)?dataI.value:dataI:""}}(i),set:function(index){return function(v){v=parseFloat(v)||0;var echarts=this.boxing().getECharts();if(echarts){var option=echarts.getOption();if(option.series&&option.xAxis){var s,d,updater=this.properties.optionUpdater,columnSize=this.properties.realTimePoints;updater.xAxis||(updater.xAxis=option.xAxis),updater.series||(updater.series=option.series);var time=xui.Date.format(new Date,this.properties.xAxisDateFormatter);if((s=updater.xAxis[index])&&(d=s.data))for(d.push(time),d.length>=columnSize&&d.shift();d.length<columnSize;)d.unshift(0);if(index>=updater.series.length)for(var m=updater.series.length-1;m<=index;m++)updater.series[m]={type:updater.series[0]&&updater.series[0].type||"line",data:[]};for((s=updater.series[index]).data||(s.data=[]),(d=s.data).push(v),d.length>=columnSize&&d.shift();d.length<columnSize;)d.unshift(0);this.boxing().setOptionUpdater(updater,!0)}}}}(i)};xui.UI.ECharts.setDataModel(dataModals)},Instance:{_reBindProp:function(prf,hash,key){var fn,ins=prf.boxing(),nhash={};if("optionUpdater"==key&&xui.isHash(hash)){for(var i in hash)nhash[i]=xui.isFun(hash[i])?hash[i](prf):xui.adjustVar(hash[i]);return xui.isFun(ins[fn="set"+xui.str.initial(key)])&&ins[fn](nhash,!0),!1}},getECharts:function(){return this.get(0)&&this.get(0).$echarts},optionAdapter:function(option){return option},echarts_call:function(funName,params){var echarts=this.getECharts();if(echarts&&echarts[funName])return echarts[funName].apply(echarts,params||[])},echarts_dispatchAction:function(payload){return this.echarts_call("dispatchAction",[payload])},echarts_showLoading:function(type,opts){return this.echarts_call("showLoading",[type,opts])},echarts_hideLoading:function(){return this.echarts_call("hideLoading")},echarts_getOption:function(){return this.echarts_call("getOption",[])},echarts_setOption:function(option,notMerge,lazyUpdate,silent){return this.echarts_call("setOption",[option,notMerge,lazyUpdate,silent])},echarts_getDataURL:function(opts){return this.echarts_call("getDataURL",[opts])},echarts_getConnectedDataURL:function(opts){return this.echarts_call("getConnectedDataURL",[opts])},echarts_appendData:function(opts){return this.echarts_call("appendData",[opts])},echarts_clear:function(){return this.echarts_call("clear")},echarts_isDisposed:function(){return!this.get(0)||!this.get(0).$echarts||this.echarts_call("isDisposed")}},Static:{_objectProp:{chartOption:1,optionUpdater:1,dataset:1},Appearances:{KEY:{overflow:"hidden"},BOX:{position:"absolute",left:0,top:0,"z-index":1},COVER:{position:"absolute",left:"-1px",top:"-1px",width:0,height:0,"z-index":4}},Templates:{tagName:"div",className:"{_className}",style:"{_style}",BOX:{tagName:"div"},COVER:{tagName:"div",style:"background-image:url("+xui.ini.img_bg+");"}},Behaviors:{HotKeyAllowed:!1},DataModel:{tabindex:null,defaultFocus:null,disableClickEffect:null,disableHoverEffect:null,disableTips:null,disabled:null,renderer:null,selectable:null,tips:null,autoTips:null,width:{$spaceunit:1,ini:"30em"},height:{$spaceunit:1,ini:"25em"},chartCDN:"https://cdn.jsdelivr.net/npm/echarts@4.2.0-rc.2/dist/echarts.min.js",chartCDNGL:"https://cdn.jsdelivr.net/npm/echarts-gl@1.1.1/dist/echarts-gl.min.js",chartTheme:{ini:"",action:function(v){this.boxing().refresh()}},chartRenderer:{ini:"canvas",listbox:["","canvas","svg"],action:function(v){this.boxing().refresh()}},chartDevicePixelRatio:{ini:window.devicePixelRatio,action:function(v){this.boxing().refresh()}},chartResizeSilent:!1,chartOption:{ini:{},action:function(v){var ins=this.boxing(),prop=this.properties;if(!ins.echarts_isDisposed()&&this.$echarts){var option=xui.isFun(v.getOption)?v.getOption():v,binder=prop.optionUpdater;for(var i in binder)xui.set(option,i.split("."),binder[i]);if("dataset"in option&&!xui.isEmpty(option.dataset)){var t=option.dataset,dimensions=(t.dimensions||t.source&&t.source[0]||[0]).length;option.xAxis&&xui.isHash(option.xAxis)&&(option.xAxis=[option.xAxis]),option.yAxis&&xui.isHash(option.yAxis)&&(option.yAxis=[option.yAxis]),i=0;for(var l=dimensions-1;i<l;i++){var type=option.series[0]&&option.series[0].type||"line";option.series[i]?delete option.series[i].data:option.series[i]={type:type}}if(t=option.xAxis)for(i=0,l=t.length;i<l;i++)delete t[i].data;if(t=option.yAxis)for(i=0,l=t.length;i<l;i++)delete t[i].data;var opt=this.$echarts.getOption();if(opt){if(t=opt.series)for(i=0,l=t.length;i<l;i++)delete t[i].data;if(t=opt.xAxis)for(i=0,l=t.length;i<l;i++)delete t[i].data;if(t=opt.yAxis)for(i=0,l=t.length;i<l;i++)delete t[i].data;try{this.$echarts.setOption(opt,!0,!0,!0)}catch(e){xui.log(e)}}}if((v=prop.tagVar.optionAdapter)&&xui.isFun(v)&&(option=v.call(ins,option,this)),(v=ins.optionAdapter)&&xui.isFun(v)&&(option=v.call(ins,option,this)),!ins.beforeSetOption||!1!==ins.beforeSetOption(this,option))try{this.$echarts.setOption(option)}catch(e){xui.log(e)}}}},optionUpdater:{ini:{},action:function(v){var prf=this;xui.resetRun("echart-data-setting:"+prf.$xid,(function(){prf&&prf.box&&prf.boxing().setChartOption(prf.properties.chartOption,!0)}))}},dataset:{ini:{},get:function(){return this.properties.optionUpdater.dataset||{}},set:function(v,force){var prop=this.properties,f=prop.xAxisDateFormatter,o=prop.optionUpdater;if(v!==o.dataset||force)return v&&xui.isHash(v)?(o.dataset=v,f&&xui.each(o.dataset.source,(function(h,i){xui.isNumb(h[0])&&(h[0]=xui.Date.format(h[0],f))}))):delete o.dataset,this.boxing().setOptionUpdater(o,!0)}},xAxisDateFormatter:"hh:mm:ss",realTimePoints:5},RenderTrigger:function(){var prf=this,prop=prf.properties,fun=function(){if(prf&&prf.box){var opts={width:prf.$px(prop.width),height:prf.$px(prop.height)};"canvas"!=prop.chartRenderer&&(opts.chartRenderer=prop.chartRenderer),prop.chartDevicePixelRatio!=window.devicePixelRatio&&(opts.chartDevicePixelRatio=prop.chartDevicePixelRatio);var chart=window.echarts.init(prf.getSubNode("BOX").get(0),prop.chartTheme,opts);prf.$echarts=chart,prf.boxing().setChartOption(prop.chartOption,!0);var evts1="click,dblclick,mousedown,mouseup,mouseover,mouseout,globalout,contextmenu".split(",");prf.onMouseEvent&&xui.arr.each(evts1,(function(name){chart.on(name,(function(params){prf&&prf.onMouseEvent&&prf.onMouseEvent(prf,name,params)}))}));var evts2="legendselectchanged,legendunselected,legendscroll,datazoom,datarangeselected,timelinechanged,timelineplaychanged,restore,dataviewchanged,magictypechanged,geoselectchanged,geoselected,geounselected,pieselectchanged,pieselected,pieunselected,mapselectchanged,mapselected,mapunselected,axisareaselected,focusnodeadjacency,unfocusnodeadjacency,brush,brushselected,rendered,finished".split(",");prf.onChartEvent&&xui.arr.each(evts2,(function(name){chart.on(name,(function(params){prf&&prf.onChartEvent&&prf.onChartEvent(prf,name,params)}))})),(prf.$beforeDestroy=prf.$beforeDestroy||{}).destroyechart=function(){var t=this.$echarts;t&&(xui.arr.each(evts1,(function(name){t.off(name)})),xui.arr.each(evts2,(function(name){t.off(name)})),t.dispose(),delete this.$echarts)}}};if(window.echarts)fun();else{prf.boxing().busy(!1,"Loading charts ...");var gl=prop.chartCDNGL;xui.include("echarts",prop.chartCDN,(function(){gl&&xui.include("",gl,(function(){prf&&prf.box&&(prf.boxing().free(),fun())}),null,!1,{cache:!0})}),null,!1,{cache:!0})}},EventHandlers:{onMouseEvent:function(profile,eventName,eventParams){},onChartEvent:function(profile,eventName,eventParams){},beforeSetOption:function(prf,option){},onShowTips:null},_beforeSerialized:function(profile){for(var o=xui.UI._beforeSerialized.call(this,profile),op=o.properties,i=0;i<9;i++)delete op["realTimeData"+(i+1)],delete op["dataValue"+(i+1)];return delete op.optionUpdater,o},_onresize:function(prf,width,height){var t,size=prf.getSubNode("BOX").cssSize(),prop=prf.properties,us=xui.$us(prf),adjustunit=function(v,emRate){return prf.$forceu(v,us>0?"em":"px",emRate)},ww=(prf.getRoot(),width?prf.$px(width):width),hh=height?prf.$px(height):height;(width&&!xui.compareNumber(size.width,ww,6)||height&&!xui.compareNumber(size.height,hh,6))&&(width&&(prop.width=adjustunit(ww)),height&&(prop.height=adjustunit(hh)),size={width:width?prop.width:null,height:height?prop.height:null},prf.getSubNode("BOX").cssSize(size,!0),(prf.$inDesign||prop.cover)&&prf.getSubNode("COVER").cssSize(size,!0),prf.renderId&&(t=prf.$echarts)&&t.resize({width:ww,height:hh,silent:prop.chartResizeSilent}))}}}),xui.Class("xui.UI.FormLayout",["xui.UI","xui.absList"],{Initialize:function(){this.addTemplateKeys(["ITEM","TABLE","CBORDER","CBT","CBL","HOLDER","HIDER","SPREADER"])},Instance:{_isDesignMode:function(){return"design"==this.getMode()},getContainer:function(subId){var prf=this.get(0);return prf.ItemIdMapSubSerialId&&prf.ItemIdMapSubSerialId[subId]?arguments.callee.upper.apply(this,[subId]):this.getSubNode("POOL")}},Static:{HasHtmlTableNode:1,_CONTAINERKEY:"ITEM",_ITEMCONTAINER:1,_getActiveHanders:function(prf){return prf.boxing()._isDesignMode()?["KEY","HOLDER"]:null},_NoProp:{conLayoutColumns:1},_objectProp:{layoutData:1},Appearances:{KEY:{overflow:"hidden"},BOX:{position:"relative",left:0,top:0,"z-index":1},CBORDER:{position:"absolute",left:0,top:0},"CBORDER div":{position:"absolute",display:"block"},POOL:{position:"absolute",left:"-100%",top:"-100%",width:0,height:0},HOLDER:{overflow:"auto",position:"relative"},TABLE:{overflow:"hidden","border-collapse":"separate","border-spacing":"0",margin:"0","border-width":"0","table-layout":"fixed",width:"0","outline-width":"0",cursor:"default","max-width":"none","max-height":"none"},"ITEM:empty:after":{"text-align":"center",color:"#ccc",content:"attr(data-coord)",position:"absolute",top:"0",bottom:"0",left:"0",right:"0",margin:"auto",height:"1.5em","-moz-user-select":xui.browser.gek?"-moz-none":null,"-khtml-user-select":xui.browser.kde?"none":null,"-webkit-user-select":xui.browser.kde?"none":null,"-o-user-select":xui.browser.opr?"none":null,"-ms-user-select":xui.browser.ie||xui.browser.newie?"none":null,"user-select":"none","touch-action":"none"},"ITEM.layoutcell":{"border-right":"1px solid transparent","border-bottom":"1px solid transparent","border-left":"none","border-top":"none",$order:1},"ITEM.layoutcell.firstrow":{"border-top":"1px solid transparent",$order:2},"ITEM.layoutcell.firstcol":{"border-left":"1px solid transparent",$order:2},"BOX.solidgridline ITEM.layoutcell":{"border-right":"1px solid #444","border-bottom":"1px solid #444","border-left":"none","border-top":"none",$order:3},"BOX.solidgridline ITEM.layoutcell.firstrow":{"border-top":"1px solid #444",$order:4},"BOX.solidgridline ITEM.layoutcell.firstcol":{"border-left":"1px solid #444",$order:4},"KEY ITEM":{position:"relative",background:"transparent",height:"22px",padding:"0 4px",overflow:"hidden","outline-width":"0","white-space":"pre-line","empty-cells":"show","line-height":"1.22","text-align":"left","vertical-align":"middle","background-clip":"padding-box"},"KEY .handsontableInput":{"line-height":"1.22"},"KEY .handsontable tr":{background:"transparent"},"BOX.handsontable tr:first-child td, BOX.handsontable tr:first-child th":{"border-top":"none"},"BOX.handsontable tr:first-child > td, BOX.handsontable tr:first-child > th":{"border-top":"1px solid #ccc"},".handsontable.solidgridline td":{"border-right":"1px solid #444","border-bottom":"1px solid #444"},".handsontable.solidgridline tr:first-child > td":{"border-top":"1px solid #444"},".handsontable.solidgridline th:nth-child(2), .handsontable.solidgridline td:first-of-type, .handsontable.solidgridline .htNoFrame + th, .handsontable.solidgridline .htNoFrame + td":{"border-left":"1px solid #444"},".handsontable.nogridline td":{"border-right":"1px solid transparent","border-bottom":"1px solid transparent"},".handsontable.nogridline tr:first-child > td":{"border-top":"1px solid transparent"},".handsontable.nogridline th:nth-child(2), .handsontable.nogridline td:first-of-type, .handsontable.nogridline .htNoFrame + th, .handsontable.nogridline .htNoFrame + td":{"border-left":"1px solid transparent"}},Templates:{tagName:"div",className:"{_className}",style:"{_style}",BOX:{tagName:"div"},POOL:{tagName:"div"}},Behaviors:{DroppableKeys:["ITEM"],PanelKeys:["ITEM"],HotKeyAllowed:!1,ITEM:{}},DataModel:{tabindex:null,defaultFocus:null,disableClickEffect:null,disableHoverEffect:null,disableTips:null,disabled:null,renderer:null,selectable:null,tips:null,autoTips:null,overflow:null,items:{hidden:!0},listKey:null,dragSortable:null,mode:{ini:"write",listbox:["design","write","read"],get:function(){return this.$inDesign&&!this.getModule()?"design":this.properties.mode||"read"},action:function(){this.boxing().refresh()}},width:{$spaceunit:1,ini:"30em"},height:{$spaceunit:1,ini:"25em"},solidGridlines:{ini:!0,action:function(value){var cls=value?"solidgridline":this.boxing()._isDesignMode()?"":"nogridline",node=this.getSubNode("BOX");node.removeClass("solidgridline nogridline"),cls&&node.addClass(cls)}},stretchH:{ini:"all",listbox:["none","last","all"],action:function(){this.boxing()._isDesignMode()?this.box._updateSetting(this,"stretchH"):this.box._resizeTable(this,this.getSubNode("BOX").cssSize(),!0)}},rowHeaderWidth:{ini:25,action:function(){if(this.boxing()._isDesignMode()){this.box._updateSetting(this,"rowHeaderWidth");var size=this.getRoot().cssSize();xui.UI.$tryResize(this,size.width,size.height)}}},columnHeaderHeight:{ini:25,action:function(){if(this.boxing()._isDesignMode()){this.box._updateSetting(this,"columnHeaderHeight");var size=this.getRoot().cssSize();xui.UI.$tryResize(this,size.width,size.height)}}},floatHandler:{ini:!0,action:function(){if(this.boxing()._isDesignMode()){var size=this.getRoot().cssSize();xui.UI.$tryResize(this,size.width,size.height,!0)}}},defaultRowSize:5,defaultColumnSize:5,defaultRowHeight:50,_defaultColumnWidth:50,layoutData:{ini:{},action:function(){this.boxing().refresh()}},rendererCDNJS:{hidden:!0,ini:"https://cdn.jsdelivr.net/gh/linb/handsontable622/handsontable.full.min.js"},rendererCDNCSS:{hidden:!0,ini:"https://cdn.jsdelivr.net/gh/linb/handsontable622/handsontable.full.min.css"}},RenderTrigger:function(){var prf=this,prop=prf.properties,cls=prf.box;if(prf.boxing()._isDesignMode())if(window.Handsontable)cls._renderAsHandsontable(prf);else{var cssId="xui.UI.HTable:Handsontable";xui.CSS.includeLink(prop.rendererCDNCSS,cssId),xui.include("Handsontable",prop.rendererCDNJS,(function(){if(xui(cssId).get(0)){cls._renderAsHandsontable(prf);var size=prf.getRoot().cssSize();xui.UI.$tryResize(prf,size.width,size.height)}else xui.Thread.repeat((function(){if(xui(cssId).get(0)){cls._renderAsHandsontable(prf);var size=prf.getRoot().cssSize();return xui.UI.$tryResize(prf,size.width,size.height),!1}}),200)}),null,!1,{cache:!0})}else cls._renderAsH5Table(prf);prf.$handleCustomVars=function(d){d||xui.arr.each(prf.children,(function(c){delete c[0]._attached2cell,delete c[0]._autoexpand}))},prf.boxing().setSolidGridlines(prop.solidGridlines,!0)},EventHandlers:{onShowTips:null,onGetCellData:function(cellCoord,cellObj,cellChild){}},_getHeaderOffset:function(prf){var prop=prf.properties,offset={left:0,top:0};return prop.floatHandler&&prf.boxing()._isDesignMode()&&(offset.left=prop.rowHeaderWidth,offset.top=prop.columnHeaderHeight+1),offset},_layoutChanged:function(prf,force){(force||prf._$tableInited)&&xui.resetRun(prf.getUid("layoutchanged"),(function(){var oData=prf.properties.layoutData;prf.properties.layoutData=prf.box._getLayoutData(prf),prf.$onLayoutChanged&&prf.$onLayoutChanged(prf,oData,prf.properties.layoutData)}))},_getLayoutData:function(prf){prf.properties;var borders,data,t,p,s,tmp,cells={},rowSetting={},colSetting={},merged=[],layoutData={};if(t=prf.$htable){layoutData.rows=t.countRows(),layoutData.cols=t.countCols(),merged=xui.copy(xui.get(t.getPlugin("mergeCells"),["mergedCellsCollection","mergedCells"])),xui.isEmpty(merged)||(layoutData.merged=merged),s=t.getSettings(),p=t.getPlugin("ManualRowResize");for(var i=0,l=layoutData.rows;i<l;i++){var row=t.toPhysicalRow(i);p.manualRowHeights&&p.manualRowHeights[row]&&xui.set(rowSetting,[i+1,"manualHeight"],p.manualRowHeights[row]),(tmp=xui.isArr(s.rowHeights)?s.rowHeights[row]:s.rowHeights)&&xui.set(rowSetting,[i+1,"height"],tmp)}for(xui.isEmpty(rowSetting)||(layoutData.rowSetting=rowSetting),p=t.getPlugin("ManualColumnResize"),i=0,l=layoutData.cols;i<l;i++){var col=t.toPhysicalColumn(i);p.manualColumnWidths&&p.manualColumnWidths[col]&&xui.set(colSetting,[xui.ExcelFormula.toColumnChr(i+1),"manualWidth"],p.manualColumnWidths[col])}for(xui.isEmpty(colSetting)||(layoutData.colSetting=colSetting),i=0,l=(data=t.getData()).length;i<l;i++)for(var m=0,n=(row=data[i]).length;m<n;m++)xui.isSet(data[i][m])&&""!==data[i][m]&&xui.set(cells,[xui.ExcelFormula.toCellId(m,i),"value"],data[i][m]);for(i=0,l=layoutData.rows;i<l;i++){row=t.toPhysicalRow(i);var rowMetas=t.getCellMetaAtRow(row);for(m=0,n=rowMetas.length;m<n;m++)col=t.toPhysicalColumn(m),xui.isEmpty(rowMetas[col].style)||xui.set(cells,[xui.ExcelFormula.toCellId(m,i),"style"],xui.copy(rowMetas[col].style))}xui.isEmpty(cells)||(layoutData.cells=cells),(borders=t.getPlugin("customBorders").getBorders()).length&&(layoutData.customBorders=xui.clone(borders,(function(h,i){return"id"!=i&&"border"!=i})))}return layoutData},_renderAsH5Table:function(prf){var t,subSerialId,item,itemId,domId,styles,elem=prf.getSubNode("BOX").get(0),prop=prf.properties,layoutData=prop.layoutData,rowSize=layoutData.rows||prop.defaultRowSize,colSize=layoutData.cols||prop.defaultColumnSize,childrenMap={},merged={},merged2={},getCellData=function(childrenMap,itemId){var data=prf.onGetCellData&&prf.boxing().onGetCellData(prf,itemId,xui.get(layoutData,["cells",itemId]),childrenMap[itemId]);if(!xui.isSet(data))if(childrenMap[itemId]){var childPrf=childrenMap[itemId],ins=childPrf&&childPrf.boxing();data="xui.UI.RichEditor"==childPrf.key?"":"xui.UI.CheckBox"==childPrf.key||"xui.UI.SCheckBox"==childPrf.key?'<input type="checkbox" disabled tabindex="-1"  onclick="javascript:return false;"'+(ins.getUIValue()?"checked":"")+">"+ins.getCaption():ins.getShowValue?ins.getShowValue():ins.getValue?"$UIvalue"in childPrf.properties?ins.getUIValue():ins.getValue():ins.getCaption?ins.getCaption():ins.getHtml?ins.getHtml():ins.getLabel?ins.getLabel():""}else data=xui.get(layoutData,["cells",itemId,"value"]);return xui.isSet(data)?data:""},tpl=[];xui.arr.each(prf.children,(function(v){childrenMap[v[1]]=v[0]})),xui.arr.each(layoutData.merged,(function(v){merged[v.row+":"+v.col]=(v.rowspan>1?" rowspan="+v.rowspan:"")+(v.colspan?" colspan = "+v.colspan:"")+" ";for(var i=0,l=v.rowspan;i<l;i++)for(var j=0,k=v.colspan;j<k;j++)0===i&&0===j||(merged2[v.row+i+":"+(v.col+j)]=1)})),tpl.push("<div id='"+prf.key+"-HOLDER:"+prf.serialId+":' class='"+prf.getClass("HOLDER")+"' style='width:"+prop.width+"; height:"+prop.height+"' >"),tpl.push("<table id='"+prf.key+"-TABLE:"+prf.serialId+":' class='"+prf.getClass("TABLE")+"'"+("none"!=prop.stretchH?" style='width:"+prop.width+";'":"")+">");var colWidths=prf.box._getColWidths(prf,prf.$px(prop.width));tpl.push("<colgroup><col style='width:0;border:0;margin:0;padding:0;'></col>");for(var col=0,n=colSize;col<n;col++)tpl.push("<col style='width:"+colWidths[col]+";'></col>");tpl.push("</colgroup>"),tpl.push("<tbody>");for(var row=0,l=rowSize;row<l;row++){for(tpl.push("<tr><th style='width:0;border:0;margin:0;padding:0;"),(t=xui.get(layoutData,["rowSetting",row+1,"height"])||xui.get(layoutData,["rowSetting",row+1,"manualHeight"])||prop.defaultRowHeight)&&tpl.push("height:"+(t-1)+"px;"),tpl.push("'></th>"),col=0,n=colSize;col<n;col++)item={_serialId:subSerialId=prf.pickSubId("items"),col:col,row:row,id:itemId=xui.ExcelFormula.toCellId(col,row),value:getCellData(childrenMap,itemId),style:xui.get(layoutData,["cells",itemId,"style"])||{}},prf.ItemIdMapSubSerialId[itemId]=subSerialId,prf.SubSerialIdMapItem[subSerialId]=item,domId=prf.key+"-ITEM:"+prf.serialId+":"+subSerialId,styles=[],xui.each(item.style,(function(v,k){styles.push(k.replace(/[A-Z]/g,(function(a){return"-"+a.toLowerCase()}))+":"+v)})),merged2[row+":"+col]||(tpl.push("<td id='"+domId+"' class='layoutcell "+(0===row?"firstrow ":"")+(0===col?"firstcol ":"")+prf.getClass("ITEM")+"' style='"+styles.join(";")+"' "+(merged[row+":"+col]||"")+">"),tpl.push(item.value),tpl.push("</td>"));tpl.push("</tr>")}tpl.push("</tbody></table>"),tpl.push("<div id='"+prf.key+"-CBORDER:"+prf.serialId+":' class='"+prf.getClass("CBORDER")+"' ></div>"),tpl.push("</div>"),elem.innerHTML=tpl.join(""),xui.UI.$addEventsHandler(prf,elem,!1),prf.box._setCustomBorders(prf);var arr=[];xui.each(prf.children,(function(v){arr.push(v)})),prf.children=[],xui.arr.each(arr,(function(v){prf.boxing().append(v[0],v[1])}))},_renderAsHandsontable:function(prf){if(prf&&prf.box){var t,onLayoutChanged=function(prf,force){prf.box._layoutChanged(prf,force)},elem=prf.getSubNode("BOX").get(0),prop=prf.properties,layoutData=prop.layoutData,fixedSet={autoWrapRow:!0,renderAllRows:!0,persistentState:!1,readOnly:!1,readOnlyCellClassName:"no",comments:!1,disableVisualSelection:!1,enterBeginsEditing:!0,manualRowMove:!0,manualColumnMove:!0,contextMenu:!0,copyable:!0,copyPaste:!0,beforeOnCellMouseDown:function(e,c){-1===c.row&&-1===c.col&&e.stopImmediatePropagation()},afterOnCellMouseUp:function(e,c){-1===c.row&&-1===c.col&&(this.deselectCell(),prf.getRoot().onClick(!0),e.stopImmediatePropagation())},beforeRenderer:function(TD,row,col,vprop,value,cellprop){var subSerialId=prf.pickSubId("items"),itemId=xui.ExcelFormula.toCellId(col,row);for(var i in cellprop.oid=cellprop.id,cellprop.id=itemId,cellprop.oid&&cellprop.oid!=cellprop.id&&(prf.$cellIdChangedMap[cellprop.oid]=cellprop.id),cellprop._serialId=subSerialId,prf.ItemIdMapSubSerialId[itemId]=subSerialId,prf.SubSerialIdMapItem[subSerialId]=cellprop,cellprop.style||(cellprop.style=xui.get(prop.layoutData,["cells",xui.ExcelFormula.toCellId(col,row),"style"])||{}),TD.id=prf.key+"-ITEM:"+prf.serialId+":"+subSerialId,xui.UI.$addEventsHandler(prf,TD,!0),cellprop.style)TD.style[i]=cellprop.style[i];TD.className=(TD.className||"")+prf.getClass("ITEM"),TD.setAttribute("data-coord",itemId),cellprop._child_autoexpandH?TD.style.height=cellprop._child_autoexpandH+"px":TD.style.height=""},beforeRender:function(flag){if(prf._$tableInited){prf.$cellIdChangedMap={};var pool=prf.getSubNode("POOL").get(0),arr=[];for(var i in xui.arr.each(prf.children,(function(v){v[0]&&v[0].rendered&&(pool.appendChild(v[0].getRootNode()),arr.push(v))})),arr.length&&(prf._pool_children=arr),prf.children=[],prf.SubSerialIdMapItem)prf.reclaimSubId(i,"items");prf.ItemIdMapSubSerialId={},prf.SubSerialIdMapItem={}}},afterInit:function(){prf._$tableInited=1},afterRender:function(isForced){var table=this;xui.tryF(prf.$onrender,[],prf);var node=prf.getSubNode("BOX");if((node=node.first()).id(prf.key+"-MASTER:"+prf.serialId+":"),(node=node.first()).id(prf.key+"-HOLDER:"+prf.serialId+":"),(node=node.first()).id(prf.key+"-HIDER:"+prf.serialId+":"),(node=node.first()).id(prf.key+"-SPREADER:"+prf.serialId+":"),"auto"==prf.properties.height&&prf.getSubNodes("BOX").height("auto"),prf._$tableInited){var map=prf.$cellIdChangedMap,exists=prf.ItemIdMapSubSerialId;xui.each(prf.SubSerialIdMapItem,(function(cell){var formula,ov=table.getDataAtCell(cell.row,cell.col);if(ov&&"="==(ov+"").charAt(0)){var nv=(formula=ov,xui.replace(formula,[[/\/\*[^*]*\*+([^\/][^*]*\*+)*\//,"$0"],[/\/\/[^\n]*/,"$0"],[/\/(\\[\/\\]|[^*\/])(\\.|[^\/\n\\])*\/[gim]*/,"$0"],[/"(\\.|[^"\\])*"/,"$0"],[/'(\\.|[^'\\])*'/,"$0"],[/[\w]+\(/,"$0"],[/\b([A-Z]+[\d]+)\b/,function(a){return map[a[0]]||(exists[a[0]]?a[0]:"'"+a[0]+"'")}]]));nv!==ov&&table.setDataAtCell(cell.row,cell.col,nv)}})),prf._pool_children&&(xui.arr.each(prf._pool_children,(function(v){delete v[0].$dockParent,prf.boxing().append(v[0],map[v[1]]||v[1])})),delete prf._pool_children)}else{var arr=[];xui.each(prf.children,(function(v){arr.push(v)})),prf.children=[],xui.arr.each(arr,(function(v){prf.boxing().append(v[0],v[1])})),prf.getRoot().onMouseup((function(p,e){prf.$lastMousePos=xui.Event.getPos(e)}))}},afterSelection:function(){prop.floatHandler&&prf.getRoot().css("overflow","visible")},outsideClickDeselects:function(node){for(;(!node.id||node.id==xui.$localeDomId||"tspan"==node.tagName)&&node.parentNode!==document&&node.parentNode!==window;)node=node.parentNode;var p=xui.UIProfile.getFromDom(node);if(p&&prf.$popmenu){var r=prf.$popmenu.get(0);if(p==r||p.$parentPopMenu==r||p.$popGrp==r.$popGrp)return!1}return prf.getRoot().css("overflow",""),!0},afterContextMenuShow:function(context){prf.$onPopMenu&&(prf.$popmenu=prf.$onPopMenu(prf,prf.$popmenu,context.menu)),context.menu.container.style.display="none"},afterUpdateSettings:function(){},afterRedo:function(){onLayoutChanged(prf)},afterUndo:function(){onLayoutChanged(prf)},afterChange:function(change,source){"loadData"!=source&&"populateFromArray"!=source&&onLayoutChanged(prf)},beforeCellAlignment:function(){onLayoutChanged(prf)},afterMergeCells:function(a,b,auto){auto||onLayoutChanged(prf)},afterUnmergeCells:function(a,b,auto){auto||onLayoutChanged(prf)},afterRowResize:function(row,size,dblclick){onLayoutChanged(prf);for(var cells=this.getCellMetaAtRow(row),i=0,l=cells.length;i<l;i++){var target=prf.boxing().getChildren(cells[i].id);target["xui.UI.Input"]&&target.getMultiLines&&target.getMultiLines()&&target.setAutoexpand&&(target.get(0)._autoexpand=size-1+"px")}"auto"==prf.properties.height&&prf.box._resizeTable(prf,{height:"auto"})},afterColumnResize:function(){onLayoutChanged(prf)},afterColumnSort:function(){onLayoutChanged(prf)},afterRowMove:function(rows,target){onLayoutChanged(prf)},afterColumnMove:function(){onLayoutChanged(prf)},afterCreateCol:function(index,amount){onLayoutChanged(prf);for(var p=this.getPlugin("ManualColumnResize"),arr=[],i=0;i<amount;i++)arr.push(prop._defaultColumnWidth);for(p.manualColumnWidths||(p.manualColumnWidths=[]),i=0;i<index;i++)p.manualColumnWidths[i]=p.manualColumnWidths[i]||void 0;p.manualColumnWidths.splice.apply(p.manualColumnWidths,[index,0].concat(arr)),this.deselectCell();var ns=this;xui.asyRun((function(){ns.selectColumns(index)}))},afterCreateRow:function(index,amount){onLayoutChanged(prf);for(var p=this.getPlugin("ManualRowResize"),arr=[],i=0;i<amount;i++)arr.push(prop.defaultRowHeight);for(p.manualRowHeights||(p.manualRowHeights=[]),i=0;i<index;i++)p.manualRowHeights[i]=p.manualRowHeights[i]||void 0;p.manualRowHeights.splice.apply(p.manualRowHeights,[index,0].concat(arr)),this.deselectCell();var ns=this;xui.asyRun((function(){ns.selectRows(index)})),"auto"==prf.properties.height&&prf.box._resizeTable(prf,{height:"auto"})},afterRemoveCol:function(index,amount){onLayoutChanged(prf);var p=this.getPlugin("ManualColumnResize");p.manualColumnWidths&&p.manualColumnWidths.splice(index,amount),this.deselectCell()},afterRemoveRow:function(index,amount){onLayoutChanged(prf);var p=this.getPlugin("ManualRowResize");p.manualRowHeights&&p.manualRowHeights.splice(index,amount),this.deselectCell(),"auto"==prf.properties.height&&prf.box._resizeTable(prf,{height:"auto"})}},settings={},offset=prf.box._getHeaderOffset(prf);if("auto"!=prop.height&&(settings.height=prf.$px(prop.height)+offset.top),settings.width=prf.$px(prop.width)+offset.left,settings.stretchH="last"==(t=prop.stretchH)?"last":"all"==t?"all":"none",settings.rowHeaderWidth=prop.rowHeaderWidth,settings.columnHeaderHeight=prop.columnHeaderHeight,settings.defaultColumnWidth=prop._defaultColumnWidth,settings.rowHeaders=!0,settings.colHeaders=!0,layoutData.merged?settings.mergeCells=layoutData.merged:settings.mergeCells=!0,layoutData.cols){var row,minRowHeights=[],manualRowResize=[],manualColumnResize=[],data=[];xui.each(layoutData.rowSetting,(function(v,k){xui.isSet(v.manualHeight||v)&&(manualRowResize[parseInt(k,10)-1]=parseInt(v.manualHeight||v,10)),xui.isSet(v.height||v)&&(minRowHeights[parseInt(k,10)-1]=parseInt(v.height||v,10))})),xui.each(layoutData.colSetting,(function(v,k){k=xui.ExcelFormula.toColumnNum(k),xui.isSet(v.manualWidth||v)&&(manualColumnResize[k-1]=parseInt(v.manualWidth||v,10))}));for(var i=0,l=layoutData.rows||prop.defaultRowSize;i<l;i++){data.push(row=[]);for(var m=0,n=layoutData.cols||prop.defaultColumnSize;m<n;m++)row.push(null)}for(xui.each(layoutData.cells,(function(cell,id){var coord=xui.ExcelFormula.toCoordinate(id);data[coord.row][coord.col]=xui.isSet(cell.value)?cell.value:null})),i=0;i<layoutData.rows;i++)manualRowResize[i]=manualRowResize[i]||prop.defaultRowHeight;settings.manualRowResize=manualRowResize,settings.manualColumnResize=!!xui.isEmpty(manualColumnResize)||manualColumnResize,xui.isEmpty(minRowHeights)||(settings.rowHeights=minRowHeights),settings.data=data,layoutData.customBorders&&(settings.customBorders=layoutData.customBorders)}else{for(settings.manualColumnResize=!0,manualRowResize=[],i=0;i<prop.defaultRowSize;i++)manualRowResize[i]=prop.defaultRowHeight;settings.manualRowResize=manualRowResize}prf.$htable=new window.Handsontable(elem,xui.merge(settings,fixedSet,"all")),layoutData.cols||(prf.properties.layoutData=prf.box._getLayoutData(prf)),(prf.$beforeDestroy=prf.$beforeDestroy||{}).destroyhtable=function(){var t;if(t=this.$htable){var node=this.getSubNode("BOX").get(0);node&&xui.$purgeChildren(node),t.isDestroyed||(window.Handsontable.hooks.destroy(t),t.destroy()),delete this.$htable}(t=this.$popmenu)&&t.destroy()}}},_getColWidths:function(prf,tableWidth){var t,per,prop=prf.properties,layoutData=prop.layoutData,colSize=layoutData.cols||prop.defaultColumnSize,reCalculated=[],colWidths=[],fix=0,count=0,bW=0;if("all"==prop.stretchH){for(var col=0,n=colSize;col<n;col++){var chr=xui.ExcelFormula.toColumnChr(col+1);(t=xui.get(layoutData,["colSetting",chr,"manualWidth"]))?(fix+=t,reCalculated.push(t)):(count++,reCalculated.push(null))}per=(tableWidth-fix)/count,Math.round(per)}for(col=0,n=colSize;col<n;col++){var aW;switch(chr=xui.ExcelFormula.toColumnChr(col+1),t=xui.get(layoutData,["colSetting",chr,"manualWidth"])||prop._defaultColumnWidth,prf.properties.stretchH){case"all":bW+=aW=null===reCalculated[col]?Math.max(prop._defaultColumnWidth,Math.round(per)):reCalculated[col],colWidths.push((col==colSize-1?Math.round(tableWidth-bW+aW):aW)+"px");break;case"last":colWidths.push(col==colSize-1?"100%":t+"px");break;default:colWidths.push(t+"px")}}return colWidths},_setCustomBorders:function(prf){xui.resetRun(prf.getUid()+":cborder",(function(){if(prf.renderId){var cborder=prf.getSubNode("CBORDER").get(0);xui.arr.each(prf.properties.layoutData.customBorders,(function(conf){var id,div,style,itemId=xui.ExcelFormula.toCellId(conf.col,conf.row),subSerialId=prf.ItemIdMapSubSerialId[itemId],table=prf.getSubNode("TABLE").get(0),td=prf.getSubNode("ITEM",subSerialId),pos=td.offset(null,table);conf.top&&conf.top.width&&(id=prf.key+"-CBT:"+prf.serialId+":"+subSerialId,style=(div=xui.Dom.byId(id))&&div.style,div||((div=document.createElement("div")).id=id,cborder.appendChild(div)),(style=div.style).backgroundColor=conf.top.color,style.left=pos.left-1+"px",style.top=pos.top-1+"px",style.width=td.offsetWidth()+"px",style.height="1px"),conf.left&&conf.left.width&&(id=prf.key+"-CBL:"+prf.serialId+":"+subSerialId,(div=xui.Dom.byId(id))||((div=document.createElement("div")).id=id,cborder.appendChild(div)),(style=div.style).backgroundColor=conf.left.color,style.left=pos.left-1+"px",style.top=pos.top-1+"px",style.width="1px",style.height=td.offsetHeight()+"px")}))}}))},_resizeTable:function(prf,size,force){var node=prf.getSubNode("HOLDER"),autoH="auto"==prf.properties.height;if(node.get(0))if(prf.boxing()._isDesignMode()){var t;if(t=prf.$htable){var holder=node.cssSize();autoH&&(size.height=prf.getSubNode("HIDER").height()),holder.width==size.width&&holder.height==size.height||(size.mergeCells=xui.copy(xui.get(t.getPlugin("mergeCells"),["mergedCellsCollection","mergedCells"])),t.updateSettings(size))}}else{autoH&&(size.height="auto"),node.cssSize(size);var tb=prf.getSubNode("TABLE");if(tb.get(0)){if(!autoH&&"none"!=prf.properties.stretchH){var rw=size.width-(tb.offsetHeight()>size.height?xui.Dom.getScrollBarSize():0);tb.width(rw)}if(force||"all"==prf.properties.stretchH){var colWidths=this._getColWidths(prf,rw);tb.first().children().each((function(node,i){0!==i&&(node.style.width=colWidths[i-1])}))}var cells=[];prf.getSubNodes("ITEM",!0).each((function(cell){xui.Dom.$hasEventHandler(cell,"onsize")&&cells.push(cell)})),cells.length&&xui(cells).onSize(!0),prf.box._setCustomBorders(prf)}}},_updateSetting:function(prf,opt){var t=prf.$htable;if("string"==typeof opt){var h={};h[opt]=prf.properties[opt],opt=h}opt.mergeCells=xui.copy(xui.get(t.getPlugin("mergeCells"),["mergedCellsCollection","mergedCells"])),t.updateSettings(opt)},$beforeAppend:function(prf,target,subId){if(!subId)return!1;1==target.size()&&xui.arr.each(prf.children,(function(v){v[0]&&subId==v[1]&&v[0]!==target.get(0)&&v[0].boxing().destroy()}),!0)},$afterAppend:function(prf,target,subId){if(subId&&prf.renderId&&target["xui.UI"]&&1==target.size()){var item=prf.getItemByItemId(subId),inputPrf=target.get(0),iProp=inputPrf.properties;if(item){var cell=prf.getSubNode("ITEM",item._serialId),isFormField=inputPrf.box._isFormField?inputPrf.box._isFormField(inputPrf):!!xui.get(inputPrf,["properties","isFormField"]),mode=prf.boxing().getMode(),show="read"!=mode||target["xui.UI.RichEditor"];if(!isFormField||iProp.name&&!prf.ItemIdMapSubSerialId[iProp.name]||(iProp.name=item.id),cell&&cell.get(0)&&inputPrf._cellresizeP!=cell){var adjustSize=function(){cell.get(0)&&(target.setPosition("absolute").setLeft(0).setTop(0),target.setWidth&&target.setWidth(cell.offsetWidth()-(item.col?1:2)),target.setHeight&&target.setHeight(cell.offsetHeight()-(item.row?1:2)))};adjustSize(),cell.onSize(adjustSize,"cellresize"),inputPrf._cellresizeP=cell}inputPrf._attached2cell||(inputPrf._attached2cell=1,isFormField&&(show?(inputPrf.locked=1,inputPrf.boxing().setDisplay(""),target.setLabelPos&&target.setLabelPos("none").setLabelCaption("").setLabelSize("0"),target.setVAlign&&target.setVAlign("middle"),target["xui.UI.Input"]&&target.getMultiLines&&target.getMultiLines()&&target.setAutoexpand&&(parseFloat(inputPrf._autoexpand)||(inputPrf._autoexpand=cell.offsetHeight()-1+"px",inputPrf.getSubNode("INPUT").addClass("autoexpand"),inputPrf.$beforeAutoexpand=function(p,h){return h=target.getAutoexpandHeight(),item._child_autoexpandH=h,prf.boxing()._isDesignMode()?xui.resetRun(prf.getUid("autoex"),(function(){prf.$htable&&prf.$htable.render()})):cell.height(h),prf.boxing()._isDesignMode()||prf.box._setCustomBorders(prf),!1},inputPrf.box._checkAutoexpand(inputPrf))),"read"==mode&&target.setReadonly&&target.setReadonly(!0,!0)):inputPrf.boxing().setDisplay("none")),inputPrf.$handleCustomVars=function(d){if(!d)return{_attached2cell:this._attached2cell,_autoexpand:this._autoexpand,$beforeAutoexpand:this.$beforeAutoexpand};for(var i in d)d[i]&&(this[i]=d[i])})}}},_onresize:function(prf,width,height){var prop=prf.properties,autoh="auto"==prop.height,us=xui.$us(prf),adjustunit=function(v,emRate){return prf.$forceu(v,us>0?"em":"px",emRate)},boxNode=(prf.getRoot(),prf.getSubNode("BOX")),offset=prf.box._getHeaderOffset(prf),ww=width?prf.$px(width):width,hh=height?prf.$px(height):height;autoh&&(height=null),(width||height)&&(width&&(prop.width=adjustunit(ww)),height&&(prop.height=adjustunit(hh)),boxNode.css({marginLeft:-offset.left+"px",marginTop:-offset.top+"px",width:width?ww+offset.left+"px":null,height:autoh?"auto":height?hh+offset.top+"px":null}),xui.resetRun(prf.getUid("resize"),(function(){prf&&prf.box&&prf.box._resizeTable(prf,prf.getSubNode("BOX").cssSize())})))}}}),xui},"function"==typeof define&&define.amd?define((function(){return factory.call(root)})):"object"==typeof module&&module.exports?module.exports=root&&root.document?factory.call(root):function(w){if(!w.document)throw new Error("xui requires a window with a document");return factory.call(w)}:root.xui=factory.call(root);